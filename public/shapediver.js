(function(l,C){"object"===typeof exports&&"undefined"!==typeof module?C(exports):"function"===typeof define&&define.amd?define(["exports"],C):C(l.THREE={})})(this,function(l){function C(a,b){this.x=a||0;this.y=b||0}function M(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function ia(a,b,c,d){this._x=a||0;this._y=b||0;this._z=c||0;this._w=void 0!==d?d:1}function p(a,b,c){this.x=a||
   0;this.y=b||0;this.z=c||0}function la(){this.elements=[1,0,0,0,1,0,0,0,1];0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function kb(a,b,c,d,e,f,g,h,k,m,q,n){ta.call(this,null,f,g,h,k,m,d,e,q,n);this.image={data:a,width:b,height:c};this.magFilter=void 0!==k?k:1003;this.minFilter=void 0!==m?m:1003;this.flipY=this.generateMipmaps=!1;this.unpackAlignment=1}function Va(a,b){this.min=void 0!==a?a:new p(Infinity,Infinity,Infinity);this.max=
   void 0!==b?b:new p(-Infinity,-Infinity,-Infinity)}function za(a,b){this.center=void 0!==a?a:new p;this.radius=void 0!==b?b:0}function Pa(a,b){this.normal=void 0!==a?a:new p(1,0,0);this.constant=void 0!==b?b:0}function ld(a,b,c,d,e,f){this.planes=[void 0!==a?a:new Pa,void 0!==b?b:new Pa,void 0!==c?c:new Pa,void 0!==d?d:new Pa,void 0!==e?e:new Pa,void 0!==f?f:new Pa]}function ca(a,b,c,d){this.x=a||0;this.y=b||0;this.z=c||0;this.w=void 0!==d?d:1}function Qd(){function a(e,f){!1!==c&&(d(e,f),b.requestAnimationFrame(a))}
   var b=null,c=!1,d=null;return{start:function(){!0!==c&&null!==d&&(b.requestAnimationFrame(a),c=!0)},stop:function(){c=!1},setAnimationLoop:function(a){d=a},setContext:function(a){b=a}}}function Gf(a){function b(b,c){var d=b.array,e=b.dynamic?a.DYNAMIC_DRAW:a.STATIC_DRAW,h=a.createBuffer();a.bindBuffer(c,h);a.bufferData(c,d,e);b.onUploadCallback();c=a.FLOAT;d instanceof Float32Array?c=a.FLOAT:d instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):
   d instanceof Uint16Array?c=a.UNSIGNED_SHORT:d instanceof Int16Array?c=a.SHORT:d instanceof Uint32Array?c=a.UNSIGNED_INT:d instanceof Int32Array?c=a.INT:d instanceof Int8Array?c=a.BYTE:d instanceof Uint8Array&&(c=a.UNSIGNED_BYTE);return{buffer:h,type:c,bytesPerElement:d.BYTES_PER_ELEMENT,version:b.version}}var c=new WeakMap;return{get:function(a){a.isInterleavedBufferAttribute&&(a=a.data);return c.get(a)},remove:function(b){b.isInterleavedBufferAttribute&&(b=b.data);var d=c.get(b);d&&(a.deleteBuffer(d.buffer),
   c.delete(b))},update:function(d,e){d.isInterleavedBufferAttribute&&(d=d.data);var f=c.get(d);if(void 0===f)c.set(d,b(d,e));else if(f.version<d.version){var g=d,h=g.array,k=g.updateRange;a.bindBuffer(e,f.buffer);!1===g.dynamic?a.bufferData(e,h,a.STATIC_DRAW):-1===k.count?a.bufferSubData(e,0,h):0===k.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(a.bufferSubData(e,
   k.offset*h.BYTES_PER_ELEMENT,h.subarray(k.offset,k.offset+k.count)),k.count=-1);f.version=d.version}}}}function lb(a,b,c,d){this._x=a||0;this._y=b||0;this._z=c||0;this._order=d||lb.DefaultOrder}function Rd(){this.mask=1}function B(){Object.defineProperty(this,"id",{value:Hf++});this.uuid=Q.generateUUID();this.name="";this.type="Object3D";this.parent=null;this.children=[];this.up=B.DefaultUp.clone();var a=new p,b=new lb,c=new ia,d=new p(1,1,1);b.onChange(function(){c.setFromEuler(b,!1)});c.onChange(function(){b.setFromQuaternion(c,
   void 0,!1)});Object.defineProperties(this,{position:{enumerable:!0,value:a},rotation:{enumerable:!0,value:b},quaternion:{enumerable:!0,value:c},scale:{enumerable:!0,value:d},modelViewMatrix:{value:new M},normalMatrix:{value:new la}});this.matrix=new M;this.matrixWorld=new M;this.matrixAutoUpdate=B.DefaultMatrixAutoUpdate;this.matrixWorldNeedsUpdate=!1;this.layers=new Rd;this.visible=!0;this.receiveShadow=this.castShadow=!1;this.frustumCulled=!0;this.renderOrder=0;this.userData={}}function Qa(){B.call(this);
   this.type="Camera";this.matrixWorldInverse=new M;this.projectionMatrix=new M}function Jb(a,b,c,d,e,f){Qa.call(this);this.type="OrthographicCamera";this.zoom=1;this.view=null;this.left=a;this.right=b;this.top=c;this.bottom=d;this.near=void 0!==e?e:.1;this.far=void 0!==f?f:2E3;this.updateProjectionMatrix()}function Wa(a,b,c,d,e,f){this.a=a;this.b=b;this.c=c;this.normal=d&&d.isVector3?d:new p;this.vertexNormals=Array.isArray(d)?d:[];this.color=e&&e.isColor?e:new G;this.vertexColors=Array.isArray(e)?
   e:[];this.materialIndex=void 0!==f?f:0}function K(){Object.defineProperty(this,"id",{value:If+=2});this.uuid=Q.generateUUID();this.name="";this.type="Geometry";this.vertices=[];this.colors=[];this.faces=[];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingSphere=this.boundingBox=null;this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.verticesNeedUpdate=
   this.elementsNeedUpdate=!1}function P(a,b,c){if(Array.isArray(a))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="";this.array=a;this.itemSize=b;this.count=void 0!==a?a.length/b:0;this.normalized=!0===c;this.dynamic=!1;this.updateRange={offset:0,count:-1};this.version=0}function qc(a,b,c){P.call(this,new Int8Array(a),b,c)}function rc(a,b,c){P.call(this,new Uint8Array(a),b,c)}function sc(a,b,c){P.call(this,new Uint8ClampedArray(a),b,c)}function tc(a,b,c){P.call(this,
   new Int16Array(a),b,c)}function mb(a,b,c){P.call(this,new Uint16Array(a),b,c)}function uc(a,b,c){P.call(this,new Int32Array(a),b,c)}function nb(a,b,c){P.call(this,new Uint32Array(a),b,c)}function A(a,b,c){P.call(this,new Float32Array(a),b,c)}function vc(a,b,c){P.call(this,new Float64Array(a),b,c)}function Ae(){this.vertices=[];this.normals=[];this.colors=[];this.uvs=[];this.uvs2=[];this.groups=[];this.morphTargets={};this.skinWeights=[];this.skinIndices=[];this.boundingSphere=this.boundingBox=null;
   this.groupsNeedUpdate=this.uvsNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.verticesNeedUpdate=!1}function Be(a){if(0===a.length)return-Infinity;for(var b=a[0],c=1,d=a.length;c<d;++c)a[c]>b&&(b=a[c]);return b}function E(){Object.defineProperty(this,"id",{value:Jf+=2});this.uuid=Q.generateUUID();this.name="";this.type="BufferGeometry";this.index=null;this.attributes={};this.morphAttributes={};this.groups=[];this.boundingSphere=this.boundingBox=null;this.drawRange={start:0,count:Infinity};
   this.userData={}}function Kb(a,b,c,d,e,f){K.call(this);this.type="BoxGeometry";this.parameters={width:a,height:b,depth:c,widthSegments:d,heightSegments:e,depthSegments:f};this.fromBufferGeometry(new ob(a,b,c,d,e,f));this.mergeVertices()}function ob(a,b,c,d,e,f){function g(a,b,c,d,e,f,g,l,da,J,C){var r=f/da,v=g/J,z=f/2,w=g/2,x=l/2;g=da+1;var H=J+1,y=f=0,O,A,Fa=new p;for(A=0;A<H;A++){var B=A*v-w;for(O=0;O<g;O++)Fa[a]=(O*r-z)*d,Fa[b]=B*e,Fa[c]=x,m.push(Fa.x,Fa.y,Fa.z),Fa[a]=0,Fa[b]=0,Fa[c]=0<l?1:-1,
   q.push(Fa.x,Fa.y,Fa.z),n.push(O/da),n.push(1-A/J),f+=1}for(A=0;A<J;A++)for(O=0;O<da;O++)a=u+O+g*(A+1),b=u+(O+1)+g*(A+1),c=u+(O+1)+g*A,k.push(u+O+g*A,a,c),k.push(a,b,c),y+=6;h.addGroup(t,y,C);t+=y;u+=f}E.call(this);this.type="BoxBufferGeometry";this.parameters={width:a,height:b,depth:c,widthSegments:d,heightSegments:e,depthSegments:f};var h=this;a=a||1;b=b||1;c=c||1;d=Math.floor(d)||1;e=Math.floor(e)||1;f=Math.floor(f)||1;var k=[],m=[],q=[],n=[],u=0,t=0;g("z","y","x",-1,-1,c,b,a,f,e,0);g("z","y","x",
   1,-1,c,b,-a,f,e,1);g("x","z","y",1,1,a,c,b,d,f,2);g("x","z","y",1,-1,a,c,-b,d,f,3);g("x","y","z",1,-1,a,b,c,d,e,4);g("x","y","z",-1,-1,a,b,-c,d,e,5);this.setIndex(k);this.addAttribute("position",new A(m,3));this.addAttribute("normal",new A(q,3));this.addAttribute("uv",new A(n,2))}function wc(a,b,c,d){K.call(this);this.type="PlaneGeometry";this.parameters={width:a,height:b,widthSegments:c,heightSegments:d};this.fromBufferGeometry(new pb(a,b,c,d));this.mergeVertices()}function pb(a,b,c,d){E.call(this);
   this.type="PlaneBufferGeometry";this.parameters={width:a,height:b,widthSegments:c,heightSegments:d};a=a||1;b=b||1;var e=a/2,f=b/2;c=Math.floor(c)||1;d=Math.floor(d)||1;var g=c+1,h=d+1,k=a/c,m=b/d,q=[],n=[],u=[],t=[];for(a=0;a<h;a++){var r=a*m-f;for(b=0;b<g;b++)n.push(b*k-e,-r,0),u.push(0,0,1),t.push(b/c),t.push(1-a/d)}for(a=0;a<d;a++)for(b=0;b<c;b++)e=b+g*(a+1),f=b+1+g*(a+1),h=b+1+g*a,q.push(b+g*a,e,h),q.push(e,f,h);this.setIndex(q);this.addAttribute("position",new A(n,3));this.addAttribute("normal",
   new A(u,3));this.addAttribute("uv",new A(t,2))}function Aa(a){F.call(this);this.type="MeshBasicMaterial";this.color=new G(16777215);this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.envMap=this.alphaMap=this.specularMap=null;this.combine=0;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.lights=this.morphTargets=this.skinning=!1;this.setValues(a)}function Da(a){F.call(this);
   this.type="ShaderMaterial";this.defines={};this.uniforms={};this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}";this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";this.linewidth=1;this.wireframe=!1;this.wireframeLinewidth=1;this.morphNormals=this.morphTargets=this.skinning=this.clipping=this.lights=this.fog=!1;this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1};this.defaultAttributeValues=
   {color:[1,1,1],uv:[0,0],uv2:[0,0]};this.index0AttributeName=void 0;this.uniformsNeedUpdate=!1;this.attributes=null;void 0!==a&&this.setValues(a)}function qb(a,b){this.origin=void 0!==a?a:new p;this.direction=void 0!==b?b:new p}function Ba(a,b,c){this.a=void 0!==a?a:new p;this.b=void 0!==b?b:new p;this.c=void 0!==c?c:new p}function ra(a,b){B.call(this);this.type="Mesh";this.geometry=void 0!==a?a:new E;this.material=void 0!==b?b:new Aa({color:16777215*Math.random()});this.drawMode=0;this.updateMorphTargets()}
   function Kf(a,b,c,d){function e(a,c){b.buffers.color.setClear(a.r,a.g,a.b,c,d)}var f=new G(0),g=0,h,k,m;return{getClearColor:function(){return f},setClearColor:function(a,b){f.set(a);g=void 0!==b?b:1;e(f,g)},getClearAlpha:function(){return g},setClearAlpha:function(a){g=a;e(f,g)},render:function(b,d,u,t){d=d.background;null===d?e(f,g):d&&d.isColor&&(e(d,1),t=!0);(a.autoClear||t)&&a.clear(a.autoClearColor,a.autoClearDepth,a.autoClearStencil);d&&d.isCubeTexture?(void 0===m&&(m=new ra(new ob(1,1,1),
   new Da({uniforms:rb.cube.uniforms,vertexShader:rb.cube.vertexShader,fragmentShader:rb.cube.fragmentShader,side:1,depthTest:!0,depthWrite:!1,fog:!1})),m.geometry.removeAttribute("normal"),m.geometry.removeAttribute("uv"),m.onBeforeRender=function(a,b,c){this.matrixWorld.copyPosition(c.matrixWorld)},c.update(m)),m.material.uniforms.tCube.value=d,b.push(m,m.geometry,m.material,0,null)):d&&d.isTexture&&(void 0===h&&(h=new Jb(-1,1,1,-1,0,1),k=new ra(new pb(2,2),new Aa({depthTest:!1,depthWrite:!1,fog:!1})),
   c.update(k)),k.material.map=d,a.renderBufferDirect(h,null,k.geometry,k.material,k,null))}}}function Lf(a,b,c,d){var e;this.setMode=function(a){e=a};this.render=function(b,d){a.drawArrays(e,b,d);c.update(d,e)};this.renderInstances=function(f,g,h){if(d.isWebGL2)var k=a;else if(k=b.get("ANGLE_instanced_arrays"),null===k){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}k[d.isWebGL2?"drawArraysInstanced":
   "drawArraysInstancedANGLE"](e,g,h,f.maxInstancedCount);c.update(h,e,f.maxInstancedCount)}}function Mf(a,b,c){function d(b){if("highp"===b){if(0<a.getShaderPrecisionFormat(a.VERTEX_SHADER,a.HIGH_FLOAT).precision&&0<a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.HIGH_FLOAT).precision)return"highp";b="mediump"}return"mediump"===b&&0<a.getShaderPrecisionFormat(a.VERTEX_SHADER,a.MEDIUM_FLOAT).precision&&0<a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.MEDIUM_FLOAT).precision?"mediump":"lowp"}var e,f="undefined"!==
   typeof WebGL2RenderingContext&&a instanceof WebGL2RenderingContext,g=void 0!==c.precision?c.precision:"highp",h=d(g);h!==g&&(console.warn("THREE.WebGLRenderer:",g,"not supported, using",h,"instead."),g=h);c=!0===c.logarithmicDepthBuffer;h=a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS);var k=a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS),m=a.getParameter(a.MAX_TEXTURE_SIZE),q=a.getParameter(a.MAX_CUBE_MAP_TEXTURE_SIZE),n=a.getParameter(a.MAX_VERTEX_ATTRIBS),u=a.getParameter(a.MAX_VERTEX_UNIFORM_VECTORS),
   t=a.getParameter(a.MAX_VARYING_VECTORS),r=a.getParameter(a.MAX_FRAGMENT_UNIFORM_VECTORS),l=0<k,p=f||!!b.get("OES_texture_float");return{isWebGL2:f,getMaxAnisotropy:function(){if(void 0!==e)return e;var c=b.get("EXT_texture_filter_anisotropic");return e=null!==c?a.getParameter(c.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:d,precision:g,logarithmicDepthBuffer:c,maxTextures:h,maxVertexTextures:k,maxTextureSize:m,maxCubemapSize:q,maxAttributes:n,maxVertexUniforms:u,maxVaryings:t,maxFragmentUniforms:r,
   vertexTextures:l,floatFragmentTextures:p,floatVertexTextures:l&&p}}function Nf(){function a(){m.value!==d&&(m.value=d,m.needsUpdate=0<e);c.numPlanes=e;c.numIntersection=0}function b(a,b,d,e){var f=null!==a?a.length:0,g=null;if(0!==f){g=m.value;if(!0!==e||null===g){e=d+4*f;b=b.matrixWorldInverse;k.getNormalMatrix(b);if(null===g||g.length<e)g=new Float32Array(e);for(e=0;e!==f;++e,d+=4)h.copy(a[e]).applyMatrix4(b,k),h.normal.toArray(g,d),g[d+3]=h.constant}m.value=g;m.needsUpdate=!0}c.numPlanes=f;return g}
   var c=this,d=null,e=0,f=!1,g=!1,h=new Pa,k=new la,m={value:null,needsUpdate:!1};this.uniform=m;this.numIntersection=this.numPlanes=0;this.init=function(a,c,g){var h=0!==a.length||c||0!==e||f;f=c;d=b(a,g,0);e=a.length;return h};this.beginShadows=function(){g=!0;b(null)};this.endShadows=function(){g=!1;a()};this.setState=function(c,h,k,t,r,l){if(!f||null===c||0===c.length||g&&!k)g?b(null):a();else{k=g?0:e;var n=4*k,q=r.clippingState||null;m.value=q;q=b(c,t,n,l);for(c=0;c!==n;++c)q[c]=d[c];r.clippingState=
   q;this.numIntersection=h?this.numPlanes:0;this.numPlanes+=k}}}function Of(a){var b={};return{get:function(c){if(void 0!==b[c])return b[c];switch(c){case "WEBGL_depth_texture":var d=a.getExtension("WEBGL_depth_texture")||a.getExtension("MOZ_WEBGL_depth_texture")||a.getExtension("WEBKIT_WEBGL_depth_texture");break;case "EXT_texture_filter_anisotropic":d=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic");
   break;case "WEBGL_compressed_texture_s3tc":d=a.getExtension("WEBGL_compressed_texture_s3tc")||a.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case "WEBGL_compressed_texture_pvrtc":d=a.getExtension("WEBGL_compressed_texture_pvrtc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:d=a.getExtension(c)}null===d&&console.warn("THREE.WebGLRenderer: "+c+" extension not supported.");return b[c]=d}}}function Pf(a,b,c){function d(a){var g=
   a.target;a=e[g.id];null!==a.index&&b.remove(a.index);for(var k in a.attributes)b.remove(a.attributes[k]);g.removeEventListener("dispose",d);delete e[g.id];if(k=f[a.id])b.remove(k),delete f[a.id];c.memory.geometries--}var e={},f={};return{get:function(a,b){var f=e[b.id];if(f)return f;b.addEventListener("dispose",d);b.isBufferGeometry?f=b:b.isGeometry&&(void 0===b._bufferGeometry&&(b._bufferGeometry=(new E).setFromObject(a)),f=b._bufferGeometry);e[b.id]=f;c.memory.geometries++;return f},update:function(c){var d=
   c.index,e=c.attributes;null!==d&&b.update(d,a.ELEMENT_ARRAY_BUFFER);for(var f in e)b.update(e[f],a.ARRAY_BUFFER);c=c.morphAttributes;for(f in c){d=c[f];e=0;for(var g=d.length;e<g;e++)b.update(d[e],a.ARRAY_BUFFER)}},getWireframeAttribute:function(c){var d=f[c.id];if(d)return d;d=[];var e=c.index,g=c.attributes;if(null!==e){e=e.array;g=0;for(var q=e.length;g<q;g+=3){var n=e[g+0],u=e[g+1],t=e[g+2];d.push(n,u,u,t,t,n)}}else for(e=g.position.array,g=0,q=e.length/3-1;g<q;g+=3)n=g+0,u=g+1,t=g+2,d.push(n,
   u,u,t,t,n);d=new (65535<Be(d)?nb:mb)(d,1);b.update(d,a.ELEMENT_ARRAY_BUFFER);return f[c.id]=d}}}function Qf(a,b,c,d){var e,f,g;this.setMode=function(a){e=a};this.setIndex=function(a){f=a.type;g=a.bytesPerElement};this.render=function(b,d){a.drawElements(e,d,f,b*g);c.update(d,e)};this.renderInstances=function(h,k,m){if(d.isWebGL2)var q=a;else if(q=b.get("ANGLE_instanced_arrays"),null===q){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");
   return}q[d.isWebGL2?"drawElementsInstanced":"drawElementsInstancedANGLE"](e,m,f,k*g,h.maxInstancedCount);c.update(m,e,h.maxInstancedCount)}}function Rf(a){var b={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:b,programs:null,autoReset:!0,reset:function(){b.frame++;b.calls=0;b.triangles=0;b.points=0;b.lines=0},update:function(c,d,e){e=e||1;b.calls++;switch(d){case a.TRIANGLES:b.triangles+=c/3*e;break;case a.TRIANGLE_STRIP:case a.TRIANGLE_FAN:b.triangles+=
   e*(c-2);break;case a.LINES:b.lines+=c/2*e;break;case a.LINE_STRIP:b.lines+=e*(c-1);break;case a.LINE_LOOP:b.lines+=e*c;break;case a.POINTS:b.points+=e*c;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",d)}}}}function Sf(a,b){return Math.abs(b[1])-Math.abs(a[1])}function Tf(a){var b={},c=new Float32Array(8);return{update:function(d,e,f,g){var h=d.morphTargetInfluences,k=h.length;d=b[e.id];if(void 0===d){d=[];for(var m=0;m<k;m++)d[m]=[m,0];b[e.id]=d}var q=f.morphTargets&&e.morphAttributes.position;
   f=f.morphNormals&&e.morphAttributes.normal;for(m=0;m<k;m++){var n=d[m];0!==n[1]&&(q&&e.removeAttribute("morphTarget"+m),f&&e.removeAttribute("morphNormal"+m))}for(m=0;m<k;m++)n=d[m],n[0]=m,n[1]=h[m];d.sort(Sf);for(m=0;8>m;m++){if(n=d[m])if(h=n[0],k=n[1]){q&&e.addAttribute("morphTarget"+m,q[h]);f&&e.addAttribute("morphNormal"+m,f[h]);c[m]=k;continue}c[m]=0}g.getUniforms().setValue(a,"morphTargetInfluences",c)}}}function Uf(a,b){var c={};return{update:function(d){var e=b.render.frame,f=d.geometry,g=
   a.get(d,f);c[g.id]!==e&&(f.isGeometry&&g.updateFromObject(d),a.update(g),c[g.id]=e);return g},dispose:function(){c={}}}}function Lb(a,b,c){var d=a[0];if(0>=d||0<d)return a;var e=b*c,f=Ce[e];void 0===f&&(f=new Float32Array(e),Ce[e]=f);if(0!==b)for(d.toArray(f,0),d=1,e=0;d!==b;++d)e+=c,a[d].toArray(f,e);return f}function S(a,b){if(a.length!==b.length)return!1;for(var c=0,d=a.length;c<d;c++)if(a[c]!==b[c])return!1;return!0}function pa(a,b){for(var c=0,d=b.length;c<d;c++)a[c]=b[c]}function De(a,b){var c=
   Ee[b];void 0===c&&(c=new Int32Array(b),Ee[b]=c);for(var d=0;d!==b;++d)c[d]=a.allocTextureUnit();return c}function Vf(a,b){var c=this.cache;c[0]!==b&&(a.uniform1f(this.addr,b),c[0]=b)}function Wf(a,b){var c=this.cache;c[0]!==b&&(a.uniform1i(this.addr,b),c[0]=b)}function Xf(a,b){var c=this.cache;if(void 0!==b.x){if(c[0]!==b.x||c[1]!==b.y)a.uniform2f(this.addr,b.x,b.y),c[0]=b.x,c[1]=b.y}else S(c,b)||(a.uniform2fv(this.addr,b),pa(c,b))}function Yf(a,b){var c=this.cache;if(void 0!==b.x){if(c[0]!==b.x||
   c[1]!==b.y||c[2]!==b.z)a.uniform3f(this.addr,b.x,b.y,b.z),c[0]=b.x,c[1]=b.y,c[2]=b.z}else if(void 0!==b.r){if(c[0]!==b.r||c[1]!==b.g||c[2]!==b.b)a.uniform3f(this.addr,b.r,b.g,b.b),c[0]=b.r,c[1]=b.g,c[2]=b.b}else S(c,b)||(a.uniform3fv(this.addr,b),pa(c,b))}function Zf(a,b){var c=this.cache;if(void 0!==b.x){if(c[0]!==b.x||c[1]!==b.y||c[2]!==b.z||c[3]!==b.w)a.uniform4f(this.addr,b.x,b.y,b.z,b.w),c[0]=b.x,c[1]=b.y,c[2]=b.z,c[3]=b.w}else S(c,b)||(a.uniform4fv(this.addr,b),pa(c,b))}function $f(a,b){var c=
   this.cache,d=b.elements;void 0===d?S(c,b)||(a.uniformMatrix2fv(this.addr,!1,b),pa(c,b)):S(c,d)||(Fe.set(d),a.uniformMatrix2fv(this.addr,!1,Fe),pa(c,d))}function ag(a,b){var c=this.cache,d=b.elements;void 0===d?S(c,b)||(a.uniformMatrix3fv(this.addr,!1,b),pa(c,b)):S(c,d)||(Ge.set(d),a.uniformMatrix3fv(this.addr,!1,Ge),pa(c,d))}function bg(a,b){var c=this.cache,d=b.elements;void 0===d?S(c,b)||(a.uniformMatrix4fv(this.addr,!1,b),pa(c,b)):S(c,d)||(He.set(d),a.uniformMatrix4fv(this.addr,!1,He),pa(c,d))}
   function cg(a,b,c){var d=this.cache,e=c.allocTextureUnit();d[0]!==e&&(a.uniform1i(this.addr,e),d[0]=e);c.setTexture2D(b||Ie,e)}function dg(a,b,c){var d=this.cache,e=c.allocTextureUnit();d[0]!==e&&(a.uniform1i(this.addr,e),d[0]=e);c.setTextureCube(b||Je,e)}function Ke(a,b){var c=this.cache;S(c,b)||(a.uniform2iv(this.addr,b),pa(c,b))}function Le(a,b){var c=this.cache;S(c,b)||(a.uniform3iv(this.addr,b),pa(c,b))}function Me(a,b){var c=this.cache;S(c,b)||(a.uniform4iv(this.addr,b),pa(c,b))}function eg(a){switch(a){case 5126:return Vf;
   case 35664:return Xf;case 35665:return Yf;case 35666:return Zf;case 35674:return $f;case 35675:return ag;case 35676:return bg;case 35678:case 36198:return cg;case 35680:return dg;case 5124:case 35670:return Wf;case 35667:case 35671:return Ke;case 35668:case 35672:return Le;case 35669:case 35673:return Me}}function fg(a,b){var c=this.cache;S(c,b)||(a.uniform1fv(this.addr,b),pa(c,b))}function gg(a,b){var c=this.cache;S(c,b)||(a.uniform1iv(this.addr,b),pa(c,b))}function hg(a,b){var c=this.cache;b=Lb(b,
   this.size,2);S(c,b)||(a.uniform2fv(this.addr,b),this.updateCache(b))}function ig(a,b){var c=this.cache;b=Lb(b,this.size,3);S(c,b)||(a.uniform3fv(this.addr,b),this.updateCache(b))}function jg(a,b){var c=this.cache;b=Lb(b,this.size,4);S(c,b)||(a.uniform4fv(this.addr,b),this.updateCache(b))}function kg(a,b){var c=this.cache;b=Lb(b,this.size,4);S(c,b)||(a.uniformMatrix2fv(this.addr,!1,b),this.updateCache(b))}function lg(a,b){var c=this.cache;b=Lb(b,this.size,9);S(c,b)||(a.uniformMatrix3fv(this.addr,!1,
   b),this.updateCache(b))}function mg(a,b){var c=this.cache;b=Lb(b,this.size,16);S(c,b)||(a.uniformMatrix4fv(this.addr,!1,b),this.updateCache(b))}function ng(a,b,c){var d=this.cache,e=b.length,f=De(c,e);!1===S(d,f)&&(a.uniform1iv(this.addr,f),pa(d,f));for(a=0;a!==e;++a)c.setTexture2D(b[a]||Ie,f[a])}function og(a,b,c){var d=this.cache,e=b.length,f=De(c,e);!1===S(d,f)&&(a.uniform1iv(this.addr,f),pa(d,f));for(a=0;a!==e;++a)c.setTextureCube(b[a]||Je,f[a])}function pg(a){switch(a){case 5126:return fg;case 35664:return hg;
   case 35665:return ig;case 35666:return jg;case 35674:return kg;case 35675:return lg;case 35676:return mg;case 35678:return ng;case 35680:return og;case 5124:case 35670:return gg;case 35667:case 35671:return Ke;case 35668:case 35672:return Le;case 35669:case 35673:return Me}}function qg(a,b,c){this.id=a;this.addr=c;this.cache=[];this.setValue=eg(b.type)}function Ne(a,b,c){this.id=a;this.addr=c;this.cache=[];this.size=b.size;this.setValue=pg(b.type)}function Oe(a){this.id=a;this.seq=[];this.map={}}
   function cb(a,b,c,d){this.seq=[];this.map={};this.renderer=c;c=a.getProgramParameter(b,a.ACTIVE_UNIFORMS);for(d=0;d<c;++d){var e=a.getActiveUniform(b,d),f=a.getUniformLocation(b,e.name),g=this,h=e.name,k=h.length;for(Sd.lastIndex=0;;){var m=Sd.exec(h),q=Sd.lastIndex,n=m[1],u=m[3];"]"===m[2]&&(n|=0);if(void 0===u||"["===u&&q+2===k){h=g;e=void 0===u?new qg(n,e,f):new Ne(n,e,f);h.seq.push(e);h.map[e.id]=e;break}else u=g.map[n],void 0===u&&(u=new Oe(n),n=g,g=u,n.seq.push(g),n.map[g.id]=g),g=u}}}function rg(a){a=
   a.split("\n");for(var b=0;b<a.length;b++)a[b]=b+1+": "+a[b];return a.join("\n")}function Pe(a,b,c){var d=Xa.Settings.resolve(),e=a.createShader(b);a.shaderSource(e,c);a.compileShader(e);d.debug()&&sg.logShaderCompilationInformation(a,e,b,c);return e}function Qe(a){switch(a){case 3E3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];
   case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw Error("unsupported encoding: "+a);}}function Td(a,b){b=Qe(b);return"vec4 "+a+"( vec4 value ) { return "+b[0]+"ToLinear"+b[1]+"; }"}function tg(a,b){b=Qe(b);return"vec4 "+a+"( vec4 value ) { return LinearTo"+b[0]+b[1]+"; }"}function ug(a,b){switch(b){case 1:b="Linear";break;case 2:b="Reinhard";break;case 3:b="Uncharted2";break;case 4:b="OptimizedCineon";break;default:throw Error("unsupported toneMapping: "+b);}return"vec3 "+
   a+"( vec3 color ) { return "+b+"ToneMapping( color ); }"}function vg(a,b,c){a=a||{};return[a.derivatives||b.envMapCubeUV||b.bumpMap||b.normalMap&&!b.objectSpaceNormalMap||b.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(a.fragDepth||b.logarithmicDepthBuffer)&&c.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",a.drawBuffers&&c.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(a.shaderTextureLOD||b.envMap)&&c.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":
   ""].filter(xc).join("\n")}function wg(a){var b=[],c;for(c in a){var d=a[c];!1!==d&&b.push("#define "+c+" "+d)}return b.join("\n")}function xg(a,b,c){var d={},e=!1;c.attributes&&0<c.attributes.length?c.attributes.forEach(function(f){d[f]=a.getAttribLocation(b,f);-1===d[f]&&(Re.warn("Attribute "+f+" not defined in material shader. Material: "+c.type+". Check shader attributes or material.attributes definition."),e=!0)}):e=!0;if(e){d={};for(var f=a.getProgramParameter(b,a.ACTIVE_ATTRIBUTES),g=0;g<f;g++){var h=
   a.getActiveAttrib(b,g).name;Re.warn("Fallback to getProgramParameter webgl method. Try to avoid it by settings attributes to material or attributes to ShaderMaterial constructor parameters. Material: "+c.type+" Attribute: "+h);d[h]=a.getAttribLocation(b,h)}}return d}function xc(a){return""!==a}function Se(a,b){return a.replace(/NUM_DIR_LIGHTS/g,b.numDirLights).replace(/NUM_SPOT_LIGHTS/g,b.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,b.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,b.numPointLights).replace(/NUM_HEMI_LIGHTS/g,
   b.numHemiLights)}function Te(a,b){return a.replace(/NUM_CLIPPING_PLANES/g,b.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,b.numClippingPlanes-b.numClipIntersection)}function Ud(a){return a.replace(/^[ \t]*#include +<([\w\d./]+)>/gm,function(a,c){a=R[c];if(void 0===a)throw Error("Can not resolve #include <"+c+">");return Ud(a)})}function Ue(a){return a.replace(/#pragma unroll_loop[\s]+?for \( int i = (\d+); i < (\d+); i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(a,c,d,e){a="";for(c=parseInt(c);c<
   parseInt(d);c++)a+=e.replace(/\[ i \]/g,"[ "+c+" ]");return a})}function yg(a,b,c,d,e,f,g){var h=Xa.Settings.resolve(),k=a.context,m=d.defines,q=e.vertexShader,n=e.fragmentShader,u="SHADOWMAP_TYPE_BASIC";1===f.shadowMapType?u="SHADOWMAP_TYPE_PCF":2===f.shadowMapType&&(u="SHADOWMAP_TYPE_PCF_SOFT");var t="ENVMAP_TYPE_CUBE",r="ENVMAP_MODE_REFLECTION",l="ENVMAP_BLENDING_MULTIPLY";if(f.envMap){switch(d.envMap.mapping){case 301:case 302:t="ENVMAP_TYPE_CUBE";break;case 306:case 307:t="ENVMAP_TYPE_CUBE_UV";
   break;case 303:case 304:t="ENVMAP_TYPE_EQUIREC";break;case 305:t="ENVMAP_TYPE_SPHERE"}switch(d.envMap.mapping){case 302:case 304:r="ENVMAP_MODE_REFRACTION"}switch(d.combine){case 0:l="ENVMAP_BLENDING_MULTIPLY";break;case 1:l="ENVMAP_BLENDING_MIX";break;case 2:l="ENVMAP_BLENDING_ADD"}}var p=0<a.gammaFactor?a.gammaFactor:1,x=g.isWebGL2?"":vg(d.extensions,f,b),w=wg(m),y=k.createProgram();d.isRawShaderMaterial?(m=[w].filter(xc).join("\n"),0<m.length&&(m+="\n"),b=[x,w].filter(xc).join("\n"),0<b.length&&
   (b+="\n")):(m=["precision "+f.precision+" float;","precision "+f.precision+" int;","#define SHADER_NAME "+e.name,w,f.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+p,"#define MAX_BONES "+f.maxBones,f.useFog&&f.fog?"#define USE_FOG":"",f.useFog&&f.fogExp?"#define FOG_EXP2":"",f.map?"#define USE_MAP":"",f.envMap?"#define USE_ENVMAP":"",f.envMap?"#define "+r:"",f.lightMap?"#define USE_LIGHTMAP":"",f.aoMap?"#define USE_AOMAP":"",f.emissiveMap?"#define USE_EMISSIVEMAP":"",
   f.bumpMap?"#define USE_BUMPMAP":"",f.normalMap?"#define USE_NORMALMAP":"",f.normalMap&&f.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",f.displacementMap&&f.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",f.specularMap?"#define USE_SPECULARMAP":"",f.roughnessMap?"#define USE_ROUGHNESSMAP":"",f.metalnessMap?"#define USE_METALNESSMAP":"",f.alphaMap?"#define USE_ALPHAMAP":"",f.vertexColors?"#define USE_COLOR":"",f.flatShading?"#define FLAT_SHADED":"",f.skinning?"#define USE_SKINNING":
   "",f.useVertexTexture?"#define BONE_TEXTURE":"",f.morphTargets?"#define USE_MORPHTARGETS":"",f.morphNormals&&!1===f.flatShading?"#define USE_MORPHNORMALS":"",f.doubleSided?"#define DOUBLE_SIDED":"",f.flipSided?"#define FLIP_SIDED":"",f.shadowMapEnabled?"#define USE_SHADOWMAP":"",f.shadowMapEnabled?"#define "+u:"",f.sizeAttenuation?"#define USE_SIZEATTENUATION":"",f.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",f.logarithmicDepthBuffer&&(g.isWebGL2||b.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":
   "","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;",
   "\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(xc).join("\n"),b=[x,"precision "+f.precision+" float;","precision "+f.precision+" int;","#define SHADER_NAME "+e.name,w,f.alphaTest?
   "#define ALPHATEST "+f.alphaTest+(f.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+p,f.useFog&&f.fog?"#define USE_FOG":"",f.useFog&&f.fogExp?"#define FOG_EXP2":"",f.map?"#define USE_MAP":"",f.envMap?"#define USE_ENVMAP":"",f.envMap?"#define "+t:"",f.envMap?"#define "+r:"",f.envMap?"#define "+l:"",f.lightMap?"#define USE_LIGHTMAP":"",f.aoMap?"#define USE_AOMAP":"",f.emissiveMap?"#define USE_EMISSIVEMAP":"",f.bumpMap?"#define USE_BUMPMAP":"",f.normalMap?"#define USE_NORMALMAP":"",f.normalMap&&f.objectSpaceNormalMap?
   "#define OBJECTSPACE_NORMALMAP":"",f.specularMap?"#define USE_SPECULARMAP":"",f.roughnessMap?"#define USE_ROUGHNESSMAP":"",f.metalnessMap?"#define USE_METALNESSMAP":"",f.alphaMap?"#define USE_ALPHAMAP":"",f.vertexColors?"#define USE_COLOR":"",f.gradientMap?"#define USE_GRADIENTMAP":"",f.flatShading?"#define FLAT_SHADED":"",f.doubleSided?"#define DOUBLE_SIDED":"",f.flipSided?"#define FLIP_SIDED":"",f.shadowMapEnabled?"#define USE_SHADOWMAP":"",f.shadowMapEnabled?"#define "+u:"",f.premultipliedAlpha?
   "#define PREMULTIPLIED_ALPHA":"",f.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",f.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",f.logarithmicDepthBuffer&&(g.isWebGL2||b.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"",f.envMap&&(g.isWebGL2||b.get("EXT_shader_texture_lod"))?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",0!==f.toneMapping?"#define TONE_MAPPING":"",0!==f.toneMapping?R.tonemapping_pars_fragment:"",0!==f.toneMapping?
   ug("toneMapping",f.toneMapping):"",f.dithering?"#define DITHERING":"",f.outputEncoding||f.mapEncoding||f.envMapEncoding||f.emissiveMapEncoding?R.encodings_pars_fragment:"",f.mapEncoding?Td("mapTexelToLinear",f.mapEncoding):"",f.envMapEncoding?Td("envMapTexelToLinear",f.envMapEncoding):"",f.emissiveMapEncoding?Td("emissiveMapTexelToLinear",f.emissiveMapEncoding):"",f.outputEncoding?tg("linearToOutputTexel",f.outputEncoding):"",f.depthPacking?"#define DEPTH_PACKING "+d.depthPacking:"","\n"].filter(xc).join("\n"));
   q=Ud(q);q=Se(q,f);q=Te(q,f);n=Ud(n);n=Se(n,f);n=Te(n,f);q=Ue(q);n=Ue(n);g.isWebGL2&&!d.isRawShaderMaterial&&(g=!1,u=/^\s*#version\s+300\s+es\s*\n/,d.isShaderMaterial&&null!==q.match(u)&&null!==n.match(u)&&(g=!0,q=q.replace(u,""),n=n.replace(u,"")),m="#version 300 es\n\n#define attribute in\n#define varying out\n#define texture2D texture\n"+m,b=["#version 300 es\n\n#define varying in",g?"":"out highp vec4 pc_fragColor;",g?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth\n#define texture2D texture\n#define textureCube texture\n#define texture2DProj textureProj\n#define texture2DLodEXT textureLod\n#define texture2DProjLodEXT textureProjLod\n#define textureCubeLodEXT textureLod\n#define texture2DGradEXT textureGrad\n#define texture2DProjGradEXT textureProjGrad\n#define textureCubeGradEXT textureGrad"].join("\n")+
   "\n"+b);n=b+n;q=Pe(k,k.VERTEX_SHADER,m+q);n=Pe(k,k.FRAGMENT_SHADER,n);k.attachShader(y,q);k.attachShader(y,n);void 0!==d.index0AttributeName?k.bindAttribLocation(y,0,d.index0AttributeName):!0===f.morphTargets&&k.bindAttribLocation(y,0,"position");k.linkProgram(y);h.debug()&&(f=zg.getWebGLProgramDiagnostics(k,y,q,n,m,b,d))&&(this.diagnostics=f);k.deleteShader(q);k.deleteShader(n);var H;this.getUniforms=function(){void 0===H&&(H=new cb(k,y,a,d));return H};var O;this.getAttributes=function(){void 0===
   O&&(O=xg(k,y,d));return O};this.destroy=function(){k.deleteProgram(y);this.program=void 0};Object.defineProperties(this,{uniforms:{get:function(){console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms().");return this.getUniforms()}},attributes:{get:function(){console.warn("THREE.WebGLProgram: .attributes is now .getAttributes().");return this.getAttributes()}}});this.name=e.name;this.id=Ag++;this.code=c;this.usedTimes=1;this.program=y;this.vertexShader=q;this.fragmentShader=n;return this}
   function Bg(a,b,c){function d(a,b){if(a)a.isTexture?c=a.encoding:a.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),c=a.texture.encoding);else var c=3E3;3E3===c&&b&&(c=3007);return c}var e=[],f={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",
   MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},g="precision supportsVertexTextures map mapEncoding envMap envMapMode envMapEncoding lightMap aoMap emissiveMap emissiveMapEncoding bumpMap normalMap objectSpaceNormalMap displacementMap specularMap roughnessMap metalnessMap gradientMap alphaMap combine vertexColors fog useFog fogExp flatShading sizeAttenuation logarithmicDepthBuffer skinning maxBones useVertexTexture morphTargets morphNormals maxMorphTargets maxMorphNormals premultipliedAlpha numDirLights numPointLights numSpotLights numHemiLights numRectAreaLights shadowMapEnabled shadowMapType toneMapping physicallyCorrectLights alphaTest doubleSided flipSided numClippingPlanes numClipIntersection depthPacking dithering".split(" ");
   this.getParameters=function(b,e,g,q,n,u,t){var h=f[b.type];if(t.isSkinnedMesh){var k=t.skeleton.bones;if(c.floatVertexTextures)k=1024;else{var m=Math.min(Math.floor((c.maxVertexUniforms-20)/4),k.length);m<k.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+k.length+" bones. This GPU supports "+m+"."),k=0):k=m}}else k=0;m=c.precision;null!==b.precision&&(m=c.getMaxPrecision(b.precision),m!==b.precision&&console.warn("THREE.WebGLProgram.getParameters:",b.precision,"not supported, using",m,"instead."));
   var l=a.getRenderTarget();return{shaderID:h,precision:m,supportsVertexTextures:c.vertexTextures,outputEncoding:d(l?l.texture:null,a.gammaOutput),map:!!b.map,mapEncoding:d(b.map,a.gammaInput),envMap:!!b.envMap,envMapMode:b.envMap&&b.envMap.mapping,envMapEncoding:d(b.envMap,a.gammaInput),envMapCubeUV:!!b.envMap&&(306===b.envMap.mapping||307===b.envMap.mapping),lightMap:!!b.lightMap,aoMap:!!b.aoMap,emissiveMap:!!b.emissiveMap,emissiveMapEncoding:d(b.emissiveMap,a.gammaInput),bumpMap:!!b.bumpMap,normalMap:!!b.normalMap,
   objectSpaceNormalMap:1===b.normalMapType,displacementMap:!!b.displacementMap,roughnessMap:!!b.roughnessMap,metalnessMap:!!b.metalnessMap,specularMap:!!b.specularMap,alphaMap:!!b.alphaMap,gradientMap:!!b.gradientMap,combine:b.combine,vertexColors:b.vertexColors,fog:!!q,useFog:b.fog,fogExp:q&&q.isFogExp2,flatShading:b.flatShading,sizeAttenuation:b.sizeAttenuation,logarithmicDepthBuffer:c.logarithmicDepthBuffer,skinning:b.skinning&&0<k,maxBones:k,useVertexTexture:c.floatVertexTextures,morphTargets:b.morphTargets,
   morphNormals:b.morphNormals,maxMorphTargets:a.maxMorphTargets,maxMorphNormals:a.maxMorphNormals,numDirLights:e.directional.length,numPointLights:e.point.length,numSpotLights:e.spot.length,numRectAreaLights:e.rectArea.length,numHemiLights:e.hemi.length,numClippingPlanes:n,numClipIntersection:u,dithering:b.dithering,shadowMapEnabled:a.shadowMap.enabled&&t.receiveShadow&&0<g.length,shadowMapType:a.shadowMap.type,toneMapping:a.toneMapping,physicallyCorrectLights:a.physicallyCorrectLights,premultipliedAlpha:b.premultipliedAlpha,
   alphaTest:b.alphaTest,doubleSided:2===b.side,flipSided:1===b.side,depthPacking:void 0!==b.depthPacking?b.depthPacking:!1}};this.getProgramCode=function(b,c){var d=[];c.shaderID?d.push(c.shaderID):(d.push(b.fragmentShader),d.push(b.vertexShader));if(void 0!==b.defines)for(var e in b.defines)d.push(e),d.push(b.defines[e]);for(e=0;e<g.length;e++)d.push(c[g[e]]);d.push(b.onBeforeCompile.toString());d.push(a.gammaOutput);return d.join()};this.acquireProgram=function(d,f,g,q){for(var h,k=0,m=e.length;k<
   m;k++){var r=e[k];if(r.code===q){h=r;++h.usedTimes;break}}void 0===h&&(h=new yg(a,b,q,d,f,g,c),e.push(h));return h};this.releaseProgram=function(a){if(!(e.length<Xa.Settings.resolve().allowedCachedPrograms())&&0===--a.usedTimes){var b=e.indexOf(a);e[b]=e[e.length-1];e.pop();a.destroy()}};this.disposeCached=function(){for(;0<e.length;)e.pop().destroy()};this.programs=e}function Cg(a,b){return a.renderOrder!==b.renderOrder?a.renderOrder-b.renderOrder:a.program&&b.program&&a.program!==b.program?a.program.id-
   b.program.id:a.material.id!==b.material.id?a.material.id-b.material.id:a.z!==b.z?a.z-b.z:a.id-b.id}function Dg(a,b){return a.renderOrder!==b.renderOrder?a.renderOrder-b.renderOrder:a.z!==b.z?b.z-a.z:a.id-b.id}function Eg(){var a=[],b=0,c=[],d=[];return{opaque:c,transparent:d,init:function(){b=0;c.length=0;d.length=0},push:function(e,f,g,h,k){var m=a[b];void 0===m?(m={id:e.id,object:e,geometry:f,material:g,program:g.program,renderOrder:e.renderOrder,z:h,group:k},a[b]=m):(m.id=e.id,m.object=e,m.geometry=
   f,m.material=g,m.program=g.program,m.renderOrder=e.renderOrder,m.z=h,m.group=k);(!0===g.transparent?d:c).push(m);b++},sort:function(){1<c.length&&c.sort(Cg);1<d.length&&d.sort(Dg)}}}function Fg(){var a={};return{get:function(b,c){b=b.id+","+c.id;c=a[b];void 0===c&&(c=new Eg,a[b]=c);return c},dispose:function(){a={}}}}function Gg(){var a={};return{get:function(b){if(void 0!==a[b.id])return a[b.id];switch(b.type){case "DirectionalLight":var c={direction:new p,color:new G,shadow:!1,shadowBias:0,shadowRadius:1,
   shadowMapSize:new C};break;case "SpotLight":c={position:new p,direction:new p,color:new G,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new C};break;case "PointLight":c={position:new p,color:new G,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new C,shadowCameraNear:1,shadowCameraFar:1E3};break;case "HemisphereLight":c={direction:new p,skyColor:new G,groundColor:new G};break;case "RectAreaLight":c={color:new G,position:new p,
   halfWidth:new p,halfHeight:new p}}return a[b.id]=c}}}function Hg(){var a=new Gg,b={id:Ig++,hash:{stateID:-1,directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,shadowsLength:-1},ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},c=new p,d=new M,e=new M;return{setup:function(f,g,h){var k=0,m=0,q=0,n=0,u=0,t=0,r=0,l=0;h=h.matrixWorldInverse;
   for(var p=0,x=f.length;p<x;p++){var w=f[p],y=w.color,H=w.intensity,O=w.distance,da=w.shadow&&w.shadow.map?w.shadow.map.texture:null;if(w.isAmbientLight)k+=y.r*H,m+=y.g*H,q+=y.b*H;else if(w.isDirectionalLight){var J=a.get(w);J.color.copy(w.color).multiplyScalar(w.intensity);J.direction.setFromMatrixPosition(w.matrixWorld);c.setFromMatrixPosition(w.target.matrixWorld);J.direction.sub(c);J.direction.transformDirection(h);if(J.shadow=w.castShadow)y=w.shadow,J.shadowBias=y.bias,J.shadowRadius=y.radius,
   J.shadowMapSize=y.mapSize;b.directionalShadowMap[n]=da;b.directionalShadowMatrix[n]=w.shadow.matrix;b.directional[n]=J;n++}else if(w.isSpotLight){J=a.get(w);J.position.setFromMatrixPosition(w.matrixWorld);J.position.applyMatrix4(h);J.color.copy(y).multiplyScalar(H);J.distance=O;J.direction.setFromMatrixPosition(w.matrixWorld);c.setFromMatrixPosition(w.target.matrixWorld);J.direction.sub(c);J.direction.transformDirection(h);J.coneCos=Math.cos(w.angle);J.penumbraCos=Math.cos(w.angle*(1-w.penumbra));
   J.decay=0===w.distance?0:w.decay;if(J.shadow=w.castShadow)y=w.shadow,J.shadowBias=y.bias,J.shadowRadius=y.radius,J.shadowMapSize=y.mapSize;b.spotShadowMap[t]=da;b.spotShadowMatrix[t]=w.shadow.matrix;b.spot[t]=J;t++}else if(w.isRectAreaLight)J=a.get(w),J.color.copy(y).multiplyScalar(H),J.position.setFromMatrixPosition(w.matrixWorld),J.position.applyMatrix4(h),e.identity(),d.copy(w.matrixWorld),d.premultiply(h),e.extractRotation(d),J.halfWidth.set(.5*w.width,0,0),J.halfHeight.set(0,.5*w.height,0),J.halfWidth.applyMatrix4(e),
   J.halfHeight.applyMatrix4(e),b.rectArea[r]=J,r++;else if(w.isPointLight){J=a.get(w);J.position.setFromMatrixPosition(w.matrixWorld);J.position.applyMatrix4(h);J.color.copy(w.color).multiplyScalar(w.intensity);J.distance=w.distance;J.decay=0===w.distance?0:w.decay;if(J.shadow=w.castShadow)y=w.shadow,J.shadowBias=y.bias,J.shadowRadius=y.radius,J.shadowMapSize=y.mapSize,J.shadowCameraNear=y.camera.near,J.shadowCameraFar=y.camera.far;b.pointShadowMap[u]=da;b.pointShadowMatrix[u]=w.shadow.matrix;b.point[u]=
   J;u++}else w.isHemisphereLight&&(J=a.get(w),J.direction.setFromMatrixPosition(w.matrixWorld),J.direction.transformDirection(h),J.direction.normalize(),J.skyColor.copy(w.color).multiplyScalar(H),J.groundColor.copy(w.groundColor).multiplyScalar(H),b.hemi[l]=J,l++)}b.ambient[0]=k;b.ambient[1]=m;b.ambient[2]=q;b.directional.length=n;b.spot.length=t;b.rectArea.length=r;b.point.length=u;b.hemi.length=l;b.hash.stateID=b.id;b.hash.directionalLength=n;b.hash.pointLength=u;b.hash.spotLength=t;b.hash.rectAreaLength=
   r;b.hash.hemiLength=l;b.hash.shadowsLength=g.length},state:b}}function Ve(){var a=new Hg,b=[],c=[];return{init:function(){b.length=0;c.length=0},state:{lightsArray:b,shadowsArray:c,lights:a},setupLights:function(d){a.setup(b,c,d)},pushLight:function(a){b.push(a)},pushShadow:function(a){c.push(a)}}}function Jg(){var a={};return{get:function(b,c){if(void 0===a[b.id]){var d=new Ve;a[b.id]={};a[b.id][c.id]=d}else void 0===a[b.id][c.id]?(d=new Ve,a[b.id][c.id]=d):d=a[b.id][c.id];return d},dispose:function(){a=
   {}}}}function db(a){F.call(this);this.type="MeshDepthMaterial";this.depthPacking=3200;this.morphTargets=this.skinning=!1;this.displacementMap=this.alphaMap=this.map=null;this.displacementScale=1;this.displacementBias=0;this.wireframe=!1;this.wireframeLinewidth=1;this.lights=this.fog=!1;this.setValues(a);this.attributes=["position"]}function eb(a){F.call(this);this.type="MeshDistanceMaterial";this.referencePosition=new p;this.nearDistance=1;this.farDistance=1E3;this.morphTargets=this.skinning=!1;this.displacementMap=
   this.alphaMap=this.map=null;this.displacementScale=1;this.displacementBias=0;this.lights=this.fog=!1;this.setValues(a)}function We(a,b,c){function d(b,c,d,e,f,g){var h=b.geometry;var k=n;var m=b.customDepthMaterial;d&&(k=u,m=b.customDistanceMaterial);m?k=m:(m=!1,c.morphTargets&&(h&&h.isBufferGeometry?m=h.morphAttributes&&h.morphAttributes.position&&0<h.morphAttributes.position.length:h&&h.isGeometry&&(m=h.morphTargets&&0<h.morphTargets.length)),b.isSkinnedMesh&&!1===c.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",
   b),b=b.isSkinnedMesh&&c.skinning,h=0,m&&(h|=1),b&&(h|=2),k=k[h]);a.localClippingEnabled&&!0===c.clipShadows&&0!==c.clippingPlanes.length&&(h=k.uuid,m=c.uuid,b=t[h],void 0===b&&(b={},t[h]=b),h=b[m],void 0===h&&(h=k.clone(),b[m]=h),k=h);k.visible=c.visible;k.wireframe=c.wireframe;k.side=null!=c.shadowSide?c.shadowSide:r[c.side];k.clipShadows=c.clipShadows;k.clippingPlanes=c.clippingPlanes;k.clipIntersection=c.clipIntersection;k.wireframeLinewidth=c.wireframeLinewidth;k.linewidth=c.linewidth;d&&k.isMeshDistanceMaterial&&
   (k.referencePosition.copy(e),k.nearDistance=f,k.farDistance=g);return k}function e(c,g,h,k){if(!1!==c.visible){if(c.layers.test(g.layers)&&(c.isMesh||c.isLine||c.isPoints)&&c.castShadow&&(!c.frustumCulled||f.intersectsObject(c))){c.modelViewMatrix.multiplyMatrices(h.matrixWorldInverse,c.matrixWorld);var m=b.update(c),n=c.material;if(Array.isArray(n))for(var u=m.groups,t=0,r=u.length;t<r;t++){var l=u[t],v=n[l.materialIndex];v&&v.visible&&(v=d(c,v,k,q,h.near,h.far),a.renderBufferDirect(h,null,m,v,c,
   l))}else n.visible&&(v=d(c,n,k,q,h.near,h.far),a.renderBufferDirect(h,null,m,v,c,null))}c=c.children;m=0;for(n=c.length;m<n;m++)e(c[m],g,h,k)}}var f=new ld,g=new M,h=new C,k=new C(c,c),m=new p,q=new p,n=Array(4),u=Array(4),t={},r={0:1,1:0,2:2},l=[new p(1,0,0),new p(-1,0,0),new p(0,0,1),new p(0,0,-1),new p(0,1,0),new p(0,-1,0)],z=[new p(0,1,0),new p(0,1,0),new p(0,1,0),new p(0,1,0),new p(0,0,1),new p(0,0,-1)],x=[new ca,new ca,new ca,new ca,new ca,new ca];for(c=0;4!==c;++c){var w=0!==(c&1),y=0!==(c&
   2),H=new db({depthPacking:3201,morphTargets:w,skinning:y});n[c]=H;w=new eb({morphTargets:w,skinning:y});u[c]=w}var O=this;this.enabled=!1;this.autoUpdate=!0;this.needsUpdate=!1;this.type=1;this.render=function(b,c,d){if(!1!==O.enabled&&(!1!==O.autoUpdate||!1!==O.needsUpdate)&&0!==b.length){var n=a.state;n.disable(a.context.BLEND);n.buffers.color.setClear(1,1,1,1);n.buffers.depth.setTest(!0);n.setScissorTest(!1);for(var u,t=0,r=b.length;t<r;t++){var v=b[t];u=v.shadow;var p=v&&v.isPointLight;if(void 0===
   u)console.warn("THREE.WebGLShadowMap:",v,"has no shadow.");else{var w=u.camera;h.copy(u.mapSize);h.min(k);if(p){var H=h.x,y=h.y;x[0].set(2*H,y,H,y);x[1].set(0,y,H,y);x[2].set(3*H,y,H,y);x[3].set(H,y,H,y);x[4].set(3*H,0,H,y);x[5].set(H,0,H,y);h.x*=4;h.y*=2}null===u.map&&(u.map=new md(h.x,h.y,{minFilter:1003,magFilter:1003,format:1023}),u.map.texture.name=v.name+".shadowMap",w.updateProjectionMatrix());u.isSpotLightShadow&&u.update(v);H=u.map;y=u.matrix;q.setFromMatrixPosition(v.matrixWorld);w.position.copy(q);
   p?(u=6,y.makeTranslation(-q.x,-q.y,-q.z)):(u=1,m.setFromMatrixPosition(v.target.matrixWorld),w.lookAt(m),w.updateMatrixWorld(),y.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),y.multiply(w.projectionMatrix),y.multiply(w.matrixWorldInverse));a.setRenderTarget(H);a.clear();for(v=0;v<u;v++)p&&(m.copy(w.position),m.add(l[v]),w.up.copy(z[v]),w.lookAt(m),w.updateMatrixWorld(),n.viewport(x[v])),g.multiplyMatrices(w.projectionMatrix,w.matrixWorldInverse),f.setFromMatrix(g),e(c,d,w,p)}}O.needsUpdate=!1}}}function Kg(a,
   b,c,d){function e(b,c,d){var e=new Uint8Array(4),f=a.createTexture();a.bindTexture(b,f);a.texParameteri(b,a.TEXTURE_MIN_FILTER,a.NEAREST);a.texParameteri(b,a.TEXTURE_MAG_FILTER,a.NEAREST);for(b=0;b<d;b++)a.texImage2D(c+b,0,a.RGBA,1,1,0,a.RGBA,a.UNSIGNED_BYTE,e);return f}function f(c,e){x[c]=1;0===w[c]&&(a.enableVertexAttribArray(c),w[c]=1);y[c]!==e&&((d.isWebGL2?a:b.get("ANGLE_instanced_arrays"))[d.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](c,e),y[c]=e)}function g(b){!0!==H[b]&&(a.enable(b),
   H[b]=!0)}function h(b){!1!==H[b]&&(a.disable(b),H[b]=!1)}function k(b,d,e,f,k,m,n,q){0!==b?g(a.BLEND):h(a.BLEND);if(5!==b){if(b!==J||q!==G)switch(b){case 2:q?(a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(a.ONE,a.ONE,a.ONE,a.ONE)):(a.blendEquation(a.FUNC_ADD),a.blendFunc(a.SRC_ALPHA,a.ONE));break;case 3:q?(a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(a.ZERO,a.ZERO,a.ONE_MINUS_SRC_COLOR,a.ONE_MINUS_SRC_ALPHA)):(a.blendEquation(a.FUNC_ADD),a.blendFunc(a.ZERO,
   a.ONE_MINUS_SRC_COLOR));break;case 4:q?(a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(a.ZERO,a.SRC_COLOR,a.ZERO,a.SRC_ALPHA)):(a.blendEquation(a.FUNC_ADD),a.blendFunc(a.ZERO,a.SRC_COLOR));break;default:q?(a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(a.ONE,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA)):(a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA))}I=V=E=B=A=C=null}else{k=
   k||d;m=m||e;n=n||f;if(d!==C||k!==E)a.blendEquationSeparate(c.convert(d),c.convert(k)),C=d,E=k;if(e!==A||f!==B||m!==V||n!==I)a.blendFuncSeparate(c.convert(e),c.convert(f),c.convert(m),c.convert(n)),A=e,B=f,V=m,I=n}J=b;G=q}function m(b){L!==b&&(b?a.frontFace(a.CW):a.frontFace(a.CCW),L=b)}function q(b){0!==b?(g(a.CULL_FACE),b!==K&&(1===b?a.cullFace(a.BACK):2===b?a.cullFace(a.FRONT):a.cullFace(a.FRONT_AND_BACK))):h(a.CULL_FACE);K=b}function n(b,c,d){if(b){if(g(a.POLYGON_OFFSET_FILL),P!==c||F!==d)a.polygonOffset(c,
   d),P=c,F=d}else h(a.POLYGON_OFFSET_FILL)}function u(b){void 0===b&&(b=a.TEXTURE0+Q-1);aa!==b&&(a.activeTexture(b),aa=b)}var t=new function(){var b=!1,c=new ca,d=null,e=new ca(0,0,0,0);return{setMask:function(c){d===c||b||(a.colorMask(c,c,c,c),d=c)},setLocked:function(a){b=a},setClear:function(b,d,f,g,h){!0===h&&(b*=g,d*=g,f*=g);c.set(b,d,f,g);!1===e.equals(c)&&(a.clearColor(b,d,f,g),e.copy(c))},reset:function(){b=!1;d=null;e.set(-1,0,0,0)}}},r=new function(){var b=!1,c=null,d=null,e=null;return{setTest:function(b){b?
   g(a.DEPTH_TEST):h(a.DEPTH_TEST)},setMask:function(d){c===d||b||(a.depthMask(d),c=d)},setFunc:function(b){if(d!==b){if(b)switch(b){case 0:a.depthFunc(a.NEVER);break;case 1:a.depthFunc(a.ALWAYS);break;case 2:a.depthFunc(a.LESS);break;case 3:a.depthFunc(a.LEQUAL);break;case 4:a.depthFunc(a.EQUAL);break;case 5:a.depthFunc(a.GEQUAL);break;case 6:a.depthFunc(a.GREATER);break;case 7:a.depthFunc(a.NOTEQUAL);break;default:a.depthFunc(a.LEQUAL)}else a.depthFunc(a.LEQUAL);d=b}},setLocked:function(a){b=a},setClear:function(b){e!==
   b&&(a.clearDepth(b),e=b)},reset:function(){b=!1;e=d=c=null}}},l=new function(){var b=!1,c=null,d=null,e=null,f=null,k=null,m=null,n=null,q=null;return{setTest:function(b){b?g(a.STENCIL_TEST):h(a.STENCIL_TEST)},setMask:function(d){c===d||b||(a.stencilMask(d),c=d)},setFunc:function(b,c,g){if(d!==b||e!==c||f!==g)a.stencilFunc(b,c,g),d=b,e=c,f=g},setOp:function(b,c,d){if(k!==b||m!==c||n!==d)a.stencilOp(b,c,d),k=b,m=c,n=d},setLocked:function(a){b=a},setClear:function(b){q!==b&&(a.clearStencil(b),q=b)},
   reset:function(){b=!1;q=n=m=k=f=e=d=c=null}}},p=a.getParameter(a.MAX_VERTEX_ATTRIBS),x=new Uint8Array(p),w=new Uint8Array(p),y=new Uint8Array(p),H={},O=null,da=null,J=null,C=null,A=null,B=null,E=null,V=null,I=null,G=!1,L=null,K=null,M=null,P=null,F=null,Q=a.getParameter(a.MAX_COMBINED_TEXTURE_IMAGE_UNITS),R=!1;p=0;p=a.getParameter(a.VERSION);-1!==p.indexOf("WebGL")?(p=parseFloat(/^WebGL ([0-9])/.exec(p)[1]),R=1<=p):-1!==p.indexOf("OpenGL ES")&&(p=parseFloat(/^OpenGL ES ([0-9])/.exec(p)[1]),R=2<=p);
   var aa=null,T={},W=new ca,S=new ca,N={};N[a.TEXTURE_2D]=e(a.TEXTURE_2D,a.TEXTURE_2D,1);N[a.TEXTURE_CUBE_MAP]=e(a.TEXTURE_CUBE_MAP,a.TEXTURE_CUBE_MAP_POSITIVE_X,6);t.setClear(0,0,0,1);r.setClear(1);l.setClear(0);g(a.DEPTH_TEST);r.setFunc(3);m(!1);q(1);g(a.CULL_FACE);g(a.BLEND);k(1);return{buffers:{color:t,depth:r,stencil:l},initAttributes:function(){for(var a=0,b=x.length;a<b;a++)x[a]=0},enableAttribute:function(a){f(a,0)},enableAttributeAndDivisor:f,disableUnusedAttributes:function(){for(var b=0,
   c=w.length;b!==c;++b)w[b]!==x[b]&&(a.disableVertexAttribArray(b),w[b]=0)},enable:g,disable:h,getCompressedTextureFormats:function(){if(null===O&&(O=[],b.get("WEBGL_compressed_texture_pvrtc")||b.get("WEBGL_compressed_texture_s3tc")||b.get("WEBGL_compressed_texture_etc1")||b.get("WEBGL_compressed_texture_astc")))for(var c=a.getParameter(a.COMPRESSED_TEXTURE_FORMATS),d=0;d<c.length;d++)O.push(c[d]);return O},useProgram:function(b){return da!==b?(a.useProgram(b),da=b,!0):!1},setBlending:k,setMaterial:function(b,
   c){2===b.side?h(a.CULL_FACE):g(a.CULL_FACE);var d=1===b.side;c&&(d=!d);m(d);1===b.blending&&!1===b.transparent?k(0):k(b.blending,b.blendEquation,b.blendSrc,b.blendDst,b.blendEquationAlpha,b.blendSrcAlpha,b.blendDstAlpha,b.premultipliedAlpha);r.setFunc(b.depthFunc);r.setTest(b.depthTest);r.setMask(b.depthWrite);t.setMask(b.colorWrite);n(b.polygonOffset,b.polygonOffsetFactor,b.polygonOffsetUnits)},setFlipSided:m,setCullFace:q,setLineWidth:function(b){b!==M&&(R&&a.lineWidth(b),M=b)},setPolygonOffset:n,
   setScissorTest:function(b){b?g(a.SCISSOR_TEST):h(a.SCISSOR_TEST)},activeTexture:u,bindTexture:function(b,c){null===aa&&u();var d=T[aa];void 0===d&&(d={type:void 0,texture:void 0},T[aa]=d);if(d.type!==b||d.texture!==c)a.bindTexture(b,c||N[b]),d.type=b,d.texture=c},compressedTexImage2D:function(){try{a.compressedTexImage2D.apply(a,arguments)}catch(U){console.error("THREE.WebGLState:",U)}},texImage2D:function(){try{a.texImage2D.apply(a,arguments)}catch(U){console.error("THREE.WebGLState:",U)}},scissor:function(b){!1===
   W.equals(b)&&(a.scissor(b.x,b.y,b.z,b.w),W.copy(b))},viewport:function(b){!1===S.equals(b)&&(a.viewport(b.x,b.y,b.z,b.w),S.copy(b))},reset:function(){for(var b=0;b<w.length;b++)1===w[b]&&(a.disableVertexAttribArray(b),w[b]=0);H={};aa=O=null;T={};K=L=J=da=null;t.reset();r.reset();l.reset()}}}function Xe(a,b,c){return{convert:function(d){if(1E3===d)return a.REPEAT;if(1001===d)return a.CLAMP_TO_EDGE;if(1002===d)return a.MIRRORED_REPEAT;if(1003===d)return a.NEAREST;if(1004===d)return a.NEAREST_MIPMAP_NEAREST;
   if(1005===d)return a.NEAREST_MIPMAP_LINEAR;if(1006===d)return a.LINEAR;if(1007===d)return a.LINEAR_MIPMAP_NEAREST;if(1008===d)return a.LINEAR_MIPMAP_LINEAR;if(1009===d)return a.UNSIGNED_BYTE;if(1017===d)return a.UNSIGNED_SHORT_4_4_4_4;if(1018===d)return a.UNSIGNED_SHORT_5_5_5_1;if(1019===d)return a.UNSIGNED_SHORT_5_6_5;if(1010===d)return a.BYTE;if(1011===d)return a.SHORT;if(1012===d)return a.UNSIGNED_SHORT;if(1013===d)return a.INT;if(1014===d)return a.UNSIGNED_INT;if(1015===d)return a.FLOAT;if(1016===
   d){if(c.isWebGL2)return a.HALF_FLOAT;var e=b.get("OES_texture_half_float");if(null!==e)return e.HALF_FLOAT_OES}if(1021===d)return a.ALPHA;if(1022===d)return a.RGB;if(1023===d)return a.RGBA;if(1024===d)return a.LUMINANCE;if(1025===d)return a.LUMINANCE_ALPHA;if(1026===d)return a.DEPTH_COMPONENT;if(1027===d)return a.DEPTH_STENCIL;if(100===d)return a.FUNC_ADD;if(101===d)return a.FUNC_SUBTRACT;if(102===d)return a.FUNC_REVERSE_SUBTRACT;if(200===d)return a.ZERO;if(201===d)return a.ONE;if(202===d)return a.SRC_COLOR;
   if(203===d)return a.ONE_MINUS_SRC_COLOR;if(204===d)return a.SRC_ALPHA;if(205===d)return a.ONE_MINUS_SRC_ALPHA;if(206===d)return a.DST_ALPHA;if(207===d)return a.ONE_MINUS_DST_ALPHA;if(208===d)return a.DST_COLOR;if(209===d)return a.ONE_MINUS_DST_COLOR;if(210===d)return a.SRC_ALPHA_SATURATE;if(33776===d||33777===d||33778===d||33779===d)if(e=b.get("WEBGL_compressed_texture_s3tc"),null!==e){if(33776===d)return e.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===d)return e.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===
   d)return e.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===d)return e.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===d||35841===d||35842===d||35843===d)if(e=b.get("WEBGL_compressed_texture_pvrtc"),null!==e){if(35840===d)return e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===d)return e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===d)return e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===d)return e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===d&&(e=b.get("WEBGL_compressed_texture_etc1"),null!==e))return e.COMPRESSED_RGB_ETC1_WEBGL;
   if(37808===d||37809===d||37810===d||37811===d||37812===d||37813===d||37814===d||37815===d||37816===d||37817===d||37818===d||37819===d||37820===d||37821===d)if(e=b.get("WEBGL_compressed_texture_astc"),null!==e)return d;if(103===d||104===d){if(c.isWebGL2){if(103===d)return a.MIN;if(104===d)return a.MAX}e=b.get("EXT_blend_minmax");if(null!==e){if(103===d)return e.MIN_EXT;if(104===d)return e.MAX_EXT}}if(1020===d){if(c.isWebGL2)return a.UNSIGNED_INT_24_8;e=b.get("WEBGL_depth_texture");if(null!==e)return e.UNSIGNED_INT_24_8_WEBGL}return 0}}}
   function Mb(){B.call(this);this.type="Group"}function ea(a,b,c,d){Qa.call(this);this.type="PerspectiveCamera";this.fov=void 0!==a?a:50;this.zoom=1;this.near=void 0!==c?c:.1;this.far=void 0!==d?d:2E3;this.focus=10;this.aspect=void 0!==b?b:1;this.view=null;this.filmGauge=35;this.filmOffset=0;this.updateProjectionMatrix()}function zc(a){ea.call(this);this.cameras=a||[]}function Ye(a){function b(){return null!==e&&!0===e.isPresenting}function c(){if(b()){var c=e.getEyeParameters("left"),f=c.renderWidth;
   c=c.renderHeight;x=a.getPixelRatio();z=a.getSize();a.setDrawingBufferSize(2*f,c,1);y.start()}else d.enabled&&(a.setDrawingBufferSize(z.width,z.height,x),y.stop())}var d=this,e=null,f=null,g=null,h=[],k=new M,m=new M;"undefined"!==typeof window&&"VRFrameData"in window&&(f=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",c,!1));var q=new M,n=new ia,u=new p,t=new ea;t.bounds=new ca(0,0,.5,1);t.layers.enable(1);var r=new ea;r.bounds=new ca(.5,0,.5,1);r.layers.enable(2);var l=new zc([t,
   r]);l.layers.enable(1);l.layers.enable(2);var z,x,w=[];this.enabled=!1;this.userHeight=1.6;this.getController=function(a){var b=h[a];void 0===b&&(b=new Mb,b.matrixAutoUpdate=!1,b.visible=!1,h[a]=b);return b};this.getDevice=function(){return e};this.setDevice=function(a){void 0!==a&&(e=a);y.setContext(a)};this.setPoseTarget=function(a){void 0!==a&&(g=a)};this.getCamera=function(a){if(null===e)return a.position.set(0,d.userHeight,0),a;e.depthNear=a.near;e.depthFar=a.far;e.getFrameData(f);var b=e.stageParameters;
   b?k.fromArray(b.sittingToStandingTransform):k.makeTranslation(0,d.userHeight,0);b=f.pose;var c=null!==g?g:a;c.matrix.copy(k);c.matrix.decompose(c.position,c.quaternion,c.scale);null!==b.orientation&&(n.fromArray(b.orientation),c.quaternion.multiply(n));null!==b.position&&(n.setFromRotationMatrix(k),u.fromArray(b.position),u.applyQuaternion(n),c.position.add(u));c.updateMatrixWorld();if(!1===e.isPresenting)return a;t.near=a.near;r.near=a.near;t.far=a.far;r.far=a.far;l.matrixWorld.copy(a.matrixWorld);
   l.matrixWorldInverse.copy(a.matrixWorldInverse);t.matrixWorldInverse.fromArray(f.leftViewMatrix);r.matrixWorldInverse.fromArray(f.rightViewMatrix);m.getInverse(k);t.matrixWorldInverse.multiply(m);r.matrixWorldInverse.multiply(m);a=c.parent;null!==a&&(q.getInverse(a.matrixWorld),t.matrixWorldInverse.multiply(q),r.matrixWorldInverse.multiply(q));t.matrixWorld.getInverse(t.matrixWorldInverse);r.matrixWorld.getInverse(r.matrixWorldInverse);t.projectionMatrix.fromArray(f.leftProjectionMatrix);r.projectionMatrix.fromArray(f.rightProjectionMatrix);
   l.projectionMatrix.copy(t.projectionMatrix);a=e.getLayers();a.length&&(a=a[0],null!==a.leftBounds&&4===a.leftBounds.length&&t.bounds.fromArray(a.leftBounds),null!==a.rightBounds&&4===a.rightBounds.length&&r.bounds.fromArray(a.rightBounds));a:for(a=0;a<h.length;a++){b=h[a];b:{c=a;for(var v=navigator.getGamepads&&navigator.getGamepads(),p=0,z=0,x=v.length;p<x;p++){var y=v[p];if(y&&("Daydream Controller"===y.id||"Gear VR Controller"===y.id||"Oculus Go Controller"===y.id||"OpenVR Gamepad"===y.id||y.id.startsWith("Oculus Touch")||
   y.id.startsWith("Spatial Controller"))){if(z===c){c=y;break b}z++}}c=void 0}if(void 0!==c&&void 0!==c.pose){if(null===c.pose)break a;v=c.pose;!1===v.hasPosition&&b.position.set(.2,-.6,-.05);null!==v.position&&b.position.fromArray(v.position);null!==v.orientation&&b.quaternion.fromArray(v.orientation);b.matrix.compose(b.position,b.quaternion,b.scale);b.matrix.premultiply(k);b.matrix.decompose(b.position,b.quaternion,b.scale);b.matrixWorldNeedsUpdate=!0;b.visible=!0;v="Daydream Controller"===c.id?0:
   1;w[a]!==c.buttons[v].pressed&&(w[a]=c.buttons[v].pressed,!0===w[a]?b.dispatchEvent({type:"selectstart"}):(b.dispatchEvent({type:"selectend"}),b.dispatchEvent({type:"select"})))}else b.visible=!1}return l};this.getStandingMatrix=function(){return k};this.isPresenting=b;var y=new Qd;this.setAnimationLoop=function(a){y.setAnimationLoop(a)};this.submitFrame=function(){b()&&e.submitFrame()};this.dispose=function(){"undefined"!==typeof window&&window.removeEventListener("vrdisplaypresentchange",c)}}function Lg(a){function b(){return null!==
   h&&null!==k}function c(a){var b=q[n.indexOf(a.inputSource)];b&&b.dispatchEvent({type:a.type})}function d(){a.setFramebuffer(null);p.stop()}function e(a,b){null===b?a.matrixWorld.copy(a.matrix):a.matrixWorld.multiplyMatrices(b.matrixWorld,a.matrix);a.matrixWorldInverse.getInverse(a.matrixWorld)}var f=a.context,g=null,h=null,k=null,m=null,q=[],n=[],u=new ea;u.layers.enable(1);u.viewport=new ca;var t=new ea;t.layers.enable(2);t.viewport=new ca;var r=new zc([u,t]);r.layers.enable(1);r.layers.enable(2);
   this.enabled=!1;this.getController=function(a){var b=q[a];void 0===b&&(b=new Mb,b.matrixAutoUpdate=!1,b.visible=!1,q[a]=b);return b};this.getDevice=function(){return g};this.setDevice=function(a){void 0!==a&&(g=a);a instanceof XRDevice&&f.setCompatibleXRDevice(a)};this.setSession=function(b,e){h=b;null!==h&&(h.addEventListener("select",c),h.addEventListener("selectstart",c),h.addEventListener("selectend",c),h.addEventListener("end",d),h.baseLayer=new XRWebGLLayer(h,f),h.requestFrameOfReference(e.frameOfReferenceType).then(function(b){k=
   b;a.setFramebuffer(h.baseLayer.framebuffer);p.setContext(h);p.start()}),n=h.getInputSources(),h.addEventListener("inputsourceschange",function(){n=h.getInputSources();console.log(n)}))};this.getCamera=function(a){if(b()){var c=a.parent,d=r.cameras;e(r,c);for(var f=0;f<d.length;f++)e(d[f],c);a.matrixWorld.copy(r.matrixWorld);a=a.children;f=0;for(c=a.length;f<c;f++)a[f].updateMatrixWorld(!0);return r}return a};this.isPresenting=b;var l=null,p=new Qd;p.setAnimationLoop(function(a,b){m=b.getDevicePose(k);
   if(null!==m)for(var c=h.baseLayer,d=b.views,e=0;e<d.length;e++){var f=d[e],g=c.getViewport(f),u=m.getViewMatrix(f),t=r.cameras[e];t.matrix.fromArray(u).getInverse(t.matrix);t.projectionMatrix.fromArray(f.projectionMatrix);t.viewport.set(g.x,g.y,g.width,g.height);0===e&&(r.matrix.copy(t.matrix),r.projectionMatrix.copy(t.projectionMatrix))}for(e=0;e<q.length;e++){c=q[e];if(d=n[e])if(d=b.getInputPose(d,k),null!==d){c.matrix.elements=d.pointerMatrix;c.matrix.decompose(c.position,c.rotation,c.scale);c.visible=
   !0;continue}c.visible=!1}l&&l(a)});this.setAnimationLoop=function(a){l=a};this.dispose=function(){};this.getStandingMatrix=function(){console.warn("THREE.WebXRManager: getStandingMatrix() is no longer needed.");return new THREE.Matrix4};this.submitFrame=function(){}}function Wd(a){var b;function c(){ja=new Of(D);xa=new Mf(D,ja,a);xa.isWebGL2||(ja.get("WEBGL_depth_texture"),ja.get("OES_texture_float"),ja.get("OES_texture_half_float"),ja.get("OES_texture_half_float_linear"),ja.get("OES_standard_derivatives"),
   ja.get("OES_element_index_uint"),ja.get("ANGLE_instanced_arrays"));ja.get("OES_texture_float_linear");ka=new Xe(D,ja,xa);ba=new Kg(D,ja,ka,xa);ba.scissor(X.copy(qa).multiplyScalar(Z));ba.viewport(aa.copy(pa).multiplyScalar(Z));ha=new Rf(D);Y=new Mg;la=new Ng(D,ja,ba,Y,xa,ka,ha,z);ta=new Gf(D);va=new Pf(D,ta,ha);ra=new Uf(va,ha);ya=new Tf(D);ma=new Bg(V,ja,xa);ua=new Fg;sa=new Jg;na=new Kf(V,ba,ra,J);Aa=new Lf(D,ja,ha,xa);Ba=new Qf(D,ja,ha,xa);ha.programs=ma.programs;V.context=D;V.capabilities=xa;
   V.extensions=ja;V.properties=Y;V.renderLists=ua;V.state=ba;V.info=ha}function d(a){a.preventDefault();console.log("THREE.WebGLRenderer: Context Lost.");G=!0}function e(){console.log("THREE.WebGLRenderer: Context Restored.");G=!1;c()}function f(a){a=a.target;a.removeEventListener("dispose",f);g(a);Y.remove(a)}function g(a){var b=Y.get(a).program;a.program=void 0;void 0!==b&&ma.releaseProgram(b)}function h(a,b){a.render(function(a){V.renderBufferImmediate(a,b)})}function k(a,b,c){if(!1!==a.visible){if(a.layers.test(b.layers))if(a.isLight)E.pushLight(a),
   a.castShadow&&E.pushShadow(a);else if(a.isSprite){if(!a.frustumCulled||fa.intersectsSprite(a)){c&&fb.setFromMatrixPosition(a.matrixWorld).applyMatrix4(yc);var d=ra.update(a),e=a.material;B.push(a,d,e,fb.z,null)}}else if(a.isImmediateRenderObject)c&&fb.setFromMatrixPosition(a.matrixWorld).applyMatrix4(yc),B.push(a,null,a.material,fb.z,null);else if(a.isMesh||a.isLine||a.isPoints)if(a.isSkinnedMesh&&a.skeleton.update(),!a.frustumCulled||fa.intersectsObject(a))if(c&&fb.setFromMatrixPosition(a.matrixWorld).applyMatrix4(yc),
   d=ra.update(a),e=a.material,Array.isArray(e))for(var f=d.groups,g=0,h=f.length;g<h;g++){var m=f[g],n=e[m.materialIndex];n&&n.visible&&B.push(a,d,n,fb.z,m)}else e.visible&&B.push(a,d,e,fb.z,null);a=a.children;g=0;for(h=a.length;g<h;g++)k(a[g],b,c)}}function m(a,b,c,d){for(var e=0,f=a.length;e<f;e++){var g=a[e],h=g.object,k=g.geometry,m=void 0===d?g.material:d;g=g.group;if(c.isArrayCamera){S=c;for(var n=c.cameras,u=0,t=n.length;u<t;u++){var l=n[u];if(h.layers.test(l.layers)){if("viewport"in l)ba.viewport(aa.copy(l.viewport));
   else{var r=l.bounds;ba.viewport(aa.set(r.x*N,r.y*U,r.z*N,r.w*U).multiplyScalar(Z))}q(h,b,l,k,m,g)}}}else S=null,q(h,b,c,k,m,g)}}function q(a,c,d,e,f,g){a.onBeforeRender(V,c,d,e,f,g);E=sa.get(c,S||d);a.modelViewMatrix.multiplyMatrices(d.matrixWorldInverse,a.matrixWorld);a.normalMatrix.getNormalMatrix(a.modelViewMatrix);if(a.isImmediateRenderObject){ba.setMaterial(f);var k=u(d,c.fog,f,a);R=b=null;T=!1;h(a,k)}else V.renderBufferDirect(d,c.fog,e,f,a,g);a.onAfterRender(V,c,d,e,f,g);E=sa.get(c,S||d)}function n(a,
   b,c){var d=Y.get(a),e=E.state.lights,h=d.lightsHash,k=e.state.hash;c=ma.getParameters(a,e.state,E.state.shadowsArray,b,Ga.numPlanes,Ga.numIntersection,c);var m=ma.getProgramCode(a,c),n=d.program,q=!0;if(void 0===n)a.addEventListener("dispose",f);else if(n.code!==m)g(a);else{if(h.stateID!==k.stateID||h.directionalLength!==k.directionalLength||h.pointLength!==k.pointLength||h.spotLength!==k.spotLength||h.rectAreaLength!==k.rectAreaLength||h.hemiLength!==k.hemiLength||h.shadowsLength!==k.shadowsLength)h.stateID=
   k.stateID,h.directionalLength=k.directionalLength,h.pointLength=k.pointLength,h.spotLength=k.spotLength,h.rectAreaLength=k.rectAreaLength,h.hemiLength=k.hemiLength,h.shadowsLength=k.shadowsLength;else if(void 0!==c.shaderID)return;q=!1}q&&(c.shaderID?(m=rb[c.shaderID],d.shader={name:a.type,uniforms:Ea.clone(m.uniforms),vertexShader:m.vertexShader,fragmentShader:m.fragmentShader}):d.shader={name:a.type,uniforms:a.uniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader},a.onBeforeCompile(d.shader,
   V),m=ma.getProgramCode(a,c),n=ma.acquireProgram(a,d.shader,c,m),d.program=n,a.program=n);c=n.getAttributes();if(a.morphTargets)for(m=a.numSupportedMorphTargets=0;m<V.maxMorphTargets;m++)0<=c["morphTarget"+m]&&a.numSupportedMorphTargets++;if(a.morphNormals)for(m=a.numSupportedMorphNormals=0;m<V.maxMorphNormals;m++)0<=c["morphNormal"+m]&&a.numSupportedMorphNormals++;c=d.shader.uniforms;if(!a.isShaderMaterial&&!a.isRawShaderMaterial||!0===a.clipping)d.numClippingPlanes=Ga.numPlanes,d.numIntersection=
   Ga.numIntersection,c.clippingPlanes=Ga.uniform;d.fog=b;void 0===h&&(d.lightsHash=h={});h.stateID=k.stateID;h.directionalLength=k.directionalLength;h.pointLength=k.pointLength;h.spotLength=k.spotLength;h.rectAreaLength=k.rectAreaLength;h.hemiLength=k.hemiLength;h.shadowsLength=k.shadowsLength;a.lights&&(c.ambientLightColor.value=e.state.ambient,c.directionalLights.value=e.state.directional,c.spotLights.value=e.state.spot,c.rectAreaLights.value=e.state.rectArea,c.pointLights.value=e.state.point,c.hemisphereLights.value=
   e.state.hemi,c.directionalShadowMap.value=e.state.directionalShadowMap,c.directionalShadowMatrix.value=e.state.directionalShadowMatrix,c.spotShadowMap.value=e.state.spotShadowMap,c.spotShadowMatrix.value=e.state.spotShadowMatrix,c.pointShadowMap.value=e.state.pointShadowMap,c.pointShadowMatrix.value=e.state.pointShadowMatrix);a=d.program.getUniforms();a=cb.seqWithValue(a.seq,c);d.uniformsList=a}function u(a,b,c,d){ia=0;var e=Y.get(c),f=e.lightsHash,g=E.state.lights.state.hash;nd&&(Vd||a!==W)&&Ga.setState(c.clippingPlanes,
   c.clipIntersection,c.clipShadows,a,e,a===W&&c.id===F);!1===c.needsUpdate&&(void 0===e.program?c.needsUpdate=!0:c.fog&&e.fog!==b?c.needsUpdate=!0:!c.lights||f.stateID===g.stateID&&f.directionalLength===g.directionalLength&&f.pointLength===g.pointLength&&f.spotLength===g.spotLength&&f.rectAreaLength===g.rectAreaLength&&f.hemiLength===g.hemiLength&&f.shadowsLength===g.shadowsLength?void 0===e.numClippingPlanes||e.numClippingPlanes===Ga.numPlanes&&e.numIntersection===Ga.numIntersection||(c.needsUpdate=
   !0):c.needsUpdate=!0);c.needsUpdate&&(n(c,b,d),c.needsUpdate=!1);var h=!1,k=!1,m=!1;f=e.program;g=f.getUniforms();var q=e.shader.uniforms;ba.useProgram(f.program)&&(m=k=h=!0);c.id!==F&&(F=c.id,k=!0);if(h||a!==W){g.setValue(D,"projectionMatrix",a.projectionMatrix);xa.logarithmicDepthBuffer&&g.setValue(D,"logDepthBufFC",2/(Math.log(a.far+1)/Math.LN2));W!==(S||a)&&(W=S||a,m=k=!0);if(c.isShaderMaterial||c.isMeshPhongMaterial||c.isMeshStandardMaterial||c.envMap)h=g.map.cameraPosition,void 0!==h&&h.setValue(D,
   fb.setFromMatrixPosition(a.matrixWorld));(c.isMeshPhongMaterial||c.isMeshLambertMaterial||c.isMeshBasicMaterial||c.isMeshStandardMaterial||c.isShaderMaterial||c.skinning)&&g.setValue(D,"viewMatrix",a.matrixWorldInverse)}if(c.skinning&&(g.setOptional(D,d,"bindMatrix"),g.setOptional(D,d,"bindMatrixInverse"),a=d.skeleton))if(h=a.bones,xa.floatVertexTextures){if(void 0===a.boneTexture){h=Math.sqrt(4*h.length);h=Q.ceilPowerOfTwo(h);h=Math.max(h,4);var u=new Float32Array(h*h*4);u.set(a.boneMatrices);var r=
   new kb(u,h,h,1023,1015);r.needsUpdate=!0;a.boneMatrices=u;a.boneTexture=r;a.boneTextureSize=h}g.setValue(D,"boneTexture",a.boneTexture);g.setValue(D,"boneTextureSize",a.boneTextureSize)}else g.setOptional(D,a,"boneMatrices");k&&(g.setValue(D,"toneMappingExposure",V.toneMappingExposure),g.setValue(D,"toneMappingWhitePoint",V.toneMappingWhitePoint),c.lights&&(k=m,q.ambientLightColor.needsUpdate=k,q.directionalLights.needsUpdate=k,q.pointLights.needsUpdate=k,q.spotLights.needsUpdate=k,q.rectAreaLights.needsUpdate=
   k,q.hemisphereLights.needsUpdate=k),b&&c.fog&&(q.fogColor.value=b.color,b.isFog?(q.fogNear.value=b.near,q.fogFar.value=b.far):b.isFogExp2&&(q.fogDensity.value=b.density)),c.isMeshBasicMaterial?t(q,c):c.isMeshLambertMaterial?(t(q,c),c.emissiveMap&&(q.emissiveMap.value=c.emissiveMap)):c.isMeshPhongMaterial?(t(q,c),c.isMeshToonMaterial?(l(q,c),c.gradientMap&&(q.gradientMap.value=c.gradientMap)):l(q,c)):c.isMeshStandardMaterial?(t(q,c),c.isMeshPhysicalMaterial?(v(q,c),q.reflectivity.value=c.reflectivity,
   q.clearCoat.value=c.clearCoat,q.clearCoatRoughness.value=c.clearCoatRoughness):v(q,c)):c.isMeshDepthMaterial?(t(q,c),c.displacementMap&&(q.displacementMap.value=c.displacementMap,q.displacementScale.value=c.displacementScale,q.displacementBias.value=c.displacementBias)):c.isMeshDistanceMaterial?(t(q,c),c.displacementMap&&(q.displacementMap.value=c.displacementMap,q.displacementScale.value=c.displacementScale,q.displacementBias.value=c.displacementBias),q.referencePosition.value.copy(c.referencePosition),
   q.nearDistance.value=c.nearDistance,q.farDistance.value=c.farDistance):c.isMeshNormalMaterial?(t(q,c),c.bumpMap&&(q.bumpMap.value=c.bumpMap,q.bumpScale.value=c.bumpScale,1===c.side&&(q.bumpScale.value*=-1)),c.normalMap&&(q.normalMap.value=c.normalMap,q.normalScale.value.copy(c.normalScale),1===c.side&&q.normalScale.value.negate()),c.displacementMap&&(q.displacementMap.value=c.displacementMap,q.displacementScale.value=c.displacementScale,q.displacementBias.value=c.displacementBias)):c.isLineBasicMaterial?
   (q.diffuse.value=c.color,q.opacity.value=c.opacity,c.isLineDashedMaterial&&(q.dashSize.value=c.dashSize,q.totalSize.value=c.dashSize+c.gapSize,q.scale.value=c.scale)):c.isPointsMaterial?(q.diffuse.value=c.color,q.opacity.value=c.opacity,q.size.value=c.size*Z,q.scale.value=.5*U,q.map.value=c.map,null!==c.map&&(!0===c.map.matrixAutoUpdate&&c.map.updateMatrix(),q.uvTransform.value.copy(c.map.matrix))):c.isSpriteMaterial?(q.diffuse.value=c.color,q.opacity.value=c.opacity,q.rotation.value=c.rotation,q.map.value=
   c.map,null!==c.map&&(!0===c.map.matrixAutoUpdate&&c.map.updateMatrix(),q.uvTransform.value.copy(c.map.matrix))):c.isShadowMaterial&&(q.color.value=c.color,q.opacity.value=c.opacity),void 0!==q.ltc_1&&(q.ltc_1.value=I.LTC_1),void 0!==q.ltc_2&&(q.ltc_2.value=I.LTC_2),cb.upload(D,e.uniformsList,q,V));c.isShaderMaterial&&!0===c.uniformsNeedUpdate&&(cb.upload(D,e.uniformsList,q,V),c.uniformsNeedUpdate=!1);c.isSpriteMaterial&&g.setValue(D,"center",d.center);g.setValue(D,"modelViewMatrix",d.modelViewMatrix);
   g.setValue(D,"normalMatrix",d.normalMatrix);g.setValue(D,"modelMatrix",d.matrixWorld);return f}function t(a,b){a.opacity.value=b.opacity;b.color&&(a.diffuse.value=b.color);b.emissive&&a.emissive.value.copy(b.emissive).multiplyScalar(b.emissiveIntensity);b.map&&(a.map.value=b.map);b.alphaMap&&(a.alphaMap.value=b.alphaMap);b.specularMap&&(a.specularMap.value=b.specularMap);b.envMap&&(a.envMap.value=b.envMap,a.flipEnvMap.value=b.envMap&&b.envMap.isCubeTexture?-1:1,a.reflectivity.value=b.reflectivity,
   a.refractionRatio.value=b.refractionRatio,a.maxMipLevel.value=Y.get(b.envMap).__maxMipLevel);b.lightMap&&(a.lightMap.value=b.lightMap,a.lightMapIntensity.value=b.lightMapIntensity);b.aoMap&&(a.aoMap.value=b.aoMap,a.aoMapIntensity.value=b.aoMapIntensity);if(b.map)var c=b.map;else b.specularMap?c=b.specularMap:b.displacementMap?c=b.displacementMap:b.normalMap?c=b.normalMap:b.bumpMap?c=b.bumpMap:b.roughnessMap?c=b.roughnessMap:b.metalnessMap?c=b.metalnessMap:b.alphaMap?c=b.alphaMap:b.emissiveMap&&(c=
   b.emissiveMap);void 0!==c&&(c.isWebGLRenderTarget&&(c=c.texture),!0===c.matrixAutoUpdate&&c.updateMatrix(),a.uvTransform.value.copy(c.matrix))}function l(a,b){a.specular.value=b.specular;a.shininess.value=Math.max(b.shininess,1E-4);b.emissiveMap&&(a.emissiveMap.value=b.emissiveMap);b.bumpMap&&(a.bumpMap.value=b.bumpMap,a.bumpScale.value=b.bumpScale,1===b.side&&(a.bumpScale.value*=-1));b.normalMap&&(a.normalMap.value=b.normalMap,a.normalScale.value.copy(b.normalScale),1===b.side&&a.normalScale.value.negate());
   b.displacementMap&&(a.displacementMap.value=b.displacementMap,a.displacementScale.value=b.displacementScale,a.displacementBias.value=b.displacementBias)}function v(a,b){a.roughness.value=b.roughness;a.metalness.value=b.metalness;b.roughnessMap&&(a.roughnessMap.value=b.roughnessMap);b.metalnessMap&&(a.metalnessMap.value=b.metalnessMap);b.emissiveMap&&(a.emissiveMap.value=b.emissiveMap);b.bumpMap&&(a.bumpMap.value=b.bumpMap,a.bumpScale.value=b.bumpScale,1===b.side&&(a.bumpScale.value*=-1));b.normalMap&&
   (a.normalMap.value=b.normalMap,a.normalScale.value.copy(b.normalScale),1===b.side&&a.normalScale.value.negate());b.displacementMap&&(a.displacementMap.value=b.displacementMap,a.displacementScale.value=b.displacementScale,a.displacementBias.value=b.displacementBias);b.envMap&&(a.envMapIntensity.value=b.envMapIntensity)}console.log("THREE.WebGLRenderer","95");var z=new Pg;a=a||{};var x=void 0!==a.canvas?a.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),w=void 0!==a.context?
   a.context:null,y=void 0!==a.alpha?a.alpha:!1,H=void 0!==a.depth?a.depth:!0,O=void 0!==a.stencil?a.stencil:!0,da=void 0!==a.antialias?a.antialias:!1,J=void 0!==a.premultipliedAlpha?a.premultipliedAlpha:!0,C=void 0!==a.preserveDrawingBuffer?a.preserveDrawingBuffer:!1,A=void 0!==a.powerPreference?a.powerPreference:"default",B=null,E=null;this.domElement=x;this.context=null;this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0;this.clippingPlanes=[];this.localClippingEnabled=
   !1;this.gammaFactor=2;this.physicallyCorrectLights=this.gammaOutput=this.gammaInput=!1;this.toneMappingWhitePoint=this.toneMappingExposure=this.toneMapping=1;this.maxMorphTargets=8;this.maxMorphNormals=4;var V=this,G=!1,L=null,K=null,P=null,F=-1;var R=b=null;var T=!1;var W=null,S=null,aa=new ca,X=new ca,ea=null,ia=0,N=x.width,U=x.height,Z=1,pa=new ca(0,0,N,U),qa=new ca(0,0,N,U),wa=!1,fa=new ld,Ga=new Nf,nd=!1,Vd=!1,yc=new M,fb=new p;try{y={alpha:y,depth:H,stencil:O,antialias:da,premultipliedAlpha:J,
   preserveDrawingBuffer:C,powerPreference:A};x.addEventListener("webglcontextlost",d,!1);x.addEventListener("webglcontextrestored",e,!1);var D=w||x.getContext("webgl",y)||x.getContext("experimental-webgl",y);if(null===D){if(null!==x.getContext("webgl"))throw Error("Error creating WebGL context with your selected attributes.");throw Error("Error creating WebGL context.");}void 0===D.getShaderPrecisionFormat&&(D.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Og){console.error("THREE.WebGLRenderer: "+
   Og.message)}var ja,xa,ba,ha,Y,la,ta,va,ra,ma,ua,sa,na,ya,Aa,Ba,ka;c();var oa="xr"in navigator?new Lg(V):new Ye(V);this.vr=oa;var Da=new We(V,ra,xa.maxTextureSize);this.shadowMap=Da;this.getContext=function(){return D};this.getContextAttributes=function(){return D.getContextAttributes()};this.forceContextLoss=function(){var a=ja.get("WEBGL_lose_context");a&&a.loseContext()};this.forceContextRestore=function(){var a=ja.get("WEBGL_lose_context");a&&a.restoreContext()};this.getPixelRatio=function(){return Z};
   this.setPixelRatio=function(a){void 0!==a&&(Z=a,this.setSize(N,U,!1))};this.getSize=function(){return{width:N,height:U}};this.setSize=function(a,b,c){oa.isPresenting()?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(N=a,U=b,x.width=a*Z,x.height=b*Z,!1!==c&&(x.style.width=a+"px",x.style.height=b+"px"),this.setViewport(0,0,a,b))};this.getDrawingBufferSize=function(){return{width:N*Z,height:U*Z}};this.setDrawingBufferSize=function(a,b,c){N=a;U=b;Z=c;x.width=a*c;
   x.height=b*c;this.setViewport(0,0,a,b)};this.getCurrentViewport=function(){return aa};this.setViewport=function(a,b,c,d){pa.set(a,U-b-d,c,d);ba.viewport(aa.copy(pa).multiplyScalar(Z))};this.setScissor=function(a,b,c,d){qa.set(a,U-b-d,c,d);ba.scissor(X.copy(qa).multiplyScalar(Z))};this.setScissorTest=function(a){ba.setScissorTest(wa=a)};this.getClearColor=function(){return na.getClearColor()};this.setClearColor=function(){na.setClearColor.apply(na,arguments)};this.getClearAlpha=function(){return na.getClearAlpha()};
   this.setClearAlpha=function(){na.setClearAlpha.apply(na,arguments)};this.clear=function(a,b,c){var d=0;if(void 0===a||a)d|=D.COLOR_BUFFER_BIT;if(void 0===b||b)d|=D.DEPTH_BUFFER_BIT;if(void 0===c||c)d|=D.STENCIL_BUFFER_BIT;D.clear(d)};this.clearColor=function(){this.clear(!0,!1,!1)};this.clearDepth=function(){this.clear(!1,!0,!1)};this.clearStencil=function(){this.clear(!1,!1,!0)};this.clearTarget=function(a,b,c,d){this.setRenderTarget(a);this.clear(b,c,d)};this.dispose=function(){x.removeEventListener("webglcontextlost",
   d,!1);x.removeEventListener("webglcontextrestored",e,!1);ua.dispose();sa.dispose();Y.dispose();ra.dispose();ma.disposeCached();z.textureCache.dispose();oa.dispose();za.stop()};this.renderBufferImmediate=function(a,b){ba.initAttributes();var c=Y.get(a);a.hasPositions&&!c.position&&(c.position=D.createBuffer());a.hasNormals&&!c.normal&&(c.normal=D.createBuffer());a.hasUvs&&!c.uv&&(c.uv=D.createBuffer());a.hasColors&&!c.color&&(c.color=D.createBuffer());b=b.getAttributes();a.hasPositions&&(D.bindBuffer(D.ARRAY_BUFFER,
   c.position),D.bufferData(D.ARRAY_BUFFER,a.positionArray,D.DYNAMIC_DRAW),ba.enableAttribute(b.position),D.vertexAttribPointer(b.position,3,D.FLOAT,!1,0,0));a.hasNormals&&(D.bindBuffer(D.ARRAY_BUFFER,c.normal),D.bufferData(D.ARRAY_BUFFER,a.normalArray,D.DYNAMIC_DRAW),ba.enableAttribute(b.normal),D.vertexAttribPointer(b.normal,3,D.FLOAT,!1,0,0));a.hasUvs&&(D.bindBuffer(D.ARRAY_BUFFER,c.uv),D.bufferData(D.ARRAY_BUFFER,a.uvArray,D.DYNAMIC_DRAW),ba.enableAttribute(b.uv),D.vertexAttribPointer(b.uv,2,D.FLOAT,
   !1,0,0));a.hasColors&&(D.bindBuffer(D.ARRAY_BUFFER,c.color),D.bufferData(D.ARRAY_BUFFER,a.colorArray,D.DYNAMIC_DRAW),ba.enableAttribute(b.color),D.vertexAttribPointer(b.color,3,D.FLOAT,!1,0,0));ba.disableUnusedAttributes();D.drawArrays(D.TRIANGLES,0,a.count);a.count=0};this.renderBufferDirect=function(a,c,d,e,f,g){var h=f.isMesh&&0>f.normalMatrix.determinant();ba.setMaterial(e,h);var k=u(a,c,e,f),m=!1;if(b!==d.id||R!==k.id||T!==(!0===e.wireframe))b=d.id,R=k.id,T=!0===e.wireframe,m=!0;f.morphTargetInfluences&&
   (ya.update(f,d,e,k),m=!0);h=d.index;var q=d.attributes.position;c=1;!0===e.wireframe&&(h=va.getWireframeAttribute(d),c=2);a=Aa;if(null!==h){var n=ta.get(h);a=Ba;a.setIndex(n)}if(m){if(d&&d.isInstancedBufferGeometry&&!xa.isWebGL2&&null===ja.get("ANGLE_instanced_arrays"))console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{ba.initAttributes();m=d.attributes;k=k.getAttributes();var t=e.defaultAttributeValues;
   for(O in k){var l=k[O];if(0<=l){var r=m[O];if(void 0!==r){var v=r.normalized,p=r.itemSize,w=ta.get(r);if(void 0!==w){var z=w.buffer,y=w.type;w=w.bytesPerElement;if(r.isInterleavedBufferAttribute){var x=r.data,H=x.stride;r=r.offset;x&&x.isInstancedInterleavedBuffer?(ba.enableAttributeAndDivisor(l,x.meshPerAttribute),void 0===d.maxInstancedCount&&(d.maxInstancedCount=x.meshPerAttribute*x.count)):ba.enableAttribute(l);D.bindBuffer(D.ARRAY_BUFFER,z);D.vertexAttribPointer(l,p,y,v,H*w,r*w)}else r.isInstancedBufferAttribute?
   (ba.enableAttributeAndDivisor(l,r.meshPerAttribute),void 0===d.maxInstancedCount&&(d.maxInstancedCount=r.meshPerAttribute*r.count)):ba.enableAttribute(l),D.bindBuffer(D.ARRAY_BUFFER,z),D.vertexAttribPointer(l,p,y,v,0,0)}}else if(void 0!==t&&(v=t[O],void 0!==v))switch(v.length){case 2:D.vertexAttrib2fv(l,v);break;case 3:D.vertexAttrib3fv(l,v);break;case 4:D.vertexAttrib4fv(l,v);break;default:D.vertexAttrib1fv(l,v)}}}ba.disableUnusedAttributes()}null!==h&&D.bindBuffer(D.ELEMENT_ARRAY_BUFFER,n.buffer)}n=
   Infinity;null!==h?n=h.count:void 0!==q&&(n=q.count);h=d.drawRange.start*c;q=null!==g?g.start*c:0;var O=Math.max(h,q);g=Math.max(0,Math.min(n,h+d.drawRange.count*c,q+(null!==g?g.count*c:Infinity))-1-O+1);if(0!==g){if(f.isMesh)if(!0===e.wireframe)ba.setLineWidth(e.wireframeLinewidth*(null===K?Z:1)),a.setMode(D.LINES);else switch(f.drawMode){case 0:a.setMode(D.TRIANGLES);break;case 1:a.setMode(D.TRIANGLE_STRIP);break;case 2:a.setMode(D.TRIANGLE_FAN)}else f.isLine?(e=e.linewidth,void 0===e&&(e=1),ba.setLineWidth(e*
   (null===K?Z:1)),f.isLineSegments?a.setMode(D.LINES):f.isLineLoop?a.setMode(D.LINE_LOOP):a.setMode(D.LINE_STRIP)):f.isPoints?a.setMode(D.POINTS):f.isSprite&&a.setMode(D.TRIANGLES);d&&d.isInstancedBufferGeometry?0<d.maxInstancedCount&&a.renderInstances(d,O,g):a.render(O,g)}};this.compile=function(a,b){E=sa.get(a,b);E.init();a.traverse(function(a){a.isLight&&(E.pushLight(a),a.castShadow&&E.pushShadow(a))});E.setupLights(b);a.traverse(function(b){if(b.material)if(Array.isArray(b.material))for(var c=0;c<
   b.material.length;c++)n(b.material[c],a.fog,b);else n(b.material,a.fog,b)})};var Ca=null,za=new Qd;za.setAnimationLoop(function(a){oa.isPresenting()||Ca&&Ca(a)});"undefined"!==typeof window&&za.setContext(window);this.setAnimationLoop=function(a){Ca=a;oa.setAnimationLoop(a);za.start()};this.render=function(a,c,d,e){if(!c||!c.isCamera)console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");else if(!G){R=b=null;T=!1;F=-1;W=null;!0===a.autoUpdate&&a.updateMatrixWorld();
   null===c.parent&&c.updateMatrixWorld();oa.enabled&&(c=oa.getCamera(c));E=sa.get(a,c);E.init();a.onBeforeRender(V,a,c,d);yc.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse);fa.setFromMatrix(yc);Vd=this.localClippingEnabled;nd=Ga.init(this.clippingPlanes,Vd,c);B=ua.get(a,c);B.init();k(a,c,V.sortObjects);!0===V.sortObjects&&B.sort();nd&&Ga.beginShadows();Da.render(E.state.shadowsArray,a,c);E.setupLights(c);nd&&Ga.endShadows();this.info.autoReset&&this.info.reset();void 0===d&&(d=null);this.setRenderTarget(d);
   na.render(B,a,c,e);e=B.opaque;var f=B.transparent;if(a.overrideMaterial){var g=a.overrideMaterial;e.length&&m(e,a,c,g);f.length&&m(f,a,c,g)}else e.length&&m(e,a,c),f.length&&m(f,a,c);d&&la.updateRenderTargetMipmap(d);ba.buffers.depth.setTest(!0);ba.buffers.depth.setMask(!0);ba.buffers.color.setMask(!0);ba.setPolygonOffset(!1);a.onAfterRender(V,a,c);oa.enabled&&oa.submitFrame();E=B=null}};this.allocTextureUnit=function(){var a=ia;a>=xa.maxTextures&&console.warn("THREE.WebGLRenderer: Trying to use "+
   a+" texture units while this GPU supports only "+xa.maxTextures);ia+=1;return a};this.setTexture2D=function(){var a=!1;return function(b,c){b&&b.isWebGLRenderTarget&&(a||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),a=!0),b=b.texture);la.setTexture2D(b,c)}}();this.setTexture=function(){var a=!1;return function(b,c){a||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),a=!0);la.setTexture2D(b,
   c)}}();this.setTextureCube=function(){var a=!1;return function(b,c){b&&b.isWebGLRenderTargetCube&&(a||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),a=!0),b=b.texture);b&&b.isCubeTexture||Array.isArray(b.images)&&6===b.images.length?la.setTextureCube(b,c):la.setTextureCubeDynamic(b,c)}}();this.setFramebuffer=function(a){L=a};this.getRenderTarget=function(){return K};this.setRenderTarget=function(a){(K=a)&&void 0===
   Y.get(a).__webglFramebuffer&&la.setupRenderTarget(a);var b=L,c=!1;a?(b=Y.get(a).__webglFramebuffer,a.isWebGLRenderTargetCube&&(b=b[a.activeCubeFace],c=!0),aa.copy(a.viewport),X.copy(a.scissor),ea=a.scissorTest):(aa.copy(pa).multiplyScalar(Z),X.copy(qa).multiplyScalar(Z),ea=wa);P!==b&&(D.bindFramebuffer(D.FRAMEBUFFER,b),P=b);ba.viewport(aa);ba.scissor(X);ba.setScissorTest(ea);c&&(c=Y.get(a.texture),D.framebufferTexture2D(D.FRAMEBUFFER,D.COLOR_ATTACHMENT0,D.TEXTURE_CUBE_MAP_POSITIVE_X+a.activeCubeFace,
   c.__webglTexture,a.activeMipMapLevel))};this.readRenderTargetPixels=function(a,b,c,d,e,f){if(a&&a.isWebGLRenderTarget){var g=Y.get(a).__webglFramebuffer;if(g){var h=!1;g!==P&&(D.bindFramebuffer(D.FRAMEBUFFER,g),h=!0);try{var k=a.texture,m=k.format,q=k.type;1023!==m&&ka.convert(m)!==D.getParameter(D.IMPLEMENTATION_COLOR_READ_FORMAT)?console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format."):1009===q||ka.convert(q)===D.getParameter(D.IMPLEMENTATION_COLOR_READ_TYPE)||
   1015===q&&(xa.isWebGL2||ja.get("OES_texture_float")||ja.get("WEBGL_color_buffer_float"))||1016===q&&(xa.isWebGL2?ja.get("EXT_color_buffer_float"):ja.get("EXT_color_buffer_half_float"))?D.checkFramebufferStatus(D.FRAMEBUFFER)===D.FRAMEBUFFER_COMPLETE?0<=b&&b<=a.width-d&&0<=c&&c<=a.height-e&&D.readPixels(b,c,d,e,ka.convert(m),ka.convert(q),f):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.")}finally{h&&
   D.bindFramebuffer(D.FRAMEBUFFER,P)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")};this.copyFramebufferToTexture=function(a,b,c){var d=b.image.width,e=b.image.height,f=ka.convert(b.format);this.setTexture2D(b,0);D.copyTexImage2D(D.TEXTURE_2D,c||0,f,a.x,a.y,d,e,0)};this.copyTextureToTexture=function(a,b,c,d){var e=b.image.width,f=b.image.height,g=ka.convert(c.format),h=ka.convert(c.type);this.setTexture2D(c,0);b.isDataTexture?D.texSubImage2D(D.TEXTURE_2D,
   d||0,a.x,a.y,e,f,g,h,b.image.data):D.texSubImage2D(D.TEXTURE_2D,d||0,a.x,a.y,g,h,b.image)}}function Nb(a,b){this.name="";this.color=new G(a);this.density=void 0!==b?b:2.5E-4}function Ob(a,b,c){this.name="";this.color=new G(a);this.near=void 0!==b?b:1;this.far=void 0!==c?c:1E3}function od(){B.call(this);this.type="Scene";this.overrideMaterial=this.fog=this.background=null;this.autoUpdate=!0}function sb(a,b){this.array=a;this.stride=b;this.count=void 0!==a?a.length/b:0;this.dynamic=!1;this.updateRange=
   {offset:0,count:-1};this.version=0}function Ac(a,b,c,d){this.data=a;this.itemSize=b;this.offset=c;this.normalized=!0===d}function gb(a){F.call(this);this.type="SpriteMaterial";this.color=new G(16777215);this.map=null;this.rotation=0;this.lights=!1;this.transparent=!0;this.setValues(a)}function Bc(a){B.call(this);this.type="Sprite";if(void 0===Pb){Pb=new E;var b=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]);b=new sb(b,5);Pb.setIndex([0,1,2,0,2,3]);Pb.addAttribute("position",
   new Ac(b,3,0,!1));Pb.addAttribute("uv",new Ac(b,2,3,!1))}this.geometry=Pb;this.material=void 0!==a?a:new gb;this.center=new C(.5,.5)}function Cc(){B.call(this);this.type="LOD";Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function Dc(a,b){a=a||[];this.bones=a.slice(0);this.boneMatrices=new Float32Array(16*this.bones.length);if(void 0===b)this.calculateInverses();else if(this.bones.length===b.length)this.boneInverses=b.slice(0);else for(console.warn("THREE.Skeleton boneInverses is the wrong length."),
   this.boneInverses=[],a=0,b=this.bones.length;a<b;a++)this.boneInverses.push(new M)}function pd(){B.call(this);this.type="Bone"}function qd(a,b){ra.call(this,a,b);this.type="SkinnedMesh";this.bindMode="attached";this.bindMatrix=new M;this.bindMatrixInverse=new M;a=this.initBones();a=new Dc(a);this.bind(a,this.matrixWorld);this.normalizeSkinWeights()}function T(a){F.call(this);this.type="LineBasicMaterial";this.color=new G(16777215);this.linewidth=1;this.linejoin=this.linecap="round";this.lights=!1;
   this.setValues(a);this.attributes=["position","color"]}function ma(a,b,c){1===c&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead.");B.call(this);this.type="Line";this.geometry=void 0!==a?a:new E;this.material=void 0!==b?b:new T({color:16777215*Math.random()})}function W(a,b){ma.call(this,a,b);this.type="LineSegments"}function rd(a,b){ma.call(this,a,b);this.type="LineLoop"}function Ha(a){F.call(this);this.type="PointsMaterial";this.color=new G(16777215);
   this.map=null;this.size=1;this.sizeAttenuation=!0;this.lights=this.morphTargets=!1;this.setValues(a)}function Qb(a,b){B.call(this);this.type="Points";this.geometry=void 0!==a?a:new E;this.material=void 0!==b?b:new Ha({color:16777215*Math.random()})}function Xd(a,b,c,d,e,f,g,h,k){ta.call(this,a,b,c,d,e,f,g,h,k);this.generateMipmaps=!1}function Rb(a,b,c,d,e,f,g,h,k,m,q,n){ta.call(this,null,f,g,h,k,m,d,e,q,n);this.image={width:b,height:c};this.mipmaps=a;this.generateMipmaps=this.flipY=!1}function Ec(a,
   b,c,d,e,f,g,h,k,m){m=void 0!==m?m:1026;if(1026!==m&&1027!==m)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===c&&1026===m&&(c=1012);void 0===c&&1027===m&&(c=1020);ta.call(this,null,d,e,f,g,h,m,c,k);this.image={width:a,height:b};this.magFilter=void 0!==g?g:1003;this.minFilter=void 0!==h?h:1003;this.generateMipmaps=this.flipY=!1}function Sb(a){E.call(this);this.type="WireframeGeometry";var b=[],c,d,e,f=[0,0],g={},h=["a","b","c"];if(a&&a.isGeometry){var k=
   a.faces;var m=0;for(d=k.length;m<d;m++){var q=k[m];for(c=0;3>c;c++){var n=q[h[c]];var u=q[h[(c+1)%3]];f[0]=Math.min(n,u);f[1]=Math.max(n,u);n=f[0]+","+f[1];void 0===g[n]&&(g[n]={index1:f[0],index2:f[1]})}}for(n in g)m=g[n],h=a.vertices[m.index1],b.push(h.x,h.y,h.z),h=a.vertices[m.index2],b.push(h.x,h.y,h.z)}else if(a&&a.isBufferGeometry)if(h=new p,null!==a.index){k=a.attributes.position;q=a.index;var t=a.groups;0===t.length&&(t=[{start:0,count:q.count,materialIndex:0}]);a=0;for(e=t.length;a<e;++a)for(m=
   t[a],c=m.start,d=m.count,m=c,d=c+d;m<d;m+=3)for(c=0;3>c;c++)n=q.getX(m+c),u=q.getX(m+(c+1)%3),f[0]=Math.min(n,u),f[1]=Math.max(n,u),n=f[0]+","+f[1],void 0===g[n]&&(g[n]={index1:f[0],index2:f[1]});for(n in g)m=g[n],h.fromBufferAttribute(k,m.index1),b.push(h.x,h.y,h.z),h.fromBufferAttribute(k,m.index2),b.push(h.x,h.y,h.z)}else for(k=a.attributes.position,m=0,d=k.count/3;m<d;m++)for(c=0;3>c;c++)g=3*m+c,h.fromBufferAttribute(k,g),b.push(h.x,h.y,h.z),g=3*m+(c+1)%3,h.fromBufferAttribute(k,g),b.push(h.x,
   h.y,h.z);this.addAttribute("position",new A(b,3))}function Fc(a,b,c){K.call(this);this.type="ParametricGeometry";this.parameters={func:a,slices:b,stacks:c};this.fromBufferGeometry(new Tb(a,b,c));this.mergeVertices()}function Tb(a,b,c){E.call(this);this.type="ParametricBufferGeometry";this.parameters={func:a,slices:b,stacks:c};var d=[],e=[],f=[],g=[],h=new p,k=new p,m=new p,q=new p,n=new p,u,t;3>a.length&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");
   var l=b+1;for(u=0;u<=c;u++){var v=u/c;for(t=0;t<=b;t++){var z=t/b;a(z,v,k);e.push(k.x,k.y,k.z);0<=z-1E-5?(a(z-1E-5,v,m),q.subVectors(k,m)):(a(z+1E-5,v,m),q.subVectors(m,k));0<=v-1E-5?(a(z,v-1E-5,m),n.subVectors(k,m)):(a(z,v+1E-5,m),n.subVectors(m,k));h.crossVectors(q,n).normalize();f.push(h.x,h.y,h.z);g.push(z,v)}}for(u=0;u<c;u++)for(t=0;t<b;t++)a=u*l+t+1,h=(u+1)*l+t+1,k=(u+1)*l+t,d.push(u*l+t,a,k),d.push(a,h,k);this.setIndex(d);this.addAttribute("position",new A(e,3));this.addAttribute("normal",
   new A(f,3));this.addAttribute("uv",new A(g,2))}function Gc(a,b,c,d){K.call(this);this.type="PolyhedronGeometry";this.parameters={vertices:a,indices:b,radius:c,detail:d};this.fromBufferGeometry(new ua(a,b,c,d));this.mergeVertices()}function ua(a,b,c,d){function e(a){h.push(a.x,a.y,a.z)}function f(b,c){b*=3;c.x=a[b+0];c.y=a[b+1];c.z=a[b+2]}function g(a,b,c,d){0>d&&1===a.x&&(k[b]=a.x-1);0===c.x&&0===c.z&&(k[b]=d/2/Math.PI+.5)}E.call(this);this.type="PolyhedronBufferGeometry";this.parameters={vertices:a,
   indices:b,radius:c,detail:d};c=c||1;d=d||0;var h=[],k=[];(function(a){for(var c=new p,d=new p,g=new p,h=0;h<b.length;h+=3){f(b[h+0],c);f(b[h+1],d);f(b[h+2],g);var k,m,l=c,x=d,w=g,y=Math.pow(2,a),H=[];for(m=0;m<=y;m++){H[m]=[];var O=l.clone().lerp(w,m/y),da=x.clone().lerp(w,m/y),J=y-m;for(k=0;k<=J;k++)H[m][k]=0===k&&m===y?O:O.clone().lerp(da,k/J)}for(m=0;m<y;m++)for(k=0;k<2*(y-m)-1;k++)l=Math.floor(k/2),0===k%2?(e(H[m][l+1]),e(H[m+1][l]),e(H[m][l])):(e(H[m][l+1]),e(H[m+1][l+1]),e(H[m+1][l]))}})(d);
   (function(a){for(var b=new p,c=0;c<h.length;c+=3)b.x=h[c+0],b.y=h[c+1],b.z=h[c+2],b.normalize().multiplyScalar(a),h[c+0]=b.x,h[c+1]=b.y,h[c+2]=b.z})(c);(function(){for(var a=new p,b=0;b<h.length;b+=3)a.x=h[b+0],a.y=h[b+1],a.z=h[b+2],k.push(Math.atan2(a.z,-a.x)/2/Math.PI+.5,1-(Math.atan2(-a.y,Math.sqrt(a.x*a.x+a.z*a.z))/Math.PI+.5));a=new p;b=new p;for(var c=new p,d=new p,e=new C,f=new C,l=new C,z=0,x=0;z<h.length;z+=9,x+=6){a.set(h[z+0],h[z+1],h[z+2]);b.set(h[z+3],h[z+4],h[z+5]);c.set(h[z+6],h[z+
   7],h[z+8]);e.set(k[x+0],k[x+1]);f.set(k[x+2],k[x+3]);l.set(k[x+4],k[x+5]);d.copy(a).add(b).add(c).divideScalar(3);var w=Math.atan2(d.z,-d.x);g(e,x+0,a,w);g(f,x+2,b,w);g(l,x+4,c,w)}for(a=0;a<k.length;a+=6)b=k[a+0],c=k[a+2],d=k[a+4],e=Math.min(b,c,d),.9<Math.max(b,c,d)&&.1>e&&(.2>b&&(k[a+0]+=1),.2>c&&(k[a+2]+=1),.2>d&&(k[a+4]+=1))})();this.addAttribute("position",new A(h,3));this.addAttribute("normal",new A(h.slice(),3));this.addAttribute("uv",new A(k,2));0===d?this.computeVertexNormals():this.normalizeNormals()}
   function Hc(a,b){K.call(this);this.type="TetrahedronGeometry";this.parameters={radius:a,detail:b};this.fromBufferGeometry(new Ub(a,b));this.mergeVertices()}function Ub(a,b){ua.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],a,b);this.type="TetrahedronBufferGeometry";this.parameters={radius:a,detail:b}}function Ic(a,b){K.call(this);this.type="OctahedronGeometry";this.parameters={radius:a,detail:b};this.fromBufferGeometry(new tb(a,b));this.mergeVertices()}function tb(a,b){ua.call(this,
   [1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],a,b);this.type="OctahedronBufferGeometry";this.parameters={radius:a,detail:b}}function Jc(a,b){K.call(this);this.type="IcosahedronGeometry";this.parameters={radius:a,detail:b};this.fromBufferGeometry(new Vb(a,b));this.mergeVertices()}function Vb(a,b){var c=(1+Math.sqrt(5))/2;ua.call(this,[-1,c,0,1,c,0,-1,-c,0,1,-c,0,0,-1,c,0,1,c,0,-1,-c,0,1,-c,c,0,-1,c,0,1,-c,0,-1,-c,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,
   1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],a,b);this.type="IcosahedronBufferGeometry";this.parameters={radius:a,detail:b}}function Kc(a,b){K.call(this);this.type="DodecahedronGeometry";this.parameters={radius:a,detail:b};this.fromBufferGeometry(new Wb(a,b));this.mergeVertices()}function Wb(a,b){var c=(1+Math.sqrt(5))/2,d=1/c;ua.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-d,-c,0,-d,c,0,d,-c,0,d,c,-d,-c,0,-d,c,0,d,-c,
   0,d,c,0,-c,0,-d,c,0,-d,-c,0,d,c,0,d],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],a,b);this.type="DodecahedronBufferGeometry";this.parameters={radius:a,detail:b}}function Lc(a,b,c,d,e,f){K.call(this);this.type="TubeGeometry";this.parameters={path:a,tubularSegments:b,radius:c,radialSegments:d,
   closed:e};void 0!==f&&console.warn("THREE.TubeGeometry: taper has been removed.");a=new Xb(a,b,c,d,e);this.tangents=a.tangents;this.normals=a.normals;this.binormals=a.binormals;this.fromBufferGeometry(a);this.mergeVertices()}function Xb(a,b,c,d,e){function f(e){q=a.getPointAt(e/b,q);var f=g.normals[e];e=g.binormals[e];for(u=0;u<=d;u++){var m=u/d*Math.PI*2,n=Math.sin(m);m=-Math.cos(m);k.x=m*f.x+n*e.x;k.y=m*f.y+n*e.y;k.z=m*f.z+n*e.z;k.normalize();r.push(k.x,k.y,k.z);h.x=q.x+c*k.x;h.y=q.y+c*k.y;h.z=
   q.z+c*k.z;l.push(h.x,h.y,h.z)}}E.call(this);this.type="TubeBufferGeometry";this.parameters={path:a,tubularSegments:b,radius:c,radialSegments:d,closed:e};b=b||64;c=c||1;d=d||8;e=e||!1;var g=a.computeFrenetFrames(b,e);this.tangents=g.tangents;this.normals=g.normals;this.binormals=g.binormals;var h=new p,k=new p,m=new C,q=new p,n,u,l=[],r=[],v=[],z=[];for(n=0;n<b;n++)f(n);f(!1===e?b:0);for(n=0;n<=b;n++)for(u=0;u<=d;u++)m.x=n/b,m.y=u/d,v.push(m.x,m.y);(function(){for(u=1;u<=b;u++)for(n=1;n<=d;n++){var a=
   (d+1)*u+(n-1),c=(d+1)*u+n,e=(d+1)*(u-1)+n;z.push((d+1)*(u-1)+(n-1),a,e);z.push(a,c,e)}})();this.setIndex(z);this.addAttribute("position",new A(l,3));this.addAttribute("normal",new A(r,3));this.addAttribute("uv",new A(v,2))}function Mc(a,b,c,d,e,f,g){K.call(this);this.type="TorusKnotGeometry";this.parameters={radius:a,tube:b,tubularSegments:c,radialSegments:d,p:e,q:f};void 0!==g&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead.");this.fromBufferGeometry(new Yb(a,
   b,c,d,e,f));this.mergeVertices()}function Yb(a,b,c,d,e,f){function g(a,b,c,d,e){var f=Math.sin(a);b=c/b*a;c=Math.cos(b);e.x=d*(2+c)*.5*Math.cos(a);e.y=d*(2+c)*f*.5;e.z=d*Math.sin(b)*.5}E.call(this);this.type="TorusKnotBufferGeometry";this.parameters={radius:a,tube:b,tubularSegments:c,radialSegments:d,p:e,q:f};a=a||1;b=b||.4;c=Math.floor(c)||64;d=Math.floor(d)||8;e=e||2;f=f||3;var h=[],k=[],m=[],q=[],n,u=new p,l=new p,r=new p,v=new p,z=new p,x=new p,w=new p;for(n=0;n<=c;++n){var y=n/c*e*Math.PI*2;
   g(y,e,f,a,r);g(y+.01,e,f,a,v);x.subVectors(v,r);w.addVectors(v,r);z.crossVectors(x,w);w.crossVectors(z,x);z.normalize();w.normalize();for(y=0;y<=d;++y){var H=y/d*Math.PI*2,O=-b*Math.cos(H);H=b*Math.sin(H);u.x=r.x+(O*w.x+H*z.x);u.y=r.y+(O*w.y+H*z.y);u.z=r.z+(O*w.z+H*z.z);k.push(u.x,u.y,u.z);l.subVectors(u,r).normalize();m.push(l.x,l.y,l.z);q.push(n/c);q.push(y/d)}}for(y=1;y<=c;y++)for(n=1;n<=d;n++)a=(d+1)*y+(n-1),b=(d+1)*y+n,e=(d+1)*(y-1)+n,h.push((d+1)*(y-1)+(n-1),a,e),h.push(a,b,e);this.setIndex(h);
   this.addAttribute("position",new A(k,3));this.addAttribute("normal",new A(m,3));this.addAttribute("uv",new A(q,2))}function Nc(a,b,c,d,e){K.call(this);this.type="TorusGeometry";this.parameters={radius:a,tube:b,radialSegments:c,tubularSegments:d,arc:e};this.fromBufferGeometry(new Zb(a,b,c,d,e));this.mergeVertices()}function Zb(a,b,c,d,e){E.call(this);this.type="TorusBufferGeometry";this.parameters={radius:a,tube:b,radialSegments:c,tubularSegments:d,arc:e};a=a||1;b=b||.4;c=Math.floor(c)||8;d=Math.floor(d)||
   6;e=e||2*Math.PI;var f=[],g=[],h=[],k=[],m=new p,q=new p,n=new p,u,l;for(u=0;u<=c;u++)for(l=0;l<=d;l++){var r=l/d*e,v=u/c*Math.PI*2;q.x=(a+b*Math.cos(v))*Math.cos(r);q.y=(a+b*Math.cos(v))*Math.sin(r);q.z=b*Math.sin(v);g.push(q.x,q.y,q.z);m.x=a*Math.cos(r);m.y=a*Math.sin(r);n.subVectors(q,m).normalize();h.push(n.x,n.y,n.z);k.push(l/d);k.push(u/c)}for(u=1;u<=c;u++)for(l=1;l<=d;l++)a=(d+1)*(u-1)+l-1,b=(d+1)*(u-1)+l,e=(d+1)*u+l,f.push((d+1)*u+l-1,a,e),f.push(a,b,e);this.setIndex(f);this.addAttribute("position",
   new A(g,3));this.addAttribute("normal",new A(h,3));this.addAttribute("uv",new A(k,2))}function Ze(a,b,c,d,e){for(var f,g=0,h=b,k=c-d;h<c;h+=d)g+=(a[k]-a[h])*(a[h+1]+a[k+1]),k=h;if(e===0<g)for(e=b;e<c;e+=d)f=$e(e,a[e],a[e+1],f);else for(e=c-d;e>=b;e-=d)f=$e(e,a[e],a[e+1],f);f&&ub(f,f.next)&&(Oc(f),f=f.next);return f}function Pc(a,b){if(!a)return a;b||(b=a);do{var c=!1;if(a.steiner||!ub(a,a.next)&&0!==va(a.prev,a,a.next))a=a.next;else{Oc(a);a=b=a.prev;if(a===a.next)break;c=!0}}while(c||a!==b);return b}
   function Qc(a,b,c,d,e,f,g){if(a){if(!g&&f){var h=a,k=h;do null===k.z&&(k.z=Yd(k.x,k.y,d,e,f)),k.prevZ=k.prev,k=k.nextZ=k.next;while(k!==h);k.prevZ.nextZ=null;k.prevZ=null;h=k;var m,q,n,u,l=1;do{k=h;var r=h=null;for(q=0;k;){q++;var v=k;for(m=n=0;m<l&&(n++,v=v.nextZ,v);m++);for(u=l;0<n||0<u&&v;)0!==n&&(0===u||!v||k.z<=v.z)?(m=k,k=k.nextZ,n--):(m=v,v=v.nextZ,u--),r?r.nextZ=m:h=m,m.prevZ=r,r=m;k=v}r.nextZ=null;l*=2}while(1<q)}for(h=a;a.prev!==a.next;){k=a.prev;v=a.next;if(f)a:{r=a;u=d;var p=e,x=f;q=r.prev;
   n=r;l=r.next;if(0<=va(q,n,l))r=!1;else{var w=q.x>n.x?q.x>l.x?q.x:l.x:n.x>l.x?n.x:l.x,y=q.y>n.y?q.y>l.y?q.y:l.y:n.y>l.y?n.y:l.y;m=Yd(q.x<n.x?q.x<l.x?q.x:l.x:n.x<l.x?n.x:l.x,q.y<n.y?q.y<l.y?q.y:l.y:n.y<l.y?n.y:l.y,u,p,x);u=Yd(w,y,u,p,x);for(p=r.nextZ;p&&p.z<=u;){if(p!==r.prev&&p!==r.next&&sd(q.x,q.y,n.x,n.y,l.x,l.y,p.x,p.y)&&0<=va(p.prev,p,p.next)){r=!1;break a}p=p.nextZ}for(p=r.prevZ;p&&p.z>=m;){if(p!==r.prev&&p!==r.next&&sd(q.x,q.y,n.x,n.y,l.x,l.y,p.x,p.y)&&0<=va(p.prev,p,p.next)){r=!1;break a}p=
   p.prevZ}r=!0}}else a:if(r=a,q=r.prev,n=r,l=r.next,0<=va(q,n,l))r=!1;else{for(m=r.next.next;m!==r.prev;){if(sd(q.x,q.y,n.x,n.y,l.x,l.y,m.x,m.y)&&0<=va(m.prev,m,m.next)){r=!1;break a}m=m.next}r=!0}if(r)b.push(k.i/c),b.push(a.i/c),b.push(v.i/c),Oc(a),h=a=v.next;else if(a=v,a===h){if(!g)Qc(Pc(a),b,c,d,e,f,1);else if(1===g){g=b;h=c;k=a;do v=k.prev,r=k.next.next,!ub(v,r)&&af(v,k,k.next,r)&&Rc(v,r)&&Rc(r,v)&&(g.push(v.i/h),g.push(k.i/h),g.push(r.i/h),Oc(k),Oc(k.next),k=a=r),k=k.next;while(k!==a);a=k;Qc(a,
   b,c,d,e,f,2)}else if(2===g)a:{g=a;do{for(h=g.next.next;h!==g.prev;){if(k=g.i!==h.i){k=g;v=h;if(r=k.next.i!==v.i&&k.prev.i!==v.i){b:{r=k;do{if(r.i!==k.i&&r.next.i!==k.i&&r.i!==v.i&&r.next.i!==v.i&&af(r,r.next,k,v)){r=!0;break b}r=r.next}while(r!==k);r=!1}r=!r}if(r=r&&Rc(k,v)&&Rc(v,k)){r=k;q=!1;n=(k.x+v.x)/2;v=(k.y+v.y)/2;do r.y>v!==r.next.y>v&&r.next.y!==r.y&&n<(r.next.x-r.x)*(v-r.y)/(r.next.y-r.y)+r.x&&(q=!q),r=r.next;while(r!==k);r=q}k=r}if(k){a=bf(g,h);g=Pc(g,g.next);a=Pc(a,a.next);Qc(g,b,c,d,e,
   f);Qc(a,b,c,d,e,f);break a}h=h.next}g=g.next}while(g!==a)}break}}}}function Qg(a,b){return a.x-b.x}function Rg(a,b){var c=b,d=a.x,e=a.y,f=-Infinity;do{if(e<=c.y&&e>=c.next.y&&c.next.y!==c.y){var g=c.x+(e-c.y)*(c.next.x-c.x)/(c.next.y-c.y);if(g<=d&&g>f){f=g;if(g===d){if(e===c.y)return c;if(e===c.next.y)return c.next}var h=c.x<c.next.x?c:c.next}}c=c.next}while(c!==b);if(!h)return null;if(d===f)return h.prev;b=h;g=h.x;var k=h.y,m=Infinity;for(c=h.next;c!==b;){if(d>=c.x&&c.x>=g&&d!==c.x&&sd(e<k?d:f,e,
   g,k,e<k?f:d,e,c.x,c.y)){var q=Math.abs(e-c.y)/(d-c.x);(q<m||q===m&&c.x>h.x)&&Rc(c,a)&&(h=c,m=q)}c=c.next}return h}function Yd(a,b,c,d,e){a=32767*(a-c)*e;b=32767*(b-d)*e;a=(a|a<<8)&16711935;a=(a|a<<4)&252645135;a=(a|a<<2)&858993459;b=(b|b<<8)&16711935;b=(b|b<<4)&252645135;b=(b|b<<2)&858993459;return(a|a<<1)&1431655765|((b|b<<1)&1431655765)<<1}function Sg(a){var b=a,c=a;do b.x<c.x&&(c=b),b=b.next;while(b!==a);return c}function sd(a,b,c,d,e,f,g,h){return 0<=(e-g)*(b-h)-(a-g)*(f-h)&&0<=(a-g)*(d-h)-(c-
   g)*(b-h)&&0<=(c-g)*(f-h)-(e-g)*(d-h)}function va(a,b,c){return(b.y-a.y)*(c.x-b.x)-(b.x-a.x)*(c.y-b.y)}function ub(a,b){return a.x===b.x&&a.y===b.y}function af(a,b,c,d){return ub(a,b)&&ub(c,d)||ub(a,d)&&ub(c,b)?!0:0<va(a,b,c)!==0<va(a,b,d)&&0<va(c,d,a)!==0<va(c,d,b)}function Rc(a,b){return 0>va(a.prev,a,a.next)?0<=va(a,b,a.next)&&0<=va(a,a.prev,b):0>va(a,b,a.prev)||0>va(a,a.next,b)}function bf(a,b){var c=new Zd(a.i,a.x,a.y),d=new Zd(b.i,b.x,b.y),e=a.next,f=b.prev;a.next=b;b.prev=a;c.next=e;e.prev=
   c;d.next=c;c.prev=d;f.next=d;d.prev=f;return d}function $e(a,b,c,d){a=new Zd(a,b,c);d?(a.next=d.next,a.prev=d,d.next.prev=a,d.next=a):(a.prev=a,a.next=a);return a}function Oc(a){a.next.prev=a.prev;a.prev.next=a.next;a.prevZ&&(a.prevZ.nextZ=a.nextZ);a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function Zd(a,b,c){this.i=a;this.x=b;this.y=c;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}function cf(a){var b=a.length;2<b&&a[b-1].equals(a[0])&&a.pop()}function df(a,b){for(var c=0;c<b.length;c++)a.push(b[c].x),
   a.push(b[c].y)}function vb(a,b){K.call(this);this.type="ExtrudeGeometry";this.parameters={shapes:a,options:b};this.fromBufferGeometry(new Ra(a,b));this.mergeVertices()}function Ra(a,b){function c(a){function c(a,b,c){b||console.error("THREE.ExtrudeGeometry: vec does not exist");return b.clone().multiplyScalar(c).add(a)}function g(a,b,c){var d=a.x-b.x;var e=a.y-b.y;var f=c.x-a.x;var g=c.y-a.y,h=d*d+e*e;if(Math.abs(d*g-e*f)>Number.EPSILON){var k=Math.sqrt(h),m=Math.sqrt(f*f+g*g);h=b.x-e/k;b=b.y+d/k;
   g=((c.x-g/m-h)*g-(c.y+f/m-b)*f)/(d*g-e*f);f=h+d*g-a.x;d=b+e*g-a.y;e=f*f+d*d;if(2>=e)return new C(f,d);e=Math.sqrt(e/2)}else a=!1,d>Number.EPSILON?f>Number.EPSILON&&(a=!0):d<-Number.EPSILON?f<-Number.EPSILON&&(a=!0):Math.sign(e)===Math.sign(g)&&(a=!0),a?(f=-e,e=Math.sqrt(h)):(f=d,d=e,e=Math.sqrt(h/2));return new C(f/e,d/e)}function h(a,b){for(N=a.length;0<=--N;){var c=N;var f=N-1;0>f&&(f=a.length-1);var g,h=w+2*J;for(g=0;g<h;g++){var k=W*g,m=W*(g+1),q=b+f+k,n=b+f+m;m=b+c+m;r(b+c+k);r(q);r(m);r(q);
   r(n);r(m);k=e.length/3;k=B.generateSideWallUV(d,e,k-6,k-3,k-2,k-1);v(k[0]);v(k[1]);v(k[3]);v(k[1]);v(k[2]);v(k[3])}}}function k(a,b,c){z.push(a);z.push(b);z.push(c)}function l(a,b,c){r(a);r(b);r(c);a=e.length/3;a=B.generateTopUV(d,e,a-3,a-2,a-1);v(a[0]);v(a[1]);v(a[2])}function r(a){e.push(z[3*a]);e.push(z[3*a+1]);e.push(z[3*a+2])}function v(a){f.push(a.x);f.push(a.y)}var z=[],x=void 0!==b.curveSegments?b.curveSegments:12,w=void 0!==b.steps?b.steps:1,y=void 0!==b.depth?b.depth:100,H=void 0!==b.bevelEnabled?
   b.bevelEnabled:!0,O=void 0!==b.bevelThickness?b.bevelThickness:6,da=void 0!==b.bevelSize?b.bevelSize:O-2,J=void 0!==b.bevelSegments?b.bevelSegments:3,A=b.extrudePath,B=void 0!==b.UVGenerator?b.UVGenerator:Tg;void 0!==b.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),y=b.amount);var E=!1;if(A){var G=A.getSpacedPoints(w);E=!0;H=!1;var V=A.computeFrenetFrames(w,!1);var L=new p;var I=new p;var K=new p}H||(da=O=J=0);var M;x=a.extractPoints(x);a=x.shape;var P=x.holes;
   if(!Ya.isClockWise(a)){a=a.reverse();var F=0;for(M=P.length;F<M;F++){var Q=P[F];Ya.isClockWise(Q)&&(P[F]=Q.reverse())}}var R=Ya.triangulateShape(a,P),T=a;F=0;for(M=P.length;F<M;F++)Q=P[F],a=a.concat(Q);var aa,W=a.length,S,Y=R.length;x=[];var N=0;var U=T.length;var Z=U-1;for(aa=N+1;N<U;N++,Z++,aa++)Z===U&&(Z=0),aa===U&&(aa=0),x[N]=g(T[N],T[Z],T[aa]);A=[];var ca=x.concat();F=0;for(M=P.length;F<M;F++){Q=P[F];var X=[];N=0;U=Q.length;Z=U-1;for(aa=N+1;N<U;N++,Z++,aa++)Z===U&&(Z=0),aa===U&&(aa=0),X[N]=g(Q[N],
   Q[Z],Q[aa]);A.push(X);ca=ca.concat(X)}for(Z=0;Z<J;Z++){U=Z/J;var ea=O*Math.cos(U*Math.PI/2);aa=da*Math.sin(U*Math.PI/2);N=0;for(U=T.length;N<U;N++){var fa=c(T[N],x[N],aa);k(fa.x,fa.y,-ea)}F=0;for(M=P.length;F<M;F++)for(Q=P[F],X=A[F],N=0,U=Q.length;N<U;N++)fa=c(Q[N],X[N],aa),k(fa.x,fa.y,-ea)}aa=da;for(N=0;N<W;N++)fa=H?c(a[N],ca[N],aa):a[N],E?(I.copy(V.normals[0]).multiplyScalar(fa.x),L.copy(V.binormals[0]).multiplyScalar(fa.y),K.copy(G[0]).add(I).add(L),k(K.x,K.y,K.z)):k(fa.x,fa.y,0);for(U=1;U<=w;U++)for(N=
   0;N<W;N++)fa=H?c(a[N],ca[N],aa):a[N],E?(I.copy(V.normals[U]).multiplyScalar(fa.x),L.copy(V.binormals[U]).multiplyScalar(fa.y),K.copy(G[U]).add(I).add(L),k(K.x,K.y,K.z)):k(fa.x,fa.y,y/w*U);for(Z=J-1;0<=Z;Z--){U=Z/J;ea=O*Math.cos(U*Math.PI/2);aa=da*Math.sin(U*Math.PI/2);N=0;for(U=T.length;N<U;N++)fa=c(T[N],x[N],aa),k(fa.x,fa.y,y+ea);F=0;for(M=P.length;F<M;F++)for(Q=P[F],X=A[F],N=0,U=Q.length;N<U;N++)fa=c(Q[N],X[N],aa),E?k(fa.x,fa.y+G[w-1].y,G[w-1].x+ea):k(fa.x,fa.y,y+ea)}(function(){var a=e.length/
   3;if(H){var b=0*W;for(N=0;N<Y;N++)S=R[N],l(S[2]+b,S[1]+b,S[0]+b);b=W*(w+2*J);for(N=0;N<Y;N++)S=R[N],l(S[0]+b,S[1]+b,S[2]+b)}else{for(N=0;N<Y;N++)S=R[N],l(S[2],S[1],S[0]);for(N=0;N<Y;N++)S=R[N],l(S[0]+W*w,S[1]+W*w,S[2]+W*w)}d.addGroup(a,e.length/3-a,0)})();(function(){var a=e.length/3,b=0;h(T,b);b+=T.length;F=0;for(M=P.length;F<M;F++)Q=P[F],h(Q,b),b+=Q.length;d.addGroup(a,e.length/3-a,1)})()}E.call(this);this.type="ExtrudeBufferGeometry";this.parameters={shapes:a,options:b};a=Array.isArray(a)?a:[a];
   for(var d=this,e=[],f=[],g=0,h=a.length;g<h;g++)c(a[g]);this.addAttribute("position",new A(e,3));this.addAttribute("uv",new A(f,2));this.computeVertexNormals()}function ef(a,b,c){c.shapes=[];if(Array.isArray(a))for(var d=0,e=a.length;d<e;d++)c.shapes.push(a[d].uuid);else c.shapes.push(a.uuid);void 0!==b.extrudePath&&(c.options.extrudePath=b.extrudePath.toJSON());return c}function Sc(a,b){K.call(this);this.type="TextGeometry";this.parameters={text:a,parameters:b};this.fromBufferGeometry(new $b(a,b));
   this.mergeVertices()}function $b(a,b){b=b||{};var c=b.font;if(!c||!c.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new K;a=c.generateShapes(a,b);b.depth=void 0!==b.height?b.height:50;void 0===b.bevelThickness&&(b.bevelThickness=10);void 0===b.bevelSize&&(b.bevelSize=8);void 0===b.bevelEnabled&&(b.bevelEnabled=!1);Ra.call(this,a,b);this.type="TextBufferGeometry"}function Tc(a,b,c,d,e,f,g){K.call(this);this.type="SphereGeometry";this.parameters=
   {radius:a,widthSegments:b,heightSegments:c,phiStart:d,phiLength:e,thetaStart:f,thetaLength:g};this.fromBufferGeometry(new wb(a,b,c,d,e,f,g));this.mergeVertices()}function wb(a,b,c,d,e,f,g){E.call(this);this.type="SphereBufferGeometry";this.parameters={radius:a,widthSegments:b,heightSegments:c,phiStart:d,phiLength:e,thetaStart:f,thetaLength:g};a=a||1;b=Math.max(3,Math.floor(b)||8);c=Math.max(2,Math.floor(c)||6);d=void 0!==d?d:0;e=void 0!==e?e:2*Math.PI;f=void 0!==f?f:0;g=void 0!==g?g:Math.PI;var h=
   f+g,k,m,q=0,n=[],l=new p,t=new p,r=[],v=[],z=[],x=[];for(m=0;m<=c;m++){var w=[],y=m/c;for(k=0;k<=b;k++){var H=k/b;l.x=-a*Math.cos(d+H*e)*Math.sin(f+y*g);l.y=a*Math.cos(f+y*g);l.z=a*Math.sin(d+H*e)*Math.sin(f+y*g);v.push(l.x,l.y,l.z);t.set(l.x,l.y,l.z).normalize();z.push(t.x,t.y,t.z);x.push(H,1-y);w.push(q++)}n.push(w)}for(m=0;m<c;m++)for(k=0;k<b;k++)a=n[m][k+1],d=n[m][k],e=n[m+1][k],g=n[m+1][k+1],(0!==m||0<f)&&r.push(a,d,g),(m!==c-1||h<Math.PI)&&r.push(d,e,g);this.setIndex(r);this.addAttribute("position",
   new A(v,3));this.addAttribute("normal",new A(z,3));this.addAttribute("uv",new A(x,2))}function Uc(a,b,c,d,e,f){K.call(this);this.type="RingGeometry";this.parameters={innerRadius:a,outerRadius:b,thetaSegments:c,phiSegments:d,thetaStart:e,thetaLength:f};this.fromBufferGeometry(new ac(a,b,c,d,e,f));this.mergeVertices()}function ac(a,b,c,d,e,f){E.call(this);this.type="RingBufferGeometry";this.parameters={innerRadius:a,outerRadius:b,thetaSegments:c,phiSegments:d,thetaStart:e,thetaLength:f};a=a||.5;b=b||
   1;e=void 0!==e?e:0;f=void 0!==f?f:2*Math.PI;c=void 0!==c?Math.max(3,c):8;d=void 0!==d?Math.max(1,d):1;var g=[],h=[],k=[],m=[],q=a,n=(b-a)/d,l=new p,t=new C,r,v;for(r=0;r<=d;r++){for(v=0;v<=c;v++)a=e+v/c*f,l.x=q*Math.cos(a),l.y=q*Math.sin(a),h.push(l.x,l.y,l.z),k.push(0,0,1),t.x=(l.x/b+1)/2,t.y=(l.y/b+1)/2,m.push(t.x,t.y);q+=n}for(r=0;r<d;r++)for(b=r*(c+1),v=0;v<c;v++)a=v+b,e=a+c+1,f=a+c+2,q=a+1,g.push(a,e,q),g.push(e,f,q);this.setIndex(g);this.addAttribute("position",new A(h,3));this.addAttribute("normal",
   new A(k,3));this.addAttribute("uv",new A(m,2))}function Vc(a,b,c,d){K.call(this);this.type="LatheGeometry";this.parameters={points:a,segments:b,phiStart:c,phiLength:d};this.fromBufferGeometry(new bc(a,b,c,d));this.mergeVertices()}function bc(a,b,c,d){E.call(this);this.type="LatheBufferGeometry";this.parameters={points:a,segments:b,phiStart:c,phiLength:d};b=Math.floor(b)||12;c=c||0;d=d||2*Math.PI;d=Q.clamp(d,0,2*Math.PI);var e=[],f=[],g=[],h=1/b,k=new p,m=new C,q;for(q=0;q<=b;q++){var n=c+q*h*d;var l=
   Math.sin(n),t=Math.cos(n);for(n=0;n<=a.length-1;n++)k.x=a[n].x*l,k.y=a[n].y,k.z=a[n].x*t,f.push(k.x,k.y,k.z),m.x=q/b,m.y=n/(a.length-1),g.push(m.x,m.y)}for(q=0;q<b;q++)for(n=0;n<a.length-1;n++)c=n+q*a.length,h=c+a.length,k=c+a.length+1,m=c+1,e.push(c,h,m),e.push(h,k,m);this.setIndex(e);this.addAttribute("position",new A(f,3));this.addAttribute("uv",new A(g,2));this.computeVertexNormals();if(d===2*Math.PI)for(d=this.attributes.normal.array,e=new p,f=new p,g=new p,c=b*a.length*3,n=q=0;q<a.length;q++,
   n+=3)e.x=d[n+0],e.y=d[n+1],e.z=d[n+2],f.x=d[c+n+0],f.y=d[c+n+1],f.z=d[c+n+2],g.addVectors(e,f).normalize(),d[n+0]=d[c+n+0]=g.x,d[n+1]=d[c+n+1]=g.y,d[n+2]=d[c+n+2]=g.z}function xb(a,b){K.call(this);this.type="ShapeGeometry";"object"===typeof b&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),b=b.curveSegments);this.parameters={shapes:a,curveSegments:b};this.fromBufferGeometry(new yb(a,b));this.mergeVertices()}function yb(a,b){function c(a){var c,h=e.length/3;a=a.extractPoints(b);
   var m=a.shape,q=a.holes;if(!1===Ya.isClockWise(m))for(m=m.reverse(),a=0,c=q.length;a<c;a++){var l=q[a];!0===Ya.isClockWise(l)&&(q[a]=l.reverse())}var p=Ya.triangulateShape(m,q);a=0;for(c=q.length;a<c;a++)l=q[a],m=m.concat(l);a=0;for(c=m.length;a<c;a++)l=m[a],e.push(l.x,l.y,0),f.push(0,0,1),g.push(l.x,l.y);a=0;for(c=p.length;a<c;a++)m=p[a],d.push(m[0]+h,m[1]+h,m[2]+h),k+=3}E.call(this);this.type="ShapeBufferGeometry";this.parameters={shapes:a,curveSegments:b};b=b||12;var d=[],e=[],f=[],g=[],h=0,k=
   0;if(!1===Array.isArray(a))c(a);else for(var m=0;m<a.length;m++)c(a[m]),this.addGroup(h,k,m),h+=k,k=0;this.setIndex(d);this.addAttribute("position",new A(e,3));this.addAttribute("normal",new A(f,3));this.addAttribute("uv",new A(g,2))}function ff(a,b){b.shapes=[];if(Array.isArray(a))for(var c=0,d=a.length;c<d;c++)b.shapes.push(a[c].uuid);else b.shapes.push(a.uuid);return b}function cc(a,b){E.call(this);this.type="EdgesGeometry";this.parameters={thresholdAngle:b};var c=[];b=Math.cos(Q.DEG2RAD*(void 0!==
   b?b:1));var d=[0,0],e={},f=["a","b","c"];if(a.isBufferGeometry){var g=new K;g.fromBufferGeometry(a)}else g=a.clone();g.mergeVertices();g.computeFaceNormals();a=g.vertices;g=g.faces;for(var h=0,k=g.length;h<k;h++)for(var m=g[h],q=0;3>q;q++){var n=m[f[q]];var l=m[f[(q+1)%3]];d[0]=Math.min(n,l);d[1]=Math.max(n,l);n=d[0]+","+d[1];void 0===e[n]?e[n]={index1:d[0],index2:d[1],face1:h,face2:void 0}:e[n].face2=h}for(n in e)if(d=e[n],void 0===d.face2||g[d.face1].normal.dot(g[d.face2].normal)<=b)f=a[d.index1],
   c.push(f.x,f.y,f.z),f=a[d.index2],c.push(f.x,f.y,f.z);this.addAttribute("position",new A(c,3))}function zb(a,b,c,d,e,f,g,h){K.call(this);this.type="CylinderGeometry";this.parameters={radiusTop:a,radiusBottom:b,height:c,radialSegments:d,heightSegments:e,openEnded:f,thetaStart:g,thetaLength:h};this.fromBufferGeometry(new Za(a,b,c,d,e,f,g,h));this.mergeVertices()}function Za(a,b,c,d,e,f,g,h){function k(c){var e,f=new C,k=new p,u=0,v=!0===c?a:b,w=!0===c?1:-1;var A=r;for(e=1;e<=d;e++)n.push(0,z*w,0),l.push(0,
   w,0),t.push(.5,.5),r++;var B=r;for(e=0;e<=d;e++){var E=e/d*h+g,V=Math.cos(E);E=Math.sin(E);k.x=v*E;k.y=z*w;k.z=v*V;n.push(k.x,k.y,k.z);l.push(0,w,0);f.x=.5*V+.5;f.y=.5*E*w+.5;t.push(f.x,f.y);r++}for(e=0;e<d;e++)f=A+e,k=B+e,!0===c?q.push(k,k+1,f):q.push(k+1,k,f),u+=3;m.addGroup(x,u,!0===c?1:2);x+=u}E.call(this);this.type="CylinderBufferGeometry";this.parameters={radiusTop:a,radiusBottom:b,height:c,radialSegments:d,heightSegments:e,openEnded:f,thetaStart:g,thetaLength:h};var m=this;a=void 0!==a?a:1;
   b=void 0!==b?b:1;c=c||1;d=Math.floor(d)||8;e=Math.floor(e)||1;f=void 0!==f?f:!1;g=void 0!==g?g:0;h=void 0!==h?h:2*Math.PI;var q=[],n=[],l=[],t=[],r=0,v=[],z=c/2,x=0;(function(){var f,k,u=new p,O=new p,da=0,J=(b-a)/c;for(k=0;k<=e;k++){var A=[],C=k/e,E=C*(b-a)+a;for(f=0;f<=d;f++){var B=f/d,V=B*h+g,F=Math.sin(V);V=Math.cos(V);O.x=E*F;O.y=-C*c+z;O.z=E*V;n.push(O.x,O.y,O.z);u.set(F,J,V).normalize();l.push(u.x,u.y,u.z);t.push(B,1-C);A.push(r++)}v.push(A)}for(f=0;f<d;f++)for(k=0;k<e;k++)u=v[k+1][f],O=v[k+
   1][f+1],J=v[k][f+1],q.push(v[k][f],u,J),q.push(u,O,J),da+=6;m.addGroup(x,da,0);x+=da})();!1===f&&(0<a&&k(!0),0<b&&k(!1));this.setIndex(q);this.addAttribute("position",new A(n,3));this.addAttribute("normal",new A(l,3));this.addAttribute("uv",new A(t,2))}function Wc(a,b,c,d,e,f,g){zb.call(this,0,a,b,c,d,e,f,g);this.type="ConeGeometry";this.parameters={radius:a,height:b,radialSegments:c,heightSegments:d,openEnded:e,thetaStart:f,thetaLength:g}}function Xc(a,b,c,d,e,f,g){Za.call(this,0,a,b,c,d,e,f,g);
   this.type="ConeBufferGeometry";this.parameters={radius:a,height:b,radialSegments:c,heightSegments:d,openEnded:e,thetaStart:f,thetaLength:g}}function Yc(a,b,c,d){K.call(this);this.type="CircleGeometry";this.parameters={radius:a,segments:b,thetaStart:c,thetaLength:d};this.fromBufferGeometry(new dc(a,b,c,d));this.mergeVertices()}function dc(a,b,c,d){E.call(this);this.type="CircleBufferGeometry";this.parameters={radius:a,segments:b,thetaStart:c,thetaLength:d};a=a||1;b=void 0!==b?Math.max(3,b):8;c=void 0!==
   c?c:0;d=void 0!==d?d:2*Math.PI;var e=[],f=[],g=[],h=[],k,m=new p,q=new C;f.push(0,0,0);g.push(0,0,1);h.push(.5,.5);var n=0;for(k=3;n<=b;n++,k+=3){var l=c+n/b*d;m.x=a*Math.cos(l);m.y=a*Math.sin(l);f.push(m.x,m.y,m.z);g.push(0,0,1);q.x=(f[k]/a+1)/2;q.y=(f[k+1]/a+1)/2;h.push(q.x,q.y)}for(k=1;k<=b;k++)e.push(k,k+1,0);this.setIndex(e);this.addAttribute("position",new A(f,3));this.addAttribute("normal",new A(g,3));this.addAttribute("uv",new A(h,2))}function Ab(a){F.call(this);this.type="ShadowMaterial";
   this.color=new G(0);this.transparent=!0;this.setValues(a)}function ec(a){Da.call(this,a);this.type="RawShaderMaterial"}function Sa(a){F.call(this);this.defines={STANDARD:""};this.type="MeshStandardMaterial";this.color=new G(16777215);this.metalness=this.roughness=.5;this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new G(0);this.emissiveIntensity=1;this.bumpMap=this.emissiveMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=0;this.normalScale=
   new C(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.envMap=this.alphaMap=this.metalnessMap=this.roughnessMap=null;this.envMapIntensity=1;this.refractionRatio=.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)}function Bb(a){Sa.call(this);this.defines={PHYSICAL:""};this.type="MeshPhysicalMaterial";this.reflectivity=.5;this.clearCoatRoughness=
   this.clearCoat=0;this.setValues(a)}function Ia(a){F.call(this);this.type="MeshPhongMaterial";this.color=new G(16777215);this.specular=new G(1118481);this.shininess=30;this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new G(0);this.emissiveIntensity=1;this.bumpMap=this.emissiveMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=0;this.normalScale=new C(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;
   this.envMap=this.alphaMap=this.specularMap=null;this.combine=0;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)}function Cb(a){Ia.call(this);this.defines={TOON:""};this.type="MeshToonMaterial";this.gradientMap=null;this.setValues(a)}function Db(a){F.call(this);this.type="MeshNormalMaterial";this.bumpMap=null;this.bumpScale=1;this.normalMap=
   null;this.normalMapType=0;this.normalScale=new C(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.wireframe=!1;this.wireframeLinewidth=1;this.morphNormals=this.morphTargets=this.skinning=this.lights=this.fog=!1;this.setValues(a);this.attributes=["position","normal"]}function Eb(a){F.call(this);this.type="MeshLambertMaterial";this.color=new G(16777215);this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new G(0);
   this.emissiveIntensity=1;this.envMap=this.alphaMap=this.specularMap=this.emissiveMap=null;this.combine=0;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)}function Fb(a){T.call(this);this.type="LineDashedMaterial";this.scale=1;this.dashSize=3;this.gapSize=1;this.setValues(a)}function Ja(a){this.manager=void 0!==a?a:sa}function gf(a){this.manager=
   void 0!==a?a:sa;this._parser=null}function $d(a){this.manager=void 0!==a?a:sa;this._parser=null}function td(a){this.manager=void 0!==a?a:sa}function L(){this.type="Curve";this.arcLengthDivisions=200}function ka(a,b,c,d,e,f,g,h){L.call(this);this.type="EllipseCurve";this.aX=a||0;this.aY=b||0;this.xRadius=c||1;this.yRadius=d||1;this.aStartAngle=e||0;this.aEndAngle=f||2*Math.PI;this.aClockwise=g||!1;this.aRotation=h||0}function fc(a,b,c,d,e,f){ka.call(this,a,b,c,c,d,e,f);this.type="ArcCurve"}function ae(){var a=
   0,b=0,c=0,d=0;return{initCatmullRom:function(e,f,g,h,k){e=k*(g-e);h=k*(h-f);a=f;b=e;c=-3*f+3*g-2*e-h;d=2*f-2*g+e+h},initNonuniformCatmullRom:function(e,f,g,h,k,m,q){e=((f-e)/k-(g-e)/(k+m)+(g-f)/m)*m;h=((g-f)/m-(h-f)/(m+q)+(h-g)/q)*m;a=f;b=e;c=-3*f+3*g-2*e-h;d=2*f-2*g+e+h},calc:function(e){var f=e*e;return a+b*e+c*f+d*f*e}}}function wa(a,b,c,d){L.call(this);this.type="CatmullRomCurve3";this.points=a||[];this.closed=b||!1;this.curveType=c||"centripetal";this.tension=d||.5}function hf(a,b,c,d,e){b=.5*
   (d-b);e=.5*(e-c);var f=a*a;return(2*c-2*d+b+e)*a*f+(-3*c+3*d-2*b-e)*f+b*a+c}function Zc(a,b,c,d){var e=1-a;return e*e*b+2*(1-a)*a*c+a*a*d}function $c(a,b,c,d,e){var f=1-a,g=1-a;return f*f*f*b+3*g*g*a*c+3*(1-a)*a*a*d+a*a*a*e}function Ka(a,b,c,d){L.call(this);this.type="CubicBezierCurve";this.v0=a||new C;this.v1=b||new C;this.v2=c||new C;this.v3=d||new C}function Ta(a,b,c,d){L.call(this);this.type="CubicBezierCurve3";this.v0=a||new p;this.v1=b||new p;this.v2=c||new p;this.v3=d||new p}function na(a,
   b){L.call(this);this.type="LineCurve";this.v1=a||new C;this.v2=b||new C}function La(a,b){L.call(this);this.type="LineCurve3";this.v1=a||new p;this.v2=b||new p}function Ma(a,b,c){L.call(this);this.type="QuadraticBezierCurve";this.v0=a||new C;this.v1=b||new C;this.v2=c||new C}function Ua(a,b,c){L.call(this);this.type="QuadraticBezierCurve3";this.v0=a||new p;this.v1=b||new p;this.v2=c||new p}function Na(a){L.call(this);this.type="SplineCurve";this.points=a||[]}function $a(){L.call(this);this.type="CurvePath";
   this.curves=[];this.autoClose=!1}function Oa(a){$a.call(this);this.type="Path";this.currentPoint=new C;a&&this.setFromPoints(a)}function hb(a){Oa.call(this,a);this.uuid=Q.generateUUID();this.type="Shape";this.holes=[]}function X(a,b){B.call(this);this.type="Light";this.color=new G(a);this.intensity=void 0!==b?b:1;this.receiveShadow=void 0}function ud(a,b,c){X.call(this,a,c);this.type="HemisphereLight";this.castShadow=void 0;this.position.copy(B.DefaultUp);this.updateMatrix();this.groundColor=new G(b)}
   function Gb(a){this.camera=a;this.bias=0;this.radius=1;this.mapSize=new C(512,512);this.map=null;this.matrix=new M}function vd(){Gb.call(this,new ea(50,1,.5,500))}function wd(a,b,c,d,e,f){X.call(this,a,b);this.type="SpotLight";this.position.copy(B.DefaultUp);this.updateMatrix();this.target=new B;Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(a){this.intensity=a/Math.PI}});this.distance=void 0!==c?c:0;this.angle=void 0!==d?d:Math.PI/3;this.penumbra=void 0!==
   e?e:0;this.decay=void 0!==f?f:1;this.shadow=new vd}function xd(a,b,c,d){X.call(this,a,b);this.type="PointLight";Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(a){this.intensity=a/(4*Math.PI)}});this.distance=void 0!==c?c:0;this.decay=void 0!==d?d:1;this.shadow=new Gb(new ea(90,1,.5,500))}function yd(){Gb.call(this,new Jb(-5,5,5,-5,.5,500))}function zd(a,b){X.call(this,a,b);this.type="DirectionalLight";this.position.copy(B.DefaultUp);this.updateMatrix();
   this.target=new B;this.shadow=new yd}function Ad(a,b){X.call(this,a,b);this.type="AmbientLight";this.castShadow=void 0}function Bd(a,b,c,d){X.call(this,a,b);this.type="RectAreaLight";this.width=void 0!==c?c:10;this.height=void 0!==d?d:10}function oa(a,b,c,d){this.parameterPositions=a;this._cachedIndex=0;this.resultBuffer=void 0!==d?d:new b.constructor(c);this.sampleValues=b;this.valueSize=c}function Cd(a,b,c,d){oa.call(this,a,b,c,d);this._offsetNext=this._weightNext=this._offsetPrev=this._weightPrev=
   -0}function ad(a,b,c,d){oa.call(this,a,b,c,d)}function Dd(a,b,c,d){oa.call(this,a,b,c,d)}function qa(a,b,c,d){if(void 0===a)throw Error("THREE.KeyframeTrack: track name is undefined");if(void 0===b||0===b.length)throw Error("THREE.KeyframeTrack: no keyframes in track named "+a);this.name=a;this.times=ha.convertArray(b,this.TimeBufferType);this.values=ha.convertArray(c,this.ValueBufferType);this.setInterpolation(d||this.DefaultInterpolation)}function Ed(a,b,c){qa.call(this,a,b,c)}function Fd(a,b,c,
   d){qa.call(this,a,b,c,d)}function gc(a,b,c,d){qa.call(this,a,b,c,d)}function Gd(a,b,c,d){oa.call(this,a,b,c,d)}function bd(a,b,c,d){qa.call(this,a,b,c,d)}function Hd(a,b,c,d){qa.call(this,a,b,c,d)}function hc(a,b,c,d){qa.call(this,a,b,c,d)}function Ca(a,b,c){this.name=a;this.tracks=c;this.duration=void 0!==b?b:-1;this.uuid=Q.generateUUID();0>this.duration&&this.resetDuration()}function Ug(a){switch(a.toLowerCase()){case "scalar":case "double":case "float":case "number":case "integer":return gc;case "vector":case "vector2":case "vector3":case "vector4":return hc;
   case "color":return Fd;case "quaternion":return bd;case "bool":case "boolean":return Ed;case "string":return Hd}throw Error("THREE.KeyframeTrack: Unsupported typeName: "+a);}function Vg(a){if(void 0===a.type)throw Error("THREE.KeyframeTrack: track type undefined, can not parse");var b=Ug(a.type);if(void 0===a.times){var c=[],d=[];ha.flattenJSON(a.keys,c,d,"value");a.times=c;a.values=d}return void 0!==b.parse?b.parse(a):new b(a.name,a.times,a.values,a.interpolation)}function Id(a){this.manager=void 0!==
   a?a:sa;this.textures={}}function be(a){this.manager=void 0!==a?a:sa}function ic(){}function ce(a){"boolean"===typeof a&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),a=void 0);this.manager=void 0!==a?a:sa;this.withCredentials=!1}function jf(a){this.manager=void 0!==a?a:sa;this.texturePath=""}function de(a){"undefined"===typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported.");"undefined"===typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported.");
   this.manager=void 0!==a?a:sa;this.options=void 0}function ee(){this.type="ShapePath";this.color=new G;this.subPaths=[];this.currentPath=null}function fe(a){this.type="Font";this.data=a}function kf(a){this.manager=void 0!==a?a:sa}function ge(a){this.manager=void 0!==a?a:sa}function lf(){this.type="StereoCamera";this.aspect=1;this.eyeSep=.064;this.cameraL=new ea;this.cameraL.layers.enable(1);this.cameraL.matrixAutoUpdate=!1;this.cameraR=new ea;this.cameraR.layers.enable(2);this.cameraR.matrixAutoUpdate=
   !1}function cd(a,b,c){B.call(this);this.type="CubeCamera";var d=new ea(90,1,a,b);d.up.set(0,-1,0);d.lookAt(new p(1,0,0));this.add(d);var e=new ea(90,1,a,b);e.up.set(0,-1,0);e.lookAt(new p(-1,0,0));this.add(e);var f=new ea(90,1,a,b);f.up.set(0,0,1);f.lookAt(new p(0,1,0));this.add(f);var g=new ea(90,1,a,b);g.up.set(0,0,-1);g.lookAt(new p(0,-1,0));this.add(g);var h=new ea(90,1,a,b);h.up.set(0,-1,0);h.lookAt(new p(0,0,1));this.add(h);var k=new ea(90,1,a,b);k.up.set(0,-1,0);k.lookAt(new p(0,0,-1));this.add(k);
   this.renderTarget=new mf(c,c,{format:1022,magFilter:1006,minFilter:1006});this.renderTarget.texture.name="CubeCamera";this.update=function(a,b){null===this.parent&&this.updateMatrixWorld();var c=this.renderTarget,m=c.texture.generateMipmaps;c.texture.generateMipmaps=!1;c.activeCubeFace=0;a.render(b,d,c);c.activeCubeFace=1;a.render(b,e,c);c.activeCubeFace=2;a.render(b,f,c);c.activeCubeFace=3;a.render(b,g,c);c.activeCubeFace=4;a.render(b,h,c);c.texture.generateMipmaps=m;c.activeCubeFace=5;a.render(b,
   k,c);a.setRenderTarget(null)};this.clear=function(a,b,c,d){for(var e=this.renderTarget,f=0;6>f;f++)e.activeCubeFace=f,a.setRenderTarget(e),a.clear(b,c,d);a.setRenderTarget(null)}}function he(){B.call(this);this.type="AudioListener";this.context=ie.getContext();this.gain=this.context.createGain();this.gain.connect(this.context.destination);this.filter=null}function jc(a){B.call(this);this.type="Audio";this.context=a.context;this.gain=this.context.createGain();this.gain.connect(a.getInput());this.autoplay=
   !1;this.buffer=null;this.loop=!1;this.offset=this.startTime=0;this.playbackRate=1;this.isPlaying=!1;this.hasPlaybackControl=!0;this.sourceType="empty";this.filters=[]}function je(a){jc.call(this,a);this.panner=this.context.createPanner();this.panner.connect(this.gain)}function ke(a,b){this.analyser=a.context.createAnalyser();this.analyser.fftSize=void 0!==b?b:2048;this.data=new Uint8Array(this.analyser.frequencyBinCount);a.getOutput().connect(this.analyser)}function le(a,b,c){this.binding=a;this.valueSize=
   c;a=Float64Array;switch(b){case "quaternion":b=this._slerp;break;case "string":case "bool":a=Array;b=this._select;break;default:b=this._lerp}this.buffer=new a(4*c);this._mixBufferRegion=b;this.referenceCount=this.useCount=this.cumulativeWeight=0}function nf(a,b,c){c=c||Y.parseTrackName(b);this._targetGroup=a;this._bindings=a.subscribe_(b,c)}function Y(a,b,c){this.path=b;this.parsedPath=c||Y.parseTrackName(b);this.node=Y.findNode(a,this.parsedPath.nodeName)||a;this.rootNode=a}function of(){this.uuid=
   Q.generateUUID();this._objects=Array.prototype.slice.call(arguments);this.nCachedObjects_=0;var a={};this._indicesByUUID=a;for(var b=0,c=arguments.length;b!==c;++b)a[arguments[b].uuid]=b;this._paths=[];this._parsedPaths=[];this._bindings=[];this._bindingsIndicesByPath={};var d=this;this.stats={objects:{get total(){return d._objects.length},get inUse(){return this.total-d.nCachedObjects_}},get bindingsPerObject(){return d._bindings.length}}}function pf(a,b,c){this._mixer=a;this._clip=b;this._localRoot=
   c||null;a=b.tracks;b=a.length;c=Array(b);for(var d={endingStart:2400,endingEnd:2400},e=0;e!==b;++e){var f=a[e].createInterpolant(null);c[e]=f;f.settings=d}this._interpolantSettings=d;this._interpolants=c;this._propertyBindings=Array(b);this._weightInterpolant=this._timeScaleInterpolant=this._byClipCacheIndex=this._cacheIndex=null;this.loop=2201;this._loopCount=-1;this._startTime=null;this.time=0;this._effectiveWeight=this.weight=this._effectiveTimeScale=this.timeScale=1;this.repetitions=Infinity;
   this.paused=!1;this.enabled=!0;this.clampWhenFinished=!1;this.zeroSlopeAtEnd=this.zeroSlopeAtStart=!0}function me(a){this._root=a;this._initMemoryManager();this.time=this._accuIndex=0;this.timeScale=1}function Jd(a,b){"string"===typeof a&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),a=b);this.value=a}function ne(){E.call(this);this.type="InstancedBufferGeometry";this.maxInstancedCount=void 0}function oe(a,b,c){sb.call(this,a,b);this.meshPerAttribute=c||1}function pe(a,b,c){P.call(this,
   a,b);this.meshPerAttribute=c||1}function qf(a,b,c,d){this.ray=new qb(a,b);this.near=c||0;this.far=d||Infinity;this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}};Object.defineProperties(this.params,{PointCloud:{get:function(){console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points.");return this.Points}}})}function rf(a,b){return a.distance-b.distance}function qe(a,b,c,d){if(!1!==a.visible&&(a.raycast(b,c),!0===d)){a=a.children;d=0;for(var e=a.length;d<e;d++)qe(a[d],
   b,c,!0)}}function sf(a){this.autoStart=void 0!==a?a:!0;this.elapsedTime=this.oldTime=this.startTime=0;this.running=!1}function tf(a,b,c){this.radius=void 0!==a?a:1;this.phi=void 0!==b?b:0;this.theta=void 0!==c?c:0;return this}function uf(a,b,c){this.radius=void 0!==a?a:1;this.theta=void 0!==b?b:0;this.y=void 0!==c?c:0;return this}function re(a,b){this.min=void 0!==a?a:new C(Infinity,Infinity);this.max=void 0!==b?b:new C(-Infinity,-Infinity)}function se(a,b){this.start=void 0!==a?a:new p;this.end=
   void 0!==b?b:new p}function dd(a){B.call(this);this.material=a;this.render=function(){}}function ed(a,b,c,d){this.object=a;this.size=void 0!==b?b:1;a=void 0!==c?c:16711680;d=void 0!==d?d:1;b=0;(c=this.object.geometry)&&c.isGeometry?b=3*c.faces.length:c&&c.isBufferGeometry&&(b=c.attributes.normal.count);c=new E;b=new A(6*b,3);c.addAttribute("position",b);W.call(this,c,new T({color:a,linewidth:d}));this.matrixAutoUpdate=!1;this.update()}function kc(a,b){B.call(this);this.light=a;this.light.updateMatrixWorld();
   this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.color=b;a=new E;b=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(var c=0,d=1;32>c;c++,d++){var e=c/32*Math.PI*2,f=d/32*Math.PI*2;b.push(Math.cos(e),Math.sin(e),1,Math.cos(f),Math.sin(f),1)}a.addAttribute("position",new A(b,3));b=new T({fog:!1});this.cone=new W(a,b);this.add(this.cone);this.update()}function vf(a){var b=[];a&&a.isBone&&b.push(a);for(var c=0;c<a.children.length;c++)b.push.apply(b,vf(a.children[c]));return b}
   function lc(a){for(var b=vf(a),c=new E,d=[],e=[],f=new G(0,0,1),g=new G(0,1,0),h=0;h<b.length;h++){var k=b[h];k.parent&&k.parent.isBone&&(d.push(0,0,0),d.push(0,0,0),e.push(f.r,f.g,f.b),e.push(g.r,g.g,g.b))}c.addAttribute("position",new A(d,3));c.addAttribute("color",new A(e,3));d=new T({vertexColors:2,depthTest:!1,depthWrite:!1,transparent:!0});W.call(this,c,d);this.root=a;this.bones=b;this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1}function mc(a,b,c){this.light=a;this.light.updateMatrixWorld();
   this.color=c;a=new wb(b,4,2);b=new Aa({wireframe:!0,fog:!1});ra.call(this,a,b);this.matrix=this.light.matrixWorld;this.matrixAutoUpdate=!1;this.update()}function nc(a,b){B.call(this);this.light=a;this.light.updateMatrixWorld();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.color=b;a=new T({fog:!1});b=new E;b.addAttribute("position",new P(new Float32Array(15),3));this.line=new ma(b,a);this.add(this.line);this.update()}function oc(a,b,c){B.call(this);this.light=a;this.light.updateMatrixWorld();
   this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.color=c;a=new tb(b);a.rotateY(.5*Math.PI);this.material=new Aa({wireframe:!0,fog:!1});void 0===this.color&&(this.material.vertexColors=2);b=a.getAttribute("position");b=new Float32Array(3*b.count);a.addAttribute("color",new P(b,3));this.add(new ra(a,this.material));this.update()}function fd(a,b,c,d){a=a||10;b=b||10;c=new G(void 0!==c?c:4473924);d=new G(void 0!==d?d:8947848);var e=b/2,f=a/b,g=a/2;a=[];for(var h=[],k=0,m=0,q=-g;k<=b;k++,q+=f){a.push(-g,
   0,q,g,0,q);a.push(q,0,-g,q,0,g);var n=k===e?c:d;n.toArray(h,m);m+=3;n.toArray(h,m);m+=3;n.toArray(h,m);m+=3;n.toArray(h,m);m+=3}b=new E;b.addAttribute("position",new A(a,3));b.addAttribute("color",new A(h,3));c=new T({vertexColors:2});W.call(this,b,c)}function Kd(a,b,c,d,e,f){a=a||10;b=b||16;c=c||8;d=d||64;e=new G(void 0!==e?e:4473924);f=new G(void 0!==f?f:8947848);var g=[],h=[],k;for(k=0;k<=b;k++){var m=k/b*2*Math.PI;var q=Math.sin(m)*a;m=Math.cos(m)*a;g.push(0,0,0);g.push(q,0,m);var n=k&1?e:f;h.push(n.r,
   n.g,n.b);h.push(n.r,n.g,n.b)}for(k=0;k<=c;k++){n=k&1?e:f;var l=a-a/c*k;for(b=0;b<d;b++)m=b/d*2*Math.PI,q=Math.sin(m)*l,m=Math.cos(m)*l,g.push(q,0,m),h.push(n.r,n.g,n.b),m=(b+1)/d*2*Math.PI,q=Math.sin(m)*l,m=Math.cos(m)*l,g.push(q,0,m),h.push(n.r,n.g,n.b)}a=new E;a.addAttribute("position",new A(g,3));a.addAttribute("color",new A(h,3));g=new T({vertexColors:2});W.call(this,a,g)}function gd(a,b,c,d){this.object=a;this.size=void 0!==b?b:1;a=void 0!==c?c:16776960;d=void 0!==d?d:1;b=0;(c=this.object.geometry)&&
   c.isGeometry?b=c.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");c=new E;b=new A(6*b,3);c.addAttribute("position",b);W.call(this,c,new T({color:a,linewidth:d}));this.matrixAutoUpdate=!1;this.update()}function pc(a,b,c){B.call(this);this.light=a;this.light.updateMatrixWorld();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.color=c;void 0===b&&(b=1);a=new E;a.addAttribute("position",new A([-b,b,0,b,b,0,b,-b,0,-b,
   -b,0,-b,b,0],3));b=new T({fog:!1});this.lightPlane=new ma(a,b);this.add(this.lightPlane);a=new E;a.addAttribute("position",new A([0,0,0,0,0,1],3));this.targetLine=new ma(a,b);this.add(this.targetLine);this.update()}function hd(a){function b(a,b,d){c(a,d);c(b,d)}function c(a,b){f.push(0,0,0);g.push(b.r,b.g,b.b);void 0===h[a]&&(h[a]=[]);h[a].push(f.length/3-1)}var d=new E,e=new T({color:16777215,vertexColors:1}),f=[],g=[],h={},k=new G(16755200),m=new G(16711680),q=new G(43775),n=new G(16777215),l=new G(3355443);
   b("n1","n2",k);b("n2","n4",k);b("n4","n3",k);b("n3","n1",k);b("f1","f2",k);b("f2","f4",k);b("f4","f3",k);b("f3","f1",k);b("n1","f1",k);b("n2","f2",k);b("n3","f3",k);b("n4","f4",k);b("p","n1",m);b("p","n2",m);b("p","n3",m);b("p","n4",m);b("u1","u2",q);b("u2","u3",q);b("u3","u1",q);b("c","t",n);b("p","c",l);b("cn1","cn2",l);b("cn3","cn4",l);b("cf1","cf2",l);b("cf3","cf4",l);d.addAttribute("position",new A(f,3));d.addAttribute("color",new A(g,3));W.call(this,d,e);this.camera=a;this.camera.updateProjectionMatrix&&
   this.camera.updateProjectionMatrix();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.pointMap=h;this.update()}function Hb(a,b){this.object=a;void 0===b&&(b=16776960);a=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var c=new Float32Array(24),d=new E;d.setIndex(new P(a,1));d.addAttribute("position",new P(c,3));W.call(this,d,new T({color:b}));this.matrixAutoUpdate=!1;this.update()}function id(a,b){this.type="Box3Helper";this.box=a;a=void 0!==b?b:16776960;b=new Uint16Array([0,
   1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var c=new E;c.setIndex(new P(b,1));c.addAttribute("position",new A([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3));W.call(this,c,new T({color:a}));this.geometry.computeBoundingSphere()}function jd(a,b,c){this.type="PlaneHelper";this.plane=a;this.size=void 0===b?1:b;a=void 0!==c?c:16776960;b=new E;b.addAttribute("position",new A([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3));b.computeBoundingSphere();ma.call(this,
   b,new T({color:a}));b=new E;b.addAttribute("position",new A([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3));b.computeBoundingSphere();this.add(new ra(b,new Aa({color:a,opacity:.2,transparent:!0,depthWrite:!1})))}function Ib(a,b,c,d,e,f){B.call(this);void 0===d&&(d=16776960);void 0===c&&(c=1);void 0===e&&(e=.2*c);void 0===f&&(f=.2*e);void 0===Ld&&(Ld=new E,Ld.addAttribute("position",new A([0,0,0,0,1,0],3)),te=new Za(0,.5,1,5,1),te.translate(0,-.5,0));this.position.copy(b);this.line=new ma(Ld,new T({color:d}));
   this.line.matrixAutoUpdate=!1;this.add(this.line);this.cone=new ra(te,new Aa({color:d}));this.cone.matrixAutoUpdate=!1;this.add(this.cone);this.setDirection(a);this.setLength(c,e,f)}function kd(a){a=a||1;var b=[0,0,0,a,0,0,0,0,0,0,a,0,0,0,0,0,0,a];a=new E;a.addAttribute("position",new A(b,3));a.addAttribute("color",new A([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));b=new T({vertexColors:2});W.call(this,a,b)}function wf(a){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead.");
   wa.call(this,a);this.type="catmullrom";this.closed=!0}function xf(a){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead.");wa.call(this,a);this.type="catmullrom"}function ue(a){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead.");wa.call(this,a);this.type="catmullrom"}void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52));void 0===Number.isInteger&&(Number.isInteger=function(a){return"number"===typeof a&&isFinite(a)&&Math.floor(a)===
   a});void 0===Math.sign&&(Math.sign=function(a){return 0>a?-1:0<a?1:+a});!1==="name"in Function.prototype&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}});void 0===Object.assign&&function(){Object.assign=function(a){if(void 0===a||null===a)throw new TypeError("Cannot convert undefined or null to object");for(var b=Object(a),c=1;c<arguments.length;c++){var d=arguments[c];if(void 0!==d&&null!==d)for(var e in d)Object.prototype.hasOwnProperty.call(d,
   e)&&(b[e]=d[e])}return b}}();var ib=function(){function a(){}a.prototype.addEventListener=function(a,c){void 0===this._listeners&&(this._listeners={});void 0===this._listeners[a]&&(this._listeners[a]=[]);-1===this._listeners[a].indexOf(c)&&this._listeners[a].push(c)};a.prototype.dispatchEvent=function(a){if(void 0!==this._listeners){var b=this._listeners[a.type];if(void 0!==b){a.target=this;b=b.slice(0);for(var d=0,e=b.length;d<e;d++)b[d].call(this,a)}return!0}};a.prototype.hasEventListener=function(a,
   c){return void 0!==this._listeners&&void 0!==this._listeners[a]&&-1!==this._listeners[a].indexOf(c)};a.prototype.removeEventListener=function(a,c){void 0!==this._listeners&&(a=this._listeners[a],void 0!==a&&(c=a.indexOf(c),-1!==c&&a.splice(c,1)))};return a}(),Q=new (function(){function a(){this.DEG2RAD=Math.PI/180;this.RAD2DEG=180/Math.PI}a.prototype.ceilPowerOfTwo=function(a){return Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))};a.prototype.clamp=function(a,c,d){return Math.max(c,Math.min(d,a))};a.prototype.degToRad=
   function(a){return a*this.DEG2RAD};a.prototype.euclideanModulo=function(a,c){return(a%c+c)%c};a.prototype.floorPowerOfTwo=function(a){return Math.pow(2,Math.floor(Math.log(a)/Math.LN2))};a.prototype.generateUUID=function(){for(var a=[],c=0;256>c;c++)a[c]=(16>c?"0":"")+c.toString(16);c=4294967295*Math.random()|0;var d=4294967295*Math.random()|0,e=4294967295*Math.random()|0,f=4294967295*Math.random()|0;return(a[c&255]+a[c>>8&255]+a[c>>16&255]+a[c>>24&255]+"-"+a[d&255]+a[d>>8&255]+"-"+a[d>>16&15|64]+
   a[d>>24&255]+"-"+a[e&63|128]+a[e>>8&255]+"-"+a[e>>16&255]+a[e>>24&255]+a[f&255]+a[f>>8&255]+a[f>>16&255]+a[f>>24&255]).toUpperCase()};a.prototype.isPowerOfTwo=function(a){return 0===(a&a-1)&&0!==a};a.prototype.lerp=function(a,c,d){return(1-d)*a+d*c};a.prototype.mapLinear=function(a,c,d,e,f){return e+(a-c)*(f-e)/(d-c)};a.prototype.radToDeg=function(a){return a*this.RAD2DEG};a.prototype.randFloat=function(a,c){return a+Math.random()*(c-a)};a.prototype.randFloatSpread=function(a){return a*(.5-Math.random())};
   a.prototype.randInt=function(a,c){return a+Math.floor(Math.random()*(c-a+1))};a.prototype.smootherstep=function(a,c,d){if(a<=c)return 0;if(a>=d)return 1;a=(a-c)/(d-c);return a*a*a*(a*(6*a-15)+10)};a.prototype.smoothstep=function(a,c,d){if(a<=c)return 0;if(a>=d)return 1;a=(a-c)/(d-c);return a*a*(3-2*a)};return a}());Object.defineProperties(C.prototype,{width:{get:function(){return this.x},set:function(a){this.x=a}},height:{get:function(){return this.y},set:function(a){this.y=a}}});Object.assign(C.prototype,
   {isVector2:!0,set:function(a,b){this.x=a;this.y=b;return this},setScalar:function(a){this.y=this.x=a;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;default:throw Error("index is out of range: "+a);}return this},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+a);}},clone:function(){return new this.constructor(this.x,
   this.y)},copy:function(a){this.x=a.x;this.y=a.y;return this},add:function(a,b){if(void 0!==b)return console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;return this},addScalar:function(a){this.x+=a;this.y+=a;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;return this},addScaledVector:function(a,b){this.x+=a.x*b;this.y+=a.y*b;return this},sub:function(a,b){if(void 0!==b)return console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),
   this.subVectors(a,b);this.x-=a.x;this.y-=a.y;return this},subScalar:function(a){this.x-=a;this.y-=a;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;return this},multiply:function(a){this.x*=a.x;this.y*=a.y;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;return this},divide:function(a){this.x/=a.x;this.y/=a.y;return this},divideScalar:function(a){return this.multiplyScalar(1/a)},applyMatrix3:function(a){var b=this.x,c=this.y;a=a.elements;this.x=a[0]*b+a[3]*c+a[6];this.y=
   a[1]*b+a[4]*c+a[7];return this},min:function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);return this},max:function(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);return this},clamp:function(a,b){this.x=Math.max(a.x,Math.min(b.x,this.x));this.y=Math.max(a.y,Math.min(b.y,this.y));return this},clampScalar:function(){var a=new C,b=new C;return function(c,d){a.set(c,c);b.set(d,d);return this.clamp(a,b)}}(),clampLength:function(a,b){var c=this.length();return this.divideScalar(c||
   1).multiplyScalar(Math.max(a,Math.min(b,c)))},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);return this},negate:function(){this.x=-this.x;this.y=-this.y;return this},dot:function(a){return this.x*
   a.x+this.y*a.y},cross:function(a){return this.x*a.y-this.y*a.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var a=Math.atan2(this.y,this.x);0>a&&(a+=2*Math.PI);return a},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=
   this.x-a.x;a=this.y-a.y;return b*b+a*a},manhattanDistanceTo:function(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)},setLength:function(a){return this.normalize().multiplyScalar(a)},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;return this},lerpVectors:function(a,b,c){return this.subVectors(b,a).multiplyScalar(c).add(a)},equals:function(a){return a.x===this.x&&a.y===this.y},fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+1];return this},toArray:function(a,
   b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this.x;a[b+1]=this.y;return a},fromBufferAttribute:function(a,b,c){void 0!==c&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute().");this.x=a.getX(b);this.y=a.getY(b);return this},rotateAround:function(a,b){var c=Math.cos(b);b=Math.sin(b);var d=this.x-a.x,e=this.y-a.y;this.x=d*c-e*b+a.x;this.y=d*b+e*c+a.y;return this}});Object.assign(M.prototype,{isMatrix4:!0,set:function(a,b,c,d,e,f,g,h,k,m,q,n,l,t,r,p){var u=this.elements;
   u[0]=a;u[4]=b;u[8]=c;u[12]=d;u[1]=e;u[5]=f;u[9]=g;u[13]=h;u[2]=k;u[6]=m;u[10]=q;u[14]=n;u[3]=l;u[7]=t;u[11]=r;u[15]=p;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},clone:function(){return(new M).fromArray(this.elements)},copy:function(a){var b=this.elements;a=a.elements;b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return this},copyPosition:function(a){var b=
   this.elements;a=a.elements;b[12]=a[12];b[13]=a[13];b[14]=a[14];return this},extractBasis:function(a,b,c){a.setFromMatrixColumn(this,0);b.setFromMatrixColumn(this,1);c.setFromMatrixColumn(this,2);return this},makeBasis:function(a,b,c){this.set(a.x,b.x,c.x,0,a.y,b.y,c.y,0,a.z,b.z,c.z,0,0,0,0,1);return this},extractRotation:function(){var a=new p;return function(b){var c=this.elements,d=b.elements,e=1/a.setFromMatrixColumn(b,0).length(),f=1/a.setFromMatrixColumn(b,1).length();b=1/a.setFromMatrixColumn(b,
   2).length();c[0]=d[0]*e;c[1]=d[1]*e;c[2]=d[2]*e;c[3]=0;c[4]=d[4]*f;c[5]=d[5]*f;c[6]=d[6]*f;c[7]=0;c[8]=d[8]*b;c[9]=d[9]*b;c[10]=d[10]*b;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return this}}(),makeRotationFromEuler:function(a){a&&a.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var b=this.elements,c=a.x,d=a.y,e=a.z,f=Math.cos(c);c=Math.sin(c);var g=Math.cos(d);d=Math.sin(d);var h=Math.cos(e);e=Math.sin(e);if("XYZ"===a.order){a=
   f*h;var k=f*e,m=c*h,q=c*e;b[0]=g*h;b[4]=-g*e;b[8]=d;b[1]=k+m*d;b[5]=a-q*d;b[9]=-c*g;b[2]=q-a*d;b[6]=m+k*d;b[10]=f*g}else"YXZ"===a.order?(a=g*h,k=g*e,m=d*h,q=d*e,b[0]=a+q*c,b[4]=m*c-k,b[8]=f*d,b[1]=f*e,b[5]=f*h,b[9]=-c,b[2]=k*c-m,b[6]=q+a*c,b[10]=f*g):"ZXY"===a.order?(a=g*h,k=g*e,m=d*h,q=d*e,b[0]=a-q*c,b[4]=-f*e,b[8]=m+k*c,b[1]=k+m*c,b[5]=f*h,b[9]=q-a*c,b[2]=-f*d,b[6]=c,b[10]=f*g):"ZYX"===a.order?(a=f*h,k=f*e,m=c*h,q=c*e,b[0]=g*h,b[4]=m*d-k,b[8]=a*d+q,b[1]=g*e,b[5]=q*d+a,b[9]=k*d-m,b[2]=-d,b[6]=c*
   g,b[10]=f*g):"YZX"===a.order?(a=f*g,k=f*d,m=c*g,q=c*d,b[0]=g*h,b[4]=q-a*e,b[8]=m*e+k,b[1]=e,b[5]=f*h,b[9]=-c*h,b[2]=-d*h,b[6]=k*e+m,b[10]=a-q*e):"XZY"===a.order&&(a=f*g,k=f*d,m=c*g,q=c*d,b[0]=g*h,b[4]=-e,b[8]=d*h,b[1]=a*e+q,b[5]=f*h,b[9]=k*e-m,b[2]=m*e-k,b[6]=c*h,b[10]=q*e+a);b[3]=0;b[7]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this},makeRotationFromQuaternion:function(){var a=new p(0,0,0),b=new p(1,1,1);return function(c){return this.compose(a,c,b)}}(),lookAt:function(){var a=new p,b=new p,
   c=new p;return function(d,e,f){var g=this.elements;c.subVectors(d,e);0===c.lengthSq()&&(c.z=1);c.normalize();a.crossVectors(f,c);0===a.lengthSq()&&(1===Math.abs(f.z)?c.x+=1E-4:c.z+=1E-4,c.normalize(),a.crossVectors(f,c));a.normalize();b.crossVectors(c,a);g[0]=a.x;g[4]=b.x;g[8]=c.x;g[1]=a.y;g[5]=b.y;g[9]=c.y;g[2]=a.z;g[6]=b.z;g[10]=c.z;return this}}(),multiply:function(a,b){return void 0!==b?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),
   this.multiplyMatrices(a,b)):this.multiplyMatrices(this,a)},premultiply:function(a){return this.multiplyMatrices(a,this)},multiplyMatrices:function(a,b){var c=a.elements,d=b.elements;b=this.elements;a=c[0];var e=c[4],f=c[8],g=c[12],h=c[1],k=c[5],m=c[9],q=c[13],n=c[2],l=c[6],t=c[10],r=c[14],p=c[3],z=c[7],x=c[11];c=c[15];var w=d[0],y=d[4],H=d[8],O=d[12],da=d[1],J=d[5],A=d[9],C=d[13],E=d[2],B=d[6],F=d[10],G=d[14],K=d[3],L=d[7],I=d[11];d=d[15];b[0]=a*w+e*da+f*E+g*K;b[4]=a*y+e*J+f*B+g*L;b[8]=a*H+e*A+f*
   F+g*I;b[12]=a*O+e*C+f*G+g*d;b[1]=h*w+k*da+m*E+q*K;b[5]=h*y+k*J+m*B+q*L;b[9]=h*H+k*A+m*F+q*I;b[13]=h*O+k*C+m*G+q*d;b[2]=n*w+l*da+t*E+r*K;b[6]=n*y+l*J+t*B+r*L;b[10]=n*H+l*A+t*F+r*I;b[14]=n*O+l*C+t*G+r*d;b[3]=p*w+z*da+x*E+c*K;b[7]=p*y+z*J+x*B+c*L;b[11]=p*H+z*A+x*F+c*I;b[15]=p*O+z*C+x*G+c*d;return this},multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[4]*=a;b[8]*=a;b[12]*=a;b[1]*=a;b[5]*=a;b[9]*=a;b[13]*=a;b[2]*=a;b[6]*=a;b[10]*=a;b[14]*=a;b[3]*=a;b[7]*=a;b[11]*=a;b[15]*=a;return this},applyToBufferAttribute:function(){var a=
   new p;return function(b){for(var c=0,d=b.count;c<d;c++)a.x=b.getX(c),a.y=b.getY(c),a.z=b.getZ(c),a.applyMatrix4(this),b.setXYZ(c,a.x,a.y,a.z);return b}}(),determinant:function(){var a=this.elements,b=a[0],c=a[4],d=a[8],e=a[12],f=a[1],g=a[5],h=a[9],k=a[13],m=a[2],q=a[6],n=a[10],l=a[14];return a[3]*(+e*h*q-d*k*q-e*g*n+c*k*n+d*g*l-c*h*l)+a[7]*(+b*h*l-b*k*n+e*f*n-d*f*l+d*k*m-e*h*m)+a[11]*(+b*k*q-b*g*l-e*f*q+c*f*l+e*g*m-c*k*m)+a[15]*(-d*g*m-b*h*q+b*g*n+d*f*q-c*f*n+c*h*m)},transpose:function(){var a=this.elements;
   var b=a[1];a[1]=a[4];a[4]=b;b=a[2];a[2]=a[8];a[8]=b;b=a[6];a[6]=a[9];a[9]=b;b=a[3];a[3]=a[12];a[12]=b;b=a[7];a[7]=a[13];a[13]=b;b=a[11];a[11]=a[14];a[14]=b;return this},setPosition:function(a){var b=this.elements;b[12]=a.x;b[13]=a.y;b[14]=a.z;return this},getInverse:function(a,b){var c=this.elements,d=a.elements;a=d[0];var e=d[1],f=d[2],g=d[3],h=d[4],k=d[5],m=d[6],q=d[7],n=d[8],l=d[9],t=d[10],r=d[11],p=d[12],z=d[13],x=d[14];d=d[15];var w=l*x*q-z*t*q+z*m*r-k*x*r-l*m*d+k*t*d,y=p*t*q-n*x*q-p*m*r+h*x*
   r+n*m*d-h*t*d,H=n*z*q-p*l*q+p*k*r-h*z*r-n*k*d+h*l*d,O=p*l*m-n*z*m-p*k*t+h*z*t+n*k*x-h*l*x,da=a*w+e*y+f*H+g*O;if(0===da){if(!0===b)throw Error("THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0");console.warn("THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0");return this.identity()}b=1/da;c[0]=w*b;c[1]=(z*t*g-l*x*g-z*f*r+e*x*r+l*f*d-e*t*d)*b;c[2]=(k*x*g-z*m*g+z*f*q-e*x*q-k*f*d+e*m*d)*b;c[3]=(l*m*g-k*t*g-l*f*q+e*t*q+k*f*r-e*m*r)*b;c[4]=y*b;c[5]=(n*x*g-p*t*g+p*f*r-
   a*x*r-n*f*d+a*t*d)*b;c[6]=(p*m*g-h*x*g-p*f*q+a*x*q+h*f*d-a*m*d)*b;c[7]=(h*t*g-n*m*g+n*f*q-a*t*q-h*f*r+a*m*r)*b;c[8]=H*b;c[9]=(p*l*g-n*z*g-p*e*r+a*z*r+n*e*d-a*l*d)*b;c[10]=(h*z*g-p*k*g+p*e*q-a*z*q-h*e*d+a*k*d)*b;c[11]=(n*k*g-h*l*g-n*e*q+a*l*q+h*e*r-a*k*r)*b;c[12]=O*b;c[13]=(n*z*f-p*l*f+p*e*t-a*z*t-n*e*x+a*l*x)*b;c[14]=(p*k*f-h*z*f-p*e*m+a*z*m+h*e*x-a*k*x)*b;c[15]=(h*l*f-n*k*f+n*e*m-a*l*m-h*e*t+a*k*t)*b;return this},scale:function(a){var b=this.elements,c=a.x,d=a.y;a=a.z;b[0]*=c;b[4]*=d;b[8]*=a;b[1]*=
   c;b[5]*=d;b[9]*=a;b[2]*=c;b[6]*=d;b[10]*=a;b[3]*=c;b[7]*=d;b[11]*=a;return this},getMaxScaleOnAxis:function(){var a=this.elements;return Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10]))},makeTranslation:function(a,b,c){this.set(1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1);return this},makeRotationX:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(1,0,0,0,0,b,-a,0,0,a,b,0,0,0,0,1);return this},makeRotationY:function(a){var b=Math.cos(a);a=Math.sin(a);
   this.set(b,0,a,0,0,1,0,0,-a,0,b,0,0,0,0,1);return this},makeRotationZ:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,-a,0,0,a,b,0,0,0,0,1,0,0,0,0,1);return this},makeRotationAxis:function(a,b){var c=Math.cos(b);b=Math.sin(b);var d=1-c,e=a.x,f=a.y;a=a.z;var g=d*e,h=d*f;this.set(g*e+c,g*f-b*a,g*a+b*f,0,g*f+b*a,h*f+c,h*a-b*e,0,g*a-b*f,h*a+b*e,d*a*a+c,0,0,0,0,1);return this},makeScale:function(a,b,c){this.set(a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1);return this},makeShear:function(a,b,c){this.set(1,b,
   c,0,a,1,c,0,a,b,1,0,0,0,0,1);return this},compose:function(a,b,c){var d=this.elements,e=b._x,f=b._y,g=b._z,h=b._w,k=e+e,m=f+f,q=g+g;b=e*k;var n=e*m;e*=q;var l=f*m;f*=q;g*=q;k*=h;m*=h;h*=q;q=c.x;var t=c.y;c=c.z;d[0]=(1-(l+g))*q;d[1]=(n+h)*q;d[2]=(e-m)*q;d[3]=0;d[4]=(n-h)*t;d[5]=(1-(b+g))*t;d[6]=(f+k)*t;d[7]=0;d[8]=(e+m)*c;d[9]=(f-k)*c;d[10]=(1-(b+l))*c;d[11]=0;d[12]=a.x;d[13]=a.y;d[14]=a.z;d[15]=1;return this},decompose:function(){var a=new p,b=new M;return function(c,d,e){var f=this.elements,g=a.set(f[0],
   f[1],f[2]).length(),h=a.set(f[4],f[5],f[6]).length(),k=a.set(f[8],f[9],f[10]).length();0>this.determinant()&&(g=-g);c.x=f[12];c.y=f[13];c.z=f[14];b.copy(this);c=1/g;f=1/h;var m=1/k;b.elements[0]*=c;b.elements[1]*=c;b.elements[2]*=c;b.elements[4]*=f;b.elements[5]*=f;b.elements[6]*=f;b.elements[8]*=m;b.elements[9]*=m;b.elements[10]*=m;d.setFromRotationMatrix(b);e.x=g;e.y=h;e.z=k;return this}}(),makePerspective:function(a,b,c,d,e,f){void 0===f&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");
   var g=this.elements;g[0]=2*e/(b-a);g[4]=0;g[8]=(b+a)/(b-a);g[12]=0;g[1]=0;g[5]=2*e/(c-d);g[9]=(c+d)/(c-d);g[13]=0;g[2]=0;g[6]=0;g[10]=-(f+e)/(f-e);g[14]=-2*f*e/(f-e);g[3]=0;g[7]=0;g[11]=-1;g[15]=0;return this},makeOrthographic:function(a,b,c,d,e,f){var g=this.elements,h=1/(b-a),k=1/(c-d),m=1/(f-e);g[0]=2*h;g[4]=0;g[8]=0;g[12]=-((b+a)*h);g[1]=0;g[5]=2*k;g[9]=0;g[13]=-((c+d)*k);g[2]=0;g[6]=0;g[10]=-2*m;g[14]=-((f+e)*m);g[3]=0;g[7]=0;g[11]=0;g[15]=1;return this},equals:function(a){var b=this.elements;
   a=a.elements;for(var c=0;16>c;c++)if(b[c]!==a[c])return!1;return!0},fromArray:function(a,b){void 0===b&&(b=0);for(var c=0;16>c;c++)this.elements[c]=a[c+b];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);var c=this.elements;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];a[b+9]=c[9];a[b+10]=c[10];a[b+11]=c[11];a[b+12]=c[12];a[b+13]=c[13];a[b+14]=c[14];a[b+15]=c[15];return a}});Object.assign(ia,{slerp:function(a,b,c,d){return c.copy(a).slerp(b,
   d)},slerpFlat:function(a,b,c,d,e,f,g){var h=c[d+0],k=c[d+1],m=c[d+2];c=c[d+3];d=e[f+0];var q=e[f+1],n=e[f+2];e=e[f+3];if(c!==e||h!==d||k!==q||m!==n){f=1-g;var l=h*d+k*q+m*n+c*e,t=0<=l?1:-1,r=1-l*l;r>Number.EPSILON&&(r=Math.sqrt(r),l=Math.atan2(r,l*t),f=Math.sin(f*l)/r,g=Math.sin(g*l)/r);t*=g;h=h*f+d*t;k=k*f+q*t;m=m*f+n*t;c=c*f+e*t;f===1-g&&(g=1/Math.sqrt(h*h+k*k+m*m+c*c),h*=g,k*=g,m*=g,c*=g)}a[b]=h;a[b+1]=k;a[b+2]=m;a[b+3]=c}});Object.defineProperties(ia.prototype,{x:{get:function(){return this._x},
   set:function(a){this._x=a;this.onChangeCallback()}},y:{get:function(){return this._y},set:function(a){this._y=a;this.onChangeCallback()}},z:{get:function(){return this._z},set:function(a){this._z=a;this.onChangeCallback()}},w:{get:function(){return this._w},set:function(a){this._w=a;this.onChangeCallback()}}});Object.assign(ia.prototype,{set:function(a,b,c,d){this._x=a;this._y=b;this._z=c;this._w=d;this.onChangeCallback();return this},clone:function(){return new this.constructor(this._x,this._y,this._z,
   this._w)},copy:function(a){this._x=a.x;this._y=a.y;this._z=a.z;this._w=a.w;this.onChangeCallback();return this},setFromEuler:function(a,b){if(!a||!a.isEuler)throw Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var c=a._x,d=a._y,e=a._z;a=a.order;var f=Math.cos,g=Math.sin,h=f(c/2),k=f(d/2);f=f(e/2);c=g(c/2);d=g(d/2);e=g(e/2);"XYZ"===a?(this._x=c*k*f+h*d*e,this._y=h*d*f-c*k*e,this._z=h*k*e+c*d*f,this._w=h*k*f-c*d*e):"YXZ"===a?(this._x=c*k*f+
   h*d*e,this._y=h*d*f-c*k*e,this._z=h*k*e-c*d*f,this._w=h*k*f+c*d*e):"ZXY"===a?(this._x=c*k*f-h*d*e,this._y=h*d*f+c*k*e,this._z=h*k*e+c*d*f,this._w=h*k*f-c*d*e):"ZYX"===a?(this._x=c*k*f-h*d*e,this._y=h*d*f+c*k*e,this._z=h*k*e-c*d*f,this._w=h*k*f+c*d*e):"YZX"===a?(this._x=c*k*f+h*d*e,this._y=h*d*f+c*k*e,this._z=h*k*e-c*d*f,this._w=h*k*f-c*d*e):"XZY"===a&&(this._x=c*k*f-h*d*e,this._y=h*d*f-c*k*e,this._z=h*k*e+c*d*f,this._w=h*k*f+c*d*e);if(!1!==b)this.onChangeCallback();return this},setFromAxisAngle:function(a,
   b){b/=2;var c=Math.sin(b);this._x=a.x*c;this._y=a.y*c;this._z=a.z*c;this._w=Math.cos(b);this.onChangeCallback();return this},setFromRotationMatrix:function(a){var b=a.elements,c=b[0];a=b[4];var d=b[8],e=b[1],f=b[5],g=b[9],h=b[2],k=b[6];b=b[10];var m=c+f+b;0<m?(c=.5/Math.sqrt(m+1),this._w=.25/c,this._x=(k-g)*c,this._y=(d-h)*c,this._z=(e-a)*c):c>f&&c>b?(c=2*Math.sqrt(1+c-f-b),this._w=(k-g)/c,this._x=.25*c,this._y=(a+e)/c,this._z=(d+h)/c):f>b?(c=2*Math.sqrt(1+f-c-b),this._w=(d-h)/c,this._x=(a+e)/c,this._y=
   .25*c,this._z=(g+k)/c):(c=2*Math.sqrt(1+b-c-f),this._w=(e-a)/c,this._x=(d+h)/c,this._y=(g+k)/c,this._z=.25*c);this.onChangeCallback();return this},setFromUnitVectors:function(){var a=new p,b;return function(c,d){void 0===a&&(a=new p);b=c.dot(d)+1;1E-6>b?(b=0,Math.abs(c.x)>Math.abs(c.z)?a.set(-c.y,c.x,0):a.set(0,-c.z,c.y)):a.crossVectors(c,d);this._x=a.x;this._y=a.y;this._z=a.z;this._w=b;return this.normalize()}}(),angleTo:function(a){return 2*Math.acos(Math.abs(Q.clamp(this.dot(a),-1,1)))},rotateTowards:function(a,
   b){var c=this.angleTo(a);if(0===c)return this;this.slerp(a,Math.min(1,b/c));return this},inverse:function(){return this.conjugate()},conjugate:function(){this._x*=-1;this._y*=-1;this._z*=-1;this.onChangeCallback();return this},dot:function(a){return this._x*a._x+this._y*a._y+this._z*a._z+this._w*a._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var a=
   this.length();0===a?(this._z=this._y=this._x=0,this._w=1):(a=1/a,this._x*=a,this._y*=a,this._z*=a,this._w*=a);this.onChangeCallback();return this},multiply:function(a,b){return void 0!==b?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(a,b)):this.multiplyQuaternions(this,a)},premultiply:function(a){return this.multiplyQuaternions(a,this)},multiplyQuaternions:function(a,b){var c=a._x,d=a._y,e=a._z;a=a._w;
   var f=b._x,g=b._y,h=b._z;b=b._w;this._x=c*b+a*f+d*h-e*g;this._y=d*b+a*g+e*f-c*h;this._z=e*b+a*h+c*g-d*f;this._w=a*b-c*f-d*g-e*h;this.onChangeCallback();return this},slerp:function(a,b){if(0===b)return this;if(1===b)return this.copy(a);var c=this._x,d=this._y,e=this._z,f=this._w,g=f*a._w+c*a._x+d*a._y+e*a._z;0>g?(this._w=-a._w,this._x=-a._x,this._y=-a._y,this._z=-a._z,g=-g):this.copy(a);if(1<=g)return this._w=f,this._x=c,this._y=d,this._z=e,this;a=1-g*g;if(a<=Number.EPSILON)return g=1-b,this._w=g*
   f+b*this._w,this._x=g*c+b*this._x,this._y=g*d+b*this._y,this._z=g*e+b*this._z,this.normalize();a=Math.sqrt(a);var h=Math.atan2(a,g);g=Math.sin((1-b)*h)/a;b=Math.sin(b*h)/a;this._w=f*g+this._w*b;this._x=c*g+this._x*b;this._y=d*g+this._y*b;this._z=e*g+this._z*b;this.onChangeCallback();return this},equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._w===this._w},fromArray:function(a,b){void 0===b&&(b=0);this._x=a[b];this._y=a[b+1];this._z=a[b+2];this._w=a[b+3];this.onChangeCallback();
   return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this._x;a[b+1]=this._y;a[b+2]=this._z;a[b+3]=this._w;return a},onChange:function(a){this.onChangeCallback=a;return this},onChangeCallback:function(){}});Object.assign(p.prototype,{isVector3:!0,set:function(a,b,c){this.x=a;this.y=b;this.z=c;return this},setScalar:function(a){this.z=this.y=this.x=a;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},
   setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;default:throw Error("index is out of range: "+a);}return this},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+a);}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this},add:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),
   this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;return this},addScaledVector:function(a,b){this.x+=a.x*b;this.y+=a.y*b;this.z+=a.z*b;return this},sub:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;
   return this},subScalar:function(a){this.x-=a;this.y-=a;this.z-=a;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;return this},multiply:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(a,b);this.x*=a.x;this.y*=a.y;this.z*=a.z;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=a;return this},multiplyVectors:function(a,b){this.x=a.x*
   b.x;this.y=a.y*b.y;this.z=a.z*b.z;return this},applyEuler:function(){var a=new ia;return function(b){b&&b.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order.");return this.applyQuaternion(a.setFromEuler(b))}}(),applyAxisAngle:function(){var a=new ia;return function(b,c){return this.applyQuaternion(a.setFromAxisAngle(b,c))}}(),applyMatrix3:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;this.x=a[0]*b+a[3]*c+a[6]*d;this.y=a[1]*
   b+a[4]*c+a[7]*d;this.z=a[2]*b+a[5]*c+a[8]*d;return this},applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;var e=1/(a[3]*b+a[7]*c+a[11]*d+a[15]);this.x=(a[0]*b+a[4]*c+a[8]*d+a[12])*e;this.y=(a[1]*b+a[5]*c+a[9]*d+a[13])*e;this.z=(a[2]*b+a[6]*c+a[10]*d+a[14])*e;return this},applyQuaternion:function(a){var b=this.x,c=this.y,d=this.z,e=a.x,f=a.y,g=a.z;a=a.w;var h=a*b+f*d-g*c,k=a*c+g*b-e*d,m=a*d+e*c-f*b;b=-e*b-f*c-g*d;this.x=h*a+b*-e+k*-g-m*-f;this.y=k*a+b*-f+m*-e-h*-g;this.z=m*a+b*
   -g+h*-f-k*-e;return this},project:function(){var a=new M;return function(b){a.multiplyMatrices(b.projectionMatrix,a.getInverse(b.matrixWorld));return this.applyMatrix4(a)}}(),unproject:function(){var a=new M;return function(b){a.multiplyMatrices(b.matrixWorld,a.getInverse(b.projectionMatrix));return this.applyMatrix4(a)}}(),transformDirection:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d;this.y=a[1]*b+a[5]*c+a[9]*d;this.z=a[2]*b+a[6]*c+a[10]*d;return this.normalize()},
   divide:function(a){this.x/=a.x;this.y/=a.y;this.z/=a.z;return this},divideScalar:function(a){return this.multiplyScalar(1/a)},min:function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);this.z=Math.min(this.z,a.z);return this},max:function(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);this.z=Math.max(this.z,a.z);return this},clamp:function(a,b){this.x=Math.max(a.x,Math.min(b.x,this.x));this.y=Math.max(a.y,Math.min(b.y,this.y));this.z=Math.max(a.z,Math.min(b.z,this.z));return this},
   clampScalar:function(){var a=new p,b=new p;return function(c,d){a.set(c,c,c);b.set(d,d,d);return this.clamp(a,b)}}(),clampLength:function(a,b){var c=this.length();return this.divideScalar(c||1).multiplyScalar(Math.max(a,Math.min(b,c)))},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);
   this.z=Math.round(this.z);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;return this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*
   this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(a){return this.normalize().multiplyScalar(a)},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;return this},lerpVectors:function(a,b,c){return this.subVectors(b,a).multiplyScalar(c).add(a)},cross:function(a,b){return void 0!==b?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),
   this.crossVectors(a,b)):this.crossVectors(this,a)},crossVectors:function(a,b){var c=a.x,d=a.y;a=a.z;var e=b.x,f=b.y;b=b.z;this.x=d*b-a*f;this.y=a*e-c*b;this.z=c*f-d*e;return this},projectOnVector:function(a){var b=a.dot(this)/a.lengthSq();return this.copy(a).multiplyScalar(b)},projectOnPlane:function(){var a=new p;return function(b){a.copy(this).projectOnVector(b);return this.sub(a)}}(),reflect:function(){var a=new p;return function(b){return this.sub(a.copy(b).multiplyScalar(2*this.dot(b)))}}(),
   angleTo:function(a){a=this.dot(a)/Math.sqrt(this.lengthSq()*a.lengthSq());return Math.acos(Q.clamp(a,-1,1))},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,c=this.y-a.y;a=this.z-a.z;return b*b+c*c+a*a},manhattanDistanceTo:function(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)+Math.abs(this.z-a.z)},setFromSpherical:function(a){var b=Math.sin(a.phi)*a.radius;this.x=b*Math.sin(a.theta);this.y=Math.cos(a.phi)*a.radius;this.z=b*
   Math.cos(a.theta);return this},setFromCylindrical:function(a){this.x=a.radius*Math.sin(a.theta);this.y=a.y;this.z=a.radius*Math.cos(a.theta);return this},setFromMatrixPosition:function(a){a=a.elements;this.x=a[12];this.y=a[13];this.z=a[14];return this},setFromMatrixScale:function(a){var b=this.setFromMatrixColumn(a,0).length(),c=this.setFromMatrixColumn(a,1).length();a=this.setFromMatrixColumn(a,2).length();this.x=b;this.y=c;this.z=a;return this},setFromMatrixColumn:function(a,b){return this.fromArray(a.elements,
   4*b)},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+1];this.z=a[b+2];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this.x;a[b+1]=this.y;a[b+2]=this.z;return a},fromBufferAttribute:function(a,b,c){void 0!==c&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute().");this.x=a.getX(b);this.y=a.getY(b);this.z=a.getZ(b);return this}});Object.assign(la.prototype,
   {isMatrix3:!0,set:function(a,b,c,d,e,f,g,h,k){var m=this.elements;m[0]=a;m[1]=d;m[2]=g;m[3]=b;m[4]=e;m[5]=h;m[6]=c;m[7]=f;m[8]=k;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(a){var b=this.elements;a=a.elements;b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return this},setFromMatrix4:function(a){a=a.elements;this.set(a[0],a[4],a[8],a[1],a[5],
   a[9],a[2],a[6],a[10]);return this},applyToBufferAttribute:function(){var a=new p;return function(b){for(var c=0,d=b.count;c<d;c++)a.x=b.getX(c),a.y=b.getY(c),a.z=b.getZ(c),a.applyMatrix3(this),b.setXYZ(c,a.x,a.y,a.z);return b}}(),multiply:function(a){return this.multiplyMatrices(this,a)},premultiply:function(a){return this.multiplyMatrices(a,this)},multiplyMatrices:function(a,b){var c=a.elements,d=b.elements;b=this.elements;a=c[0];var e=c[3],f=c[6],g=c[1],h=c[4],k=c[7],m=c[2],q=c[5];c=c[8];var n=
   d[0],l=d[3],t=d[6],r=d[1],p=d[4],z=d[7],x=d[2],w=d[5];d=d[8];b[0]=a*n+e*r+f*x;b[3]=a*l+e*p+f*w;b[6]=a*t+e*z+f*d;b[1]=g*n+h*r+k*x;b[4]=g*l+h*p+k*w;b[7]=g*t+h*z+k*d;b[2]=m*n+q*r+c*x;b[5]=m*l+q*p+c*w;b[8]=m*t+q*z+c*d;return this},multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[3]*=a;b[6]*=a;b[1]*=a;b[4]*=a;b[7]*=a;b[2]*=a;b[5]*=a;b[8]*=a;return this},determinant:function(){var a=this.elements,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],k=a[7];a=a[8];return b*f*a-b*g*k-c*e*a+c*g*h+d*e*k-
   d*f*h},getInverse:function(a,b){a&&a.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var c=a.elements;a=this.elements;var d=c[0],e=c[1],f=c[2],g=c[3],h=c[4],k=c[5],m=c[6],q=c[7];c=c[8];var n=c*h-k*q,l=k*m-c*g,t=q*g-h*m,r=d*n+e*l+f*t;if(0===r){if(!0===b)throw Error("THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0");console.warn("THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0");return this.identity()}b=1/r;a[0]=n*b;
   a[1]=(f*q-c*e)*b;a[2]=(k*e-f*h)*b;a[3]=l*b;a[4]=(c*d-f*m)*b;a[5]=(f*g-k*d)*b;a[6]=t*b;a[7]=(e*m-q*d)*b;a[8]=(h*d-e*g)*b;return this},transpose:function(){var a=this.elements;var b=a[1];a[1]=a[3];a[3]=b;b=a[2];a[2]=a[6];a[6]=b;b=a[5];a[5]=a[7];a[7]=b;return this},getNormalMatrix:function(a){return this.setFromMatrix4(a).getInverse(this).transpose()},transposeIntoArray:function(a){var b=this.elements;a[0]=b[0];a[1]=b[3];a[2]=b[6];a[3]=b[1];a[4]=b[4];a[5]=b[7];a[6]=b[2];a[7]=b[5];a[8]=b[8];return this},
   setUvTransform:function(a,b,c,d,e,f,g){var h=Math.cos(e);e=Math.sin(e);this.set(c*h,c*e,-c*(h*f+e*g)+f+a,-d*e,d*h,-d*(-e*f+h*g)+g+b,0,0,1)},scale:function(a,b){var c=this.elements;c[0]*=a;c[3]*=a;c[6]*=a;c[1]*=b;c[4]*=b;c[7]*=b;return this},rotate:function(a){var b=Math.cos(a);a=Math.sin(a);var c=this.elements,d=c[0],e=c[3],f=c[6],g=c[1],h=c[4],k=c[7];c[0]=b*d+a*g;c[3]=b*e+a*h;c[6]=b*f+a*k;c[1]=-a*d+b*g;c[4]=-a*e+b*h;c[7]=-a*f+b*k;return this},translate:function(a,b){var c=this.elements;c[0]+=a*c[2];
   c[3]+=a*c[5];c[6]+=a*c[8];c[1]+=b*c[2];c[4]+=b*c[5];c[7]+=b*c[8];return this},equals:function(a){var b=this.elements;a=a.elements;for(var c=0;9>c;c++)if(b[c]!==a[c])return!1;return!0},fromArray:function(a,b){void 0===b&&(b=0);for(var c=0;9>c;c++)this.elements[c]=a[c+b];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);var c=this.elements;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];return a}});var jb={getDataURL:function(a){if(a instanceof
   HTMLCanvasElement)var b=a;else{"undefined"!==typeof OffscreenCanvas?b=new OffscreenCanvas(a.width,a.height):(b=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),b.width=a.width,b.height=a.height);var c=b.getContext("2d");a instanceof ImageData?c.putImageData(a,0,0):c.drawImage(a,0,0,a.width,a.height)}return 2048<b.width||2048<b.height?b.toDataURL("image/jpeg",.6):b.toDataURL("image/png")}},Wg=function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,
   b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Xg=function(){function a(){}a.generateId=function(){return a.id++};a.id=0;return a}(),ta=function(a){function b(c,d,e,f,g,h,k,m,q,n){void 0===c&&(c=b.DEFAULT_IMAGE);void 0===d&&(d=b.DEFAULT_IMAGE);void 0===e&&(e=1001);void 0===f&&(f=1001);void 0===g&&(g=1006);void 0===h&&
   (h=1008);void 0===k&&(k=1023);void 0===m&&(m=1009);void 0===q&&(q=1);void 0===n&&(n=3E3);var l=a.call(this)||this;l.image=c;l.mapping=d;l.wrapS=e;l.wrapT=f;l.magFilter=g;l.minFilter=h;l.format=k;l.type=m;l.anisotropy=q;l.encoding=n;l._needsUpdate=!1;l.isTexture=!0;l.center=new C(0,0);l.flipY=!0;l.generateMipmaps=!0;l.matrix=new la;l.matrixAutoUpdate=!0;l.mipmaps=[];l.name="";l.offset=new C(0,0);l.onUpdate=null;l.premultiplyAlpha=!1;l.repeat=new C(1,1);l.rotation=0;l.unpackAlignment=4;l.version=0;
   l.id={value:Xg.generateId()};l.uuid=Q.generateUUID();return l}Wg(b,a);Object.defineProperty(b.prototype,"needsUpdate",{get:function(){return this._needsUpdate},set:function(a){this._needsUpdate=a;!0===a&&this.version++},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"src",{get:function(){!this._src&&this.image&&(this._src=this.image.src);return this._src},enumerable:!0,configurable:!0});b.prototype.cacheKey=function(){void 0===this._cacheKey&&(this._cacheKey=this.src+";"+(this.format+
   ";"+this.type+";"+this.wrapS+";"+this.wrapT+";"+this.magFilter+";"+this.minFilter+";"+this.anisotropy+";"+this.name));return this._cacheKey};b.prototype.clone=function(){return(new b).copy(this)};b.prototype.copy=function(a){this.name=a.name;this.image=a.image;this.mipmaps=a.mipmaps.slice(0);this.mapping=a.mapping;this.wrapS=a.wrapS;this.wrapT=a.wrapT;this.magFilter=a.magFilter;this.minFilter=a.minFilter;this.anisotropy=a.anisotropy;this.format=a.format;this.type=a.type;this.offset.copy(a.offset);
   this.repeat.copy(a.repeat);this.center.copy(a.center);this.rotation=a.rotation;this.matrixAutoUpdate=a.matrixAutoUpdate;this.matrix.copy(a.matrix);this.generateMipmaps=a.generateMipmaps;this.premultiplyAlpha=a.premultiplyAlpha;this.flipY=a.flipY;this.unpackAlignment=a.unpackAlignment;this.encoding=a.encoding;return this};b.prototype.dispose=function(){this.dispatchEvent({type:"dispose"})};b.prototype.toJSON=function(a){var b=void 0===a||"string"===typeof a;if(!b&&void 0!==a.textures[this.uuid])return a.textures[this.uuid];
   var c={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var f=this.image;void 0===f.uuid&&(f.uuid=Q.generateUUID());if(!b&&void 0===a.images[f.uuid]){if(Array.isArray(f)){var g=
   [];for(var h=0,k=f.length;h<k;h++)g.push(jb.getDataURL(f[h]))}else g=jb.getDataURL(f);a.images[f.uuid]={uuid:f.uuid,url:g}}c.image=f.uuid}b||(a.textures[this.uuid]=c);return c};b.prototype.transformUv=function(a){if(300===this.mapping){a.applyMatrix3(this.matrix);if(0>a.x||1<a.x)switch(this.wrapS){case 1E3:a.x-=Math.floor(a.x);break;case 1001:a.x=0>a.x?0:1;break;case 1002:a.x=1===Math.abs(Math.floor(a.x)%2)?Math.ceil(a.x)-a.x:a.x-Math.floor(a.x)}if(0>a.y||1<a.y)switch(this.wrapT){case 1E3:a.y-=Math.floor(a.y);
   break;case 1001:a.y=0>a.y?0:1;break;case 1002:a.y=1===Math.abs(Math.floor(a.y)%2)?Math.ceil(a.y)-a.y:a.y-Math.floor(a.y)}this.flipY&&(a.y=1-a.y)}};b.prototype.updateMatrix=function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)};b.textureId=0;b.DEFAULT_IMAGE=void 0;b.DEFAULT_MAPPING=300;return b}(ib),Yg=function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||
   function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),md=function(a){function b(b,d,e){void 0===b&&(b=0);void 0===d&&(d=0);void 0===e&&(e={});var c=a.call(this)||this;c.width=b;c.height=d;c.options=e;c.scissorTest=!1;c.isWebGLRenderTarget=!0;c.scissor=new ca(0,0,b,d);c.viewport=new ca(0,0,b,d);void 0===e.minFilter&&(e.minFilter=1006);c.texture=
   new ta(void 0,void 0,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.encoding);c.texture.generateMipmaps=void 0!==e.generateMipmaps?e.generateMipmaps:!0;c.depthBuffer=void 0!==e.depthBuffer?e.depthBuffer:!0;c.stencilBuffer=void 0!==e.stencilBuffer?e.stencilBuffer:!0;c.depthTexture=void 0!==e.depthTexture?e.depthTexture:null;return c}Yg(b,a);b.prototype.cacheKey=function(){return this.texture.cacheKey()+";"+this.depthTexture.cacheKey()+";"+this.depthBuffer+";"+this.stencilBuffer+
   ";"+this.scissorTest+";"};b.prototype.clone=function(){return(new b).copy(this)};b.prototype.copy=function(a){this.width=a.width;this.height=a.height;this.viewport.copy(a.viewport);this.texture=a.texture.clone();this.depthBuffer=a.depthBuffer;this.stencilBuffer=a.stencilBuffer;this.depthTexture=a.depthTexture;return this};b.prototype.dispose=function(){this.dispatchEvent({type:"dispose"})};b.prototype.setSize=function(a,b){if(this.width!==a||this.height!==b)this.width=a,this.height=b,this.dispose();
   this.viewport.set(0,0,a,b);this.scissor.set(0,0,a,b)};return b}(ib),Zg=function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),mf=function(a){function b(b,d,e){b=a.call(this,b,d,e)||this;b.isWebGLRenderTargetCube=!0;b.activeCubeFace=
   0;b.activeMipMapLevel=0;return b}Zg(b,a);return b}(md);kb.prototype=Object.create(ta.prototype);kb.prototype.constructor=kb;kb.prototype.isDataTexture=!0;Object.assign(Va.prototype,{isBox3:!0,set:function(a,b){this.min.copy(a);this.max.copy(b);return this},setFromArray:function(a){for(var b=Infinity,c=Infinity,d=Infinity,e=-Infinity,f=-Infinity,g=-Infinity,h=0,k=a.length;h<k;h+=3){var m=a[h],q=a[h+1],l=a[h+2];m<b&&(b=m);q<c&&(c=q);l<d&&(d=l);m>e&&(e=m);q>f&&(f=q);l>g&&(g=l)}this.min.set(b,c,d);this.max.set(e,
   f,g);return this},setFromBufferAttribute:function(a){for(var b=Infinity,c=Infinity,d=Infinity,e=-Infinity,f=-Infinity,g=-Infinity,h=0,k=a.count;h<k;h++){var m=a.getX(h),q=a.getY(h),l=a.getZ(h);m<b&&(b=m);q<c&&(c=q);l<d&&(d=l);m>e&&(e=m);q>f&&(f=q);l>g&&(g=l)}this.min.set(b,c,d);this.max.set(e,f,g);return this},setFromPoints:function(a){this.makeEmpty();for(var b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);return this},setFromCenterAndSize:function(){var a=new p;return function(b,c){c=a.copy(c).multiplyScalar(.5);
   this.min.copy(b).sub(c);this.max.copy(b).add(c);return this}}(),setFromObject:function(a){this.makeEmpty();return this.expandByObject(a)},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.min.copy(a.min);this.max.copy(a.max);return this},makeEmpty:function(){this.min.x=this.min.y=this.min.z=Infinity;this.max.x=this.max.y=this.max.z=-Infinity;return this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(a){void 0===
   a&&(console.warn("THREE.Box3: .getCenter() target is now required"),a=new p);return this.isEmpty()?a.set(0,0,0):a.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(a){void 0===a&&(console.warn("THREE.Box3: .getSize() target is now required"),a=new p);return this.isEmpty()?a.set(0,0,0):a.subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);
   this.max.addScalar(a);return this},expandByObject:function(){function a(a){var f=a.geometry;if(void 0!==f)if(f.isGeometry)for(f=f.vertices,c=0,d=f.length;c<d;c++)e.copy(f[c]),e.applyMatrix4(a.matrixWorld),b.expandByPoint(e);else if(f.isBufferGeometry&&(f=f.attributes.position,void 0!==f))for(c=0,d=f.count;c<d;c++)e.fromBufferAttribute(f,c).applyMatrix4(a.matrixWorld),b.expandByPoint(e)}var b,c,d,e=new p;return function(c){b=this;c.updateMatrixWorld(!0);c.traverse(a);return this}}(),containsPoint:function(a){return a.x<
   this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<this.min.z||a.z>this.max.z?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z&&a.max.z<=this.max.z},getParameter:function(a,b){void 0===b&&(console.warn("THREE.Box3: .getParameter() target is now required"),b=new p);return b.set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))},
   intersectsBox:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y||a.max.z<this.min.z||a.min.z>this.max.z?!1:!0},intersectsSphere:function(){var a=new p;return function(b){this.clampPoint(b.center,a);return a.distanceToSquared(b.center)<=b.radius*b.radius}}(),intersectsPlane:function(a){if(0<a.normal.x){var b=a.normal.x*this.min.x;var c=a.normal.x*this.max.x}else b=a.normal.x*this.max.x,c=a.normal.x*this.min.x;0<a.normal.y?(b+=a.normal.y*this.min.y,c+=
   a.normal.y*this.max.y):(b+=a.normal.y*this.max.y,c+=a.normal.y*this.min.y);0<a.normal.z?(b+=a.normal.z*this.min.z,c+=a.normal.z*this.max.z):(b+=a.normal.z*this.max.z,c+=a.normal.z*this.min.z);return b<=a.constant&&c>=a.constant},intersectsTriangle:function(){function a(a){var e;var f=0;for(e=a.length-3;f<=e;f+=3){h.fromArray(a,f);var g=m.x*Math.abs(h.x)+m.y*Math.abs(h.y)+m.z*Math.abs(h.z),k=b.dot(h),q=c.dot(h),l=d.dot(h);if(Math.max(-Math.max(k,q,l),Math.min(k,q,l))>g)return!1}return!0}var b=new p,
   c=new p,d=new p,e=new p,f=new p,g=new p,h=new p,k=new p,m=new p,q=new p;return function(h){if(this.isEmpty())return!1;this.getCenter(k);m.subVectors(this.max,k);b.subVectors(h.a,k);c.subVectors(h.b,k);d.subVectors(h.c,k);e.subVectors(c,b);f.subVectors(d,c);g.subVectors(b,d);h=[0,-e.z,e.y,0,-f.z,f.y,0,-g.z,g.y,e.z,0,-e.x,f.z,0,-f.x,g.z,0,-g.x,-e.y,e.x,0,-f.y,f.x,0,-g.y,g.x,0];if(!a(h))return!1;h=[1,0,0,0,1,0,0,0,1];if(!a(h))return!1;q.crossVectors(e,f);h=[q.x,q.y,q.z];return a(h)}}(),clampPoint:function(a,
   b){void 0===b&&(console.warn("THREE.Box3: .clampPoint() target is now required"),b=new p);return b.copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new p;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),getBoundingSphere:function(){var a=new p;return function(b){void 0===b&&(b=new za);this.getCenter(b.center);b.radius=.5*this.getSize(a).length();return b}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);this.isEmpty()&&this.makeEmpty();
   return this},union:function(a){this.min.min(a.min);this.max.max(a.max);return this},applyMatrix4:function(a){if(this.isEmpty())return this;a=a.elements;var b=a[0]*this.min.x,c=a[1]*this.min.x,d=a[2]*this.min.x,e=a[0]*this.max.x,f=a[1]*this.max.x,g=a[2]*this.max.x,h=a[4]*this.min.y,k=a[5]*this.min.y,m=a[6]*this.min.y,q=a[4]*this.max.y,l=a[5]*this.max.y,u=a[6]*this.max.y,t=a[8]*this.min.z,r=a[9]*this.min.z,p=a[10]*this.min.z,z=a[8]*this.max.z,x=a[9]*this.max.z,w=a[10]*this.max.z;this.min.x=Math.min(b,
   e)+Math.min(h,q)+Math.min(t,z)+a[12];this.min.y=Math.min(c,f)+Math.min(k,l)+Math.min(r,x)+a[13];this.min.z=Math.min(d,g)+Math.min(m,u)+Math.min(p,w)+a[14];this.max.x=Math.max(b,e)+Math.max(h,q)+Math.max(t,z)+a[12];this.max.y=Math.max(c,f)+Math.max(k,l)+Math.max(r,x)+a[13];this.max.z=Math.max(d,g)+Math.max(m,u)+Math.max(p,w)+a[14];return this},translate:function(a){this.min.add(a);this.max.add(a);return this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)}});Object.assign(za.prototype,
   {set:function(a,b){this.center.copy(a);this.radius=b;return this},setFromPoints:function(){var a=new Va;return function(b,c){var d=this.center;void 0!==c?d.copy(c):a.setFromPoints(b).getCenter(d);for(var e=c=0,f=b.length;e<f;e++)c=Math.max(c,d.distanceToSquared(b[e]));this.radius=Math.sqrt(c);return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.center.copy(a.center);this.radius=a.radius;return this},empty:function(){return 0>=this.radius},containsPoint:function(a){return a.distanceToSquared(this.center)<=
   this.radius*this.radius},distanceToPoint:function(a){return a.distanceTo(this.center)-this.radius},intersectsSphere:function(a){var b=this.radius+a.radius;return a.center.distanceToSquared(this.center)<=b*b},intersectsBox:function(a){return a.intersectsSphere(this)},intersectsPlane:function(a){return Math.abs(a.distanceToPoint(this.center))<=this.radius},clampPoint:function(a,b){var c=this.center.distanceToSquared(a);void 0===b&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),
   b=new p);b.copy(a);c>this.radius*this.radius&&(b.sub(this.center).normalize(),b.multiplyScalar(this.radius).add(this.center));return b},getBoundingBox:function(a){void 0===a&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),a=new Va);a.set(this.center,this.center);a.expandByScalar(this.radius);return a},applyMatrix4:function(a){this.center.applyMatrix4(a);this.radius*=a.getMaxScaleOnAxis();return this},translate:function(a){this.center.add(a);return this},equals:function(a){return a.center.equals(this.center)&&
   a.radius===this.radius}});Object.assign(Pa.prototype,{set:function(a,b){this.normal.copy(a);this.constant=b;return this},setComponents:function(a,b,c,d){this.normal.set(a,b,c);this.constant=d;return this},setFromNormalAndCoplanarPoint:function(a,b){this.normal.copy(a);this.constant=-b.dot(this.normal);return this},setFromCoplanarPoints:function(){var a=new p,b=new p;return function(c,d,e){d=a.subVectors(e,d).cross(b.subVectors(c,d)).normalize();this.setFromNormalAndCoplanarPoint(d,c);return this}}(),
   clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.normal.copy(a.normal);this.constant=a.constant;return this},normalize:function(){var a=1/this.normal.length();this.normal.multiplyScalar(a);this.constant*=a;return this},negate:function(){this.constant*=-1;this.normal.negate();return this},distanceToPoint:function(a){return this.normal.dot(a)+this.constant},distanceToSphere:function(a){return this.distanceToPoint(a.center)-a.radius},projectPoint:function(a,b){void 0===
   b&&(console.warn("THREE.Plane: .projectPoint() target is now required"),b=new p);return b.copy(this.normal).multiplyScalar(-this.distanceToPoint(a)).add(a)},intersectLine:function(){var a=new p;return function(b,c){void 0===c&&(console.warn("THREE.Plane: .intersectLine() target is now required"),c=new p);var d=b.delta(a),e=this.normal.dot(d);if(0===e){if(0===this.distanceToPoint(b.start))return c.copy(b.start)}else if(e=-(b.start.dot(this.normal)+this.constant)/e,!(0>e||1<e))return c.copy(d).multiplyScalar(e).add(b.start)}}(),
   intersectsLine:function(a){var b=this.distanceToPoint(a.start);a=this.distanceToPoint(a.end);return 0>b&&0<a||0>a&&0<b},intersectsBox:function(a){return a.intersectsPlane(this)},intersectsSphere:function(a){return a.intersectsPlane(this)},coplanarPoint:function(a){void 0===a&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),a=new p);return a.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var a=new p,b=new la;return function(c,d){d=d||b.getNormalMatrix(c);
   c=this.coplanarPoint(a).applyMatrix4(c);d=this.normal.applyMatrix3(d).normalize();this.constant=-c.dot(d);return this}}(),translate:function(a){this.constant-=a.dot(this.normal);return this},equals:function(a){return a.normal.equals(this.normal)&&a.constant===this.constant}});Object.assign(ld.prototype,{set:function(a,b,c,d,e,f){var g=this.planes;g[0].copy(a);g[1].copy(b);g[2].copy(c);g[3].copy(d);g[4].copy(e);g[5].copy(f);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){for(var b=
   this.planes,c=0;6>c;c++)b[c].copy(a.planes[c]);return this},setFromMatrix:function(a){var b=this.planes,c=a.elements;a=c[0];var d=c[1],e=c[2],f=c[3],g=c[4],h=c[5],k=c[6],m=c[7],l=c[8],n=c[9],u=c[10],t=c[11],r=c[12],p=c[13],z=c[14];c=c[15];b[0].setComponents(f-a,m-g,t-l,c-r).normalize();b[1].setComponents(f+a,m+g,t+l,c+r).normalize();b[2].setComponents(f+d,m+h,t+n,c+p).normalize();b[3].setComponents(f-d,m-h,t-n,c-p).normalize();b[4].setComponents(f-e,m-k,t-u,c-z).normalize();b[5].setComponents(f+e,
   m+k,t+u,c+z).normalize();return this},intersectsObject:function(){var a=new za;return function(b){var c=b.geometry;null===c.boundingSphere&&c.computeBoundingSphere();a.copy(c.boundingSphere).applyMatrix4(b.matrixWorld);return this.intersectsSphere(a)}}(),intersectsSprite:function(){var a=new za;return function(b){a.center.set(0,0,0);a.radius=.7071067811865476;a.applyMatrix4(b.matrixWorld);return this.intersectsSphere(a)}}(),intersectsSphere:function(a){var b=this.planes,c=a.center;a=-a.radius;for(var d=
   0;6>d;d++)if(b[d].distanceToPoint(c)<a)return!1;return!0},intersectsBox:function(){var a=new p;return function(b){for(var c=this.planes,d=0;6>d;d++){var e=c[d];a.x=0<e.normal.x?b.max.x:b.min.x;a.y=0<e.normal.y?b.max.y:b.min.y;a.z=0<e.normal.z?b.max.z:b.min.z;if(0>e.distanceToPoint(a))return!1}return!0}}(),containsPoint:function(a){for(var b=this.planes,c=0;6>c;c++)if(0>b[c].distanceToPoint(a))return!1;return!0}});var R={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",
   alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",
   aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"\nvec3 transformed = vec3( position );\n",beginnormal_vertex:"\nvec3 objectNormal = vec3( normal );\n",bsdfs:"float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t}\n\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",
   bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",
   clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif\n",
   clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",
   color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\n",
   cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV( sampler2D envMap, vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",
   defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",
   emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",encodings_fragment:"  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM            = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat D      = max( maxRange / maxRGB, 1.0 );\n\tD            = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract(Le);\n\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max(vRGB, 0.0), 1.0 );\n}\n",
   envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",
   envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",
   envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent ));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",
   envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",
   fog_vertex:"\n#ifdef USE_FOG\nfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n  varying float fogDepth;\n#endif\n",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n",
   gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",
   lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",
   lights_pars_begin:"uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n",
   lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",
   lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",
   lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",
   lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearCoatRadiance = vec3( 0.0 );\n#endif\n",
   lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t#ifndef STANDARD\n\t\tclearCoatRadiance += getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t#endif\n#endif\n",
   lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",
   logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif\n",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",
   map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",map_particle_fragment:"#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif\n",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n",
   metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",
   morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",
   normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n#endif\n",normal_fragment_maps:"#ifdef USE_NORMALMAP\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t#ifdef FLIP_SIDED\n\t\t\tnormal = - normal;\n\t\t#endif\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\tnormal = normalize( normalMatrix * normal );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",
   normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tuniform mat3 normalMatrix;\n\t#else\n\t\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\t\tvec2 st0 = dFdx( vUv.st );\n\t\t\tvec2 st1 = dFdy( vUv.st );\n\t\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\t\tvec3 N = normalize( surf_norm );\n\t\t\tmat3 tsn = mat3( S, T, N );\n\t\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t\tmapN.xy *= normalScale;\n\t\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\treturn normalize( tsn * mapN );\n\t\t}\n\t#endif\n#endif\n",
   packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",
   premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n",dithering_fragment:"#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n",
   roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",
   shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",
   shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",
   shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",
   skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",
   skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif\n",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",
   specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",tonemapping_pars_fragment:"#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",
   uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\n",
   uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",
   uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif\n",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",
   cube_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}\n",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",
   depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",
   distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}\n",
   distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}\n",
   equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",equirect_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",
   linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",
   linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n",
   meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",
   meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n",
   meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",
   meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",
   meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",
   meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",
   meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",
   meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",
   normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n",
   normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",
   points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",
   points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}\n",
   shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}\n",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",
   sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",
   sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tvec4 mvPosition;\n\tmvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n"},
   Ea={merge:function(a){for(var b={},c=0;c<a.length;c++){var d=this.clone(a[c]),e;for(e in d)b[e]=d[e]}return b},clone:function(a){var b={},c;for(c in a){b[c]={};for(var d in a[c]){var e=a[c][d];e&&(e.isColor||e.isMatrix3||e.isMatrix4||e.isVector2||e.isVector3||e.isVector4||e.isTexture)?b[c][d]=e.clone():Array.isArray(e)?b[c][d]=e.slice():b[c][d]=e}}return b}},$g={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,
   blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,
   darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,
   lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,
   mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,
   rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},G=function(){function a(a,
   c,d){this.isColor=!0;this.r=this.g=this.b=1;return void 0===c&&void 0===d?this.set(a):this.setRGB(a,c,d)}a.prototype.add=function(a){this.r+=a.r;this.g+=a.g;this.b+=a.b;return this};a.prototype.addColors=function(a,c){this.r=a.r+c.r;this.g=a.g+c.g;this.b=a.b+c.b;return this};a.prototype.addScalar=function(a){this.r+=a;this.g+=a;this.b+=a;return this};a.prototype.clone=function(){return new a(this.r,this.g,this.b)};a.prototype.convertGammaToLinear=function(a){this.copyGammaToLinear(this,a);return this};
   a.prototype.convertLinearToGamma=function(a){this.copyLinearToGamma(this,a);return this};a.prototype.convertLinearToSRGB=function(){this.copyLinearToSRGB(this);return this};a.prototype.convertSRGBToLinear=function(){this.copySRGBToLinear(this);return this};a.prototype.copy=function(a){Array.isArray(a)&&(a=a[0]);this.r=a.r;this.g=a.g;this.b=a.b;return this};a.prototype.copyGammaToLinear=function(a,c){void 0===c&&(c=2);this.r=Math.pow(a.r,c);this.g=Math.pow(a.g,c);this.b=Math.pow(a.b,c);return this};
   a.prototype.copyLinearToGamma=function(a,c){void 0===c&&(c=2);c=0<c?1/c:1;this.r=Math.pow(a.r,c);this.g=Math.pow(a.g,c);this.b=Math.pow(a.b,c);return this};a.prototype.copyLinearToSRGB=function(a){this.r=this.LinearToSRGB(a.r);this.g=this.LinearToSRGB(a.g);this.b=this.LinearToSRGB(a.b);return this};a.prototype.copySRGBToLinear=function(a){this.r=this.SRGBToLinear(a.r);this.g=this.SRGBToLinear(a.g);this.b=this.SRGBToLinear(a.b);return this};a.prototype.equals=function(a){return a.r===this.r&&a.g===
   this.g&&a.b===this.b};a.prototype.fromArray=function(a,c){void 0===c&&(c=0);this.r=a[c];this.g=a[c+1];this.b=a[c+2];return this};a.prototype.getHSL=function(a){void 0===a&&(a={h:0,s:0,l:0});var b=this.r,d=this.g,e=this.b,f=Math.max(b,d,e),g=Math.min(b,d,e),h,k=(g+f)/2;if(g===f)g=h=0;else{var m=f-g;g=.5>=k?m/(f+g):m/(2-f-g);switch(f){case b:h=(d-e)/m+(d<e?6:0);break;case d:h=(e-b)/m+2;break;case e:h=(b-d)/m+4}h/=6}a.h=h;a.s=g;a.l=k;return a};a.prototype.getHex=function(){return 255*this.r<<16^255*
   this.g<<8^255*this.b<<0};a.prototype.getHexString=function(){return("000000"+this.getHex().toString(16)).slice(-6)};a.prototype.getStyle=function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"};a.prototype.lerp=function(a,c){this.r+=(a.r-this.r)*c;this.g+=(a.g-this.g)*c;this.b+=(a.b-this.b)*c;return this};a.prototype.multiply=function(a){this.r*=a.r;this.g*=a.g;this.b*=a.b;return this};a.prototype.multiplyScalar=function(a){this.r*=a;this.g*=a;this.b*=a;return this};a.prototype.offsetHSL=
   function(a,c,d){this.getHSL(this._hsl);this._hsl.h+=a;this._hsl.s+=c;this._hsl.l+=d;this.setHSL(this._hsl.h,this._hsl.s,this._hsl.l);return this};a.prototype.set=function(a){a&&a.isColor?this.copy(a):"number"===typeof a?this.setHex(a):"string"===typeof a&&this.setStyle(a);return this};a.prototype.setHSL=function(a,c,d){a=Q.euclideanModulo(a,1);c=Q.clamp(c,0,1);d=Q.clamp(d,0,1);0===c?this.r=this.g=this.b=d:(c=.5>=d?d*(1+c):d+c-d*c,d=2*d-c,this.r=this.hue2rgb(d,c,a+1/3),this.g=this.hue2rgb(d,c,a),this.b=
   this.hue2rgb(d,c,a-1/3));return this};a.prototype.setHex=function(a){a=Math.floor(a);this.r=(a>>16&255)/255;this.g=(a>>8&255)/255;this.b=(a&255)/255;return this};a.prototype.setRGB=function(a,c,d){this.r=a;this.g=c;this.b=d;return this};a.prototype.setScalar=function(a){this.b=this.g=this.r=a;return this};a.prototype.setStyle=function(a){var b;if(b=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(a)){var d=b[2];switch(b[1]){case "rgb":case "rgba":if(b=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(d))return this.r=
   Math.min(255,parseInt(b[1],10))/255,this.g=Math.min(255,parseInt(b[2],10))/255,this.b=Math.min(255,parseInt(b[3],10))/255,this;if(b=/^(\d+)%\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(d))return this.r=Math.min(100,parseInt(b[1],10))/100,this.g=Math.min(100,parseInt(b[2],10))/100,this.b=Math.min(100,parseInt(b[3],10))/100,this;break;case "hsl":case "hsla":if(b=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(d))return a=parseFloat(b[1])/360,d=parseInt(b[2],
   10)/100,b=parseInt(b[3],10)/100,this.setHSL(a,d,b)}}else if(b=/^#([A-Fa-f0-9]+)$/.exec(a)){b=b[1];d=b.length;if(3===d)return this.r=parseInt(b.charAt(0)+b.charAt(0),16)/255,this.g=parseInt(b.charAt(1)+b.charAt(1),16)/255,this.b=parseInt(b.charAt(2)+b.charAt(2),16)/255,this;if(6===d)return this.r=parseInt(b.charAt(0)+b.charAt(1),16)/255,this.g=parseInt(b.charAt(2)+b.charAt(3),16)/255,this.b=parseInt(b.charAt(4)+b.charAt(5),16)/255,this}a&&0<a.length&&(b=$g[a],void 0!==b?this.setHex(b):console.warn("THREE.Color: Unknown color "+
   a));return this};a.prototype.sub=function(a){this.r=Math.max(0,this.r-a.r);this.g=Math.max(0,this.g-a.g);this.b=Math.max(0,this.b-a.b);return this};a.prototype.toArray=function(a,c){void 0===a&&(a=[]);void 0===c&&(c=0);a[c]=this.r;a[c+1]=this.g;a[c+2]=this.b;return a};a.prototype.toJSON=function(){return this.getHex()};a.prototype.LinearToSRGB=function(a){return.0031308>a?12.92*a:1.055*Math.pow(a,.41666)-.055};a.prototype.SRGBToLinear=function(a){return.04045>a?.0773993808*a:Math.pow(.9478672986*
   a+.0521327014,2.4)};a.prototype.hue2rgb=function(a,c,d){0>d&&(d+=1);1<d&&--d;return d<1/6?a+6*(c-a)*d:.5>d?c:d<2/3?a+6*(c-a)*(2/3-d):a};return a}(),I={common:{diffuse:{value:new G(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new la},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},
   lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new C(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:2.5E-4},fogNear:{value:1},fogFar:{value:2E3},fogColor:{value:new G(16777215)}},
   lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},
   decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new G(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new la}},sprite:{diffuse:{value:new G(15658734)},
   opacity:{value:1},center:{value:new C(.5,.5)},rotation:{value:0},map:{value:null},uvTransform:{value:new la}}},rb={basic:{uniforms:Ea.merge([I.common,I.specularmap,I.envmap,I.aomap,I.lightmap,I.fog]),vertexShader:R.meshbasic_vert,fragmentShader:R.meshbasic_frag},lambert:{uniforms:Ea.merge([I.common,I.specularmap,I.envmap,I.aomap,I.lightmap,I.emissivemap,I.fog,I.lights,{emissive:{value:new G(0)}}]),vertexShader:R.meshlambert_vert,fragmentShader:R.meshlambert_frag},phong:{uniforms:Ea.merge([I.common,
   I.specularmap,I.envmap,I.aomap,I.lightmap,I.emissivemap,I.bumpmap,I.normalmap,I.displacementmap,I.gradientmap,I.fog,I.lights,{emissive:{value:new G(0)},specular:{value:new G(1118481)},shininess:{value:30}}]),vertexShader:R.meshphong_vert,fragmentShader:R.meshphong_frag},standard:{uniforms:Ea.merge([I.common,I.envmap,I.aomap,I.lightmap,I.emissivemap,I.bumpmap,I.normalmap,I.displacementmap,I.roughnessmap,I.metalnessmap,I.fog,I.lights,{emissive:{value:new G(0)},roughness:{value:.5},metalness:{value:.5},
   envMapIntensity:{value:1}}]),vertexShader:R.meshphysical_vert,fragmentShader:R.meshphysical_frag},points:{uniforms:Ea.merge([I.points,I.fog]),vertexShader:R.points_vert,fragmentShader:R.points_frag},dashed:{uniforms:Ea.merge([I.common,I.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:R.linedashed_vert,fragmentShader:R.linedashed_frag},depth:{uniforms:Ea.merge([I.common,I.displacementmap]),vertexShader:R.depth_vert,fragmentShader:R.depth_frag},normal:{uniforms:Ea.merge([I.common,
   I.bumpmap,I.normalmap,I.displacementmap,{opacity:{value:1}}]),vertexShader:R.normal_vert,fragmentShader:R.normal_frag},sprite:{uniforms:Ea.merge([I.sprite,I.fog]),vertexShader:R.sprite_vert,fragmentShader:R.sprite_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:R.cube_vert,fragmentShader:R.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:R.equirect_vert,fragmentShader:R.equirect_frag},distanceRGBA:{uniforms:Ea.merge([I.common,I.displacementmap,
   {referencePosition:{value:new p},nearDistance:{value:1},farDistance:{value:1E3}}]),vertexShader:R.distanceRGBA_vert,fragmentShader:R.distanceRGBA_frag},shadow:{uniforms:Ea.merge([I.lights,I.fog,{color:{value:new G(0)},opacity:{value:1}}]),vertexShader:R.shadow_vert,fragmentShader:R.shadow_frag}};rb.physical={uniforms:Ea.merge([rb.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:R.meshphysical_vert,fragmentShader:R.meshphysical_frag};Object.assign(ca.prototype,{isVector4:!0,
   set:function(a,b,c,d){this.x=a;this.y=b;this.z=c;this.w=d;return this},setScalar:function(a){this.w=this.z=this.y=this.x=a;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setW:function(a){this.w=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;case 3:this.w=b;break;default:throw Error("index is out of range: "+a);}return this},getComponent:function(a){switch(a){case 0:return this.x;
   case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+a);}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=void 0!==a.w?a.w:1;return this},add:function(a,b){if(void 0!==b)return console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;this.w+=a.w;return this},
   addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;this.w+=a;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;this.w=a.w+b.w;return this},addScaledVector:function(a,b){this.x+=a.x*b;this.y+=a.y*b;this.z+=a.z*b;this.w+=a.w*b;return this},sub:function(a,b){if(void 0!==b)return console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;this.w-=a.w;return this},subScalar:function(a){this.x-=
   a;this.y-=a;this.z-=a;this.w-=a;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;this.w=a.w-b.w;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=a;this.w*=a;return this},applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z,e=this.w;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d+a[12]*e;this.y=a[1]*b+a[5]*c+a[9]*d+a[13]*e;this.z=a[2]*b+a[6]*c+a[10]*d+a[14]*e;this.w=a[3]*b+a[7]*c+a[11]*d+a[15]*e;return this},divideScalar:function(a){return this.multiplyScalar(1/
   a)},setAxisAngleFromQuaternion:function(a){this.w=2*Math.acos(a.w);var b=Math.sqrt(1-a.w*a.w);1E-4>b?(this.x=1,this.z=this.y=0):(this.x=a.x/b,this.y=a.y/b,this.z=a.z/b);return this},setAxisAngleFromRotationMatrix:function(a){a=a.elements;var b=a[0];var c=a[4];var d=a[8],e=a[1],f=a[5],g=a[9];var h=a[2];var k=a[6];var m=a[10];if(.01>Math.abs(c-e)&&.01>Math.abs(d-h)&&.01>Math.abs(g-k)){if(.1>Math.abs(c+e)&&.1>Math.abs(d+h)&&.1>Math.abs(g+k)&&.1>Math.abs(b+f+m-3))return this.set(1,0,0,0),this;a=Math.PI;
   b=(b+1)/2;f=(f+1)/2;m=(m+1)/2;c=(c+e)/4;d=(d+h)/4;g=(g+k)/4;b>f&&b>m?.01>b?(k=0,c=h=.707106781):(k=Math.sqrt(b),h=c/k,c=d/k):f>m?.01>f?(k=.707106781,h=0,c=.707106781):(h=Math.sqrt(f),k=c/h,c=g/h):.01>m?(h=k=.707106781,c=0):(c=Math.sqrt(m),k=d/c,h=g/c);this.set(k,h,c,a);return this}a=Math.sqrt((k-g)*(k-g)+(d-h)*(d-h)+(e-c)*(e-c));.001>Math.abs(a)&&(a=1);this.x=(k-g)/a;this.y=(d-h)/a;this.z=(e-c)/a;this.w=Math.acos((b+f+m-1)/2);return this},min:function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,
   a.y);this.z=Math.min(this.z,a.z);this.w=Math.min(this.w,a.w);return this},max:function(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);this.z=Math.max(this.z,a.z);this.w=Math.max(this.w,a.w);return this},clamp:function(a,b){this.x=Math.max(a.x,Math.min(b.x,this.x));this.y=Math.max(a.y,Math.min(b.y,this.y));this.z=Math.max(a.z,Math.min(b.z,this.z));this.w=Math.max(a.w,Math.min(b.w,this.w));return this},clampScalar:function(){var a,b;return function(c,d){void 0===a&&(a=new ca,b=new ca);a.set(c,
   c,c,c);b.set(d,d,d,d);return this.clamp(a,b)}}(),clampLength:function(a,b){var c=this.length();return this.divideScalar(c||1).multiplyScalar(Math.max(a,Math.min(b,c)))},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);this.w=Math.floor(this.w);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);this.w=Math.ceil(this.w);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);
   this.z=Math.round(this.z);this.w=Math.round(this.w);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z);this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;this.w=-this.w;return this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w},lengthSq:function(){return this.x*
   this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(a){return this.normalize().multiplyScalar(a)},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;this.w+=(a.w-this.w)*b;return this},lerpVectors:function(a,
   b,c){return this.subVectors(b,a).multiplyScalar(c).add(a)},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&a.w===this.w},fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+1];this.z=a[b+2];this.w=a[b+3];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this.x;a[b+1]=this.y;a[b+2]=this.z;a[b+3]=this.w;return a},fromBufferAttribute:function(a,b,c){void 0!==c&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute().");
   this.x=a.getX(b);this.y=a.getY(b);this.z=a.getZ(b);this.w=a.getW(b);return this}});lb.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" ");lb.DefaultOrder="XYZ";Object.defineProperties(lb.prototype,{x:{get:function(){return this._x},set:function(a){this._x=a;this.onChangeCallback()}},y:{get:function(){return this._y},set:function(a){this._y=a;this.onChangeCallback()}},z:{get:function(){return this._z},set:function(a){this._z=a;this.onChangeCallback()}},order:{get:function(){return this._order},set:function(a){this._order=
   a;this.onChangeCallback()}}});Object.assign(lb.prototype,{isEuler:!0,set:function(a,b,c,d){this._x=a;this._y=b;this._z=c;this._order=d||this._order;this.onChangeCallback();return this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(a){this._x=a._x;this._y=a._y;this._z=a._z;this._order=a._order;this.onChangeCallback();return this},setFromRotationMatrix:function(a,b,c){var d=Q.clamp,e=a.elements;a=e[0];var f=e[4],g=e[8],h=e[1],k=e[5],m=e[9],l=e[2],n=
   e[6];e=e[10];b=b||this._order;"XYZ"===b?(this._y=Math.asin(d(g,-1,1)),.99999>Math.abs(g)?(this._x=Math.atan2(-m,e),this._z=Math.atan2(-f,a)):(this._x=Math.atan2(n,k),this._z=0)):"YXZ"===b?(this._x=Math.asin(-d(m,-1,1)),.99999>Math.abs(m)?(this._y=Math.atan2(g,e),this._z=Math.atan2(h,k)):(this._y=Math.atan2(-l,a),this._z=0)):"ZXY"===b?(this._x=Math.asin(d(n,-1,1)),.99999>Math.abs(n)?(this._y=Math.atan2(-l,e),this._z=Math.atan2(-f,k)):(this._y=0,this._z=Math.atan2(h,a))):"ZYX"===b?(this._y=Math.asin(-d(l,
   -1,1)),.99999>Math.abs(l)?(this._x=Math.atan2(n,e),this._z=Math.atan2(h,a)):(this._x=0,this._z=Math.atan2(-f,k))):"YZX"===b?(this._z=Math.asin(d(h,-1,1)),.99999>Math.abs(h)?(this._x=Math.atan2(-m,k),this._y=Math.atan2(-l,a)):(this._x=0,this._y=Math.atan2(g,e))):"XZY"===b?(this._z=Math.asin(-d(f,-1,1)),.99999>Math.abs(f)?(this._x=Math.atan2(n,k),this._y=Math.atan2(g,a)):(this._x=Math.atan2(-m,e),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+b);this._order=
   b;if(!1!==c)this.onChangeCallback();return this},setFromQuaternion:function(){var a=new M;return function(b,c,d){a.makeRotationFromQuaternion(b);return this.setFromRotationMatrix(a,c,d)}}(),setFromVector3:function(a,b){return this.set(a.x,a.y,a.z,b||this._order)},reorder:function(){var a=new ia;return function(b){a.setFromEuler(this);return this.setFromQuaternion(a,b)}}(),equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._order===this._order},fromArray:function(a){this._x=
   a[0];this._y=a[1];this._z=a[2];void 0!==a[3]&&(this._order=a[3]);this.onChangeCallback();return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this._x;a[b+1]=this._y;a[b+2]=this._z;a[b+3]=this._order;return a},toVector3:function(a){return a?a.set(this._x,this._y,this._z):new p(this._x,this._y,this._z)},onChange:function(a){this.onChangeCallback=a;return this},onChangeCallback:function(){}});Object.assign(Rd.prototype,{set:function(a){this.mask=1<<a|0},enable:function(a){this.mask=
   this.mask|1<<a|0},toggle:function(a){this.mask^=1<<a|0},disable:function(a){this.mask&=~(1<<a|0)},test:function(a){return 0!==(this.mask&a.mask)}});var Hf=0;B.DefaultUp=new p(0,1,0);B.DefaultMatrixAutoUpdate=!0;B.prototype=Object.assign(Object.create(ib.prototype),{constructor:B,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(a){this.matrix.multiplyMatrices(a,this.matrix);this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(a){this.quaternion.premultiply(a);
   return this},setRotationFromAxisAngle:function(a,b){this.quaternion.setFromAxisAngle(a,b)},setRotationFromEuler:function(a){this.quaternion.setFromEuler(a,!0)},setRotationFromMatrix:function(a){this.quaternion.setFromRotationMatrix(a)},setRotationFromQuaternion:function(a){this.quaternion.copy(a)},rotateOnAxis:function(){var a=new ia;return function(b,c){a.setFromAxisAngle(b,c);this.quaternion.multiply(a);return this}}(),rotateOnWorldAxis:function(){var a=new ia;return function(b,c){a.setFromAxisAngle(b,
   c);this.quaternion.premultiply(a);return this}}(),rotateX:function(){var a=new p(1,0,0);return function(b){return this.rotateOnAxis(a,b)}}(),rotateY:function(){var a=new p(0,1,0);return function(b){return this.rotateOnAxis(a,b)}}(),rotateZ:function(){var a=new p(0,0,1);return function(b){return this.rotateOnAxis(a,b)}}(),translateOnAxis:function(){var a=new p;return function(b,c){a.copy(b).applyQuaternion(this.quaternion);this.position.add(a.multiplyScalar(c));return this}}(),translateX:function(){var a=
   new p(1,0,0);return function(b){return this.translateOnAxis(a,b)}}(),translateY:function(){var a=new p(0,1,0);return function(b){return this.translateOnAxis(a,b)}}(),translateZ:function(){var a=new p(0,0,1);return function(b){return this.translateOnAxis(a,b)}}(),localToWorld:function(a){return a.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var a=new M;return function(b){return b.applyMatrix4(a.getInverse(this.matrixWorld))}}(),lookAt:function(){var a=new M,b=new p;return function(c,d,e){c.isVector3?
   b.copy(c):b.set(c,d,e);this.isCamera?a.lookAt(this.position,b,this.up):a.lookAt(b,this.position,this.up);this.quaternion.setFromRotationMatrix(a)}}(),add:function(a){if(1<arguments.length){for(var b=0;b<arguments.length;b++)this.add(arguments[b]);return this}if(a===this)return console.error("THREE.Object3D.add: object can't be added as a child of itself.",a),this;a&&a.isObject3D?(null!==a.parent&&a.parent.remove(a),a.parent=this,a.dispatchEvent({type:"added"}),this.children.push(a)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",
   a);return this},remove:function(a){if(1<arguments.length){for(var b=0;b<arguments.length;b++)this.remove(arguments[b]);return this}b=this.children.indexOf(a);-1!==b&&(a.parent=null,a.dispatchEvent({type:"removed"}),this.children.splice(b,1));return this},getObjectById:function(a){return this.getObjectByProperty("id",a)},getObjectByName:function(a){return this.getObjectByProperty("name",a)},getObjectByProperty:function(a,b){if(this[a]===b)return this;for(var c=0,d=this.children.length;c<d;c++){var e=
   this.children[c].getObjectByProperty(a,b);if(void 0!==e)return e}},getWorldPosition:function(a){void 0===a&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),a=new p);this.updateMatrixWorld(!0);return a.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var a=new p,b=new p;return function(c){void 0===c&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),c=new ia);this.updateMatrixWorld(!0);this.matrixWorld.decompose(a,c,b);return c}}(),
   getWorldScale:function(){var a=new p,b=new ia;return function(c){void 0===c&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),c=new p);this.updateMatrixWorld(!0);this.matrixWorld.decompose(a,b,c);return c}}(),getWorldDirection:function(){var a=new ia;return function(b){void 0===b&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),b=new p);this.getWorldQuaternion(a);return b.set(0,0,1).applyQuaternion(a)}}(),raycast:function(){},traverse:function(a){a(this);
   for(var b=this.children,c=0,d=b.length;c<d;c++)b[c].traverse(a)},traverseVisible:function(a){if(!1!==this.visible){a(this);for(var b=this.children,c=0,d=b.length;c<d;c++)b[c].traverseVisible(a)}},traverseAncestors:function(a){var b=this.parent;null!==b&&(a(b),b.traverseAncestors(a))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(a){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||
   a)null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,a=!0;for(var b=this.children,c=0,d=b.length;c<d;c++)b[c].updateMatrixWorld(a)},toJSON:function(a){function b(b,c){void 0===b[c.uuid]&&(b[c.uuid]=c.toJSON(a));return c.uuid}function c(a){var b=[],c;for(c in a){var d=a[c];delete d.metadata;b.push(d)}return b}var d=void 0===a||"string"===typeof a,e={};d&&(a={geometries:{},materials:{},textures:{},
   images:{},shapes:{}},e.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var f={};f.uuid=this.uuid;f.type=this.type;""!==this.name&&(f.name=this.name);!0===this.castShadow&&(f.castShadow=!0);!0===this.receiveShadow&&(f.receiveShadow=!0);!1===this.visible&&(f.visible=!1);!1===this.frustumCulled&&(f.frustumCulled=!1);0!==this.renderOrder&&(f.renderOrder=this.renderOrder);"{}"!==JSON.stringify(this.userData)&&(f.userData=this.userData);f.layers=this.layers.mask;f.matrix=this.matrix.toArray();
   !1===this.matrixAutoUpdate&&(f.matrixAutoUpdate=!1);if(this.isMesh||this.isLine||this.isPoints){f.geometry=b(a.geometries,this.geometry);var g=this.geometry.parameters;if(void 0!==g&&void 0!==g.shapes)if(g=g.shapes,Array.isArray(g))for(var h=0,k=g.length;h<k;h++)b(a.shapes,g[h]);else b(a.shapes,g)}if(void 0!==this.material)if(Array.isArray(this.material)){g=[];h=0;for(k=this.material.length;h<k;h++)g.push(b(a.materials,this.material[h]));f.material=g}else f.material=b(a.materials,this.material);if(0<
   this.children.length)for(f.children=[],h=0;h<this.children.length;h++)f.children.push(this.children[h].toJSON(a).object);if(d){d=c(a.geometries);h=c(a.materials);k=c(a.textures);var m=c(a.images);g=c(a.shapes);0<d.length&&(e.geometries=d);0<h.length&&(e.materials=h);0<k.length&&(e.textures=k);0<m.length&&(e.images=m);0<g.length&&(e.shapes=g)}e.object=f;return e},clone:function(a){return(new this.constructor).copy(this,a)},copy:function(a,b){void 0===b&&(b=!0);this.name=a.name;this.up.copy(a.up);this.position.copy(a.position);
   this.quaternion.copy(a.quaternion);this.scale.copy(a.scale);this.matrix.copy(a.matrix);this.matrixWorld.copy(a.matrixWorld);this.matrixAutoUpdate=a.matrixAutoUpdate;this.matrixWorldNeedsUpdate=a.matrixWorldNeedsUpdate;this.layers.mask=a.layers.mask;this.visible=a.visible;this.castShadow=a.castShadow;this.receiveShadow=a.receiveShadow;this.frustumCulled=a.frustumCulled;this.renderOrder=a.renderOrder;this.userData=JSON.parse(JSON.stringify(a.userData));if(!0===b)for(b=0;b<a.children.length;b++)this.add(a.children[b].clone());
   return this}});Qa.prototype=Object.assign(Object.create(B.prototype),{constructor:Qa,isCamera:!0,copy:function(a,b){B.prototype.copy.call(this,a,b);this.matrixWorldInverse.copy(a.matrixWorldInverse);this.projectionMatrix.copy(a.projectionMatrix);return this},getWorldDirection:function(){var a=new ia;return function(b){void 0===b&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),b=new p);this.getWorldQuaternion(a);return b.set(0,0,-1).applyQuaternion(a)}}(),updateMatrixWorld:function(a){B.prototype.updateMatrixWorld.call(this,
   a);this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}});Jb.prototype=Object.assign(Object.create(Qa.prototype),{constructor:Jb,isOrthographicCamera:!0,copy:function(a,b){Qa.prototype.copy.call(this,a,b);this.left=a.left;this.right=a.right;this.top=a.top;this.bottom=a.bottom;this.near=a.near;this.far=a.far;this.zoom=a.zoom;this.view=null===a.view?null:Object.assign({},a.view);return this},setViewOffset:function(a,b,c,d,e,f){null===this.view&&
   (this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1});this.view.enabled=!0;this.view.fullWidth=a;this.view.fullHeight=b;this.view.offsetX=c;this.view.offsetY=d;this.view.width=e;this.view.height=f;this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1);this.updateProjectionMatrix()},updateProjectionMatrix:function(){var a=(this.right-this.left)/(2*this.zoom),b=(this.top-this.bottom)/(2*this.zoom),c=(this.right+this.left)/
   2,d=(this.top+this.bottom)/2,e=c-a;c+=a;a=d+b;b=d-b;if(null!==this.view&&this.view.enabled){c=this.zoom/(this.view.width/this.view.fullWidth);b=this.zoom/(this.view.height/this.view.fullHeight);var f=(this.right-this.left)/this.view.width;d=(this.top-this.bottom)/this.view.height;e+=this.view.offsetX/c*f;c=e+this.view.width/c*f;a-=this.view.offsetY/b*d;b=a-this.view.height/b*d}this.projectionMatrix.makeOrthographic(e,c,a,b,this.near,this.far)},toJSON:function(a){a=B.prototype.toJSON.call(this,a);
   a.object.zoom=this.zoom;a.object.left=this.left;a.object.right=this.right;a.object.top=this.top;a.object.bottom=this.bottom;a.object.near=this.near;a.object.far=this.far;null!==this.view&&(a.object.view=Object.assign({},this.view));return a}});Object.assign(Wa.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.a=a.a;this.b=a.b;this.c=a.c;this.normal.copy(a.normal);this.color.copy(a.color);this.materialIndex=a.materialIndex;for(var b=0,c=a.vertexNormals.length;b<
   c;b++)this.vertexNormals[b]=a.vertexNormals[b].clone();b=0;for(c=a.vertexColors.length;b<c;b++)this.vertexColors[b]=a.vertexColors[b].clone();return this}});var If=0;K.prototype=Object.assign(Object.create(ib.prototype),{constructor:K,isGeometry:!0,applyMatrix:function(a){for(var b=(new la).getNormalMatrix(a),c=0,d=this.vertices.length;c<d;c++)this.vertices[c].applyMatrix4(a);c=0;for(d=this.faces.length;c<d;c++){a=this.faces[c];a.normal.applyMatrix3(b).normalize();for(var e=0,f=a.vertexNormals.length;e<
   f;e++)a.vertexNormals[e].applyMatrix3(b).normalize()}null!==this.boundingBox&&this.computeBoundingBox();null!==this.boundingSphere&&this.computeBoundingSphere();this.normalsNeedUpdate=this.verticesNeedUpdate=!0;return this},rotateX:function(){var a=new M;return function(b){a.makeRotationX(b);this.applyMatrix(a);return this}}(),rotateY:function(){var a=new M;return function(b){a.makeRotationY(b);this.applyMatrix(a);return this}}(),rotateZ:function(){var a=new M;return function(b){a.makeRotationZ(b);
   this.applyMatrix(a);return this}}(),translate:function(){var a=new M;return function(b,c,d){a.makeTranslation(b,c,d);this.applyMatrix(a);return this}}(),scale:function(){var a=new M;return function(b,c,d){a.makeScale(b,c,d);this.applyMatrix(a);return this}}(),lookAt:function(){var a=new B;return function(b){a.lookAt(b);a.updateMatrix();this.applyMatrix(a.matrix)}}(),fromBufferGeometry:function(a){function b(a,b,d,e){var f=void 0!==g?[l[a].clone(),l[b].clone(),l[d].clone()]:[],q=void 0!==h?[c.colors[a].clone(),
   c.colors[b].clone(),c.colors[d].clone()]:[];e=new Wa(a,b,d,f,q,e);c.faces.push(e);void 0!==k&&c.faceVertexUvs[0].push([n[a].clone(),n[b].clone(),n[d].clone()]);void 0!==m&&c.faceVertexUvs[1].push([u[a].clone(),u[b].clone(),u[d].clone()])}var c=this,d=null!==a.index?a.index.array:void 0,e=a.attributes,f=e.position.array,g=void 0!==e.normal?e.normal.array:void 0,h=void 0!==e.color?e.color.array:void 0,k=void 0!==e.uv?e.uv.array:void 0,m=void 0!==e.uv2?e.uv2.array:void 0;void 0!==m&&(this.faceVertexUvs[1]=
   []);for(var l=[],n=[],u=[],t=e=0;e<f.length;e+=3,t+=2)c.vertices.push(new p(f[e],f[e+1],f[e+2])),void 0!==g&&l.push(new p(g[e],g[e+1],g[e+2])),void 0!==h&&c.colors.push(new G(h[e],h[e+1],h[e+2])),void 0!==k&&n.push(new C(k[t],k[t+1])),void 0!==m&&u.push(new C(m[t],m[t+1]));var r=a.groups;if(0<r.length)for(e=0;e<r.length;e++){f=r[e];var v=f.start,z=f.count;t=v;for(v+=z;t<v;t+=3)void 0!==d?b(d[t],d[t+1],d[t+2],f.materialIndex):b(t,t+1,t+2,f.materialIndex)}else if(void 0!==d)for(e=0;e<d.length;e+=3)b(d[e],
   d[e+1],d[e+2]);else for(e=0;e<f.length/3;e+=3)b(e,e+1,e+2);this.computeFaceNormals();null!==a.boundingBox&&(this.boundingBox=a.boundingBox.clone());null!==a.boundingSphere&&(this.boundingSphere=a.boundingSphere.clone());return this},center:function(){var a=new p;return function(){this.computeBoundingBox();this.boundingBox.getCenter(a).negate();this.translate(a.x,a.y,a.z);return this}}(),normalize:function(){this.computeBoundingSphere();var a=this.boundingSphere.center,b=this.boundingSphere.radius;
   b=0===b?1:1/b;var c=new M;c.set(b,0,0,-b*a.x,0,b,0,-b*a.y,0,0,b,-b*a.z,0,0,0,1);this.applyMatrix(c);return this},computeFaceNormals:function(){for(var a=new p,b=new p,c=0,d=this.faces.length;c<d;c++){var e=this.faces[c],f=this.vertices[e.a],g=this.vertices[e.b];a.subVectors(this.vertices[e.c],g);b.subVectors(f,g);a.cross(b);a.normalize();e.normal.copy(a)}},computeVertexNormals:function(a){void 0===a&&(a=!0);var b;var c=Array(this.vertices.length);var d=0;for(b=this.vertices.length;d<b;d++)c[d]=new p;
   if(a){var e=new p,f=new p;a=0;for(d=this.faces.length;a<d;a++){b=this.faces[a];var g=this.vertices[b.a];var h=this.vertices[b.b];var k=this.vertices[b.c];e.subVectors(k,h);f.subVectors(g,h);e.cross(f);c[b.a].add(e);c[b.b].add(e);c[b.c].add(e)}}else for(this.computeFaceNormals(),a=0,d=this.faces.length;a<d;a++)b=this.faces[a],c[b.a].add(b.normal),c[b.b].add(b.normal),c[b.c].add(b.normal);d=0;for(b=this.vertices.length;d<b;d++)c[d].normalize();a=0;for(d=this.faces.length;a<d;a++)b=this.faces[a],g=b.vertexNormals,
   3===g.length?(g[0].copy(c[b.a]),g[1].copy(c[b.b]),g[2].copy(c[b.c])):(g[0]=c[b.a].clone(),g[1]=c[b.b].clone(),g[2]=c[b.c].clone());0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var a;this.computeFaceNormals();var b=0;for(a=this.faces.length;b<a;b++){var c=this.faces[b];var d=c.vertexNormals;3===d.length?(d[0].copy(c.normal),d[1].copy(c.normal),d[2].copy(c.normal)):(d[0]=c.normal.clone(),d[1]=c.normal.clone(),d[2]=c.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=
   !0)},computeMorphNormals:function(){var a,b;var c=0;for(b=this.faces.length;c<b;c++){var d=this.faces[c];d.__originalFaceNormal?d.__originalFaceNormal.copy(d.normal):d.__originalFaceNormal=d.normal.clone();d.__originalVertexNormals||(d.__originalVertexNormals=[]);var e=0;for(a=d.vertexNormals.length;e<a;e++)d.__originalVertexNormals[e]?d.__originalVertexNormals[e].copy(d.vertexNormals[e]):d.__originalVertexNormals[e]=d.vertexNormals[e].clone()}var f=new K;f.faces=this.faces;e=0;for(a=this.morphTargets.length;e<
   a;e++){if(!this.morphNormals[e]){this.morphNormals[e]={};this.morphNormals[e].faceNormals=[];this.morphNormals[e].vertexNormals=[];d=this.morphNormals[e].faceNormals;var g=this.morphNormals[e].vertexNormals;c=0;for(b=this.faces.length;c<b;c++){var h=new p;var k={a:new p,b:new p,c:new p};d.push(h);g.push(k)}}g=this.morphNormals[e];f.vertices=this.morphTargets[e].vertices;f.computeFaceNormals();f.computeVertexNormals();c=0;for(b=this.faces.length;c<b;c++)d=this.faces[c],h=g.faceNormals[c],k=g.vertexNormals[c],
   h.copy(d.normal),k.a.copy(d.vertexNormals[0]),k.b.copy(d.vertexNormals[1]),k.c.copy(d.vertexNormals[2])}c=0;for(b=this.faces.length;c<b;c++)d=this.faces[c],d.normal=d.__originalFaceNormal,d.vertexNormals=d.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Va);this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new za);this.boundingSphere.setFromPoints(this.vertices)},merge:function(a,
   b,c){if(a&&a.isGeometry){var d,e=this.vertices.length,f=this.vertices,g=a.vertices,h=this.faces,k=a.faces,m=this.faceVertexUvs[0],l=a.faceVertexUvs[0],n=this.colors,u=a.colors;void 0===c&&(c=0);void 0!==b&&(d=(new la).getNormalMatrix(b));a=0;for(var p=g.length;a<p;a++){var r=g[a].clone();void 0!==b&&r.applyMatrix4(b);f.push(r)}a=0;for(p=u.length;a<p;a++)n.push(u[a].clone());a=0;for(p=k.length;a<p;a++){g=k[a];var v=g.vertexNormals;u=g.vertexColors;n=new Wa(g.a+e,g.b+e,g.c+e);n.normal.copy(g.normal);
   void 0!==d&&n.normal.applyMatrix3(d).normalize();b=0;for(f=v.length;b<f;b++)r=v[b].clone(),void 0!==d&&r.applyMatrix3(d).normalize(),n.vertexNormals.push(r);n.color.copy(g.color);b=0;for(f=u.length;b<f;b++)r=u[b],n.vertexColors.push(r.clone());n.materialIndex=g.materialIndex+c;h.push(n)}a=0;for(p=l.length;a<p;a++)if(c=l[a],d=[],void 0!==c){b=0;for(f=c.length;b<f;b++)d.push(c[b].clone());m.push(d)}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",a)},mergeMesh:function(a){a&&
   a.isMesh?(a.matrixAutoUpdate&&a.updateMatrix(),this.merge(a.geometry,a.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",a)},mergeVertices:function(){var a={},b=[],c=[],d=Math.pow(10,4),e;var f=0;for(e=this.vertices.length;f<e;f++){var g=this.vertices[f];g=Math.round(g.x*d)+"_"+Math.round(g.y*d)+"_"+Math.round(g.z*d);void 0===a[g]?(a[g]=f,b.push(this.vertices[f]),c[f]=b.length-1):c[f]=c[a[g]]}a=[];f=0;for(e=this.faces.length;f<e;f++)for(d=this.faces[f],d.a=c[d.a],
   d.b=c[d.b],d.c=c[d.c],d=[d.a,d.b,d.c],g=0;3>g;g++)if(d[g]===d[(g+1)%3]){a.push(f);break}for(f=a.length-1;0<=f;f--)for(d=a[f],this.faces.splice(d,1),c=0,e=this.faceVertexUvs.length;c<e;c++)this.faceVertexUvs[c].splice(d,1);f=this.vertices.length-b.length;this.vertices=b;return f},setFromPoints:function(a){this.vertices=[];for(var b=0,c=a.length;b<c;b++){var d=a[b];this.vertices.push(new p(d.x,d.y,d.z||0))}return this},sortFacesByMaterialIndex:function(){for(var a=this.faces,b=a.length,c=0;c<b;c++)a[c]._id=
   c;a.sort(function(a,b){return a.materialIndex-b.materialIndex});var d=this.faceVertexUvs[0],e=this.faceVertexUvs[1],f,g;d&&d.length===b&&(f=[]);e&&e.length===b&&(g=[]);for(c=0;c<b;c++){var h=a[c]._id;f&&f.push(d[h]);g&&g.push(e[h])}f&&(this.faceVertexUvs[0]=f);g&&(this.faceVertexUvs[1]=g)},toJSON:function(){function a(a,b,c){return c?a|1<<b:a&~(1<<b)}function b(a){var b=a.x.toString()+a.y.toString()+a.z.toString();if(void 0!==m[b])return m[b];m[b]=k.length/3;k.push(a.x,a.y,a.z);return m[b]}function c(a){var b=
   a.r.toString()+a.g.toString()+a.b.toString();if(void 0!==n[b])return n[b];n[b]=l.length;l.push(a.getHex());return n[b]}function d(a){var b=a.x.toString()+a.y.toString();if(void 0!==p[b])return p[b];p[b]=u.length/2;u.push(a.x,a.y);return p[b]}var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};e.uuid=this.uuid;e.type=this.type;""!==this.name&&(e.name=this.name);if(void 0!==this.parameters){var f=this.parameters,g;for(g in f)void 0!==f[g]&&(e[g]=f[g]);return e}f=[];for(g=0;g<
   this.vertices.length;g++){var h=this.vertices[g];f.push(h.x,h.y,h.z)}h=[];var k=[],m={},l=[],n={},u=[],p={};for(g=0;g<this.faces.length;g++){var r=this.faces[g],v=void 0!==this.faceVertexUvs[0][g],z=0<r.normal.length(),x=0<r.vertexNormals.length,w=1!==r.color.r||1!==r.color.g||1!==r.color.b,y=0<r.vertexColors.length,H=0;H=a(H,0,0);H=a(H,1,!0);H=a(H,2,!1);H=a(H,3,v);H=a(H,4,z);H=a(H,5,x);H=a(H,6,w);H=a(H,7,y);h.push(H);h.push(r.a,r.b,r.c);h.push(r.materialIndex);v&&(v=this.faceVertexUvs[0][g],h.push(d(v[0]),
   d(v[1]),d(v[2])));z&&h.push(b(r.normal));x&&(z=r.vertexNormals,h.push(b(z[0]),b(z[1]),b(z[2])));w&&h.push(c(r.color));y&&(r=r.vertexColors,h.push(c(r[0]),c(r[1]),c(r[2])))}e.data={};e.data.vertices=f;e.data.normals=k;0<l.length&&(e.data.colors=l);0<u.length&&(e.data.uvs=[u]);e.data.faces=h;return e},clone:function(){return(new K).copy(this)},copy:function(a){var b,c,d;this.vertices=[];this.colors=[];this.faces=[];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphNormals=[];this.skinWeights=[];
   this.skinIndices=[];this.lineDistances=[];this.boundingSphere=this.boundingBox=null;this.name=a.name;var e=a.vertices;var f=0;for(b=e.length;f<b;f++)this.vertices.push(e[f].clone());e=a.colors;f=0;for(b=e.length;f<b;f++)this.colors.push(e[f].clone());e=a.faces;f=0;for(b=e.length;f<b;f++)this.faces.push(e[f].clone());f=0;for(b=a.faceVertexUvs.length;f<b;f++){var g=a.faceVertexUvs[f];void 0===this.faceVertexUvs[f]&&(this.faceVertexUvs[f]=[]);e=0;for(c=g.length;e<c;e++){var h=g[e],k=[];var m=0;for(d=
   h.length;m<d;m++)k.push(h[m].clone());this.faceVertexUvs[f].push(k)}}m=a.morphTargets;f=0;for(b=m.length;f<b;f++){d={};d.name=m[f].name;if(void 0!==m[f].vertices)for(d.vertices=[],e=0,c=m[f].vertices.length;e<c;e++)d.vertices.push(m[f].vertices[e].clone());if(void 0!==m[f].normals)for(d.normals=[],e=0,c=m[f].normals.length;e<c;e++)d.normals.push(m[f].normals[e].clone());this.morphTargets.push(d)}m=a.morphNormals;f=0;for(b=m.length;f<b;f++){d={};if(void 0!==m[f].vertexNormals)for(d.vertexNormals=[],
   e=0,c=m[f].vertexNormals.length;e<c;e++)g=m[f].vertexNormals[e],h={},h.a=g.a.clone(),h.b=g.b.clone(),h.c=g.c.clone(),d.vertexNormals.push(h);if(void 0!==m[f].faceNormals)for(d.faceNormals=[],e=0,c=m[f].faceNormals.length;e<c;e++)d.faceNormals.push(m[f].faceNormals[e].clone());this.morphNormals.push(d)}e=a.skinWeights;f=0;for(b=e.length;f<b;f++)this.skinWeights.push(e[f].clone());e=a.skinIndices;f=0;for(b=e.length;f<b;f++)this.skinIndices.push(e[f].clone());e=a.lineDistances;f=0;for(b=e.length;f<b;f++)this.lineDistances.push(e[f]);
   f=a.boundingBox;null!==f&&(this.boundingBox=f.clone());f=a.boundingSphere;null!==f&&(this.boundingSphere=f.clone());this.elementsNeedUpdate=a.elementsNeedUpdate;this.verticesNeedUpdate=a.verticesNeedUpdate;this.uvsNeedUpdate=a.uvsNeedUpdate;this.normalsNeedUpdate=a.normalsNeedUpdate;this.colorsNeedUpdate=a.colorsNeedUpdate;this.lineDistancesNeedUpdate=a.lineDistancesNeedUpdate;this.groupsNeedUpdate=a.groupsNeedUpdate;return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});Object.defineProperty(P.prototype,
   "needsUpdate",{set:function(a){!0===a&&this.version++}});Object.assign(P.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setArray:function(a){if(Array.isArray(a))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==a?a.length/this.itemSize:0;this.array=a;return this},setDynamic:function(a){this.dynamic=a;return this},copy:function(a){this.name=a.name;this.array=new a.array.constructor(a.array);this.itemSize=a.itemSize;this.count=a.count;this.normalized=
   a.normalized;this.dynamic=a.dynamic;return this},copyAt:function(a,b,c){a*=this.itemSize;c*=b.itemSize;for(var d=0,e=this.itemSize;d<e;d++)this.array[a+d]=b.array[c+d];return this},copyArray:function(a){this.array.set(a);return this},copyColorsArray:function(a){for(var b=this.array,c=0,d=0,e=a.length;d<e;d++){var f=a[d];void 0===f&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",d),f=new G);b[c++]=f.r;b[c++]=f.g;b[c++]=f.b}return this},copyVector2sArray:function(a){for(var b=
   this.array,c=0,d=0,e=a.length;d<e;d++){var f=a[d];void 0===f&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",d),f=new C);b[c++]=f.x;b[c++]=f.y}return this},copyVector3sArray:function(a){for(var b=this.array,c=0,d=0,e=a.length;d<e;d++){var f=a[d];void 0===f&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",d),f=new p);b[c++]=f.x;b[c++]=f.y;b[c++]=f.z}return this},copyVector4sArray:function(a){for(var b=this.array,c=0,d=0,e=a.length;d<e;d++){var f=
   a[d];void 0===f&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",d),f=new ca);b[c++]=f.x;b[c++]=f.y;b[c++]=f.z;b[c++]=f.w}return this},set:function(a,b){void 0===b&&(b=0);this.array.set(a,b);return this},getX:function(a){return this.array[a*this.itemSize]},setX:function(a,b){this.array[a*this.itemSize]=b;return this},getY:function(a){return this.array[a*this.itemSize+1]},setY:function(a,b){this.array[a*this.itemSize+1]=b;return this},getZ:function(a){return this.array[a*
   this.itemSize+2]},setZ:function(a,b){this.array[a*this.itemSize+2]=b;return this},getW:function(a){return this.array[a*this.itemSize+3]},setW:function(a,b){this.array[a*this.itemSize+3]=b;return this},setXY:function(a,b,c){a*=this.itemSize;this.array[a+0]=b;this.array[a+1]=c;return this},setXYZ:function(a,b,c,d){a*=this.itemSize;this.array[a+0]=b;this.array[a+1]=c;this.array[a+2]=d;return this},setXYZW:function(a,b,c,d,e){a*=this.itemSize;this.array[a+0]=b;this.array[a+1]=c;this.array[a+2]=d;this.array[a+
   3]=e;return this},onUpload:function(a){this.onUploadCallback=a;return this},clone:function(){return(new this.constructor(this.array,this.itemSize)).copy(this)}});qc.prototype=Object.create(P.prototype);qc.prototype.constructor=qc;rc.prototype=Object.create(P.prototype);rc.prototype.constructor=rc;sc.prototype=Object.create(P.prototype);sc.prototype.constructor=sc;tc.prototype=Object.create(P.prototype);tc.prototype.constructor=tc;mb.prototype=Object.create(P.prototype);mb.prototype.constructor=mb;
   uc.prototype=Object.create(P.prototype);uc.prototype.constructor=uc;nb.prototype=Object.create(P.prototype);nb.prototype.constructor=nb;A.prototype=Object.create(P.prototype);A.prototype.constructor=A;vc.prototype=Object.create(P.prototype);vc.prototype.constructor=vc;Object.assign(Ae.prototype,{computeGroups:function(a){var b=[],c=void 0;a=a.faces;for(var d=0;d<a.length;d++){var e=a[d];if(e.materialIndex!==c){c=e.materialIndex;void 0!==f&&(f.count=3*d-f.start,b.push(f));var f={start:3*d,materialIndex:c}}}void 0!==
   f&&(f.count=3*d-f.start,b.push(f));this.groups=b},fromGeometry:function(a){var b=a.faces,c=a.vertices,d=a.faceVertexUvs,e=d[0]&&0<d[0].length,f=d[1]&&0<d[1].length,g=a.morphTargets,h=g.length;if(0<h){var k=[];for(var m=0;m<h;m++)k[m]=[];this.morphTargets.position=k}var l=a.morphNormals,n=l.length;if(0<n){var u=[];for(m=0;m<n;m++)u[m]=[];this.morphTargets.normal=u}var p=a.skinIndices,r=a.skinWeights,v=p.length===c.length,z=r.length===c.length;0<c.length&&0===b.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");
   for(m=0;m<b.length;m++){var x=b[m];this.vertices.push(c[x.a],c[x.b],c[x.c]);var w=x.vertexNormals;3===w.length?this.normals.push(w[0],w[1],w[2]):(w=x.normal,this.normals.push(w,w,w));w=x.vertexColors;3===w.length?this.colors.push(w[0],w[1],w[2]):(w=x.color,this.colors.push(w,w,w));!0===e&&(w=d[0][m],void 0!==w?this.uvs.push(w[0],w[1],w[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",m),this.uvs.push(new C,new C,new C)));!0===f&&(w=d[1][m],void 0!==w?this.uvs2.push(w[0],
   w[1],w[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",m),this.uvs2.push(new C,new C,new C)));for(w=0;w<h;w++){var y=g[w].vertices;k[w].push(y[x.a],y[x.b],y[x.c])}for(w=0;w<n;w++)y=l[w].vertexNormals[m],u[w].push(y.a,y.b,y.c);v&&this.skinIndices.push(p[x.a],p[x.b],p[x.c]);z&&this.skinWeights.push(r[x.a],r[x.b],r[x.c])}this.computeGroups(a);this.verticesNeedUpdate=a.verticesNeedUpdate;this.normalsNeedUpdate=a.normalsNeedUpdate;this.colorsNeedUpdate=a.colorsNeedUpdate;
   this.uvsNeedUpdate=a.uvsNeedUpdate;this.groupsNeedUpdate=a.groupsNeedUpdate;return this}});var Jf=1;E.prototype=Object.assign(Object.create(ib.prototype),{constructor:E,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(a){Array.isArray(a)?this.index=new (65535<Be(a)?nb:mb)(a,1):this.index=a},addAttribute:function(a,b,c){if(!(b&&b.isBufferAttribute||b&&b.isInterleavedBufferAttribute))return console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),
   this.addAttribute(a,new P(b,c));if("index"===a)return console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(b),this;this.attributes[a]=b;return this},getAttribute:function(a){return this.attributes[a]},removeAttribute:function(a){delete this.attributes[a];return this},addGroup:function(a,b,c){this.groups.push({start:a,count:b,materialIndex:void 0!==c?c:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(a,b){this.drawRange.start=a;this.drawRange.count=
   b},applyMatrix:function(a){var b=this.attributes.position;void 0!==b&&(a.applyToBufferAttribute(b),b.needsUpdate=!0);b=this.attributes.normal;void 0!==b&&((new la).getNormalMatrix(a).applyToBufferAttribute(b),b.needsUpdate=!0);null!==this.boundingBox&&this.computeBoundingBox();null!==this.boundingSphere&&this.computeBoundingSphere();return this},rotateX:function(){var a=new M;return function(b){a.makeRotationX(b);this.applyMatrix(a);return this}}(),rotateY:function(){var a=new M;return function(b){a.makeRotationY(b);
   this.applyMatrix(a);return this}}(),rotateZ:function(){var a=new M;return function(b){a.makeRotationZ(b);this.applyMatrix(a);return this}}(),translate:function(){var a=new M;return function(b,c,d){a.makeTranslation(b,c,d);this.applyMatrix(a);return this}}(),scale:function(){var a=new M;return function(b,c,d){a.makeScale(b,c,d);this.applyMatrix(a);return this}}(),lookAt:function(){var a=new B;return function(b){a.lookAt(b);a.updateMatrix();this.applyMatrix(a.matrix)}}(),center:function(){var a=new p;
   return function(){this.computeBoundingBox();this.boundingBox.getCenter(a).negate();this.translate(a.x,a.y,a.z);return this}}(),setFromObject:function(a){var b=a.geometry;if(a.isPoints||a.isLine){a=new A(3*b.vertices.length,3);var c=new A(3*b.colors.length,3);this.addAttribute("position",a.copyVector3sArray(b.vertices));this.addAttribute("color",c.copyColorsArray(b.colors));b.lineDistances&&b.lineDistances.length===b.vertices.length&&(a=new A(b.lineDistances.length,1),this.addAttribute("lineDistance",
   a.copyArray(b.lineDistances)));null!==b.boundingSphere&&(this.boundingSphere=b.boundingSphere.clone());null!==b.boundingBox&&(this.boundingBox=b.boundingBox.clone())}else a.isMesh&&b&&b.isGeometry&&this.fromGeometry(b);return this},setFromPoints:function(a){for(var b=[],c=0,d=a.length;c<d;c++){var e=a[c];b.push(e.x,e.y,e.z||0)}this.addAttribute("position",new A(b,3));return this},updateFromObject:function(a){var b=a.geometry;if(a.isMesh){var c=b.__directGeometry;!0===b.elementsNeedUpdate&&(c=void 0,
   b.elementsNeedUpdate=!1);if(void 0===c)return this.fromGeometry(b);c.verticesNeedUpdate=b.verticesNeedUpdate;c.normalsNeedUpdate=b.normalsNeedUpdate;c.colorsNeedUpdate=b.colorsNeedUpdate;c.uvsNeedUpdate=b.uvsNeedUpdate;c.groupsNeedUpdate=b.groupsNeedUpdate;b.verticesNeedUpdate=!1;b.normalsNeedUpdate=!1;b.colorsNeedUpdate=!1;b.uvsNeedUpdate=!1;b.groupsNeedUpdate=!1;b=c}!0===b.verticesNeedUpdate&&(c=this.attributes.position,void 0!==c&&(c.copyVector3sArray(b.vertices),c.needsUpdate=!0),b.verticesNeedUpdate=
   !1);!0===b.normalsNeedUpdate&&(c=this.attributes.normal,void 0!==c&&(c.copyVector3sArray(b.normals),c.needsUpdate=!0),b.normalsNeedUpdate=!1);!0===b.colorsNeedUpdate&&(c=this.attributes.color,void 0!==c&&(c.copyColorsArray(b.colors),c.needsUpdate=!0),b.colorsNeedUpdate=!1);b.uvsNeedUpdate&&(c=this.attributes.uv,void 0!==c&&(c.copyVector2sArray(b.uvs),c.needsUpdate=!0),b.uvsNeedUpdate=!1);b.lineDistancesNeedUpdate&&(c=this.attributes.lineDistance,void 0!==c&&(c.copyArray(b.lineDistances),c.needsUpdate=
   !0),b.lineDistancesNeedUpdate=!1);b.groupsNeedUpdate&&(b.computeGroups(a.geometry),this.groups=b.groups,b.groupsNeedUpdate=!1);return this},fromGeometry:function(a){a.__directGeometry=(new Ae).fromGeometry(a);return this.fromDirectGeometry(a.__directGeometry)},fromDirectGeometry:function(a){var b=new Float32Array(3*a.vertices.length);this.addAttribute("position",(new P(b,3)).copyVector3sArray(a.vertices));0<a.normals.length&&(b=new Float32Array(3*a.normals.length),this.addAttribute("normal",(new P(b,
   3)).copyVector3sArray(a.normals)));0<a.colors.length&&(b=new Float32Array(3*a.colors.length),this.addAttribute("color",(new P(b,3)).copyColorsArray(a.colors)));0<a.uvs.length&&(b=new Float32Array(2*a.uvs.length),this.addAttribute("uv",(new P(b,2)).copyVector2sArray(a.uvs)));0<a.uvs2.length&&(b=new Float32Array(2*a.uvs2.length),this.addAttribute("uv2",(new P(b,2)).copyVector2sArray(a.uvs2)));this.groups=a.groups;for(var c in a.morphTargets){b=[];for(var d=a.morphTargets[c],e=0,f=d.length;e<f;e++){var g=
   d[e],h=new A(3*g.length,3);b.push(h.copyVector3sArray(g))}this.morphAttributes[c]=b}0<a.skinIndices.length&&(c=new A(4*a.skinIndices.length,4),this.addAttribute("skinIndex",c.copyVector4sArray(a.skinIndices)));0<a.skinWeights.length&&(c=new A(4*a.skinWeights.length,4),this.addAttribute("skinWeight",c.copyVector4sArray(a.skinWeights)));null!==a.boundingSphere&&(this.boundingSphere=a.boundingSphere.clone());null!==a.boundingBox&&(this.boundingBox=a.boundingBox.clone());return this},computeBoundingBox:function(){null===
   this.boundingBox&&(this.boundingBox=new Va);var a=this.attributes.position;void 0!==a?this.boundingBox.setFromBufferAttribute(a):this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var a=new Va,b=new p;return function(){null===this.boundingSphere&&
   (this.boundingSphere=new za);var c=this.attributes.position;if(c){var d=this.boundingSphere.center;a.setFromBufferAttribute(c);a.getCenter(d);for(var e=0,f=0,g=c.count;f<g;f++)b.x=c.getX(f),b.y=c.getY(f),b.z=c.getZ(f),e=Math.max(e,d.distanceToSquared(b));this.boundingSphere.radius=Math.sqrt(e);isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},
   computeVertexNormals:function(){var a=this.index,b=this.attributes,c=this.groups;if(b.position){var d=b.position.array;if(void 0===b.normal)this.addAttribute("normal",new P(new Float32Array(d.length),3));else for(var e=b.normal.array,f=0,g=e.length;f<g;f++)e[f]=0;e=b.normal.array;var h=new p,k=new p,m=new p,l=new p,n=new p;if(a){a=a.array;0===c.length&&this.addGroup(0,a.length);for(var u=0,t=c.length;u<t;++u){f=c[u];g=f.start;var r=f.count;f=g;for(g+=r;f<g;f+=3){r=3*a[f+0];var v=3*a[f+1];var z=3*
   a[f+2];h.fromArray(d,r);k.fromArray(d,v);m.fromArray(d,z);l.subVectors(m,k);n.subVectors(h,k);l.cross(n);e[r]+=l.x;e[r+1]+=l.y;e[r+2]+=l.z;e[v]+=l.x;e[v+1]+=l.y;e[v+2]+=l.z;e[z]+=l.x;e[z+1]+=l.y;e[z+2]+=l.z}}}else for(f=0,g=d.length;f<g;f+=9)h.fromArray(d,f),k.fromArray(d,f+3),m.fromArray(d,f+6),l.subVectors(m,k),n.subVectors(h,k),l.cross(n),e[f]=l.x,e[f+1]=l.y,e[f+2]=l.z,e[f+3]=l.x,e[f+4]=l.y,e[f+5]=l.z,e[f+6]=l.x,e[f+7]=l.y,e[f+8]=l.z;this.normalizeNormals();b.normal.needsUpdate=!0}},merge:function(a,
   b){if(a&&a.isBufferGeometry){void 0===b&&(b=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var c=this.attributes,d;for(d in c)if(void 0!==a.attributes[d]){var e=c[d].array,f=a.attributes[d],g=f.array,h=0;for(f=f.itemSize*b;h<g.length;h++,f++)e[f]=g[h]}return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",a)},normalizeNormals:function(){var a=
   new p;return function(){for(var b=this.attributes.normal,c=0,d=b.count;c<d;c++)a.x=b.getX(c),a.y=b.getY(c),a.z=b.getZ(c),a.normalize(),b.setXYZ(c,a.x,a.y,a.z)}}(),toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var a=new E,b=this.index.array,c=this.attributes,d;for(d in c){var e=c[d],f=e.array,g=e.itemSize,h=new f.constructor(b.length*g),k=0;e=0;for(var m=b.length;e<m;e++){var l=b[e]*g;for(var n=0;n<g;n++)h[k++]=
   f[l++]}a.addAttribute(d,new P(h,g))}b=this.groups;e=0;for(m=b.length;e<m;e++)c=b[e],a.addGroup(c.start,c.count,c.materialIndex);return a},toJSON:function(){var a={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};a.uuid=this.uuid;a.type=this.type;""!==this.name&&(a.name=this.name);0<Object.keys(this.userData).length&&(a.userData=this.userData);if(void 0!==this.parameters){var b=this.parameters;for(e in b)void 0!==b[e]&&(a[e]=b[e]);return a}a.data={attributes:{}};var c=
   this.index;null!==c&&(b=Array.prototype.slice.call(c.array),a.data.index={type:c.array.constructor.name,array:b});c=this.attributes;for(e in c){var d=c[e];b=Array.prototype.slice.call(d.array);a.data.attributes[e]={itemSize:d.itemSize,type:d.array.constructor.name,array:b,normalized:d.normalized}}var e=this.groups;0<e.length&&(a.data.groups=JSON.parse(JSON.stringify(e)));e=this.boundingSphere;null!==e&&(a.data.boundingSphere={center:e.center.toArray(),radius:e.radius});return a},clone:function(){return(new E).copy(this)},
   copy:function(a){var b;this.index=null;this.attributes={};this.morphAttributes={};this.groups=[];this.boundingSphere=this.boundingBox=null;this.name=a.name;var c=a.index;null!==c&&this.setIndex(c.clone());c=a.attributes;for(g in c)this.addAttribute(g,c[g].clone());var d=a.morphAttributes;for(g in d){var e=[],f=d[g];c=0;for(b=f.length;c<b;c++)e.push(f[c].clone());this.morphAttributes[g]=e}var g=a.groups;c=0;for(b=g.length;c<b;c++)d=g[c],this.addGroup(d.start,d.count,d.materialIndex);g=a.boundingBox;
   null!==g&&(this.boundingBox=g.clone());g=a.boundingSphere;null!==g&&(this.boundingSphere=g.clone());this.drawRange.start=a.drawRange.start;this.drawRange.count=a.drawRange.count;this.userData=a.userData;return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});Kb.prototype=Object.create(K.prototype);Kb.prototype.constructor=Kb;ob.prototype=Object.create(E.prototype);ob.prototype.constructor=ob;wc.prototype=Object.create(K.prototype);wc.prototype.constructor=wc;pb.prototype=Object.create(E.prototype);
   pb.prototype.constructor=pb;var ah=function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),bh=function(){function a(){}a.generateId=function(){return a.id++};a.id=0;return a}(),F=function(a){function b(){var b=a.call(this)||this;
   b._isMaterial=!0;b.attributes=null;b.needsUpdate=!0;b.type="Material";b.alphaTest=0;b.blendDst=205;b.blendDstAlpha=null;b.blendEquation=100;b.blendEquationAlpha=null;b.blendSrc=204;b.blendSrcAlpha=null;b.blending=1;b.clipIntersection=!1;b.clipShadows=!1;b.clippingPlanes=null;b.colorWrite=!0;b.depthFunc=3;b.depthTest=!0;b.depthWrite=!0;b.dithering=!1;b.flatShading=!1;b.fog=!0;b.lights=!0;b.name="";b.opacity=1;b.overdraw=0;b.polygonOffset=!1;b.polygonOffsetFactor=0;b.polygonOffsetUnits=0;b.precision=
   null;b.premultipliedAlpha=!1;b.shadowSide=null;b.side=0;b.transparent=!1;b.userData={};b.vertexColors=0;b.visible=!0;b._id=bh.generateId();b.uuid=Q.generateUUID();return b}ah(b,a);Object.defineProperty(b.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"isMaterial",{get:function(){return this._isMaterial},enumerable:!0,configurable:!0});b.prototype.clone=function(){return(new b).copy(this)};b.prototype.copy=function(a){this.name=a.name;
   this.fog=a.fog;this.lights=a.lights;this.blending=a.blending;this.side=a.side;this.flatShading=a.flatShading;this.vertexColors=a.vertexColors;this.opacity=a.opacity;this.transparent=a.transparent;this.blendSrc=a.blendSrc;this.blendDst=a.blendDst;this.blendEquation=a.blendEquation;this.blendSrcAlpha=a.blendSrcAlpha;this.blendDstAlpha=a.blendDstAlpha;this.blendEquationAlpha=a.blendEquationAlpha;this.depthFunc=a.depthFunc;this.depthTest=a.depthTest;this.depthWrite=a.depthWrite;this.colorWrite=a.colorWrite;
   this.precision=a.precision;this.polygonOffset=a.polygonOffset;this.polygonOffsetFactor=a.polygonOffsetFactor;this.polygonOffsetUnits=a.polygonOffsetUnits;this.dithering=a.dithering;this.alphaTest=a.alphaTest;this.premultipliedAlpha=a.premultipliedAlpha;this.overdraw=a.overdraw;this.visible=a.visible;this.userData=JSON.parse(JSON.stringify(a.userData));this.clipShadows=a.clipShadows;this.clipIntersection=a.clipIntersection;var b=a.clippingPlanes,c=null;if(null!==b){var f=b.length;c=Array(f);for(var g=
   0;g!==f;++g)c[g]=b[g].clone()}this.clippingPlanes=c;this.shadowSide=a.shadowSide;return this};b.prototype.dispose=function(){this.dispatchEvent({type:"dispose"})};b.prototype.onBeforeCompile=function(){};b.prototype.setValues=function(a){if(void 0!==a)for(var b in a){var c=a[b];if(void 0===c)console.warn("THREE.Material: '"+b+"' parameter is undefined.");else if("shading"===b)console.warn("THREE.'"+this.type+"': .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===
   c?!0:!1;else{var f=this[b];void 0===f?console.warn("THREE."+this.type+": '"+b+"' is not a property of this material."):f&&f.isColor?f.set(c):f&&f.isVector3&&c&&c.isVector3?f.copy(c):this[b]="overdraw"===b?Number(c):c}}};b.prototype.toJSON=function(a){var b=void 0===a||"string"===typeof a;b&&(a={textures:{},images:{}});var c={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};c.uuid=this.uuid;c.type=this.type;""!==this.name&&(c.name=this.name);this.color&&this.color.isColor&&(c.color=
   this.color.getHex());void 0!==this.roughness&&(c.roughness=this.roughness);void 0!==this.metalness&&(c.metalness=this.metalness);this.emissive&&this.emissive.isColor&&(c.emissive=this.emissive.getHex());1!==this.emissiveIntensity&&(c.emissiveIntensity=this.emissiveIntensity);this.specular&&this.specular.isColor&&(c.specular=this.specular.getHex());void 0!==this.shininess&&(c.shininess=this.shininess);void 0!==this.clearCoat&&(c.clearCoat=this.clearCoat);void 0!==this.clearCoatRoughness&&(c.clearCoatRoughness=
   this.clearCoatRoughness);this.map&&this.map.isTexture&&(c.map=this.map.toJSON(a).uuid);this.alphaMap&&this.alphaMap.isTexture&&(c.alphaMap=this.alphaMap.toJSON(a).uuid);this.lightMap&&this.lightMap.isTexture&&(c.lightMap=this.lightMap.toJSON(a).uuid);this.aoMap&&this.aoMap.isTexture&&(c.aoMap=this.aoMap.toJSON(a).uuid,c.aoMapIntensity=this.aoMapIntensity);this.bumpMap&&this.bumpMap.isTexture&&(c.bumpMap=this.bumpMap.toJSON(a).uuid,c.bumpScale=this.bumpScale);this.normalMap&&this.normalMap.isTexture&&
   (c.normalMap=this.normalMap.toJSON(a).uuid,c.normalMapType=this.normalMapType,c.normalScale=this.normalScale.toArray());this.displacementMap&&this.displacementMap.isTexture&&(c.displacementMap=this.displacementMap.toJSON(a).uuid,c.displacementScale=this.displacementScale,c.displacementBias=this.displacementBias);this.roughnessMap&&this.roughnessMap.isTexture&&(c.roughnessMap=this.roughnessMap.toJSON(a).uuid);this.metalnessMap&&this.metalnessMap.isTexture&&(c.metalnessMap=this.metalnessMap.toJSON(a).uuid);
   this.emissiveMap&&this.emissiveMap.isTexture&&(c.emissiveMap=this.emissiveMap.toJSON(a).uuid);this.specularMap&&this.specularMap.isTexture&&(c.specularMap=this.specularMap.toJSON(a).uuid);this.envMap&&this.envMap.isTexture&&(c.envMap=this.envMap.toJSON(a).uuid,c.reflectivity=this.reflectivity);this.gradientMap&&this.gradientMap.isTexture&&(c.gradientMap=this.gradientMap.toJSON(a).uuid);void 0!==this.size&&(c.size=this.size);void 0!==this.sizeAttenuation&&(c.sizeAttenuation=this.sizeAttenuation);1!==
   this.blending&&(c.blending=this.blending);!0===this.flatShading&&(c.flatShading=this.flatShading);0!==this.side&&(c.side=this.side);0!==this.vertexColors&&(c.vertexColors=this.vertexColors);1>this.opacity&&(c.opacity=this.opacity);!0===this.transparent&&(c.transparent=this.transparent);c.depthFunc=this.depthFunc;c.depthTest=this.depthTest;c.depthWrite=this.depthWrite;0!==this.rotation&&(c.rotation=this.rotation);1!==this.linewidth&&(c.linewidth=this.linewidth);void 0!==this.dashSize&&(c.dashSize=
   this.dashSize);void 0!==this.gapSize&&(c.gapSize=this.gapSize);void 0!==this.scale&&(c.scale=this.scale);!0===this.dithering&&(c.dithering=!0);0<this.alphaTest&&(c.alphaTest=this.alphaTest);!0===this.premultipliedAlpha&&(c.premultipliedAlpha=this.premultipliedAlpha);!0===this.wireframe&&(c.wireframe=this.wireframe);1<this.wireframeLinewidth&&(c.wireframeLinewidth=this.wireframeLinewidth);"round"!==this.wireframeLinecap&&(c.wireframeLinecap=this.wireframeLinecap);"round"!==this.wireframeLinejoin&&
   (c.wireframeLinejoin=this.wireframeLinejoin);!0===this.morphTargets&&(c.morphTargets=!0);!0===this.skinning&&(c.skinning=!0);!1===this.visible&&(c.visible=!1);"{}"!==JSON.stringify(this.userData)&&(c.userData=this.userData);var f=function(a){var b=[],c;for(c in a){var d=a[c];delete d.metadata;b.push(d)}return b};b&&(b=f(a.textures),a=f(a.images),0<b.length&&(c.textures=b),0<a.length&&(c.images=a));return c};return b}(ib);Aa.prototype=Object.create(F.prototype);Aa.prototype.constructor=Aa;Aa.prototype.isMeshBasicMaterial=
   !0;Aa.prototype.copy=function(a){F.prototype.copy.call(this,a);this.color.copy(a.color);this.map=a.map;this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.specularMap=a.specularMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.combine=a.combine;this.reflectivity=a.reflectivity;this.refractionRatio=a.refractionRatio;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;
   this.wireframeLinejoin=a.wireframeLinejoin;this.skinning=a.skinning;this.morphTargets=a.morphTargets;return this};Da.prototype=Object.create(F.prototype);Da.prototype.constructor=Da;Da.prototype.isShaderMaterial=!0;Da.prototype.copy=function(a){F.prototype.copy.call(this,a);this.fragmentShader=a.fragmentShader;this.vertexShader=a.vertexShader;this.uniforms=Ea.clone(a.uniforms);this.defines=Object.assign({},a.defines);this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.lights=
   a.lights;this.clipping=a.clipping;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.morphNormals=a.morphNormals;this.extensions=a.extensions;return this};Da.prototype.toJSON=function(a){a=F.prototype.toJSON.call(this,a);a.uniforms=this.uniforms;a.vertexShader=this.vertexShader;a.fragmentShader=this.fragmentShader;return a};Object.assign(qb.prototype,{set:function(a,b){this.origin.copy(a);this.direction.copy(b);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.origin.copy(a.origin);
   this.direction.copy(a.direction);return this},at:function(a,b){void 0===b&&(console.warn("THREE.Ray: .at() target is now required"),b=new p);return b.copy(this.direction).multiplyScalar(a).add(this.origin)},lookAt:function(a){this.direction.copy(a).sub(this.origin).normalize();return this},recast:function(){var a=new p;return function(b){this.origin.copy(this.at(b,a));return this}}(),closestPointToPoint:function(a,b){void 0===b&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),
   b=new p);b.subVectors(a,this.origin);a=b.dot(this.direction);return 0>a?b.copy(this.origin):b.copy(this.direction).multiplyScalar(a).add(this.origin)},distanceToPoint:function(a){return Math.sqrt(this.distanceSqToPoint(a))},distanceSqToPoint:function(){var a=new p;return function(b){var c=a.subVectors(b,this.origin).dot(this.direction);if(0>c)return this.origin.distanceToSquared(b);a.copy(this.direction).multiplyScalar(c).add(this.origin);return a.distanceToSquared(b)}}(),distanceSqToSegment:function(){var a=
   new p,b=new p,c=new p;return function(d,e,f,g){a.copy(d).add(e).multiplyScalar(.5);b.copy(e).sub(d).normalize();c.copy(this.origin).sub(a);var h=.5*d.distanceTo(e),k=-this.direction.dot(b),m=c.dot(this.direction),l=-c.dot(b),n=c.lengthSq(),u=Math.abs(1-k*k);if(0<u){d=k*l-m;e=k*m-l;var p=h*u;0<=d?e>=-p?e<=p?(h=1/u,d*=h,e*=h,k=d*(d+k*e+2*m)+e*(k*d+e+2*l)+n):(e=h,d=Math.max(0,-(k*e+m)),k=-d*d+e*(e+2*l)+n):(e=-h,d=Math.max(0,-(k*e+m)),k=-d*d+e*(e+2*l)+n):e<=-p?(d=Math.max(0,-(-k*h+m)),e=0<d?-h:Math.min(Math.max(-h,
   -l),h),k=-d*d+e*(e+2*l)+n):e<=p?(d=0,e=Math.min(Math.max(-h,-l),h),k=e*(e+2*l)+n):(d=Math.max(0,-(k*h+m)),e=0<d?h:Math.min(Math.max(-h,-l),h),k=-d*d+e*(e+2*l)+n)}else e=0<k?-h:h,d=Math.max(0,-(k*e+m)),k=-d*d+e*(e+2*l)+n;f&&f.copy(this.direction).multiplyScalar(d).add(this.origin);g&&g.copy(b).multiplyScalar(e).add(a);return k}}(),intersectSphere:function(){var a=new p;return function(b,c){a.subVectors(b.center,this.origin);var d=a.dot(this.direction),e=a.dot(a)-d*d;b=b.radius*b.radius;if(e>b)return null;
   b=Math.sqrt(b-e);e=d-b;d+=b;return 0>e&&0>d?null:0>e?this.at(d,c):this.at(e,c)}}(),intersectsSphere:function(a){return this.distanceToPoint(a.center)<=a.radius},distanceToPlane:function(a){var b=a.normal.dot(this.direction);if(0===b)return 0===a.distanceToPoint(this.origin)?0:null;a=-(this.origin.dot(a.normal)+a.constant)/b;return 0<=a?a:null},intersectPlane:function(a,b){a=this.distanceToPlane(a);return null===a?null:this.at(a,b)},intersectsPlane:function(a){var b=a.distanceToPoint(this.origin);
   return 0===b||0>a.normal.dot(this.direction)*b?!0:!1},intersectBox:function(a,b){var c=1/this.direction.x;var d=1/this.direction.y;var e=1/this.direction.z,f=this.origin;if(0<=c){var g=(a.min.x-f.x)*c;c*=a.max.x-f.x}else g=(a.max.x-f.x)*c,c*=a.min.x-f.x;if(0<=d){var h=(a.min.y-f.y)*d;d*=a.max.y-f.y}else h=(a.max.y-f.y)*d,d*=a.min.y-f.y;if(g>d||h>c)return null;if(h>g||g!==g)g=h;if(d<c||c!==c)c=d;0<=e?(h=(a.min.z-f.z)*e,a=(a.max.z-f.z)*e):(h=(a.max.z-f.z)*e,a=(a.min.z-f.z)*e);if(g>a||h>c)return null;
   if(h>g||g!==g)g=h;if(a<c||c!==c)c=a;return 0>c?null:this.at(0<=g?g:c,b)},intersectsBox:function(){var a=new p;return function(b){return null!==this.intersectBox(b,a)}}(),intersectTriangle:function(){var a=new p,b=new p,c=new p,d=new p;return function(e,f,g,h,k){b.subVectors(f,e);c.subVectors(g,e);d.crossVectors(b,c);f=this.direction.dot(d);if(0<f){if(h)return null;h=1}else if(0>f)h=-1,f=-f;else return null;a.subVectors(this.origin,e);e=h*this.direction.dot(c.crossVectors(a,c));if(0>e)return null;
   g=h*this.direction.dot(b.cross(a));if(0>g||e+g>f)return null;e=-h*a.dot(d);return 0>e?null:this.at(e/f,k)}}(),applyMatrix4:function(a){this.origin.applyMatrix4(a);this.direction.transformDirection(a);return this},equals:function(a){return a.origin.equals(this.origin)&&a.direction.equals(this.direction)}});Object.assign(Ba,{getNormal:function(){var a=new p;return function(b,c,d,e){void 0===e&&(console.warn("THREE.Triangle: .getNormal() target is now required"),e=new p);e.subVectors(d,c);a.subVectors(b,
   c);e.cross(a);b=e.lengthSq();return 0<b?e.multiplyScalar(1/Math.sqrt(b)):e.set(0,0,0)}}(),getBarycoord:function(){var a=new p,b=new p,c=new p;return function(d,e,f,g,h){a.subVectors(g,e);b.subVectors(f,e);c.subVectors(d,e);d=a.dot(a);e=a.dot(b);f=a.dot(c);var k=b.dot(b);g=b.dot(c);var m=d*k-e*e;void 0===h&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),h=new p);if(0===m)return h.set(-2,-1,-1);m=1/m;k=(k*f-e*g)*m;d=(d*g-e*f)*m;return h.set(1-k-d,d,k)}}(),containsPoint:function(){var a=
   new p;return function(b,c,d,e){Ba.getBarycoord(b,c,d,e,a);return 0<=a.x&&0<=a.y&&1>=a.x+a.y}}()});Object.assign(Ba.prototype,{set:function(a,b,c){this.a.copy(a);this.b.copy(b);this.c.copy(c);return this},setFromPointsAndIndices:function(a,b,c,d){this.a.copy(a[b]);this.b.copy(a[c]);this.c.copy(a[d]);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.a.copy(a.a);this.b.copy(a.b);this.c.copy(a.c);return this},getArea:function(){var a=new p,b=new p;return function(){a.subVectors(this.c,
   this.b);b.subVectors(this.a,this.b);return.5*a.cross(b).length()}}(),getMidpoint:function(a){void 0===a&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),a=new p);return a.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(a){return Ba.getNormal(this.a,this.b,this.c,a)},getPlane:function(a){void 0===a&&(console.warn("THREE.Triangle: .getPlane() target is now required"),a=new p);return a.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(a,
   b){return Ba.getBarycoord(a,this.a,this.b,this.c,b)},containsPoint:function(a){return Ba.containsPoint(a,this.a,this.b,this.c)},intersectsBox:function(a){return a.intersectsTriangle(this)},closestPointToPoint:function(){var a=new p,b=new p,c=new p,d=new p,e=new p,f=new p;return function(g,h){void 0===h&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),h=new p);var k=this.a,m=this.b,l=this.c;a.subVectors(m,k);b.subVectors(l,k);d.subVectors(g,k);var n=a.dot(d),u=b.dot(d);
   if(0>=n&&0>=u)return h.copy(k);e.subVectors(g,m);var t=a.dot(e),r=b.dot(e);if(0<=t&&r<=t)return h.copy(m);var v=n*r-t*u;if(0>=v&&0<=n&&0>=t)return m=n/(n-t),h.copy(k).addScaledVector(a,m);f.subVectors(g,l);g=a.dot(f);var z=b.dot(f);if(0<=z&&g<=z)return h.copy(l);n=g*u-n*z;if(0>=n&&0<=u&&0>=z)return v=u/(u-z),h.copy(k).addScaledVector(b,v);u=t*z-g*r;if(0>=u&&0<=r-t&&0<=g-z)return c.subVectors(l,m),v=(r-t)/(r-t+(g-z)),h.copy(m).addScaledVector(c,v);l=1/(u+n+v);m=n*l;v*=l;return h.copy(k).addScaledVector(a,
   m).addScaledVector(b,v)}}(),equals:function(a){return a.a.equals(this.a)&&a.b.equals(this.b)&&a.c.equals(this.c)}});ra.prototype=Object.assign(Object.create(B.prototype),{constructor:ra,isMesh:!0,setDrawMode:function(a){this.drawMode=a},copy:function(a){B.prototype.copy.call(this,a);this.drawMode=a.drawMode;void 0!==a.morphTargetInfluences&&(this.morphTargetInfluences=a.morphTargetInfluences.slice());void 0!==a.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},a.morphTargetDictionary));
   return this},updateMorphTargets:function(){var a=this.geometry;if(a.isBufferGeometry){a=a.morphAttributes;var b=Object.keys(a);if(0<b.length){var c=a[b[0]];if(void 0!==c)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},a=0,b=c.length;a<b;a++){var d=c[a].name||String(a);this.morphTargetInfluences.push(0);this.morphTargetDictionary[d]=a}}}else if(c=a.morphTargets,void 0!==c&&0<c.length)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},a=0,b=c.length;a<b;a++)d=c[a].name||
   String(a),this.morphTargetInfluences.push(0),this.morphTargetDictionary[d]=a},raycast:function(){function a(a,b,c,d,e,f,g){Ba.getBarycoord(a,b,c,d,v);e.multiplyScalar(v.x);f.multiplyScalar(v.y);g.multiplyScalar(v.z);e.add(f).add(g);return e.clone()}function b(a,b,c,d,e,f,g,h){if(null===(1===b.side?d.intersectTriangle(g,f,e,!0,h):d.intersectTriangle(e,f,g,2!==b.side,h)))return null;x.copy(h);x.applyMatrix4(a.matrixWorld);b=c.ray.origin.distanceTo(x);return b<c.near||b>c.far?null:{distance:b,point:x.clone(),
   object:a}}function c(c,d,e,f,m,l,n,q,p){g.fromBufferAttribute(m,n);h.fromBufferAttribute(m,q);k.fromBufferAttribute(m,p);if(c=b(c,d,e,f,g,h,k,z))l&&(u.fromBufferAttribute(l,n),t.fromBufferAttribute(l,q),r.fromBufferAttribute(l,p),c.uv=a(z,g,h,k,u,t,r)),l=new Wa(n,q,p),Ba.getNormal(g,h,k,l.normal),c.face=l;return c}var d=new M,e=new qb,f=new za,g=new p,h=new p,k=new p,m=new p,l=new p,n=new p,u=new C,t=new C,r=new C,v=new p,z=new p,x=new p;return function(q,p){var v=this.geometry,w=this.material,x=
   this.matrixWorld;if(void 0!==w&&(null===v.boundingSphere&&v.computeBoundingSphere(),f.copy(v.boundingSphere),f.applyMatrix4(x),!1!==q.ray.intersectsSphere(f)&&(d.getInverse(x),e.copy(q.ray).applyMatrix4(d),null===v.boundingBox||!1!==e.intersectsBox(v.boundingBox))))if(v.isBufferGeometry){var y=v.index,A=v.attributes.position,C=v.attributes.uv,E=v.groups;v=v.drawRange;var B;if(null!==y)if(Array.isArray(w)){var F=0;for(B=E.length;F<B;F++){var G=E[F];var K=w[G.materialIndex];x=Math.max(G.start,v.start);
   var L=Math.min(G.start+G.count,v.start+v.count);for(G=x;G<L;G+=3){x=y.getX(G);var I=y.getX(G+1);var M=y.getX(G+2);if(x=c(this,K,q,e,A,C,x,I,M))x.faceIndex=Math.floor(G/3),p.push(x)}}}else for(x=Math.max(0,v.start),L=Math.min(y.count,v.start+v.count),F=x,B=L;F<B;F+=3){if(x=y.getX(F),I=y.getX(F+1),M=y.getX(F+2),x=c(this,w,q,e,A,C,x,I,M))x.faceIndex=Math.floor(F/3),p.push(x)}else if(void 0!==A)if(Array.isArray(w))for(F=0,B=E.length;F<B;F++)for(G=E[F],K=w[G.materialIndex],x=Math.max(G.start,v.start),
   L=Math.min(G.start+G.count,v.start+v.count),G=x;G<L;G+=3){if(x=G,I=G+1,M=G+2,x=c(this,K,q,e,A,C,x,I,M))x.faceIndex=Math.floor(G/3),p.push(x)}else for(x=Math.max(0,v.start),L=Math.min(A.count,v.start+v.count),F=x,B=L;F<B;F+=3)if(x=F,I=F+1,M=F+2,x=c(this,w,q,e,A,C,x,I,M))x.faceIndex=Math.floor(F/3),p.push(x)}else if(v.isGeometry)for(A=Array.isArray(w),C=v.vertices,E=v.faces,x=v.faceVertexUvs[0],0<x.length&&(y=x),G=0,L=E.length;G<L;G++)if(I=E[G],x=A?w[I.materialIndex]:w,void 0!==x){F=C[I.a];B=C[I.b];
   K=C[I.c];if(!0===x.morphTargets){M=v.morphTargets;var P=this.morphTargetInfluences;g.set(0,0,0);h.set(0,0,0);k.set(0,0,0);for(var Q=0,S=M.length;Q<S;Q++){var R=P[Q];if(0!==R){var T=M[Q].vertices;g.addScaledVector(m.subVectors(T[I.a],F),R);h.addScaledVector(l.subVectors(T[I.b],B),R);k.addScaledVector(n.subVectors(T[I.c],K),R)}}g.add(F);h.add(B);k.add(K);F=g;B=h;K=k}if(x=b(this,x,q,e,F,B,K,z))y&&y[G]&&(M=y[G],u.copy(M[0]),t.copy(M[1]),r.copy(M[2]),x.uv=a(z,F,B,K,u,t,r)),x.face=I,x.faceIndex=G,p.push(x)}}}(),
   clone:function(){return(new this.constructor(this.geometry,this.material)).copy(this)}});var yf=function(a,b){this._instance=b;this.bind=function(c){"object"===typeof c&&(Object.keys(a).forEach(function(a){if("function"!==typeof c[a])throw Error(typeof c+" must implement "+a);}),this._instance=c);return b};this.resolve=function(){return this._instance}},zf=function(){return{log:function(){},error:function(){},warn:function(){},info:function(){},debug:function(){}}}(),Af=function(){return{debug:function(){return!1},
   allowedCachedPrograms:function(){return 50}}}(),Xa={Logger:new yf(zf,zf),Settings:new yf(Af,Af)},zg=function(){return{getWebGLProgramDiagnostics:function(a,b,c,d,e,f,g){var h=Xa.Logger.resolve(),k=a.getProgramInfoLog(b).trim();c=a.getShaderInfoLog(c).trim();d=a.getShaderInfoLog(d).trim();var m=!0,l=!0;if(!1===a.getProgramParameter(b,a.LINK_STATUS))m=!1,h.error("THREE.WebGLProgram: shader error: ",a.getError(),"gl.VALIDATE_STATUS",a.getProgramParameter(b,a.VALIDATE_STATUS),"gl.getProgramInfoLog",k,
   c,d);else if(""!==k)h.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",k);else if(""===c||""===d)l=!1;return l?{runnable:m,material:g,programLog:k,vertexShader:{log:c,prefix:e},fragmentShader:{log:d,prefix:f}}:null}}}(),ch=function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?
   Object.create(c):(d.prototype=c.prototype,new d)}}(),Md=function(a){function b(b,d,e,f,g,h,k,m,l,n){b=a.call(this,b?b:[],d?d:301,e,f,g,h,k,m,l,n)||this;b._isCubeTexture=!0;b.maxMipLevel=0;b.flipY=!1;return b}ch(b,a);Object.defineProperty(b.prototype,"src",{get:function(){this._src||(this._src=this.images.map(function(a){return a.src}).join(";"));return this._src},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"images",{get:function(){return this.image},set:function(a){this.image=
   a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"isCubeTexture",{get:function(){return this._isCubeTexture},enumerable:!0,configurable:!0});return b}(ta),Ie=new ta,Je=new Md,Ce=[],Ee=[],He=new Float32Array(16),Ge=new Float32Array(9),Fe=new Float32Array(4);Ne.prototype.updateCache=function(a){var b=this.cache;a instanceof Float32Array&&b.length!==a.length&&(this.cache=new Float32Array(a.length));pa(b,a)};Oe.prototype.setValue=function(a,b,c){for(var d=this.seq,e=0,f=d.length;e!==
   f;++e){var g=d[e];g.setValue(a,b[g.id],c)}};var Sd=/([\w\d_]+)(\])?(\[|\.)?/g;cb.prototype.setValue=function(a,b,c){b=this.map[b];void 0!==b&&b.setValue(a,c,this.renderer)};cb.prototype.setOptional=function(a,b,c){b=b[c];void 0!==b&&this.setValue(a,c,b)};cb.upload=function(a,b,c,d){for(var e=0,f=b.length;e!==f;++e){var g=b[e],h=c[g.id];!1!==h.needsUpdate&&g.setValue(a,h.value,d)}};cb.seqWithValue=function(a,b){for(var c=[],d=0,e=a.length;d!==e;++d){var f=a[d];f.id in b&&c.push(f)}return c};var sg=
   function(){var a=Xa.Logger.resolve();return{logShaderCompilationInformation:function(b,c,d,e){!1===b.getShaderParameter(c,b.COMPILE_STATUS)&&a.error("THREE.WebGLShader: Shader couldn't compile.");c=b.getShaderInfoLog(c);""!==c&&a.warn("THREE.WebGLShader: gl.getShaderInfoLog()",d===b.VERTEX_SHADER?"vertex":"fragment",c,rg(e))}}}(),Ag=0,Re=Xa.Logger.resolve();Xa.Settings.resolve();var Mg=function(){function a(){this._properties=new WeakMap}a.prototype.dispose=function(){this._properties=new WeakMap};
   a.prototype.get=function(a){var b=this._properties.get(a);void 0===b&&(b={},this._properties.set(a,b));return b};a.prototype.remove=function(a){this._properties.delete(a)};a.prototype.update=function(a,c,d){this._properties.get(a)[c]=d};return a}(),Ig=0;db.prototype=Object.create(F.prototype);db.prototype.constructor=db;db.prototype.isMeshDepthMaterial=!0;db.prototype.copy=function(a){F.prototype.copy.call(this,a);this.depthPacking=a.depthPacking;this.skinning=a.skinning;this.morphTargets=a.morphTargets;
   this.map=a.map;this.alphaMap=a.alphaMap;this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;return this};eb.prototype=Object.create(F.prototype);eb.prototype.constructor=eb;eb.prototype.isMeshDistanceMaterial=!0;eb.prototype.copy=function(a){F.prototype.copy.call(this,a);this.referencePosition.copy(a.referencePosition);this.nearDistance=a.nearDistance;this.farDistance=
   a.farDistance;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.map=a.map;this.alphaMap=a.alphaMap;this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;return this};var Ng=function(){function a(a,c,d,e,f,g,h,k){this._gl=a;this._extensions=c;this._state=d;this._properties=e;this._capabilities=f;this._utils=g;this._info=h;this._webGLCacheFacade=k;this._videoTextures={};this._logger=Xa.Logger.resolve()}a.prototype.setTexture2D=
   function(a,c){var b=!a.isCanvasTexture&&this._webGLCacheFacade.textureCache.isInCache(a);a=b?this._webGLCacheFacade.textureCache.get(a):a;var e=this._properties.get(a);a.isVideoTexture&&this.updateVideoTexture(a);if(0<a.version&&!b)if(a.isCanvasTexture||this._webGLCacheFacade.textureCache.cache(a),b=a.image,void 0===b)this._logger.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(!1===b.complete)this._logger.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");
   else{this.uploadTexture(e,a,c);return}this._state.activeTexture(this._gl.TEXTURE0+c);this._state.bindTexture(this._gl.TEXTURE_2D,e.__webglTexture)};a.prototype.setTextureCube=function(a,c){var b=this._webGLCacheFacade.textureCache.isInCache(a);a=b?this._webGLCacheFacade.textureCache.get(a):a;var e=this._properties.get(a);if(6===a.images.length)if(0<a.version&&!b){e.__image__webglTextureCube||(e.__image__webglTextureCube=this.createWebGLTexture(a,this.onTextureDispose));this._state.activeTexture(this._gl.TEXTURE0+
   c);this._state.bindTexture(this._gl.TEXTURE_CUBE_MAP,e.__image__webglTextureCube);this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,a.flipY);c=a&&a.isCompressedTexture;b=a.image[0]&&a.image[0].isDataTexture;for(var f=[],g=0;6>g;g++)f[g]=c||b?b?a.image[g].image:a.image[g]:this.clampToMaxSize(a.image[g],this._capabilities.maxCubemapSize);var h=f[0],k=this.isPowerOfTwo(h),m=this._utils.convert(a.format),l=this._utils.convert(a.type),n=this.getInternalFormat(m,l);this.setTextureParameters(this._gl.TEXTURE_CUBE_MAP,
   a,k);for(g=0;6>g;g++)if(c)for(var u,p=f[g].mipmaps,r=0,v=p.length;r<v;r++)u=p[r],1023!==a.format&&1022!==a.format?-1<this._state.getCompressedTextureFormats().indexOf(m)?this._state.compressedTexImage2D(this._gl.TEXTURE_CUBE_MAP_POSITIVE_X+g,r,n,u.width,u.height,0,u.data):this._logger.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):this._state.texImage2D(this._gl.TEXTURE_CUBE_MAP_POSITIVE_X+g,r,n,u.width,u.height,0,m,l,u.data);else b?this._state.texImage2D(this._gl.TEXTURE_CUBE_MAP_POSITIVE_X+
   g,0,n,f[g].width,f[g].height,0,m,l,f[g].data):this._state.texImage2D(this._gl.TEXTURE_CUBE_MAP_POSITIVE_X+g,0,n,m,l,f[g]);e.__maxMipLevel=c?p.length-1:0;this.textureNeedsGenerateMipmaps(a,k)&&this.generateMipmap(this._gl.TEXTURE_CUBE_MAP,a,h.width,h.height);e.__version=a.version;if(a.onUpdate)a.onUpdate(a);this._webGLCacheFacade.textureCache.cache(a)}else this._state.activeTexture(this._gl.TEXTURE0+c),this._state.bindTexture(this._gl.TEXTURE_CUBE_MAP,e.__image__webglTextureCube)};a.prototype.setTextureCubeDynamic=
   function(a,c){this._state.activeTexture(this._gl.TEXTURE0+c);this._state.bindTexture(this._gl.TEXTURE_CUBE_MAP,this._properties.get(a).__webglTexture)};a.prototype.setupRenderTarget=function(a){var b=this._properties.get(a),d=this._properties.get(a.texture);d.__webglTexture=this.createWebGLTexture(a,this.onRenderTargetDispose);var e=this.isPowerOfTwo(a);if(a.isWebGLRenderTargetCube){b.__webglFramebuffer=[];for(var f=0;6>f;f++)b.__webglFramebuffer[f]=this._gl.createFramebuffer()}else b.__webglFramebuffer=
   this._gl.createFramebuffer();if(a.isWebGLRenderTargetCube){this._state.bindTexture(this._gl.TEXTURE_CUBE_MAP,d.__webglTexture);this.setTextureParameters(this._gl.TEXTURE_CUBE_MAP,a.texture,e);for(f=0;6>f;f++)this.setupFrameBufferTexture(b.__webglFramebuffer[f],a,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_CUBE_MAP_POSITIVE_X+f);this.textureNeedsGenerateMipmaps(a.texture,e)&&this.generateMipmap(this._gl.TEXTURE_CUBE_MAP,a.texture,a.width,a.height);this._state.bindTexture(this._gl.TEXTURE_CUBE_MAP,
   null)}else this._state.bindTexture(this._gl.TEXTURE_2D,d.__webglTexture),this.setTextureParameters(this._gl.TEXTURE_2D,a.texture,e),this.setupFrameBufferTexture(b.__webglFramebuffer,a,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D),this.textureNeedsGenerateMipmaps(a.texture,e)&&this.generateMipmap(this._gl.TEXTURE_2D,a.texture,a.width,a.height),this._state.bindTexture(this._gl.TEXTURE_2D,null);a.depthBuffer&&this.setupDepthRenderbuffer(a)};a.prototype.updateRenderTargetMipmap=function(a){var b=a.texture,
   d=this.isPowerOfTwo(a);if(this.textureNeedsGenerateMipmaps(b,d)){d=a.isWebGLRenderTargetCube?this._gl.TEXTURE_CUBE_MAP:this._gl.TEXTURE_2D;var e=this._properties.get(b).__webglTexture;this._state.bindTexture(d,e);this.generateMipmap(d,b,a.width,a.height);this._state.bindTexture(d,null)}};a.prototype.clampToMaxSize=function(a,c){if(a.width>c||a.height>c){if("data"in a){this._logger.warn("THREE.WebGLRenderer: image in DataTexture is too big ("+a.width+"x"+a.height+").");return}c/=Math.max(a.width,a.height);
   var b=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");b.width=Math.floor(a.width*c);b.height=Math.floor(a.height*c);b.getContext("2d").drawImage(a,0,0,a.width,a.height,0,0,b.width,b.height);this._logger.warn("THREE.WebGLRenderer: image is too big ("+a.width+"x"+a.height+"). Resized to "+b.width+"x"+b.height);return b}return a};a.prototype.createWebGLTexture=function(a,c){a.addEventListener("dispose",c.bind(this));this._info.memory.textures++;return this._gl.createTexture()};a.prototype.deallocateRenderTarget=
   function(a){var b=this._properties.get(a),d=this._properties.get(a.texture);if(a){void 0!==d.__webglTexture&&this._gl.deleteTexture(d.__webglTexture);a.depthTexture&&a.depthTexture.dispose();if(a.isWebGLRenderTargetCube)for(d=0;6>d;d++)this._gl.deleteFramebuffer(b.__webglFramebuffer[d]),b.__webglDepthbuffer&&this._gl.deleteRenderbuffer(b.__webglDepthbuffer[d]);else this._gl.deleteFramebuffer(b.__webglFramebuffer),b.__webglDepthbuffer&&this._gl.deleteRenderbuffer(b.__webglDepthbuffer);this._properties.remove(a.texture);
   this._properties.remove(a)}};a.prototype.deallocateTexture=function(a){var b=this._properties.get(a);if(a.image&&b.__image__webglTextureCube)this._gl.deleteTexture(b.__image__webglTextureCube);else{if(void 0===b.__webglInit)return;this._gl.deleteTexture(b.__webglTexture)}this._properties.remove(a)};a.prototype.filterFallback=function(a){return 1003===a||1004===a||1005===a?this._gl.NEAREST:this._gl.LINEAR};a.prototype.generateMipmap=function(a,c,d,e){this._gl.generateMipmap(a);this._properties.get(c).__maxMipLevel=
   Math.log(Math.max(d,e))*Math.LOG2E};a.prototype.getInternalFormat=function(a,c){if(!this._capabilities.isWebGL2)return a;if(a===this._gl.RGB){if(c===this._gl.FLOAT)return this._gl.RGB32F;if(c===this._gl.HALF_FLOAT)return this._gl.RGB16F;if(c===this._gl.UNSIGNED_BYTE)return this._gl.RGB8}if(a===this._gl.RGBA){if(c===this._gl.FLOAT)return this._gl.RGBA32F;if(c===this._gl.HALF_FLOAT)return this._gl.RGBA16F;if(c===this._gl.UNSIGNED_BYTE)return this._gl.RGBA8}return a};a.prototype.isPowerOfTwo=function(a){return Q.isPowerOfTwo(a.width)&&
   Q.isPowerOfTwo(a.height)};a.prototype.makePowerOfTwo=function(a){return a instanceof HTMLImageElement||a instanceof HTMLCanvasElement||a instanceof ImageBitmap?(void 0===this._canvas&&(this._canvas=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),this._canvas.width=Q.floorPowerOfTwo(a.width),this._canvas.height=Q.floorPowerOfTwo(a.height),this._canvas.getContext("2d").drawImage(a,0,0,this._canvas.width,this._canvas.height),this._logger.warn("THREE.WebGLRenderer: image is not power of two ("+
   a.width+"x"+a.height+"). Resized to "+this._canvas.width+"x"+this._canvas.height),this._canvas):a};a.prototype.onRenderTargetDispose=function(a){a=a.target;a.removeEventListener("dispose",this.onRenderTargetDispose.bind(this));this.deallocateRenderTarget(a);this._info.memory.textures--};a.prototype.onTextureDispose=function(a){a=a.target;a.removeEventListener("dispose",this.onTextureDispose.bind(this));this._webGLCacheFacade.textureCache.remove(a);this.deallocateTexture(a);a.isVideoTexture&&delete this._videoTextures[a.id.value];
   this._info.memory.textures--};a.prototype.setTextureParameters=function(a,c,d){d?(this._gl.texParameteri(a,this._gl.TEXTURE_WRAP_S,this._utils.convert(c.wrapS)),this._gl.texParameteri(a,this._gl.TEXTURE_WRAP_T,this._utils.convert(c.wrapT)),this._gl.texParameteri(a,this._gl.TEXTURE_MAG_FILTER,this._utils.convert(c.magFilter)),this._gl.texParameteri(a,this._gl.TEXTURE_MIN_FILTER,this._utils.convert(c.minFilter))):(this._gl.texParameteri(a,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(a,
   this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),1001===c.wrapS&&1001===c.wrapT||this._logger.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),this._gl.texParameteri(a,this._gl.TEXTURE_MAG_FILTER,this.filterFallback(c.magFilter)),this._gl.texParameteri(a,this._gl.TEXTURE_MIN_FILTER,this.filterFallback(c.minFilter)),1003!==c.minFilter&&1006!==c.minFilter&&this._logger.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));
   !(d=this._extensions.get("EXT_texture_filter_anisotropic"))||1015===c.type&&null===this._extensions.get("OES_texture_float_linear")||1016===c.type&&null===(this._capabilities.isWebGL2||this._extensions.get("OES_texture_half_float_linear"))||!(1<c.anisotropy||this._properties.get(c).__currentAnisotropy)||(this._gl.texParameterf(a,d.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(c.anisotropy,this._capabilities.getMaxAnisotropy())),this._properties.get(c).__currentAnisotropy=c.anisotropy)};a.prototype.setupDepthRenderbuffer=
   function(a){var b=this._properties.get(a),d=!0===a.isWebGLRenderTargetCube;if(a.depthTexture){if(d)throw Error("target.depthTexture not supported in Cube render targets");this.setupDepthTexture(b.__webglFramebuffer,a)}else if(d)for(b.__webglDepthbuffer=[],d=0;6>d;d++)this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,b.__webglFramebuffer[d]),b.__webglDepthbuffer[d]=this._gl.createRenderbuffer(),this.setupRenderBufferStorage(b.__webglDepthbuffer[d],a);else this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,
   b.__webglFramebuffer),b.__webglDepthbuffer=this._gl.createRenderbuffer(),this.setupRenderBufferStorage(b.__webglDepthbuffer,a);this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null)};a.prototype.setupDepthTexture=function(a,c){if(c&&c.isWebGLRenderTargetCube)throw Error("Depth Texture with cube render targets is not supported");this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,a);if(!c.depthTexture||!c.depthTexture.isDepthTexture)throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");
   this._properties.get(c.depthTexture).__webglTexture&&c.depthTexture.image.width===c.width&&c.depthTexture.image.height===c.height||(c.depthTexture.image.width=c.width,c.depthTexture.image.height=c.height,c.depthTexture.needsUpdate=!0);this.setTexture2D(c.depthTexture,0);a=this._properties.get(c.depthTexture).__webglTexture;if(1026===c.depthTexture.format)this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,a,0);else if(1027===c.depthTexture.format)this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,
   this._gl.DEPTH_STENCIL_ATTACHMENT,this._gl.TEXTURE_2D,a,0);else throw Error("Unknown depthTexture format");};a.prototype.setupFrameBufferTexture=function(a,c,d,e){var b=this._utils.convert(c.texture.format),g=this._utils.convert(c.texture.type),h=this.getInternalFormat(b,g);this._state.texImage2D(e,0,h,c.width,c.height,0,b,g,null);this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,a);this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,d,e,this._properties.get(c.texture).__webglTexture,0);this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,
   null)};a.prototype.setupRenderBufferStorage=function(a,c){this._gl.bindRenderbuffer(this._gl.RENDERBUFFER,a);c.depthBuffer&&!c.stencilBuffer?(this._gl.renderbufferStorage(this._gl.RENDERBUFFER,this._gl.DEPTH_COMPONENT16,c.width,c.height),this._gl.framebufferRenderbuffer(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.RENDERBUFFER,a)):c.depthBuffer&&c.stencilBuffer?(this._gl.renderbufferStorage(this._gl.RENDERBUFFER,this._gl.DEPTH_STENCIL,c.width,c.height),this._gl.framebufferRenderbuffer(this._gl.FRAMEBUFFER,
   this._gl.DEPTH_STENCIL_ATTACHMENT,this._gl.RENDERBUFFER,a)):this._gl.renderbufferStorage(this._gl.RENDERBUFFER,this._gl.RGBA4,c.width,c.height);this._gl.bindRenderbuffer(this._gl.RENDERBUFFER,null)};a.prototype.textureNeedsGenerateMipmaps=function(a,c){return a.generateMipmaps&&c&&1003!==a.minFilter&&1006!==a.minFilter};a.prototype.textureNeedsPowerOfTwo=function(a){return this._capabilities.isWebGL2?!1:1001!==a.wrapS||1001!==a.wrapT||1003!==a.minFilter&&1006!==a.minFilter};a.prototype.updateVideoTexture=
   function(a){var b=a.id.value,d=this._info.render.frame;this._videoTextures[b]!==d&&(this._videoTextures[b]=d,a.update())};a.prototype.uploadTexture=function(a,c,d){void 0===a.__webglInit&&(a.__webglInit=!0,a.__webglTexture=this.createWebGLTexture(c,this.onTextureDispose));this._state.activeTexture(this._gl.TEXTURE0+d);this._state.bindTexture(this._gl.TEXTURE_2D,a.__webglTexture);this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,c.flipY);this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,
   c.premultiplyAlpha);this._gl.pixelStorei(this._gl.UNPACK_ALIGNMENT,c.unpackAlignment);d=this.clampToMaxSize(c.image,this._capabilities.maxTextureSize);this.textureNeedsPowerOfTwo(c)&&!1===this.isPowerOfTwo(d)&&(d=this.makePowerOfTwo(d));var b=this.isPowerOfTwo(d),f=this._utils.convert(c.format),g=this._utils.convert(c.type),h=this.getInternalFormat(f,g);this.setTextureParameters(this._gl.TEXTURE_2D,c,b);var k=c.mipmaps;if(c.isDepthTexture){h=this._gl.DEPTH_COMPONENT;if(1015===c.type){if(!this._capabilities.isWebGL2)throw Error("Float Depth Texture only supported in WebGL2.0");
   h=this._gl.DEPTH_COMPONENT32F}else this._capabilities.isWebGL2&&(h=this._gl.DEPTH_COMPONENT16);1026===c.format&&h===this._gl.DEPTH_COMPONENT&&1012!==c.type&&1014!==c.type&&(this._logger.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),c.type=1012,g=this._utils.convert(c.type));1027===c.format&&(h=this._gl.DEPTH_STENCIL,1020!==c.type&&(this._logger.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),c.type=1020,
   g=this._utils.convert(c.type)));this._state.texImage2D(this._gl.TEXTURE_2D,0,h,d.width,d.height,0,f,g,null)}else if(c.isDataTexture)if(0<k.length&&b){for(var m=0,l=k.length;m<l;m++){var n=k[m];this._state.texImage2D(this._gl.TEXTURE_2D,m,h,n.width,n.height,0,f,g,n.data)}c.generateMipmaps=!1;a.__maxMipLevel=k.length-1}else this._state.texImage2D(this._gl.TEXTURE_2D,0,h,d.width,d.height,0,f,g,d.data),a.__maxMipLevel=0;else if(c.isCompressedTexture){m=0;for(l=k.length;m<l;m++)n=k[m],1023!==c.format&&
   1022!==c.format?-1<this._state.getCompressedTextureFormats().indexOf(f)?this._state.compressedTexImage2D(this._gl.TEXTURE_2D,m,h,n.width,n.height,0,n.data):this._logger.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):this._state.texImage2D(this._gl.TEXTURE_2D,m,h,n.width,n.height,0,f,g,n.data);a.__maxMipLevel=k.length-1}else if(0<k.length&&b){m=0;for(l=k.length;m<l;m++)n=k[m],this._state.texImage2D(this._gl.TEXTURE_2D,m,h,f,g,n);c.generateMipmaps=
   !1;a.__maxMipLevel=k.length-1}else this._state.texImage2D(this._gl.TEXTURE_2D,0,h,f,g,d),a.__maxMipLevel=0;this.textureNeedsGenerateMipmaps(c,b)&&this.generateMipmap(this._gl.TEXTURE_2D,c,d.width,d.height);a.__version=c.version;if(c.onUpdate)c.onUpdate(c)};return a}();Mb.prototype=Object.assign(Object.create(B.prototype),{constructor:Mb,isGroup:!0});ea.prototype=Object.assign(Object.create(Qa.prototype),{constructor:ea,isPerspectiveCamera:!0,copy:function(a,b){Qa.prototype.copy.call(this,a,b);this.fov=
   a.fov;this.zoom=a.zoom;this.near=a.near;this.far=a.far;this.focus=a.focus;this.aspect=a.aspect;this.view=null===a.view?null:Object.assign({},a.view);this.filmGauge=a.filmGauge;this.filmOffset=a.filmOffset;return this},setFocalLength:function(a){a=.5*this.getFilmHeight()/a;this.fov=2*Q.RAD2DEG*Math.atan(a);this.updateProjectionMatrix()},getFocalLength:function(){var a=Math.tan(.5*Q.DEG2RAD*this.fov);return.5*this.getFilmHeight()/a},getEffectiveFOV:function(){return 2*Q.RAD2DEG*Math.atan(Math.tan(.5*
   Q.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(a,b,c,d,e,f){this.aspect=a/b;null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1});this.view.enabled=!0;this.view.fullWidth=a;this.view.fullHeight=b;this.view.offsetX=c;this.view.offsetY=d;this.view.width=e;this.view.height=f;this.updateProjectionMatrix()},
   clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1);this.updateProjectionMatrix()},updateProjectionMatrix:function(){var a=this.near,b=a*Math.tan(.5*Q.DEG2RAD*this.fov)/this.zoom,c=2*b,d=this.aspect*c,e=-.5*d,f=this.view;if(null!==this.view&&this.view.enabled){var g=f.fullWidth,h=f.fullHeight;e+=f.offsetX*d/g;b-=f.offsetY*c/h;d*=f.width/g;c*=f.height/h}f=this.filmOffset;0!==f&&(e+=a*f/this.getFilmWidth());this.projectionMatrix.makePerspective(e,e+d,b,b-c,a,this.far)},toJSON:function(a){a=
   B.prototype.toJSON.call(this,a);a.object.fov=this.fov;a.object.zoom=this.zoom;a.object.near=this.near;a.object.far=this.far;a.object.focus=this.focus;a.object.aspect=this.aspect;null!==this.view&&(a.object.view=Object.assign({},this.view));a.object.filmGauge=this.filmGauge;a.object.filmOffset=this.filmOffset;return a}});zc.prototype=Object.assign(Object.create(ea.prototype),{constructor:zc,isArrayCamera:!0});var dh=function(){function a(){this._hash={};this._skipConditions=[]}a.prototype.cache=function(a){this._hash[a.cacheKey()]=
   a};a.prototype.dispose=function(){for(var a in this._hash)this._hash[a].dispose(),delete this._hash[a]};a.prototype.get=function(a){return this._hash[a.cacheKey()]};a.prototype.isInCache=function(a){return!!this._hash[a.cacheKey()]};a.prototype.remove=function(a){return this.isInCache(a)?(a.cacheKey(),delete this._hash[a.cacheKey()],!0):!1};return a}(),Pg=function(){function a(){this._textureCache=new dh}Object.defineProperty(a.prototype,"textureCache",{get:function(){return this._textureCache},enumerable:!0,
   configurable:!0});return a}();Nb.prototype.isFogExp2=!0;Nb.prototype.clone=function(){return new Nb(this.color,this.density)};Nb.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}};Ob.prototype.isFog=!0;Ob.prototype.clone=function(){return new Ob(this.color,this.near,this.far)};Ob.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}};od.prototype=Object.assign(Object.create(B.prototype),{constructor:od,
   copy:function(a,b){B.prototype.copy.call(this,a,b);null!==a.background&&(this.background=a.background.clone());null!==a.fog&&(this.fog=a.fog.clone());null!==a.overrideMaterial&&(this.overrideMaterial=a.overrideMaterial.clone());this.autoUpdate=a.autoUpdate;this.matrixAutoUpdate=a.matrixAutoUpdate;return this},toJSON:function(a){var b=B.prototype.toJSON.call(this,a);null!==this.background&&(b.object.background=this.background.toJSON(a));null!==this.fog&&(b.object.fog=this.fog.toJSON());return b}});
   Object.defineProperty(sb.prototype,"needsUpdate",{set:function(a){!0===a&&this.version++}});Object.assign(sb.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setArray:function(a){if(Array.isArray(a))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==a?a.length/this.stride:0;this.array=a;return this},setDynamic:function(a){this.dynamic=a;return this},copy:function(a){this.array=new a.array.constructor(a.array);this.count=a.count;this.stride=
   a.stride;this.dynamic=a.dynamic;return this},copyAt:function(a,b,c){a*=this.stride;c*=b.stride;for(var d=0,e=this.stride;d<e;d++)this.array[a+d]=b.array[c+d];return this},set:function(a,b){void 0===b&&(b=0);this.array.set(a,b);return this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(a){this.onUploadCallback=a;return this}});Object.defineProperties(Ac.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}});Object.assign(Ac.prototype,
   {isInterleavedBufferAttribute:!0,setX:function(a,b){this.data.array[a*this.data.stride+this.offset]=b;return this},setY:function(a,b){this.data.array[a*this.data.stride+this.offset+1]=b;return this},setZ:function(a,b){this.data.array[a*this.data.stride+this.offset+2]=b;return this},setW:function(a,b){this.data.array[a*this.data.stride+this.offset+3]=b;return this},getX:function(a){return this.data.array[a*this.data.stride+this.offset]},getY:function(a){return this.data.array[a*this.data.stride+this.offset+
   1]},getZ:function(a){return this.data.array[a*this.data.stride+this.offset+2]},getW:function(a){return this.data.array[a*this.data.stride+this.offset+3]},setXY:function(a,b,c){a=a*this.data.stride+this.offset;this.data.array[a+0]=b;this.data.array[a+1]=c;return this},setXYZ:function(a,b,c,d){a=a*this.data.stride+this.offset;this.data.array[a+0]=b;this.data.array[a+1]=c;this.data.array[a+2]=d;return this},setXYZW:function(a,b,c,d,e){a=a*this.data.stride+this.offset;this.data.array[a+0]=b;this.data.array[a+
   1]=c;this.data.array[a+2]=d;this.data.array[a+3]=e;return this}});gb.prototype=Object.create(F.prototype);gb.prototype.constructor=gb;gb.prototype.isSpriteMaterial=!0;gb.prototype.copy=function(a){F.prototype.copy.call(this,a);this.color.copy(a.color);this.map=a.map;this.rotation=a.rotation;return this};var Pb;Bc.prototype=Object.assign(Object.create(B.prototype),{constructor:Bc,isSprite:!0,raycast:function(){function a(a,b,c,d,h,k){e.subVectors(a,c).addScalar(.5).multiply(d);void 0!==h?(f.x=k*e.x-
   h*e.y,f.y=h*e.x+k*e.y):f.copy(e);a.copy(b);a.x+=f.x;a.y+=f.y;a.applyMatrix4(g)}var b=new p,c=new p,d=new p,e=new C,f=new C,g=new M,h=new p,k=new p,m=new p;return function(e,f){c.setFromMatrixScale(this.matrixWorld);g.getInverse(this.modelViewMatrix).premultiply(this.matrixWorld);d.setFromMatrixPosition(this.modelViewMatrix);var l=this.material.rotation;if(0!==l){var n=Math.cos(l);var q=Math.sin(l)}l=this.center;a(h.set(-.5,-.5,0),d,l,c,q,n);a(k.set(.5,-.5,0),d,l,c,q,n);a(m.set(.5,.5,0),d,l,c,q,n);
   var p=e.ray.intersectTriangle(h,k,m,!1,b);if(null===p&&(a(k.set(-.5,.5,0),d,l,c,q,n),p=e.ray.intersectTriangle(h,m,k,!1,b),null===p))return;q=e.ray.origin.distanceTo(b);q<e.near||q>e.far||f.push({distance:q,point:b.clone(),face:null,object:this})}}(),clone:function(){return(new this.constructor(this.material)).copy(this)},copy:function(a){B.prototype.copy.call(this,a);void 0!==a.center&&this.center.copy(a.center);return this}});Cc.prototype=Object.assign(Object.create(B.prototype),{constructor:Cc,
   copy:function(a){B.prototype.copy.call(this,a,!1);a=a.levels;for(var b=0,c=a.length;b<c;b++){var d=a[b];this.addLevel(d.object.clone(),d.distance)}return this},addLevel:function(a,b){void 0===b&&(b=0);b=Math.abs(b);for(var c=this.levels,d=0;d<c.length&&!(b<c[d].distance);d++);c.splice(d,0,{distance:b,object:a});this.add(a)},getObjectForDistance:function(a){for(var b=this.levels,c=1,d=b.length;c<d&&!(a<b[c].distance);c++);return b[c-1].object},raycast:function(){var a=new p;return function(b,c){a.setFromMatrixPosition(this.matrixWorld);
   var d=b.ray.origin.distanceTo(a);this.getObjectForDistance(d).raycast(b,c)}}(),update:function(){var a=new p,b=new p;return function(c){var d=this.levels;if(1<d.length){a.setFromMatrixPosition(c.matrixWorld);b.setFromMatrixPosition(this.matrixWorld);c=a.distanceTo(b);d[0].object.visible=!0;for(var e=1,f=d.length;e<f;e++)if(c>=d[e].distance)d[e-1].object.visible=!1,d[e].object.visible=!0;else break;for(;e<f;e++)d[e].object.visible=!1}}}(),toJSON:function(a){a=B.prototype.toJSON.call(this,a);a.object.levels=
   [];for(var b=this.levels,c=0,d=b.length;c<d;c++){var e=b[c];a.object.levels.push({object:e.object.uuid,distance:e.distance})}return a}});Object.assign(Dc.prototype,{calculateInverses:function(){this.boneInverses=[];for(var a=0,b=this.bones.length;a<b;a++){var c=new M;this.bones[a]&&c.getInverse(this.bones[a].matrixWorld);this.boneInverses.push(c)}},pose:function(){var a,b;var c=0;for(b=this.bones.length;c<b;c++)(a=this.bones[c])&&a.matrixWorld.getInverse(this.boneInverses[c]);c=0;for(b=this.bones.length;c<
   b;c++)if(a=this.bones[c])a.parent&&a.parent.isBone?(a.matrix.getInverse(a.parent.matrixWorld),a.matrix.multiply(a.matrixWorld)):a.matrix.copy(a.matrixWorld),a.matrix.decompose(a.position,a.quaternion,a.scale)},update:function(){var a=new M,b=new M;return function(){for(var c=this.bones,d=this.boneInverses,e=this.boneMatrices,f=this.boneTexture,g=0,h=c.length;g<h;g++)a.multiplyMatrices(c[g]?c[g].matrixWorld:b,d[g]),a.toArray(e,16*g);void 0!==f&&(f.needsUpdate=!0)}}(),clone:function(){return new Dc(this.bones,
   this.boneInverses)},getBoneByName:function(a){for(var b=0,c=this.bones.length;b<c;b++){var d=this.bones[b];if(d.name===a)return d}}});pd.prototype=Object.assign(Object.create(B.prototype),{constructor:pd,isBone:!0});qd.prototype=Object.assign(Object.create(ra.prototype),{constructor:qd,isSkinnedMesh:!0,initBones:function(){var a=[],b;if(this.geometry&&void 0!==this.geometry.bones){var c=0;for(b=this.geometry.bones.length;c<b;c++){var d=this.geometry.bones[c];var e=new pd;a.push(e);e.name=d.name;e.position.fromArray(d.pos);
   e.quaternion.fromArray(d.rotq);void 0!==d.scl&&e.scale.fromArray(d.scl)}c=0;for(b=this.geometry.bones.length;c<b;c++)d=this.geometry.bones[c],-1!==d.parent&&null!==d.parent&&void 0!==a[d.parent]?a[d.parent].add(a[c]):this.add(a[c])}this.updateMatrixWorld(!0);return a},bind:function(a,b){this.skeleton=a;void 0===b&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),b=this.matrixWorld);this.bindMatrix.copy(b);this.bindMatrixInverse.getInverse(b)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var a;
   if(this.geometry&&this.geometry.isGeometry)for(a=0;a<this.geometry.skinWeights.length;a++){var b=this.geometry.skinWeights[a];var c=1/b.manhattanLength();Infinity!==c?b.multiplyScalar(c):b.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry){b=new ca;var d=this.geometry.attributes.skinWeight;for(a=0;a<d.count;a++)b.x=d.getX(a),b.y=d.getY(a),b.z=d.getZ(a),b.w=d.getW(a),c=1/b.manhattanLength(),Infinity!==c?b.multiplyScalar(c):b.set(1,0,0,0),d.setXYZW(a,b.x,b.y,b.z,b.w)}},updateMatrixWorld:function(a){ra.prototype.updateMatrixWorld.call(this,
   a);"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return(new this.constructor(this.geometry,this.material)).copy(this)}});T.prototype=Object.create(F.prototype);T.prototype.constructor=T;T.prototype.isLineBasicMaterial=!0;T.prototype.copy=function(a){F.prototype.copy.call(this,a);this.color.copy(a.color);
   this.linewidth=a.linewidth;this.linecap=a.linecap;this.linejoin=a.linejoin;return this};ma.prototype=Object.assign(Object.create(B.prototype),{constructor:ma,isLine:!0,computeLineDistances:function(){var a=new p,b=new p;return function(){var c=this.geometry;if(c.isBufferGeometry)if(null===c.index){for(var d=c.attributes.position,e=[0],f=1,g=d.count;f<g;f++)a.fromBufferAttribute(d,f-1),b.fromBufferAttribute(d,f),e[f]=e[f-1],e[f]+=a.distanceTo(b);c.addAttribute("lineDistance",new A(e,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");
   else if(c.isGeometry)for(d=c.vertices,e=c.lineDistances,e[0]=0,f=1,g=d.length;f<g;f++)e[f]=e[f-1],e[f]+=d[f-1].distanceTo(d[f]);return this}}(),raycast:function(){var a=new M,b=new qb,c=new za;return function(d,e){var f=d.linePrecision;f*=f;var g=this.geometry,h=this.matrixWorld;null===g.boundingSphere&&g.computeBoundingSphere();c.copy(g.boundingSphere);c.applyMatrix4(h);if(!1!==d.ray.intersectsSphere(c)){a.getInverse(h);b.copy(d.ray).applyMatrix4(a);var k=new p,m=new p;h=new p;var l=new p,n=this&&
   this.isLineSegments?2:1;if(g.isBufferGeometry){var u=g.index,t=g.attributes.position.array;if(null!==u){u=u.array;g=0;for(var r=u.length-1;g<r;g+=n){var v=u[g+1];k.fromArray(t,3*u[g]);m.fromArray(t,3*v);v=b.distanceSqToSegment(k,m,l,h);v>f||(l.applyMatrix4(this.matrixWorld),v=d.ray.origin.distanceTo(l),v<d.near||v>d.far||e.push({distance:v,point:h.clone().applyMatrix4(this.matrixWorld),index:g,face:null,faceIndex:null,object:this}))}}else for(g=0,r=t.length/3-1;g<r;g+=n)k.fromArray(t,3*g),m.fromArray(t,
   3*g+3),v=b.distanceSqToSegment(k,m,l,h),v>f||(l.applyMatrix4(this.matrixWorld),v=d.ray.origin.distanceTo(l),v<d.near||v>d.far||e.push({distance:v,point:h.clone().applyMatrix4(this.matrixWorld),index:g,face:null,faceIndex:null,object:this}))}else if(g.isGeometry)for(k=g.vertices,m=k.length,g=0;g<m-1;g+=n)v=b.distanceSqToSegment(k[g],k[g+1],l,h),v>f||(l.applyMatrix4(this.matrixWorld),v=d.ray.origin.distanceTo(l),v<d.near||v>d.far||e.push({distance:v,point:h.clone().applyMatrix4(this.matrixWorld),index:g,
   face:null,faceIndex:null,object:this}))}}}(),clone:function(){return(new this.constructor(this.geometry,this.material)).copy(this)}});W.prototype=Object.assign(Object.create(ma.prototype),{constructor:W,isLineSegments:!0,computeLineDistances:function(){var a=new p,b=new p;return function(){var c=this.geometry;if(c.isBufferGeometry)if(null===c.index){for(var d=c.attributes.position,e=[],f=0,g=d.count;f<g;f+=2)a.fromBufferAttribute(d,f),b.fromBufferAttribute(d,f+1),e[f]=0===f?0:e[f-1],e[f+1]=e[f]+a.distanceTo(b);
   c.addAttribute("lineDistance",new A(e,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(c.isGeometry)for(d=c.vertices,e=c.lineDistances,f=0,g=d.length;f<g;f+=2)a.copy(d[f]),b.copy(d[f+1]),e[f]=0===f?0:e[f-1],e[f+1]=e[f]+a.distanceTo(b);return this}}()});rd.prototype=Object.assign(Object.create(ma.prototype),{constructor:rd,isLineLoop:!0});Ha.prototype=Object.create(F.prototype);Ha.prototype.constructor=Ha;Ha.prototype.isPointsMaterial=
   !0;Ha.prototype.copy=function(a){F.prototype.copy.call(this,a);this.color.copy(a.color);this.map=a.map;this.size=a.size;this.sizeAttenuation=a.sizeAttenuation;this.morphTargets=a.morphTargets;return this};Qb.prototype=Object.assign(Object.create(B.prototype),{constructor:Qb,isPoints:!0,raycast:function(){var a=new M,b=new qb,c=new za;return function(d,e){function f(a,c){var f=b.distanceSqToPoint(a);f<l&&(b.closestPointToPoint(a,n),n.applyMatrix4(k),a=d.ray.origin.distanceTo(n),a<d.near||a>d.far||
   e.push({distance:a,distanceToRay:Math.sqrt(f),point:n.clone(),index:c,face:null,object:g}))}var g=this,h=this.geometry,k=this.matrixWorld,m=d.params.Points.threshold;null===h.boundingSphere&&h.computeBoundingSphere();c.copy(h.boundingSphere);c.applyMatrix4(k);c.radius+=m;if(!1!==d.ray.intersectsSphere(c)){a.getInverse(k);b.copy(d.ray).applyMatrix4(a);m/=(this.scale.x+this.scale.y+this.scale.z)/3;var l=m*m;m=new p;var n=new p;if(h.isBufferGeometry){var u=h.index;h=h.attributes.position.array;if(null!==
   u){var t=u.array;u=0;for(var r=t.length;u<r;u++){var v=t[u];m.fromArray(h,3*v);f(m,v)}}else for(u=0,t=h.length/3;u<t;u++)m.fromArray(h,3*u),f(m,u)}else for(m=h.vertices,u=0,t=m.length;u<t;u++)f(m[u],u)}}}(),clone:function(){return(new this.constructor(this.geometry,this.material)).copy(this)}});Xd.prototype=Object.assign(Object.create(ta.prototype),{constructor:Xd,isVideoTexture:!0,update:function(){var a=this.image;a.readyState>=a.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}});Rb.prototype=Object.create(ta.prototype);
   Rb.prototype.constructor=Rb;Rb.prototype.isCompressedTexture=!0;var eh=function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),fh=function(a){function b(b,d,e,f,g,h,k,m,l){b=a.call(this,b,d,e,f,g,h,k,m,l)||this;b.needsUpdate=!0;
   return b}eh(b,a);Object.defineProperty(b.prototype,"isCanvasTexture",{get:function(){return!0},enumerable:!0,configurable:!0});return b}(ta);Ec.prototype=Object.create(ta.prototype);Ec.prototype.constructor=Ec;Ec.prototype.isDepthTexture=!0;Sb.prototype=Object.create(E.prototype);Sb.prototype.constructor=Sb;Fc.prototype=Object.create(K.prototype);Fc.prototype.constructor=Fc;Tb.prototype=Object.create(E.prototype);Tb.prototype.constructor=Tb;Gc.prototype=Object.create(K.prototype);Gc.prototype.constructor=
   Gc;ua.prototype=Object.create(E.prototype);ua.prototype.constructor=ua;Hc.prototype=Object.create(K.prototype);Hc.prototype.constructor=Hc;Ub.prototype=Object.create(ua.prototype);Ub.prototype.constructor=Ub;Ic.prototype=Object.create(K.prototype);Ic.prototype.constructor=Ic;tb.prototype=Object.create(ua.prototype);tb.prototype.constructor=tb;Jc.prototype=Object.create(K.prototype);Jc.prototype.constructor=Jc;Vb.prototype=Object.create(ua.prototype);Vb.prototype.constructor=Vb;Kc.prototype=Object.create(K.prototype);
   Kc.prototype.constructor=Kc;Wb.prototype=Object.create(ua.prototype);Wb.prototype.constructor=Wb;Lc.prototype=Object.create(K.prototype);Lc.prototype.constructor=Lc;Xb.prototype=Object.create(E.prototype);Xb.prototype.constructor=Xb;Mc.prototype=Object.create(K.prototype);Mc.prototype.constructor=Mc;Yb.prototype=Object.create(E.prototype);Yb.prototype.constructor=Yb;Nc.prototype=Object.create(K.prototype);Nc.prototype.constructor=Nc;Zb.prototype=Object.create(E.prototype);Zb.prototype.constructor=
   Zb;var gh={triangulate:function(a,b,c){c=c||2;var d=b&&b.length,e=d?b[0]*c:a.length,f=Ze(a,0,e,c,!0),g=[];if(!f)return g;var h;if(d){var k=c;d=[];var m;var l=0;for(m=b.length;l<m;l++){var n=b[l]*k;var p=l<m-1?b[l+1]*k:a.length;n=Ze(a,n,p,k,!1);n===n.next&&(n.steiner=!0);d.push(Sg(n))}d.sort(Qg);for(l=0;l<d.length;l++){b=d[l];k=f;if(k=Rg(b,k))b=bf(k,b),Pc(b,b.next);f=Pc(f,f.next)}}if(a.length>80*c){var t=h=a[0];var r=d=a[1];for(k=c;k<e;k+=c)l=a[k],b=a[k+1],l<t&&(t=l),b<r&&(r=b),l>h&&(h=l),b>d&&(d=
   b);h=Math.max(h-t,d-r);h=0!==h?1/h:0}Qc(f,g,c,t,r,h);return g}},Ya={area:function(a){for(var b=a.length,c=0,d=b-1,e=0;e<b;d=e++)c+=a[d].x*a[e].y-a[e].x*a[d].y;return.5*c},isClockWise:function(a){return 0>Ya.area(a)},triangulateShape:function(a,b){var c=[],d=[],e=[];cf(a);df(c,a);var f=a.length;b.forEach(cf);for(a=0;a<b.length;a++)d.push(f),f+=b[a].length,df(c,b[a]);b=gh.triangulate(c,d);for(a=0;a<b.length;a+=3)e.push(b.slice(a,a+3));return e}};vb.prototype=Object.create(K.prototype);vb.prototype.constructor=
   vb;vb.prototype.toJSON=function(){var a=K.prototype.toJSON.call(this);return ef(this.parameters.shapes,this.parameters.options,a)};Ra.prototype=Object.create(E.prototype);Ra.prototype.constructor=Ra;Ra.prototype.toJSON=function(){var a=E.prototype.toJSON.call(this);return ef(this.parameters.shapes,this.parameters.options,a)};var Tg={generateTopUV:function(a,b,c,d,e){a=b[3*d];d=b[3*d+1];var f=b[3*e];e=b[3*e+1];return[new C(b[3*c],b[3*c+1]),new C(a,d),new C(f,e)]},generateSideWallUV:function(a,b,c,
   d,e,f){a=b[3*c];var g=b[3*c+1];c=b[3*c+2];var h=b[3*d],k=b[3*d+1];d=b[3*d+2];var m=b[3*e],l=b[3*e+1];e=b[3*e+2];var n=b[3*f],p=b[3*f+1];b=b[3*f+2];return.01>Math.abs(g-k)?[new C(a,1-c),new C(h,1-d),new C(m,1-e),new C(n,1-b)]:[new C(g,1-c),new C(k,1-d),new C(l,1-e),new C(p,1-b)]}};Sc.prototype=Object.create(K.prototype);Sc.prototype.constructor=Sc;$b.prototype=Object.create(Ra.prototype);$b.prototype.constructor=$b;Tc.prototype=Object.create(K.prototype);Tc.prototype.constructor=Tc;wb.prototype=Object.create(E.prototype);
   wb.prototype.constructor=wb;Uc.prototype=Object.create(K.prototype);Uc.prototype.constructor=Uc;ac.prototype=Object.create(E.prototype);ac.prototype.constructor=ac;Vc.prototype=Object.create(K.prototype);Vc.prototype.constructor=Vc;bc.prototype=Object.create(E.prototype);bc.prototype.constructor=bc;xb.prototype=Object.create(K.prototype);xb.prototype.constructor=xb;xb.prototype.toJSON=function(){var a=K.prototype.toJSON.call(this);return ff(this.parameters.shapes,a)};yb.prototype=Object.create(E.prototype);
   yb.prototype.constructor=yb;yb.prototype.toJSON=function(){var a=E.prototype.toJSON.call(this);return ff(this.parameters.shapes,a)};cc.prototype=Object.create(E.prototype);cc.prototype.constructor=cc;zb.prototype=Object.create(K.prototype);zb.prototype.constructor=zb;Za.prototype=Object.create(E.prototype);Za.prototype.constructor=Za;Wc.prototype=Object.create(zb.prototype);Wc.prototype.constructor=Wc;Xc.prototype=Object.create(Za.prototype);Xc.prototype.constructor=Xc;Yc.prototype=Object.create(K.prototype);
   Yc.prototype.constructor=Yc;dc.prototype=Object.create(E.prototype);dc.prototype.constructor=dc;var ya=Object.freeze({WireframeGeometry:Sb,ParametricGeometry:Fc,ParametricBufferGeometry:Tb,TetrahedronGeometry:Hc,TetrahedronBufferGeometry:Ub,OctahedronGeometry:Ic,OctahedronBufferGeometry:tb,IcosahedronGeometry:Jc,IcosahedronBufferGeometry:Vb,DodecahedronGeometry:Kc,DodecahedronBufferGeometry:Wb,PolyhedronGeometry:Gc,PolyhedronBufferGeometry:ua,TubeGeometry:Lc,TubeBufferGeometry:Xb,TorusKnotGeometry:Mc,
   TorusKnotBufferGeometry:Yb,TorusGeometry:Nc,TorusBufferGeometry:Zb,TextGeometry:Sc,TextBufferGeometry:$b,SphereGeometry:Tc,SphereBufferGeometry:wb,RingGeometry:Uc,RingBufferGeometry:ac,PlaneGeometry:wc,PlaneBufferGeometry:pb,LatheGeometry:Vc,LatheBufferGeometry:bc,ShapeGeometry:xb,ShapeBufferGeometry:yb,ExtrudeGeometry:vb,ExtrudeBufferGeometry:Ra,EdgesGeometry:cc,ConeGeometry:Wc,ConeBufferGeometry:Xc,CylinderGeometry:zb,CylinderBufferGeometry:Za,CircleGeometry:Yc,CircleBufferGeometry:dc,BoxGeometry:Kb,
   BoxBufferGeometry:ob});Ab.prototype=Object.create(F.prototype);Ab.prototype.constructor=Ab;Ab.prototype.isShadowMaterial=!0;Ab.prototype.copy=function(a){F.prototype.copy.call(this,a);this.color.copy(a.color);return this};ec.prototype=Object.create(Da.prototype);ec.prototype.constructor=ec;ec.prototype.isRawShaderMaterial=!0;Sa.prototype=Object.create(F.prototype);Sa.prototype.constructor=Sa;Sa.prototype.isMeshStandardMaterial=!0;Sa.prototype.copy=function(a){F.prototype.copy.call(this,a);this.defines=
   {STANDARD:""};this.color.copy(a.color);this.roughness=a.roughness;this.metalness=a.metalness;this.map=a.map;this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.emissive.copy(a.emissive);this.emissiveMap=a.emissiveMap;this.emissiveIntensity=a.emissiveIntensity;this.bumpMap=a.bumpMap;this.bumpScale=a.bumpScale;this.normalMap=a.normalMap;this.normalMapType=a.normalMapType;this.normalScale.copy(a.normalScale);this.displacementMap=
   a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.roughnessMap=a.roughnessMap;this.metalnessMap=a.metalnessMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.envMapIntensity=a.envMapIntensity;this.refractionRatio=a.refractionRatio;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;this.skinning=a.skinning;this.morphTargets=a.morphTargets;
   this.morphNormals=a.morphNormals;return this};Bb.prototype=Object.create(Sa.prototype);Bb.prototype.constructor=Bb;Bb.prototype.isMeshPhysicalMaterial=!0;Bb.prototype.copy=function(a){Sa.prototype.copy.call(this,a);this.defines={PHYSICAL:""};this.reflectivity=a.reflectivity;this.clearCoat=a.clearCoat;this.clearCoatRoughness=a.clearCoatRoughness;return this};Ia.prototype=Object.create(F.prototype);Ia.prototype.constructor=Ia;Ia.prototype.isMeshPhongMaterial=!0;Ia.prototype.copy=function(a){F.prototype.copy.call(this,
   a);this.color.copy(a.color);this.specular.copy(a.specular);this.shininess=a.shininess;this.map=a.map;this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.emissive.copy(a.emissive);this.emissiveMap=a.emissiveMap;this.emissiveIntensity=a.emissiveIntensity;this.bumpMap=a.bumpMap;this.bumpScale=a.bumpScale;this.normalMap=a.normalMap;this.normalMapType=a.normalMapType;this.normalScale.copy(a.normalScale);this.displacementMap=a.displacementMap;
   this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.specularMap=a.specularMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.combine=a.combine;this.reflectivity=a.reflectivity;this.refractionRatio=a.refractionRatio;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.morphNormals=a.morphNormals;
   return this};Cb.prototype=Object.create(Ia.prototype);Cb.prototype.constructor=Cb;Cb.prototype.isMeshToonMaterial=!0;Cb.prototype.copy=function(a){Ia.prototype.copy.call(this,a);this.gradientMap=a.gradientMap;return this};Db.prototype=Object.create(F.prototype);Db.prototype.constructor=Db;Db.prototype.isMeshNormalMaterial=!0;Db.prototype.copy=function(a){F.prototype.copy.call(this,a);this.bumpMap=a.bumpMap;this.bumpScale=a.bumpScale;this.normalMap=a.normalMap;this.normalMapType=a.normalMapType;this.normalScale.copy(a.normalScale);
   this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.morphNormals=a.morphNormals;return this};Eb.prototype=Object.create(F.prototype);Eb.prototype.constructor=Eb;Eb.prototype.isMeshLambertMaterial=!0;Eb.prototype.copy=function(a){F.prototype.copy.call(this,a);this.color.copy(a.color);this.map=a.map;
   this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.emissive.copy(a.emissive);this.emissiveMap=a.emissiveMap;this.emissiveIntensity=a.emissiveIntensity;this.specularMap=a.specularMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.combine=a.combine;this.reflectivity=a.reflectivity;this.refractionRatio=a.refractionRatio;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;
   this.wireframeLinejoin=a.wireframeLinejoin;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.morphNormals=a.morphNormals;return this};Fb.prototype=Object.create(T.prototype);Fb.prototype.constructor=Fb;Fb.prototype.isLineDashedMaterial=!0;Fb.prototype.copy=function(a){T.prototype.copy.call(this,a);this.scale=a.scale;this.dashSize=a.dashSize;this.gapSize=a.gapSize;return this};var hh=Object.freeze({ShadowMaterial:Ab,SpriteMaterial:gb,RawShaderMaterial:ec,ShaderMaterial:Da,PointsMaterial:Ha,
   MeshPhysicalMaterial:Bb,MeshStandardMaterial:Sa,MeshPhongMaterial:Ia,MeshToonMaterial:Cb,MeshNormalMaterial:Db,MeshLambertMaterial:Eb,MeshDepthMaterial:db,MeshDistanceMaterial:eb,MeshBasicMaterial:Aa,LineDashedMaterial:Fb,LineBasicMaterial:T,Material:F}),ab=new (function(){function a(){this._files={};this.enabled=!1}a.prototype.add=function(a,c){!1!==this.enabled&&(this._files[a]=c)};a.prototype.clear=function(){this._files={}};a.prototype.get=function(a){if(!1!==this.enabled)return this._files[a]};
   a.prototype.remove=function(a){delete this._files[a]};return a}()),ve=function(){function a(a,c,d){void 0===a&&(a=null);void 0===c&&(c=null);void 0===d&&(d=null);this.onLoad=a;this.onProgress=c;this.onError=d;this.isLoading=!1;this.itemsTotal=this.itemsLoaded=0}a.prototype.itemEnd=function(a){this.itemsLoaded++;if("function"===typeof this.onProgress)this.onProgress(a,this.itemsLoaded,this.itemsTotal);if(this.itemsLoaded===this.itemsTotal&&(this.isLoading=!1,"function"===typeof this.onLoad))this.onLoad()};
   a.prototype.itemError=function(a){if("function"===typeof this.onError)this.onError(a)};a.prototype.itemStart=function(a){this.itemsTotal++;if(!1===this.isLoading&&"function"===typeof this.onStart)this.onStart(a,this.itemsLoaded,this.itemsTotal)};a.prototype.resolveURL=function(a){return this.urlModifier?this.urlModifier(a):a};a.prototype.setURLModifier=function(a){this.urlModifier=a;return this};return a}(),sa=new ve,bb={};Object.assign(Ja.prototype,{load:function(a,b,c,d){void 0===a&&(a="");void 0!==
   this.path&&(a=this.path+a);a=this.manager.resolveURL(a);var e=this,f=ab.get(a);if(void 0!==f)return e.manager.itemStart(a),setTimeout(function(){b&&b(f);e.manager.itemEnd(a)},0),f;if(void 0!==bb[a])bb[a].push({onLoad:b,onProgress:c,onError:d});else{var g=a.match(/^data:(.*?)(;base64)?,(.*)$/);if(g){c=g[1];var h=!!g[2];g=g[3];g=window.decodeURIComponent(g);h&&(g=window.atob(g));try{var k=(this.responseType||"").toLowerCase();switch(k){case "arraybuffer":case "blob":var m=new Uint8Array(g.length);for(h=
   0;h<g.length;h++)m[h]=g.charCodeAt(h);var l="blob"===k?new Blob([m.buffer],{type:c}):m.buffer;break;case "document":l=(new DOMParser).parseFromString(g,c);break;case "json":l=JSON.parse(g);break;default:l=g}window.setTimeout(function(){b&&b(l);e.manager.itemEnd(a)},0)}catch(u){window.setTimeout(function(){d&&d(u);e.manager.itemEnd(a);e.manager.itemError(a)},0)}}else{bb[a]=[];bb[a].push({onLoad:b,onProgress:c,onError:d});var n=new XMLHttpRequest;n.open("GET",a,!0);n.addEventListener("load",function(b){var c=
   this.response;ab.add(a,c);var d=bb[a];delete bb[a];if(200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received.");for(var f=0,g=d.length;f<g;f++){var h=d[f];if(h.onLoad)h.onLoad(c)}e.manager.itemEnd(a)}else{f=0;for(g=d.length;f<g;f++)if(h=d[f],h.onError)h.onError(b);e.manager.itemEnd(a);e.manager.itemError(a)}},!1);n.addEventListener("progress",function(b){for(var c=bb[a],d=0,e=c.length;d<e;d++){var f=c[d];if(f.onProgress)f.onProgress(b)}},!1);n.addEventListener("error",
   function(b){var c=bb[a];delete bb[a];for(var d=0,f=c.length;d<f;d++){var g=c[d];if(g.onError)g.onError(b)}e.manager.itemEnd(a);e.manager.itemError(a)},!1);void 0!==this.responseType&&(n.responseType=this.responseType);void 0!==this.withCredentials&&(n.withCredentials=this.withCredentials);n.overrideMimeType&&n.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(h in this.requestHeader)n.setRequestHeader(h,this.requestHeader[h]);n.send(null)}e.manager.itemStart(a);return n}},setPath:function(a){this.path=
   a;return this},setResponseType:function(a){this.responseType=a;return this},setWithCredentials:function(a){this.withCredentials=a;return this},setMimeType:function(a){this.mimeType=a;return this},setRequestHeader:function(a){this.requestHeader=a;return this}});Object.assign(gf.prototype,{load:function(a,b,c,d){function e(e){k.load(a[e],function(a){a=f._parser(a,!0);g[e]={width:a.width,height:a.height,format:a.format,mipmaps:a.mipmaps};m+=1;6===m&&(1===a.mipmapCount&&(h.minFilter=1006),h.format=a.format,
   h.needsUpdate=!0,b&&b(h))},c,d)}var f=this,g=[],h=new Rb;h.image=g;var k=new Ja(this.manager);k.setPath(this.path);k.setResponseType("arraybuffer");if(Array.isArray(a))for(var m=0,l=0,n=a.length;l<n;++l)e(l);else k.load(a,function(a){a=f._parser(a,!0);if(a.isCubemap)for(var c=a.mipmaps.length/a.mipmapCount,d=0;d<c;d++){g[d]={mipmaps:[]};for(var e=0;e<a.mipmapCount;e++)g[d].mipmaps.push(a.mipmaps[d*a.mipmapCount+e]),g[d].format=a.format,g[d].width=a.width,g[d].height=a.height}else h.image.width=a.width,
   h.image.height=a.height,h.mipmaps=a.mipmaps;1===a.mipmapCount&&(h.minFilter=1006);h.format=a.format;h.needsUpdate=!0;b&&b(h)},c,d);return h},setPath:function(a){this.path=a;return this}});Object.assign($d.prototype,{load:function(a,b,c,d){var e=this,f=new kb,g=new Ja(this.manager);g.setResponseType("arraybuffer");g.load(a,function(a){if(a=e._parser(a))void 0!==a.image?f.image=a.image:void 0!==a.data&&(f.image.width=a.width,f.image.height=a.height,f.image.data=a.data),f.wrapS=void 0!==a.wrapS?a.wrapS:
   1001,f.wrapT=void 0!==a.wrapT?a.wrapT:1001,f.magFilter=void 0!==a.magFilter?a.magFilter:1006,f.minFilter=void 0!==a.minFilter?a.minFilter:1008,f.anisotropy=void 0!==a.anisotropy?a.anisotropy:1,void 0!==a.format&&(f.format=a.format),void 0!==a.type&&(f.type=a.type),void 0!==a.mipmaps&&(f.mipmaps=a.mipmaps),1===a.mipmapCount&&(f.minFilter=1006),f.needsUpdate=!0,b&&b(f,a)},c,d);return f}});var ih=function(a,b,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,
   g){function f(a){try{m(d.next(a))}catch(n){g(n)}}function k(a){try{m(d["throw"](a))}catch(n){g(n)}}function m(a){a.done?c(a.value):e(a.value).then(f,k)}m((d=d.apply(a,b||[])).next())})},jh=function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(f)throw new TypeError("Generator is already executing.");for(;e;)try{if(f=1,g&&(h=c[0]&2?g["return"]:c[0]?g["throw"]||((h=g["return"])&&h.call(g),0):g.next)&&!(h=h.call(g,c[1])).done)return h;if(g=0,h)c=[c[0]&2,h.value];switch(c[0]){case 0:case 1:h=
   c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++;g=c[1];c=[0];continue;case 7:c=e.ops.pop();e.trys.pop();continue;default:if(!(h=e.trys,h=0<h.length&&h[h.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!h||c[1]>h[0]&&c[1]<h[3]))e.label=c[1];else if(6===c[0]&&e.label<h[1])e.label=h[1],h=c;else if(h&&e.label<h[2])e.label=h[2],e.ops.push(c);else{h[2]&&e.ops.pop();e.trys.pop();continue}}c=b.call(a,e)}catch(q){c=[6,q],g=0}finally{f=h=0}if(c[0]&5)throw c[1];return{value:c[0]?
   c[1]:void 0,done:!0}}var e={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},f,g,h,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k},Nd=function(){function a(a){this._crossOrigin="anonymous";this._manager=a?a:sa}Object.defineProperty(a.prototype,"manager",{get:function(){return this._manager},enumerable:!0,configurable:!0});a.prototype.load=function(a,c,d,e){var b=this;void 0===a&&(a="");void 0!==
   this._path&&(a=this._path+a);a=this._manager.resolveURL(a);d=ab.get(a);if(void 0!==d){this._manager.itemStart(a);e=d[0];var g=d[1];!0===d[2]?(c&&c(e),b._manager.itemEnd(a)):g.then(function(d){c&&c(d);b._manager.itemEnd(a)});return e}d=document.createElementNS("http://www.w3.org/1999/xhtml","img");e=[d,this.loadImage(d,a,c,e),!1];ab.add(a,e);return d};a.prototype.setCrossOrigin=function(a){this._crossOrigin=a;return this};a.prototype.setPath=function(a){this._path=a;return this};a.prototype.loadImage=
   function(a,c,d,e){return ih(this,void 0,void 0,function(){var b=this;return jh(this,function(f){return[2,new Promise(function(f,g){var h=function(){a.removeEventListener("load",h,!1);a.removeEventListener("error",k,!1);ab.get(c)[2]=!0;d&&d(a);b._manager.itemEnd(c);f(a)},k=function(d){a.removeEventListener("load",h,!1);a.removeEventListener("error",k,!1);ab.remove(c);e&&e(d);b._manager.itemEnd(c);b._manager.itemError(c);g(d)};a.addEventListener("load",h,!1);a.addEventListener("error",k,!1);"data:"!==
   c.substr(0,5)&&void 0!==b._crossOrigin&&(a.crossOrigin=b._crossOrigin);b._manager.itemStart(c);a.src=c;return a})]})})};return a}(),Bf=function(){function a(a){this._crossOrigin="anonymous";this._manager=a?a:sa;this._imageLoader=new Nd(this._manager)}Object.defineProperty(a.prototype,"crossOrigin",{get:function(){return this._crossOrigin},enumerable:!0,configurable:!0});a.prototype.load=function(a,c,d,e){var b=this,g=new Md;this._imageLoader.setCrossOrigin(this.crossOrigin);this._imageLoader.setPath(this._path);
   var h=0;d=function(d){b._imageLoader.load(a[d],function(a){g.images[d]=a;h++;6===h&&(g.needsUpdate=!0,c&&c(g))},void 0,e)};for(var k=0;k<a.length;++k)d(k);return g};a.prototype.setCrossOrigin=function(a){this._crossOrigin=a;return this};a.prototype.setPath=function(a){this._path=a;return this};return a}();Object.assign(td.prototype,{crossOrigin:"anonymous",load:function(a,b,c,d){var e=new ta,f=new Nd(this.manager);f.setCrossOrigin(this.crossOrigin);f.setPath(this.path);f.load(a,function(c){e.image=
   c;c=0<a.search(/\.(jpg|jpeg)$/)||0===a.search(/^data:image\/jpeg/);e.format=c?1022:1023;e.needsUpdate=!0;void 0!==b&&b(e)},c,d);return e},setCrossOrigin:function(a){this.crossOrigin=a;return this},setPath:function(a){this.path=a;return this}});Object.assign(L.prototype,{getPoint:function(){console.warn("THREE.Curve: .getPoint() not implemented.");return null},getPointAt:function(a,b){a=this.getUtoTmapping(a);return this.getPoint(a,b)},getPoints:function(a){void 0===a&&(a=5);for(var b=[],c=0;c<=a;c++)b.push(this.getPoint(c/
   a));return b},getSpacedPoints:function(a){void 0===a&&(a=5);for(var b=[],c=0;c<=a;c++)b.push(this.getPointAt(c/a));return b},getLength:function(){var a=this.getLengths();return a[a.length-1]},getLengths:function(a){void 0===a&&(a=this.arcLengthDivisions);if(this.cacheArcLengths&&this.cacheArcLengths.length===a+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var b=[],c=this.getPoint(0),d,e=0;b.push(0);for(d=1;d<=a;d++){var f=this.getPoint(d/a);e+=f.distanceTo(c);b.push(e);c=f}return this.cacheArcLengths=
   b},updateArcLengths:function(){this.needsUpdate=!0;this.getLengths()},getUtoTmapping:function(a,b){var c=this.getLengths(),d=c.length;b=b?b:a*c[d-1];for(var e=0,f=d-1,g;e<=f;)if(a=Math.floor(e+(f-e)/2),g=c[a]-b,0>g)e=a+1;else if(0<g)f=a-1;else{f=a;break}a=f;if(c[a]===b)return a/(d-1);e=c[a];return(a+(b-e)/(c[a+1]-e))/(d-1)},getTangent:function(a){var b=a-1E-4;a+=1E-4;0>b&&(b=0);1<a&&(a=1);b=this.getPoint(b);return this.getPoint(a).clone().sub(b).normalize()},getTangentAt:function(a){a=this.getUtoTmapping(a);
   return this.getTangent(a)},computeFrenetFrames:function(a,b){var c=new p,d=[],e=[],f=[],g=new p,h=new M,k;for(k=0;k<=a;k++){var m=k/a;d[k]=this.getTangentAt(m);d[k].normalize()}e[0]=new p;f[0]=new p;k=Number.MAX_VALUE;m=Math.abs(d[0].x);var l=Math.abs(d[0].y),n=Math.abs(d[0].z);m<=k&&(k=m,c.set(1,0,0));l<=k&&(k=l,c.set(0,1,0));n<=k&&c.set(0,0,1);g.crossVectors(d[0],c).normalize();e[0].crossVectors(d[0],g);f[0].crossVectors(d[0],e[0]);for(k=1;k<=a;k++)e[k]=e[k-1].clone(),f[k]=f[k-1].clone(),g.crossVectors(d[k-
   1],d[k]),g.length()>Number.EPSILON&&(g.normalize(),c=Math.acos(Q.clamp(d[k-1].dot(d[k]),-1,1)),e[k].applyMatrix4(h.makeRotationAxis(g,c))),f[k].crossVectors(d[k],e[k]);if(!0===b)for(c=Math.acos(Q.clamp(e[0].dot(e[a]),-1,1)),c/=a,0<d[0].dot(g.crossVectors(e[0],e[a]))&&(c=-c),k=1;k<=a;k++)e[k].applyMatrix4(h.makeRotationAxis(d[k],c*k)),f[k].crossVectors(d[k],e[k]);return{tangents:d,normals:e,binormals:f}},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.arcLengthDivisions=
   a.arcLengthDivisions;return this},toJSON:function(){var a={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};a.arcLengthDivisions=this.arcLengthDivisions;a.type=this.type;return a},fromJSON:function(a){this.arcLengthDivisions=a.arcLengthDivisions;return this}});ka.prototype=Object.create(L.prototype);ka.prototype.constructor=ka;ka.prototype.isEllipseCurve=!0;ka.prototype.getPoint=function(a,b){b=b||new C;for(var c=2*Math.PI,d=this.aEndAngle-this.aStartAngle,e=Math.abs(d)<Number.EPSILON;0>
   d;)d+=c;for(;d>c;)d-=c;d<Number.EPSILON&&(d=e?0:c);!0!==this.aClockwise||e||(d=d===c?-c:d-c);c=this.aStartAngle+a*d;a=this.aX+this.xRadius*Math.cos(c);var f=this.aY+this.yRadius*Math.sin(c);0!==this.aRotation&&(c=Math.cos(this.aRotation),d=Math.sin(this.aRotation),e=a-this.aX,f-=this.aY,a=e*c-f*d+this.aX,f=e*d+f*c+this.aY);return b.set(a,f)};ka.prototype.copy=function(a){L.prototype.copy.call(this,a);this.aX=a.aX;this.aY=a.aY;this.xRadius=a.xRadius;this.yRadius=a.yRadius;this.aStartAngle=a.aStartAngle;
   this.aEndAngle=a.aEndAngle;this.aClockwise=a.aClockwise;this.aRotation=a.aRotation;return this};ka.prototype.toJSON=function(){var a=L.prototype.toJSON.call(this);a.aX=this.aX;a.aY=this.aY;a.xRadius=this.xRadius;a.yRadius=this.yRadius;a.aStartAngle=this.aStartAngle;a.aEndAngle=this.aEndAngle;a.aClockwise=this.aClockwise;a.aRotation=this.aRotation;return a};ka.prototype.fromJSON=function(a){L.prototype.fromJSON.call(this,a);this.aX=a.aX;this.aY=a.aY;this.xRadius=a.xRadius;this.yRadius=a.yRadius;this.aStartAngle=
   a.aStartAngle;this.aEndAngle=a.aEndAngle;this.aClockwise=a.aClockwise;this.aRotation=a.aRotation;return this};fc.prototype=Object.create(ka.prototype);fc.prototype.constructor=fc;fc.prototype.isArcCurve=!0;var Od=new p,we=new ae,xe=new ae,ye=new ae;wa.prototype=Object.create(L.prototype);wa.prototype.constructor=wa;wa.prototype.isCatmullRomCurve3=!0;wa.prototype.getPoint=function(a,b){b=b||new p;var c=this.points,d=c.length;a*=d-(this.closed?0:1);var e=Math.floor(a);a-=e;this.closed?e+=0<e?0:(Math.floor(Math.abs(e)/
   d)+1)*d:0===a&&e===d-1&&(e=d-2,a=1);if(this.closed||0<e)var f=c[(e-1)%d];else Od.subVectors(c[0],c[1]).add(c[0]),f=Od;var g=c[e%d];var h=c[(e+1)%d];this.closed||e+2<d?c=c[(e+2)%d]:(Od.subVectors(c[d-1],c[d-2]).add(c[d-1]),c=Od);if("centripetal"===this.curveType||"chordal"===this.curveType){var k="chordal"===this.curveType?.5:.25;d=Math.pow(f.distanceToSquared(g),k);e=Math.pow(g.distanceToSquared(h),k);k=Math.pow(h.distanceToSquared(c),k);1E-4>e&&(e=1);1E-4>d&&(d=e);1E-4>k&&(k=e);we.initNonuniformCatmullRom(f.x,
   g.x,h.x,c.x,d,e,k);xe.initNonuniformCatmullRom(f.y,g.y,h.y,c.y,d,e,k);ye.initNonuniformCatmullRom(f.z,g.z,h.z,c.z,d,e,k)}else"catmullrom"===this.curveType&&(we.initCatmullRom(f.x,g.x,h.x,c.x,this.tension),xe.initCatmullRom(f.y,g.y,h.y,c.y,this.tension),ye.initCatmullRom(f.z,g.z,h.z,c.z,this.tension));b.set(we.calc(a),xe.calc(a),ye.calc(a));return b};wa.prototype.copy=function(a){L.prototype.copy.call(this,a);this.points=[];for(var b=0,c=a.points.length;b<c;b++)this.points.push(a.points[b].clone());
   this.closed=a.closed;this.curveType=a.curveType;this.tension=a.tension;return this};wa.prototype.toJSON=function(){var a=L.prototype.toJSON.call(this);a.points=[];for(var b=0,c=this.points.length;b<c;b++)a.points.push(this.points[b].toArray());a.closed=this.closed;a.curveType=this.curveType;a.tension=this.tension;return a};wa.prototype.fromJSON=function(a){L.prototype.fromJSON.call(this,a);this.points=[];for(var b=0,c=a.points.length;b<c;b++){var d=a.points[b];this.points.push((new p).fromArray(d))}this.closed=
   a.closed;this.curveType=a.curveType;this.tension=a.tension;return this};Ka.prototype=Object.create(L.prototype);Ka.prototype.constructor=Ka;Ka.prototype.isCubicBezierCurve=!0;Ka.prototype.getPoint=function(a,b){b=b||new C;var c=this.v0,d=this.v1,e=this.v2,f=this.v3;b.set($c(a,c.x,d.x,e.x,f.x),$c(a,c.y,d.y,e.y,f.y));return b};Ka.prototype.copy=function(a){L.prototype.copy.call(this,a);this.v0.copy(a.v0);this.v1.copy(a.v1);this.v2.copy(a.v2);this.v3.copy(a.v3);return this};Ka.prototype.toJSON=function(){var a=
   L.prototype.toJSON.call(this);a.v0=this.v0.toArray();a.v1=this.v1.toArray();a.v2=this.v2.toArray();a.v3=this.v3.toArray();return a};Ka.prototype.fromJSON=function(a){L.prototype.fromJSON.call(this,a);this.v0.fromArray(a.v0);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);this.v3.fromArray(a.v3);return this};Ta.prototype=Object.create(L.prototype);Ta.prototype.constructor=Ta;Ta.prototype.isCubicBezierCurve3=!0;Ta.prototype.getPoint=function(a,b){b=b||new p;var c=this.v0,d=this.v1,e=this.v2,f=this.v3;
   b.set($c(a,c.x,d.x,e.x,f.x),$c(a,c.y,d.y,e.y,f.y),$c(a,c.z,d.z,e.z,f.z));return b};Ta.prototype.copy=function(a){L.prototype.copy.call(this,a);this.v0.copy(a.v0);this.v1.copy(a.v1);this.v2.copy(a.v2);this.v3.copy(a.v3);return this};Ta.prototype.toJSON=function(){var a=L.prototype.toJSON.call(this);a.v0=this.v0.toArray();a.v1=this.v1.toArray();a.v2=this.v2.toArray();a.v3=this.v3.toArray();return a};Ta.prototype.fromJSON=function(a){L.prototype.fromJSON.call(this,a);this.v0.fromArray(a.v0);this.v1.fromArray(a.v1);
   this.v2.fromArray(a.v2);this.v3.fromArray(a.v3);return this};na.prototype=Object.create(L.prototype);na.prototype.constructor=na;na.prototype.isLineCurve=!0;na.prototype.getPoint=function(a,b){b=b||new C;1===a?b.copy(this.v2):(b.copy(this.v2).sub(this.v1),b.multiplyScalar(a).add(this.v1));return b};na.prototype.getPointAt=function(a,b){return this.getPoint(a,b)};na.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()};na.prototype.copy=function(a){L.prototype.copy.call(this,
   a);this.v1.copy(a.v1);this.v2.copy(a.v2);return this};na.prototype.toJSON=function(){var a=L.prototype.toJSON.call(this);a.v1=this.v1.toArray();a.v2=this.v2.toArray();return a};na.prototype.fromJSON=function(a){L.prototype.fromJSON.call(this,a);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);return this};La.prototype=Object.create(L.prototype);La.prototype.constructor=La;La.prototype.isLineCurve3=!0;La.prototype.getPoint=function(a,b){b=b||new p;1===a?b.copy(this.v2):(b.copy(this.v2).sub(this.v1),
   b.multiplyScalar(a).add(this.v1));return b};La.prototype.getPointAt=function(a,b){return this.getPoint(a,b)};La.prototype.copy=function(a){L.prototype.copy.call(this,a);this.v1.copy(a.v1);this.v2.copy(a.v2);return this};La.prototype.toJSON=function(){var a=L.prototype.toJSON.call(this);a.v1=this.v1.toArray();a.v2=this.v2.toArray();return a};La.prototype.fromJSON=function(a){L.prototype.fromJSON.call(this,a);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);return this};Ma.prototype=Object.create(L.prototype);
   Ma.prototype.constructor=Ma;Ma.prototype.isQuadraticBezierCurve=!0;Ma.prototype.getPoint=function(a,b){b=b||new C;var c=this.v0,d=this.v1,e=this.v2;b.set(Zc(a,c.x,d.x,e.x),Zc(a,c.y,d.y,e.y));return b};Ma.prototype.copy=function(a){L.prototype.copy.call(this,a);this.v0.copy(a.v0);this.v1.copy(a.v1);this.v2.copy(a.v2);return this};Ma.prototype.toJSON=function(){var a=L.prototype.toJSON.call(this);a.v0=this.v0.toArray();a.v1=this.v1.toArray();a.v2=this.v2.toArray();return a};Ma.prototype.fromJSON=function(a){L.prototype.fromJSON.call(this,
   a);this.v0.fromArray(a.v0);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);return this};Ua.prototype=Object.create(L.prototype);Ua.prototype.constructor=Ua;Ua.prototype.isQuadraticBezierCurve3=!0;Ua.prototype.getPoint=function(a,b){b=b||new p;var c=this.v0,d=this.v1,e=this.v2;b.set(Zc(a,c.x,d.x,e.x),Zc(a,c.y,d.y,e.y),Zc(a,c.z,d.z,e.z));return b};Ua.prototype.copy=function(a){L.prototype.copy.call(this,a);this.v0.copy(a.v0);this.v1.copy(a.v1);this.v2.copy(a.v2);return this};Ua.prototype.toJSON=function(){var a=
   L.prototype.toJSON.call(this);a.v0=this.v0.toArray();a.v1=this.v1.toArray();a.v2=this.v2.toArray();return a};Ua.prototype.fromJSON=function(a){L.prototype.fromJSON.call(this,a);this.v0.fromArray(a.v0);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);return this};Na.prototype=Object.create(L.prototype);Na.prototype.constructor=Na;Na.prototype.isSplineCurve=!0;Na.prototype.getPoint=function(a,b){b=b||new C;var c=this.points,d=(c.length-1)*a;a=Math.floor(d);d-=a;var e=c[0===a?a:a-1],f=c[a],g=c[a>c.length-
   2?c.length-1:a+1];c=c[a>c.length-3?c.length-1:a+2];b.set(hf(d,e.x,f.x,g.x,c.x),hf(d,e.y,f.y,g.y,c.y));return b};Na.prototype.copy=function(a){L.prototype.copy.call(this,a);this.points=[];for(var b=0,c=a.points.length;b<c;b++)this.points.push(a.points[b].clone());return this};Na.prototype.toJSON=function(){var a=L.prototype.toJSON.call(this);a.points=[];for(var b=0,c=this.points.length;b<c;b++)a.points.push(this.points[b].toArray());return a};Na.prototype.fromJSON=function(a){L.prototype.fromJSON.call(this,
   a);this.points=[];for(var b=0,c=a.points.length;b<c;b++){var d=a.points[b];this.points.push((new C).fromArray(d))}return this};var Cf=Object.freeze({ArcCurve:fc,CatmullRomCurve3:wa,CubicBezierCurve:Ka,CubicBezierCurve3:Ta,EllipseCurve:ka,LineCurve:na,LineCurve3:La,QuadraticBezierCurve:Ma,QuadraticBezierCurve3:Ua,SplineCurve:Na});$a.prototype=Object.assign(Object.create(L.prototype),{constructor:$a,add:function(a){this.curves.push(a)},closePath:function(){var a=this.curves[0].getPoint(0),b=this.curves[this.curves.length-
   1].getPoint(1);a.equals(b)||this.curves.push(new na(b,a))},getPoint:function(a){var b=a*this.getLength(),c=this.getCurveLengths();for(a=0;a<c.length;){if(c[a]>=b)return b=c[a]-b,a=this.curves[a],c=a.getLength(),a.getPointAt(0===c?0:1-b/c);a++}return null},getLength:function(){var a=this.getCurveLengths();return a[a.length-1]},updateArcLengths:function(){this.needsUpdate=!0;this.cacheLengths=null;this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;
   for(var a=[],b=0,c=0,d=this.curves.length;c<d;c++)b+=this.curves[c].getLength(),a.push(b);return this.cacheLengths=a},getSpacedPoints:function(a){void 0===a&&(a=40);for(var b=[],c=0;c<=a;c++)b.push(this.getPoint(c/a));this.autoClose&&b.push(b[0]);return b},getPoints:function(a){a=a||12;for(var b=[],c,d=0,e=this.curves;d<e.length;d++){var f=e[d];f=f.getPoints(f&&f.isEllipseCurve?2*a:f&&(f.isLineCurve||f.isLineCurve3)?1:f&&f.isSplineCurve?a*f.points.length:a);for(var g=0;g<f.length;g++){var h=f[g];
   c&&c.equals(h)||(b.push(h),c=h)}}this.autoClose&&1<b.length&&!b[b.length-1].equals(b[0])&&b.push(b[0]);return b},copy:function(a){L.prototype.copy.call(this,a);this.curves=[];for(var b=0,c=a.curves.length;b<c;b++)this.curves.push(a.curves[b].clone());this.autoClose=a.autoClose;return this},toJSON:function(){var a=L.prototype.toJSON.call(this);a.autoClose=this.autoClose;a.curves=[];for(var b=0,c=this.curves.length;b<c;b++)a.curves.push(this.curves[b].toJSON());return a},fromJSON:function(a){L.prototype.fromJSON.call(this,
   a);this.autoClose=a.autoClose;this.curves=[];for(var b=0,c=a.curves.length;b<c;b++){var d=a.curves[b];this.curves.push((new Cf[d.type]).fromJSON(d))}return this}});Oa.prototype=Object.assign(Object.create($a.prototype),{constructor:Oa,setFromPoints:function(a){this.moveTo(a[0].x,a[0].y);for(var b=1,c=a.length;b<c;b++)this.lineTo(a[b].x,a[b].y)},moveTo:function(a,b){this.currentPoint.set(a,b)},lineTo:function(a,b){var c=new na(this.currentPoint.clone(),new C(a,b));this.curves.push(c);this.currentPoint.set(a,
   b)},quadraticCurveTo:function(a,b,c,d){a=new Ma(this.currentPoint.clone(),new C(a,b),new C(c,d));this.curves.push(a);this.currentPoint.set(c,d)},bezierCurveTo:function(a,b,c,d,e,f){a=new Ka(this.currentPoint.clone(),new C(a,b),new C(c,d),new C(e,f));this.curves.push(a);this.currentPoint.set(e,f)},splineThru:function(a){var b=[this.currentPoint.clone()].concat(a);b=new Na(b);this.curves.push(b);this.currentPoint.copy(a[a.length-1])},arc:function(a,b,c,d,e,f){this.absarc(a+this.currentPoint.x,b+this.currentPoint.y,
   c,d,e,f)},absarc:function(a,b,c,d,e,f){this.absellipse(a,b,c,c,d,e,f)},ellipse:function(a,b,c,d,e,f,g,h){this.absellipse(a+this.currentPoint.x,b+this.currentPoint.y,c,d,e,f,g,h)},absellipse:function(a,b,c,d,e,f,g,h){a=new ka(a,b,c,d,e,f,g,h);0<this.curves.length&&(b=a.getPoint(0),b.equals(this.currentPoint)||this.lineTo(b.x,b.y));this.curves.push(a);a=a.getPoint(1);this.currentPoint.copy(a)},copy:function(a){$a.prototype.copy.call(this,a);this.currentPoint.copy(a.currentPoint);return this},toJSON:function(){var a=
   $a.prototype.toJSON.call(this);a.currentPoint=this.currentPoint.toArray();return a},fromJSON:function(a){$a.prototype.fromJSON.call(this,a);this.currentPoint.fromArray(a.currentPoint);return this}});hb.prototype=Object.assign(Object.create(Oa.prototype),{constructor:hb,getPointsHoles:function(a){for(var b=[],c=0,d=this.holes.length;c<d;c++)b[c]=this.holes[c].getPoints(a);return b},extractPoints:function(a){return{shape:this.getPoints(a),holes:this.getPointsHoles(a)}},copy:function(a){Oa.prototype.copy.call(this,
   a);this.holes=[];for(var b=0,c=a.holes.length;b<c;b++)this.holes.push(a.holes[b].clone());return this},toJSON:function(){var a=Oa.prototype.toJSON.call(this);a.uuid=this.uuid;a.holes=[];for(var b=0,c=this.holes.length;b<c;b++)a.holes.push(this.holes[b].toJSON());return a},fromJSON:function(a){Oa.prototype.fromJSON.call(this,a);this.uuid=a.uuid;this.holes=[];for(var b=0,c=a.holes.length;b<c;b++){var d=a.holes[b];this.holes.push((new Oa).fromJSON(d))}return this}});X.prototype=Object.assign(Object.create(B.prototype),
   {constructor:X,isLight:!0,copy:function(a){B.prototype.copy.call(this,a);this.color.copy(a.color);this.intensity=a.intensity;return this},toJSON:function(a){a=B.prototype.toJSON.call(this,a);a.object.color=this.color.getHex();a.object.intensity=this.intensity;void 0!==this.groundColor&&(a.object.groundColor=this.groundColor.getHex());void 0!==this.distance&&(a.object.distance=this.distance);void 0!==this.angle&&(a.object.angle=this.angle);void 0!==this.decay&&(a.object.decay=this.decay);void 0!==
   this.penumbra&&(a.object.penumbra=this.penumbra);void 0!==this.shadow&&(a.object.shadow=this.shadow.toJSON());return a}});ud.prototype=Object.assign(Object.create(X.prototype),{constructor:ud,isHemisphereLight:!0,copy:function(a){X.prototype.copy.call(this,a);this.groundColor.copy(a.groundColor);return this}});Object.assign(Gb.prototype,{copy:function(a){this.camera=a.camera.clone();this.bias=a.bias;this.radius=a.radius;this.mapSize.copy(a.mapSize);return this},clone:function(){return(new this.constructor).copy(this)},
   toJSON:function(){var a={};0!==this.bias&&(a.bias=this.bias);1!==this.radius&&(a.radius=this.radius);if(512!==this.mapSize.x||512!==this.mapSize.y)a.mapSize=this.mapSize.toArray();a.camera=this.camera.toJSON(!1).object;delete a.camera.matrix;return a}});vd.prototype=Object.assign(Object.create(Gb.prototype),{constructor:vd,isSpotLightShadow:!0,update:function(a){var b=this.camera,c=2*Q.RAD2DEG*a.angle,d=this.mapSize.width/this.mapSize.height;a=a.distance||b.far;if(c!==b.fov||d!==b.aspect||a!==b.far)b.fov=
   c,b.aspect=d,b.far=a,b.updateProjectionMatrix()}});wd.prototype=Object.assign(Object.create(X.prototype),{constructor:wd,isSpotLight:!0,copy:function(a){X.prototype.copy.call(this,a);this.distance=a.distance;this.angle=a.angle;this.penumbra=a.penumbra;this.decay=a.decay;this.target=a.target.clone();this.shadow=a.shadow.clone();return this}});xd.prototype=Object.assign(Object.create(X.prototype),{constructor:xd,isPointLight:!0,copy:function(a){X.prototype.copy.call(this,a);this.distance=a.distance;
   this.decay=a.decay;this.shadow=a.shadow.clone();return this}});yd.prototype=Object.assign(Object.create(Gb.prototype),{constructor:yd});zd.prototype=Object.assign(Object.create(X.prototype),{constructor:zd,isDirectionalLight:!0,copy:function(a){X.prototype.copy.call(this,a);this.target=a.target.clone();this.shadow=a.shadow.clone();return this}});Ad.prototype=Object.assign(Object.create(X.prototype),{constructor:Ad,isAmbientLight:!0});Bd.prototype=Object.assign(Object.create(X.prototype),{constructor:Bd,
   isRectAreaLight:!0,copy:function(a){X.prototype.copy.call(this,a);this.width=a.width;this.height=a.height;return this},toJSON:function(a){a=X.prototype.toJSON.call(this,a);a.object.width=this.width;a.object.height=this.height;return a}});var ha={arraySlice:function(a,b,c){return ha.isTypedArray(a)?new a.constructor(a.subarray(b,void 0!==c?c:a.length)):a.slice(b,c)},convertArray:function(a,b,c){return!a||!c&&a.constructor===b?a:"number"===typeof b.BYTES_PER_ELEMENT?new b(a):Array.prototype.slice.call(a)},
   isTypedArray:function(a){return ArrayBuffer.isView(a)&&!(a instanceof DataView)},getKeyframeOrder:function(a){for(var b=a.length,c=Array(b),d=0;d!==b;++d)c[d]=d;c.sort(function(b,c){return a[b]-a[c]});return c},sortedArray:function(a,b,c){for(var d=a.length,e=new a.constructor(d),f=0,g=0;g!==d;++f)for(var h=c[f]*b,k=0;k!==b;++k)e[g++]=a[h+k];return e},flattenJSON:function(a,b,c,d){for(var e=1,f=a[0];void 0!==f&&void 0===f[d];)f=a[e++];if(void 0!==f){var g=f[d];if(void 0!==g)if(Array.isArray(g)){do g=
   f[d],void 0!==g&&(b.push(f.time),c.push.apply(c,g)),f=a[e++];while(void 0!==f)}else if(void 0!==g.toArray){do g=f[d],void 0!==g&&(b.push(f.time),g.toArray(c,c.length)),f=a[e++];while(void 0!==f)}else{do g=f[d],void 0!==g&&(b.push(f.time),c.push(g)),f=a[e++];while(void 0!==f)}}}};Object.assign(oa.prototype,{evaluate:function(a){var b=this.parameterPositions,c=this._cachedIndex,d=b[c],e=b[c-1];a:{b:{c:{d:if(!(a<d)){for(var f=c+2;;){if(void 0===d){if(a<e)break d;this._cachedIndex=c=b.length;return this.afterEnd_(c-
   1,a,e)}if(c===f)break;e=d;d=b[++c];if(a<d)break b}d=b.length;break c}if(a>=e)break a;else{f=b[1];a<f&&(c=2,e=f);for(f=c-2;;){if(void 0===e)return this._cachedIndex=0,this.beforeStart_(0,a,d);if(c===f)break;d=e;e=b[--c-1];if(a>=e)break b}d=c;c=0}}for(;c<d;)e=c+d>>>1,a<b[e]?d=e:c=e+1;d=b[c];e=b[c-1];if(void 0===e)return this._cachedIndex=0,this.beforeStart_(0,a,d);if(void 0===d)return this._cachedIndex=c=b.length,this.afterEnd_(c-1,e,a)}this._cachedIndex=c;this.intervalChanged_(c,e,d)}return this.interpolate_(c,
   e,a,d)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(a){var b=this.resultBuffer,c=this.sampleValues,d=this.valueSize;a*=d;for(var e=0;e!==d;++e)b[e]=c[a+e];return b},interpolate_:function(){throw Error("call to abstract method");},intervalChanged_:function(){}});Object.assign(oa.prototype,{beforeStart_:oa.prototype.copySampleValue_,afterEnd_:oa.prototype.copySampleValue_});Cd.prototype=Object.assign(Object.create(oa.prototype),
   {constructor:Cd,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(a,b,c){var d=this.parameterPositions,e=a-2,f=a+1,g=d[e],h=d[f];if(void 0===g)switch(this.getSettings_().endingStart){case 2401:e=a;g=2*b-c;break;case 2402:e=d.length-2;g=b+d[e]-d[e+1];break;default:e=a,g=c}if(void 0===h)switch(this.getSettings_().endingEnd){case 2401:f=a;h=2*c-b;break;case 2402:f=1;h=c+d[1]-d[0];break;default:f=a-1,h=b}a=.5*(c-b);d=this.valueSize;this._weightPrev=a/(b-g);this._weightNext=
   a/(h-c);this._offsetPrev=e*d;this._offsetNext=f*d},interpolate_:function(a,b,c,d){var e=this.resultBuffer,f=this.sampleValues,g=this.valueSize;a*=g;var h=a-g,k=this._offsetPrev,m=this._offsetNext,l=this._weightPrev,n=this._weightNext,p=(c-b)/(d-b);c=p*p;d=c*p;b=-l*d+2*l*c-l*p;l=(1+l)*d+(-1.5-2*l)*c+(-.5+l)*p+1;p=(-1-n)*d+(1.5+n)*c+.5*p;n=n*d-n*c;for(c=0;c!==g;++c)e[c]=b*f[k+c]+l*f[h+c]+p*f[a+c]+n*f[m+c];return e}});ad.prototype=Object.assign(Object.create(oa.prototype),{constructor:ad,interpolate_:function(a,
   b,c,d){var e=this.resultBuffer,f=this.sampleValues,g=this.valueSize;a*=g;var h=a-g;b=(c-b)/(d-b);c=1-b;for(d=0;d!==g;++d)e[d]=f[h+d]*c+f[a+d]*b;return e}});Dd.prototype=Object.assign(Object.create(oa.prototype),{constructor:Dd,interpolate_:function(a){return this.copySampleValue_(a-1)}});Object.assign(qa,{toJSON:function(a){var b=a.constructor;if(void 0!==b.toJSON)b=b.toJSON(a);else{b={name:a.name,times:ha.convertArray(a.times,Array),values:ha.convertArray(a.values,Array)};var c=a.getInterpolation();
   c!==a.DefaultInterpolation&&(b.interpolation=c)}b.type=a.ValueTypeName;return b}});Object.assign(qa.prototype,{constructor:qa,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(a){return new Dd(this.times,this.values,this.getValueSize(),a)},InterpolantFactoryMethodLinear:function(a){return new ad(this.times,this.values,this.getValueSize(),a)},InterpolantFactoryMethodSmooth:function(a){return new Cd(this.times,this.values,this.getValueSize(),
   a)},setInterpolation:function(a){switch(a){case 2300:var b=this.InterpolantFactoryMethodDiscrete;break;case 2301:b=this.InterpolantFactoryMethodLinear;break;case 2302:b=this.InterpolantFactoryMethodSmooth}if(void 0===b){b="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant)if(a!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw Error(b);console.warn("THREE.KeyframeTrack:",b);return this}this.createInterpolant=
   b;return this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(a){if(0!==a)for(var b=this.times,c=0,d=b.length;c!==d;++c)b[c]+=a;return this},scale:function(a){if(1!==a)for(var b=this.times,c=0,d=b.length;c!==d;++c)b[c]*=a;return this},trim:function(a,
   b){for(var c=this.times,d=c.length,e=0,f=d-1;e!==d&&c[e]<a;)++e;for(;-1!==f&&c[f]>b;)--f;++f;if(0!==e||f!==d)e>=f&&(f=Math.max(f,1),e=f-1),a=this.getValueSize(),this.times=ha.arraySlice(c,e,f),this.values=ha.arraySlice(this.values,e*a,f*a);return this},validate:function(){var a=!0,b=this.getValueSize();0!==b-Math.floor(b)&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),a=!1);var c=this.times;b=this.values;var d=c.length;0===d&&(console.error("THREE.KeyframeTrack: Track is empty.",
   this),a=!1);for(var e=null,f=0;f!==d;f++){var g=c[f];if("number"===typeof g&&isNaN(g)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,f,g);a=!1;break}if(null!==e&&e>g){console.error("THREE.KeyframeTrack: Out of order keys.",this,f,g,e);a=!1;break}e=g}if(void 0!==b&&ha.isTypedArray(b))for(f=0,c=b.length;f!==c;++f)if(d=b[f],isNaN(d)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,f,d);a=!1;break}return a},optimize:function(){for(var a=this.times,b=this.values,
   c=this.getValueSize(),d=2302===this.getInterpolation(),e=1,f=a.length-1,g=1;g<f;++g){var h=!1,k=a[g];if(k!==a[g+1]&&(1!==g||k!==k[0]))if(d)h=!0;else{var m=g*c,l=m-c,n=m+c;for(k=0;k!==c;++k){var p=b[m+k];if(p!==b[l+k]||p!==b[n+k]){h=!0;break}}}if(h){if(g!==e)for(a[e]=a[g],h=g*c,m=e*c,k=0;k!==c;++k)b[m+k]=b[h+k];++e}}if(0<f){a[e]=a[f];h=f*c;m=e*c;for(k=0;k!==c;++k)b[m+k]=b[h+k];++e}e!==a.length&&(this.times=ha.arraySlice(a,0,e),this.values=ha.arraySlice(b,0,e*c));return this}});Ed.prototype=Object.assign(Object.create(qa.prototype),
   {constructor:Ed,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});Fd.prototype=Object.assign(Object.create(qa.prototype),{constructor:Fd,ValueTypeName:"color"});gc.prototype=Object.assign(Object.create(qa.prototype),{constructor:gc,ValueTypeName:"number"});Gd.prototype=Object.assign(Object.create(oa.prototype),{constructor:Gd,interpolate_:function(a,b,c,d){var e=this.resultBuffer,f=this.sampleValues,g=
   this.valueSize;a*=g;b=(c-b)/(d-b);for(c=a+g;a!==c;a+=4)ia.slerpFlat(e,0,f,a-g,f,a,b);return e}});bd.prototype=Object.assign(Object.create(qa.prototype),{constructor:bd,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(a){return new Gd(this.times,this.values,this.getValueSize(),a)},InterpolantFactoryMethodSmooth:void 0});Hd.prototype=Object.assign(Object.create(qa.prototype),{constructor:Hd,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,
   InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});hc.prototype=Object.assign(Object.create(qa.prototype),{constructor:hc,ValueTypeName:"vector"});Object.assign(Ca,{parse:function(a){for(var b=[],c=a.tracks,d=1/(a.fps||1),e=0,f=c.length;e!==f;++e)b.push(Vg(c[e]).scale(d));return new Ca(a.name,a.duration,b)},toJSON:function(a){var b=[],c=a.tracks;a={name:a.name,duration:a.duration,tracks:b,uuid:a.uuid};for(var d=0,e=c.length;d!==e;++d)b.push(qa.toJSON(c[d]));return a},CreateFromMorphTargetSequence:function(a,
   b,c,d){for(var e=b.length,f=[],g=0;g<e;g++){var h=[],k=[];h.push((g+e-1)%e,g,(g+1)%e);k.push(0,1,0);var m=ha.getKeyframeOrder(h);h=ha.sortedArray(h,1,m);k=ha.sortedArray(k,1,m);d||0!==h[0]||(h.push(e),k.push(k[0]));f.push((new gc(".morphTargetInfluences["+b[g].name+"]",h,k)).scale(1/c))}return new Ca(a,-1,f)},findByName:function(a,b){var c=a;Array.isArray(a)||(c=a.geometry&&a.geometry.animations||a.animations);for(a=0;a<c.length;a++)if(c[a].name===b)return c[a];return null},CreateClipsFromMorphTargetSequences:function(a,
   b,c){for(var d={},e=/^([\w-]*?)([\d]+)$/,f=0,g=a.length;f<g;f++){var h=a[f],k=h.name.match(e);if(k&&1<k.length){var m=k[1];(k=d[m])||(d[m]=k=[]);k.push(h)}}a=[];for(m in d)a.push(Ca.CreateFromMorphTargetSequence(m,d[m],b,c));return a},parseAnimation:function(a,b){if(!a)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;var c=function(a,b,c,d,e){if(0!==c.length){var f=[],g=[];ha.flattenJSON(c,f,g,d);0!==f.length&&e.push(new a(b,f,g))}},d=[],e=a.name||"default",f=a.length||
   -1,g=a.fps||30;a=a.hierarchy||[];for(var h=0;h<a.length;h++){var k=a[h].keys;if(k&&0!==k.length)if(k[0].morphTargets){f={};for(var m=0;m<k.length;m++)if(k[m].morphTargets)for(var l=0;l<k[m].morphTargets.length;l++)f[k[m].morphTargets[l]]=-1;for(var n in f){var p=[],t=[];for(l=0;l!==k[m].morphTargets.length;++l){var r=k[m];p.push(r.time);t.push(r.morphTarget===n?1:0)}d.push(new gc(".morphTargetInfluence["+n+"]",p,t))}f=f.length*(g||1)}else m=".bones["+b[h].name+"]",c(hc,m+".position",k,"pos",d),c(bd,
   m+".quaternion",k,"rot",d),c(hc,m+".scale",k,"scl",d)}return 0===d.length?null:new Ca(e,f,d)}});Object.assign(Ca.prototype,{resetDuration:function(){for(var a=0,b=0,c=this.tracks.length;b!==c;++b){var d=this.tracks[b];a=Math.max(a,d.times[d.times.length-1])}this.duration=a;return this},trim:function(){for(var a=0;a<this.tracks.length;a++)this.tracks[a].trim(0,this.duration);return this},validate:function(){for(var a=!0,b=0;b<this.tracks.length;b++)a=a&&this.tracks[b].validate();return a},optimize:function(){for(var a=
   0;a<this.tracks.length;a++)this.tracks[a].optimize();return this}});Object.assign(Id.prototype,{load:function(a,b,c,d){var e=this;(new Ja(e.manager)).load(a,function(a){b(e.parse(JSON.parse(a)))},c,d)},setTextures:function(a){this.textures=a},parse:function(a){function b(a){void 0===c[a]&&console.warn("THREE.MaterialLoader: Undefined texture",a);return c[a]}var c=this.textures,d=new hh[a.type];void 0!==a.uuid&&(d.uuid=a.uuid);void 0!==a.name&&(d.name=a.name);void 0!==a.color&&d.color.setHex(a.color);
   void 0!==a.roughness&&(d.roughness=a.roughness);void 0!==a.metalness&&(d.metalness=a.metalness);void 0!==a.emissive&&d.emissive.setHex(a.emissive);void 0!==a.specular&&d.specular.setHex(a.specular);void 0!==a.shininess&&(d.shininess=a.shininess);void 0!==a.clearCoat&&(d.clearCoat=a.clearCoat);void 0!==a.clearCoatRoughness&&(d.clearCoatRoughness=a.clearCoatRoughness);void 0!==a.uniforms&&(d.uniforms=a.uniforms);void 0!==a.vertexShader&&(d.vertexShader=a.vertexShader);void 0!==a.fragmentShader&&(d.fragmentShader=
   a.fragmentShader);void 0!==a.vertexColors&&(d.vertexColors=a.vertexColors);void 0!==a.fog&&(d.fog=a.fog);void 0!==a.flatShading&&(d.flatShading=a.flatShading);void 0!==a.blending&&(d.blending=a.blending);void 0!==a.side&&(d.side=a.side);void 0!==a.opacity&&(d.opacity=a.opacity);void 0!==a.transparent&&(d.transparent=a.transparent);void 0!==a.alphaTest&&(d.alphaTest=a.alphaTest);void 0!==a.depthTest&&(d.depthTest=a.depthTest);void 0!==a.depthWrite&&(d.depthWrite=a.depthWrite);void 0!==a.colorWrite&&
   (d.colorWrite=a.colorWrite);void 0!==a.wireframe&&(d.wireframe=a.wireframe);void 0!==a.wireframeLinewidth&&(d.wireframeLinewidth=a.wireframeLinewidth);void 0!==a.wireframeLinecap&&(d.wireframeLinecap=a.wireframeLinecap);void 0!==a.wireframeLinejoin&&(d.wireframeLinejoin=a.wireframeLinejoin);void 0!==a.rotation&&(d.rotation=a.rotation);1!==a.linewidth&&(d.linewidth=a.linewidth);void 0!==a.dashSize&&(d.dashSize=a.dashSize);void 0!==a.gapSize&&(d.gapSize=a.gapSize);void 0!==a.scale&&(d.scale=a.scale);
   void 0!==a.polygonOffset&&(d.polygonOffset=a.polygonOffset);void 0!==a.polygonOffsetFactor&&(d.polygonOffsetFactor=a.polygonOffsetFactor);void 0!==a.polygonOffsetUnits&&(d.polygonOffsetUnits=a.polygonOffsetUnits);void 0!==a.skinning&&(d.skinning=a.skinning);void 0!==a.morphTargets&&(d.morphTargets=a.morphTargets);void 0!==a.dithering&&(d.dithering=a.dithering);void 0!==a.visible&&(d.visible=a.visible);void 0!==a.userData&&(d.userData=a.userData);void 0!==a.shading&&(d.flatShading=1===a.shading);void 0!==
   a.size&&(d.size=a.size);void 0!==a.sizeAttenuation&&(d.sizeAttenuation=a.sizeAttenuation);void 0!==a.map&&(d.map=b(a.map));void 0!==a.alphaMap&&(d.alphaMap=b(a.alphaMap),d.transparent=!0);void 0!==a.bumpMap&&(d.bumpMap=b(a.bumpMap));void 0!==a.bumpScale&&(d.bumpScale=a.bumpScale);void 0!==a.normalMap&&(d.normalMap=b(a.normalMap));void 0!==a.normalMapType&&(d.normalMapType=a.normalMapType);if(void 0!==a.normalScale){var e=a.normalScale;!1===Array.isArray(e)&&(e=[e,e]);d.normalScale=(new C).fromArray(e)}void 0!==
   a.displacementMap&&(d.displacementMap=b(a.displacementMap));void 0!==a.displacementScale&&(d.displacementScale=a.displacementScale);void 0!==a.displacementBias&&(d.displacementBias=a.displacementBias);void 0!==a.roughnessMap&&(d.roughnessMap=b(a.roughnessMap));void 0!==a.metalnessMap&&(d.metalnessMap=b(a.metalnessMap));void 0!==a.emissiveMap&&(d.emissiveMap=b(a.emissiveMap));void 0!==a.emissiveIntensity&&(d.emissiveIntensity=a.emissiveIntensity);void 0!==a.specularMap&&(d.specularMap=b(a.specularMap));
   void 0!==a.envMap&&(d.envMap=b(a.envMap));void 0!==a.reflectivity&&(d.reflectivity=a.reflectivity);void 0!==a.lightMap&&(d.lightMap=b(a.lightMap));void 0!==a.lightMapIntensity&&(d.lightMapIntensity=a.lightMapIntensity);void 0!==a.aoMap&&(d.aoMap=b(a.aoMap));void 0!==a.aoMapIntensity&&(d.aoMapIntensity=a.aoMapIntensity);void 0!==a.gradientMap&&(d.gradientMap=b(a.gradientMap));return d}});Object.assign(be.prototype,{load:function(a,b,c,d){var e=this;(new Ja(e.manager)).load(a,function(a){b(e.parse(JSON.parse(a)))},
   c,d)},parse:function(a){var b=new E,c=a.data.index;void 0!==c&&(c=new Df[c.type](c.array),b.setIndex(new P(c,1)));var d=a.data.attributes;for(f in d){var e=d[f];c=new Df[e.type](e.array);b.addAttribute(f,new P(c,e.itemSize,e.normalized))}var f=a.data.groups||a.data.drawcalls||a.data.offsets;if(void 0!==f)for(c=0,d=f.length;c!==d;++c)e=f[c],b.addGroup(e.start,e.count,e.materialIndex);a=a.data.boundingSphere;void 0!==a&&(f=new p,void 0!==a.center&&f.fromArray(a.center),b.boundingSphere=new za(f,a.radius));
   return b}});var Df={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!==typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};ic.Handlers={handlers:[],add:function(a,b){this.handlers.push(a,b)},get:function(a){for(var b=this.handlers,c=0,d=b.length;c<d;c+=2){var e=b[c+1];if(b[c].test(a))return e}return null}};Object.assign(ic.prototype,
   {crossOrigin:"anonymous",onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(a,b,c){for(var d=[],e=0;e<a.length;++e)d[e]=this.createMaterial(a[e],b,c);return d},createMaterial:function(){var a={NoBlending:0,NormalBlending:1,AdditiveBlending:2,SubtractiveBlending:3,MultiplyBlending:4,CustomBlending:5},b=new G,c=new td,d=new Id;return function(e,f,g){function h(a,b,d,e,h){a=f+a;var m=ic.Handlers.get(a);null!==m?a=m.load(a):(c.setCrossOrigin(g),a=c.load(a));
   void 0!==b&&(a.repeat.fromArray(b),1!==b[0]&&(a.wrapS=1E3),1!==b[1]&&(a.wrapT=1E3));void 0!==d&&a.offset.fromArray(d);void 0!==e&&("repeat"===e[0]&&(a.wrapS=1E3),"mirror"===e[0]&&(a.wrapS=1002),"repeat"===e[1]&&(a.wrapT=1E3),"mirror"===e[1]&&(a.wrapT=1002));void 0!==h&&(a.anisotropy=h);b=Q.generateUUID();k[b]=a;return b}var k={},m={uuid:Q.generateUUID(),type:"MeshLambertMaterial"},l;for(l in e){var n=e[l];switch(l){case "DbgColor":case "DbgIndex":case "opticalDensity":case "illumination":break;case "DbgName":m.name=
   n;break;case "blending":m.blending=a[n];break;case "colorAmbient":case "mapAmbient":console.warn("THREE.Loader.createMaterial:",l,"is no longer supported.");break;case "colorDiffuse":m.color=b.fromArray(n).getHex();break;case "colorSpecular":m.specular=b.fromArray(n).getHex();break;case "colorEmissive":m.emissive=b.fromArray(n).getHex();break;case "specularCoef":m.shininess=n;break;case "shading":"basic"===n.toLowerCase()&&(m.type="MeshBasicMaterial");"phong"===n.toLowerCase()&&(m.type="MeshPhongMaterial");
   "standard"===n.toLowerCase()&&(m.type="MeshStandardMaterial");break;case "mapDiffuse":m.map=h(n,e.mapDiffuseRepeat,e.mapDiffuseOffset,e.mapDiffuseWrap,e.mapDiffuseAnisotropy);break;case "mapDiffuseRepeat":case "mapDiffuseOffset":case "mapDiffuseWrap":case "mapDiffuseAnisotropy":break;case "mapEmissive":m.emissiveMap=h(n,e.mapEmissiveRepeat,e.mapEmissiveOffset,e.mapEmissiveWrap,e.mapEmissiveAnisotropy);break;case "mapEmissiveRepeat":case "mapEmissiveOffset":case "mapEmissiveWrap":case "mapEmissiveAnisotropy":break;
   case "mapLight":m.lightMap=h(n,e.mapLightRepeat,e.mapLightOffset,e.mapLightWrap,e.mapLightAnisotropy);break;case "mapLightRepeat":case "mapLightOffset":case "mapLightWrap":case "mapLightAnisotropy":break;case "mapAO":m.aoMap=h(n,e.mapAORepeat,e.mapAOOffset,e.mapAOWrap,e.mapAOAnisotropy);break;case "mapAORepeat":case "mapAOOffset":case "mapAOWrap":case "mapAOAnisotropy":break;case "mapBump":m.bumpMap=h(n,e.mapBumpRepeat,e.mapBumpOffset,e.mapBumpWrap,e.mapBumpAnisotropy);break;case "mapBumpScale":m.bumpScale=
   n;break;case "mapBumpRepeat":case "mapBumpOffset":case "mapBumpWrap":case "mapBumpAnisotropy":break;case "mapNormal":m.normalMap=h(n,e.mapNormalRepeat,e.mapNormalOffset,e.mapNormalWrap,e.mapNormalAnisotropy);break;case "mapNormalFactor":m.normalScale=n;break;case "mapNormalRepeat":case "mapNormalOffset":case "mapNormalWrap":case "mapNormalAnisotropy":break;case "mapSpecular":m.specularMap=h(n,e.mapSpecularRepeat,e.mapSpecularOffset,e.mapSpecularWrap,e.mapSpecularAnisotropy);break;case "mapSpecularRepeat":case "mapSpecularOffset":case "mapSpecularWrap":case "mapSpecularAnisotropy":break;
   case "mapMetalness":m.metalnessMap=h(n,e.mapMetalnessRepeat,e.mapMetalnessOffset,e.mapMetalnessWrap,e.mapMetalnessAnisotropy);break;case "mapMetalnessRepeat":case "mapMetalnessOffset":case "mapMetalnessWrap":case "mapMetalnessAnisotropy":break;case "mapRoughness":m.roughnessMap=h(n,e.mapRoughnessRepeat,e.mapRoughnessOffset,e.mapRoughnessWrap,e.mapRoughnessAnisotropy);break;case "mapRoughnessRepeat":case "mapRoughnessOffset":case "mapRoughnessWrap":case "mapRoughnessAnisotropy":break;case "mapAlpha":m.alphaMap=
   h(n,e.mapAlphaRepeat,e.mapAlphaOffset,e.mapAlphaWrap,e.mapAlphaAnisotropy);break;case "mapAlphaRepeat":case "mapAlphaOffset":case "mapAlphaWrap":case "mapAlphaAnisotropy":break;case "flipSided":m.side=1;break;case "doubleSided":m.side=2;break;case "transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity");m.opacity=n;break;case "depthTest":case "depthWrite":case "colorWrite":case "opacity":case "reflectivity":case "transparent":case "visible":case "wireframe":m[l]=
   n;break;case "vertexColors":!0===n&&(m.vertexColors=2);"face"===n&&(m.vertexColors=1);break;default:console.error("THREE.Loader.createMaterial: Unsupported",l,n)}}"MeshBasicMaterial"===m.type&&delete m.emissive;"MeshPhongMaterial"!==m.type&&delete m.specular;1>m.opacity&&(m.transparent=!0);d.setTextures(k);return d.parse(m)}}()});var ze={decodeText:function(a){if("undefined"!==typeof TextDecoder)return(new TextDecoder).decode(a);for(var b="",c=0,d=a.length;c<d;c++)b+=String.fromCharCode(a[c]);return decodeURIComponent(escape(b))},
   extractUrlBase:function(a){var b=a.lastIndexOf("/");return-1===b?"./":a.substr(0,b+1)}};Object.assign(ce.prototype,{crossOrigin:"anonymous",load:function(a,b,c,d){var e=this,f=this.texturePath&&"string"===typeof this.texturePath?this.texturePath:ze.extractUrlBase(a),g=new Ja(this.manager);g.setWithCredentials(this.withCredentials);g.load(a,function(c){c=JSON.parse(c);var d=c.metadata;if(void 0!==d&&(d=d.type,void 0!==d&&"object"===d.toLowerCase())){console.error("THREE.JSONLoader: "+a+" should be loaded with THREE.ObjectLoader instead.");
   return}c=e.parse(c,f);b(c.geometry,c.materials)},c,d)},setCrossOrigin:function(a){this.crossOrigin=a;return this},setTexturePath:function(a){this.texturePath=a;return this},parse:function(){return function(a,b){void 0!==a.data&&(a=a.data);a.scale=void 0!==a.scale?1/a.scale:1;var c=new K,d=a,e,f,g,h=d.faces;var k=d.vertices;var m=d.normals,l=d.colors;var n=d.scale;var u=0;if(void 0!==d.uvs){for(e=0;e<d.uvs.length;e++)d.uvs[e].length&&u++;for(e=0;e<u;e++)c.faceVertexUvs[e]=[]}var t=0;for(g=k.length;t<
   g;)e=new p,e.x=k[t++]*n,e.y=k[t++]*n,e.z=k[t++]*n,c.vertices.push(e);t=0;for(g=h.length;t<g;){k=h[t++];var r=k&1;var v=k&2;e=k&8;var z=k&16;var x=k&32;n=k&64;k&=128;if(r){r=new Wa;r.a=h[t];r.b=h[t+1];r.c=h[t+3];var w=new Wa;w.a=h[t+1];w.b=h[t+2];w.c=h[t+3];t+=4;v&&(v=h[t++],r.materialIndex=v,w.materialIndex=v);v=c.faces.length;if(e)for(e=0;e<u;e++){var y=d.uvs[e];c.faceVertexUvs[e][v]=[];c.faceVertexUvs[e][v+1]=[];for(f=0;4>f;f++){var A=h[t++];var B=y[2*A];A=y[2*A+1];B=new C(B,A);2!==f&&c.faceVertexUvs[e][v].push(B);
   0!==f&&c.faceVertexUvs[e][v+1].push(B)}}z&&(z=3*h[t++],r.normal.set(m[z++],m[z++],m[z]),w.normal.copy(r.normal));if(x)for(e=0;4>e;e++)z=3*h[t++],x=new p(m[z++],m[z++],m[z]),2!==e&&r.vertexNormals.push(x),0!==e&&w.vertexNormals.push(x);n&&(n=h[t++],n=l[n],r.color.setHex(n),w.color.setHex(n));if(k)for(e=0;4>e;e++)n=h[t++],n=l[n],2!==e&&r.vertexColors.push(new G(n)),0!==e&&w.vertexColors.push(new G(n));c.faces.push(r);c.faces.push(w)}else{r=new Wa;r.a=h[t++];r.b=h[t++];r.c=h[t++];v&&(v=h[t++],r.materialIndex=
   v);v=c.faces.length;if(e)for(e=0;e<u;e++)for(y=d.uvs[e],c.faceVertexUvs[e][v]=[],f=0;3>f;f++)A=h[t++],B=y[2*A],A=y[2*A+1],B=new C(B,A),c.faceVertexUvs[e][v].push(B);z&&(z=3*h[t++],r.normal.set(m[z++],m[z++],m[z]));if(x)for(e=0;3>e;e++)z=3*h[t++],x=new p(m[z++],m[z++],m[z]),r.vertexNormals.push(x);n&&(n=h[t++],r.color.setHex(l[n]));if(k)for(e=0;3>e;e++)n=h[t++],r.vertexColors.push(new G(l[n]));c.faces.push(r)}}d=a;t=void 0!==d.influencesPerVertex?d.influencesPerVertex:2;if(d.skinWeights)for(g=0,h=
   d.skinWeights.length;g<h;g+=t)c.skinWeights.push(new ca(d.skinWeights[g],1<t?d.skinWeights[g+1]:0,2<t?d.skinWeights[g+2]:0,3<t?d.skinWeights[g+3]:0));if(d.skinIndices)for(g=0,h=d.skinIndices.length;g<h;g+=t)c.skinIndices.push(new ca(d.skinIndices[g],1<t?d.skinIndices[g+1]:0,2<t?d.skinIndices[g+2]:0,3<t?d.skinIndices[g+3]:0));c.bones=d.bones;c.bones&&0<c.bones.length&&(c.skinWeights.length!==c.skinIndices.length||c.skinIndices.length!==c.vertices.length)&&console.warn("When skinning, number of vertices ("+
   c.vertices.length+"), skinIndices ("+c.skinIndices.length+"), and skinWeights ("+c.skinWeights.length+") should match.");g=a;h=g.scale;if(void 0!==g.morphTargets)for(d=0,t=g.morphTargets.length;d<t;d++)for(c.morphTargets[d]={},c.morphTargets[d].name=g.morphTargets[d].name,c.morphTargets[d].vertices=[],m=c.morphTargets[d].vertices,l=g.morphTargets[d].vertices,u=0,k=l.length;u<k;u+=3)n=new p,n.x=l[u]*h,n.y=l[u+1]*h,n.z=l[u+2]*h,m.push(n);if(void 0!==g.morphColors&&0<g.morphColors.length)for(console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.'),
   h=c.faces,g=g.morphColors[0].colors,d=0,t=h.length;d<t;d++)h[d].color.fromArray(g,3*d);g=a;d=[];t=[];void 0!==g.animation&&t.push(g.animation);void 0!==g.animations&&(g.animations.length?t=t.concat(g.animations):t.push(g.animations));for(g=0;g<t.length;g++)(h=Ca.parseAnimation(t[g],c.bones))&&d.push(h);c.morphTargets&&(t=Ca.CreateClipsFromMorphTargetSequences(c.morphTargets,10),d=d.concat(t));0<d.length&&(c.animations=d);c.computeFaceNormals();c.computeBoundingSphere();if(void 0===a.materials||0===
   a.materials.length)return{geometry:c};a=ic.prototype.initMaterials(a.materials,b,this.crossOrigin);return{geometry:c,materials:a}}}()});Object.assign(jf.prototype,{crossOrigin:"anonymous",load:function(a,b,c,d){""===this.texturePath&&(this.texturePath=a.substring(0,a.lastIndexOf("/")+1));var e=this;(new Ja(e.manager)).load(a,function(c){var f=null;try{f=JSON.parse(c)}catch(h){void 0!==d&&d(h);console.error("THREE:ObjectLoader: Can't parse "+a+".",h.message);return}c=f.metadata;void 0===c||void 0===
   c.type||"geometry"===c.type.toLowerCase()?console.error("THREE.ObjectLoader: Can't load "+a+". Use THREE.JSONLoader instead."):e.parse(f,b)},c,d)},setTexturePath:function(a){this.texturePath=a;return this},setCrossOrigin:function(a){this.crossOrigin=a;return this},parse:function(a,b){var c=this.parseShape(a.shapes);c=this.parseGeometries(a.geometries,c);var d=this.parseImages(a.images,function(){void 0!==b&&b(e)});d=this.parseTextures(a.textures,d);d=this.parseMaterials(a.materials,d);var e=this.parseObject(a.object,
   c,d);a.animations&&(e.animations=this.parseAnimations(a.animations));void 0!==a.images&&0!==a.images.length||void 0===b||b(e);return e},parseShape:function(a){var b={};if(void 0!==a)for(var c=0,d=a.length;c<d;c++){var e=(new hb).fromJSON(a[c]);b[e.uuid]=e}return b},parseGeometries:function(a,b){var c={};if(void 0!==a)for(var d=new ce,e=new be,f=0,g=a.length;f<g;f++){var h=a[f];switch(h.type){case "PlaneGeometry":case "PlaneBufferGeometry":var k=new ya[h.type](h.width,h.height,h.widthSegments,h.heightSegments);
   break;case "BoxGeometry":case "BoxBufferGeometry":case "CubeGeometry":k=new ya[h.type](h.width,h.height,h.depth,h.widthSegments,h.heightSegments,h.depthSegments);break;case "CircleGeometry":case "CircleBufferGeometry":k=new ya[h.type](h.radius,h.segments,h.thetaStart,h.thetaLength);break;case "CylinderGeometry":case "CylinderBufferGeometry":k=new ya[h.type](h.radiusTop,h.radiusBottom,h.height,h.radialSegments,h.heightSegments,h.openEnded,h.thetaStart,h.thetaLength);break;case "ConeGeometry":case "ConeBufferGeometry":k=
   new ya[h.type](h.radius,h.height,h.radialSegments,h.heightSegments,h.openEnded,h.thetaStart,h.thetaLength);break;case "SphereGeometry":case "SphereBufferGeometry":k=new ya[h.type](h.radius,h.widthSegments,h.heightSegments,h.phiStart,h.phiLength,h.thetaStart,h.thetaLength);break;case "DodecahedronGeometry":case "DodecahedronBufferGeometry":case "IcosahedronGeometry":case "IcosahedronBufferGeometry":case "OctahedronGeometry":case "OctahedronBufferGeometry":case "TetrahedronGeometry":case "TetrahedronBufferGeometry":k=
   new ya[h.type](h.radius,h.detail);break;case "RingGeometry":case "RingBufferGeometry":k=new ya[h.type](h.innerRadius,h.outerRadius,h.thetaSegments,h.phiSegments,h.thetaStart,h.thetaLength);break;case "TorusGeometry":case "TorusBufferGeometry":k=new ya[h.type](h.radius,h.tube,h.radialSegments,h.tubularSegments,h.arc);break;case "TorusKnotGeometry":case "TorusKnotBufferGeometry":k=new ya[h.type](h.radius,h.tube,h.tubularSegments,h.radialSegments,h.p,h.q);break;case "LatheGeometry":case "LatheBufferGeometry":k=
   new ya[h.type](h.points,h.segments,h.phiStart,h.phiLength);break;case "PolyhedronGeometry":case "PolyhedronBufferGeometry":k=new ya[h.type](h.vertices,h.indices,h.radius,h.details);break;case "ShapeGeometry":case "ShapeBufferGeometry":k=[];for(var m=0,l=h.shapes.length;m<l;m++){var n=b[h.shapes[m]];k.push(n)}k=new ya[h.type](k,h.curveSegments);break;case "ExtrudeGeometry":case "ExtrudeBufferGeometry":k=[];m=0;for(l=h.shapes.length;m<l;m++)n=b[h.shapes[m]],k.push(n);m=h.options.extrudePath;void 0!==
   m&&(h.options.extrudePath=(new Cf[m.type]).fromJSON(m));k=new ya[h.type](k,h.options);break;case "BufferGeometry":k=e.parse(h);break;case "Geometry":k=d.parse(h,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+h.type+'"');continue}k.uuid=h.uuid;void 0!==h.name&&(k.name=h.name);!0===k.isBufferGeometry&&void 0!==h.userData&&(k.userData=h.userData);c[h.uuid]=k}return c},parseMaterials:function(a,b){var c={};if(void 0!==a){var d=new Id;d.setTextures(b);
   b=0;for(var e=a.length;b<e;b++){var f=a[b];if("MultiMaterial"===f.type){for(var g=[],h=0;h<f.materials.length;h++)g.push(d.parse(f.materials[h]));c[f.uuid]=g}else c[f.uuid]=d.parse(f)}}return c},parseAnimations:function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c],e=Ca.parse(d);void 0!==d.uuid&&(e.uuid=d.uuid);b.push(e)}return b},parseImages:function(a,b){function c(a){d.manager.itemStart(a);return f.load(a,function(){d.manager.itemEnd(a)},void 0,function(){d.manager.itemEnd(a);d.manager.itemError(a)})}
   var d=this,e={};if(void 0!==a&&0<a.length){b=new ve(b);var f=new Nd(b);f.setCrossOrigin(this.crossOrigin);b=0;for(var g=a.length;b<g;b++){var h=a[b],k=h.url;if(Array.isArray(k)){e[h.uuid]=[];for(var m=0,l=k.length;m<l;m++){var n=k[m];n=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(n)?n:d.texturePath+n;e[h.uuid].push(c(n))}}else n=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(h.url)?h.url:d.texturePath+h.url,e[h.uuid]=c(n)}}return e},parseTextures:function(a,b){function c(a,b){if("number"===typeof a)return a;console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",
   a);return b[a]}var d={};if(void 0!==a)for(var e=0,f=a.length;e<f;e++){var g=a[e];void 0===g.image&&console.warn('THREE.ObjectLoader: No "image" specified for',g.uuid);void 0===b[g.image]&&console.warn("THREE.ObjectLoader: Undefined image",g.image);var h=Array.isArray(b[g.image])?new Md(b[g.image]):new ta(b[g.image]);h.needsUpdate=!0;h.uuid=g.uuid;void 0!==g.name&&(h.name=g.name);void 0!==g.mapping&&(h.mapping=c(g.mapping,kh));void 0!==g.offset&&h.offset.fromArray(g.offset);void 0!==g.repeat&&h.repeat.fromArray(g.repeat);
   void 0!==g.center&&h.center.fromArray(g.center);void 0!==g.rotation&&(h.rotation=g.rotation);void 0!==g.wrap&&(h.wrapS=c(g.wrap[0],Ef),h.wrapT=c(g.wrap[1],Ef));void 0!==g.format&&(h.format=g.format);void 0!==g.minFilter&&(h.minFilter=c(g.minFilter,Ff));void 0!==g.magFilter&&(h.magFilter=c(g.magFilter,Ff));void 0!==g.anisotropy&&(h.anisotropy=g.anisotropy);void 0!==g.flipY&&(h.flipY=g.flipY);d[g.uuid]=h}return d},parseObject:function(a,b,c){function d(a){void 0===b[a]&&console.warn("THREE.ObjectLoader: Undefined geometry",
   a);return b[a]}function e(a){if(void 0!==a){if(Array.isArray(a)){for(var b=[],d=0,e=a.length;d<e;d++){var f=a[d];void 0===c[f]&&console.warn("THREE.ObjectLoader: Undefined material",f);b.push(c[f])}return b}void 0===c[a]&&console.warn("THREE.ObjectLoader: Undefined material",a);return c[a]}}switch(a.type){case "Scene":var f=new od;void 0!==a.background&&Number.isInteger(a.background)&&(f.background=new G(a.background));void 0!==a.fog&&("Fog"===a.fog.type?f.fog=new Ob(a.fog.color,a.fog.near,a.fog.far):
   "FogExp2"===a.fog.type&&(f.fog=new Nb(a.fog.color,a.fog.density)));break;case "PerspectiveCamera":f=new ea(a.fov,a.aspect,a.near,a.far);void 0!==a.focus&&(f.focus=a.focus);void 0!==a.zoom&&(f.zoom=a.zoom);void 0!==a.filmGauge&&(f.filmGauge=a.filmGauge);void 0!==a.filmOffset&&(f.filmOffset=a.filmOffset);void 0!==a.view&&(f.view=Object.assign({},a.view));break;case "OrthographicCamera":f=new Jb(a.left,a.right,a.top,a.bottom,a.near,a.far);void 0!==a.zoom&&(f.zoom=a.zoom);void 0!==a.view&&(f.view=Object.assign({},
   a.view));break;case "AmbientLight":f=new Ad(a.color,a.intensity);break;case "DirectionalLight":f=new zd(a.color,a.intensity);break;case "PointLight":f=new xd(a.color,a.intensity,a.distance,a.decay);break;case "RectAreaLight":f=new Bd(a.color,a.intensity,a.width,a.height);break;case "SpotLight":f=new wd(a.color,a.intensity,a.distance,a.angle,a.penumbra,a.decay);break;case "HemisphereLight":f=new ud(a.color,a.groundColor,a.intensity);break;case "SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");
   case "Mesh":f=d(a.geometry);var g=e(a.material);f=f.bones&&0<f.bones.length?new qd(f,g):new ra(f,g);break;case "LOD":f=new Cc;break;case "Line":f=new ma(d(a.geometry),e(a.material),a.mode);break;case "LineLoop":f=new rd(d(a.geometry),e(a.material));break;case "LineSegments":f=new W(d(a.geometry),e(a.material));break;case "PointCloud":case "Points":f=new Qb(d(a.geometry),e(a.material));break;case "Sprite":f=new Bc(e(a.material));break;case "Group":f=new Mb;break;default:f=new B}f.uuid=a.uuid;void 0!==
   a.name&&(f.name=a.name);void 0!==a.matrix?(f.matrix.fromArray(a.matrix),void 0!==a.matrixAutoUpdate&&(f.matrixAutoUpdate=a.matrixAutoUpdate),f.matrixAutoUpdate&&f.matrix.decompose(f.position,f.quaternion,f.scale)):(void 0!==a.position&&f.position.fromArray(a.position),void 0!==a.rotation&&f.rotation.fromArray(a.rotation),void 0!==a.quaternion&&f.quaternion.fromArray(a.quaternion),void 0!==a.scale&&f.scale.fromArray(a.scale));void 0!==a.castShadow&&(f.castShadow=a.castShadow);void 0!==a.receiveShadow&&
   (f.receiveShadow=a.receiveShadow);a.shadow&&(void 0!==a.shadow.bias&&(f.shadow.bias=a.shadow.bias),void 0!==a.shadow.radius&&(f.shadow.radius=a.shadow.radius),void 0!==a.shadow.mapSize&&f.shadow.mapSize.fromArray(a.shadow.mapSize),void 0!==a.shadow.camera&&(f.shadow.camera=this.parseObject(a.shadow.camera)));void 0!==a.visible&&(f.visible=a.visible);void 0!==a.frustumCulled&&(f.frustumCulled=a.frustumCulled);void 0!==a.renderOrder&&(f.renderOrder=a.renderOrder);void 0!==a.userData&&(f.userData=a.userData);
   void 0!==a.layers&&(f.layers.mask=a.layers);if(void 0!==a.children){g=a.children;for(var h=0;h<g.length;h++)f.add(this.parseObject(g[h],b,c))}if("LOD"===a.type)for(a=a.levels,g=0;g<a.length;g++){h=a[g];var k=f.getObjectByProperty("uuid",h.object);void 0!==k&&f.addLevel(k,h.distance)}return f}});var kh={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,SphericalReflectionMapping:305,CubeUVReflectionMapping:306,
   CubeUVRefractionMapping:307},Ef={RepeatWrapping:1E3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},Ff={NearestFilter:1003,NearestMipMapNearestFilter:1004,NearestMipMapLinearFilter:1005,LinearFilter:1006,LinearMipMapNearestFilter:1007,LinearMipMapLinearFilter:1008};de.prototype={constructor:de,setOptions:function(a){this.options=a;return this},load:function(a,b,c,d){void 0===a&&(a="");void 0!==this.path&&(a=this.path+a);a=this.manager.resolveURL(a);var e=this,f=ab.get(a);if(void 0!==f)return e.manager.itemStart(a),
   setTimeout(function(){b&&b(f);e.manager.itemEnd(a)},0),f;fetch(a).then(function(a){return a.blob()}).then(function(a){return createImageBitmap(a,e.options)}).then(function(c){ab.add(a,c);b&&b(c);e.manager.itemEnd(a)}).catch(function(b){d&&d(b);e.manager.itemEnd(a);e.manager.itemError(a)})},setCrossOrigin:function(){return this},setPath:function(a){this.path=a;return this}};Object.assign(ee.prototype,{moveTo:function(a,b){this.currentPath=new Oa;this.subPaths.push(this.currentPath);this.currentPath.moveTo(a,
   b)},lineTo:function(a,b){this.currentPath.lineTo(a,b)},quadraticCurveTo:function(a,b,c,d){this.currentPath.quadraticCurveTo(a,b,c,d)},bezierCurveTo:function(a,b,c,d,e,f){this.currentPath.bezierCurveTo(a,b,c,d,e,f)},splineThru:function(a){this.currentPath.splineThru(a)},toShapes:function(a,b){function c(a){for(var b=[],c=0,d=a.length;c<d;c++){var e=a[c],f=new hb;f.curves=e.curves;b.push(f)}return b}function d(a,b){for(var c=b.length,d=!1,e=c-1,f=0;f<c;e=f++){var g=b[e],h=b[f],k=h.x-g.x,l=h.y-g.y;if(Math.abs(l)>
   Number.EPSILON){if(0>l&&(g=b[f],k=-k,h=b[e],l=-l),!(a.y<g.y||a.y>h.y))if(a.y===g.y){if(a.x===g.x)return!0}else{e=l*(a.x-g.x)-k*(a.y-g.y);if(0===e)return!0;0>e||(d=!d)}}else if(a.y===g.y&&(h.x<=a.x&&a.x<=g.x||g.x<=a.x&&a.x<=h.x))return!0}return d}var e=Ya.isClockWise,f=this.subPaths;if(0===f.length)return[];if(!0===b)return c(f);b=[];if(1===f.length){var g=f[0];var h=new hb;h.curves=g.curves;b.push(h);return b}var k=!e(f[0].getPoints());k=a?!k:k;h=[];var l=[],q=[],n=0;l[n]=void 0;q[n]=[];for(var p=
   0,t=f.length;p<t;p++){g=f[p];var r=g.getPoints();var v=e(r);(v=a?!v:v)?(!k&&l[n]&&n++,l[n]={s:new hb,p:r},l[n].s.curves=g.curves,k&&n++,q[n]=[]):q[n].push({h:g,p:r[0]})}if(!l[0])return c(f);if(1<l.length){p=!1;a=[];e=0;for(f=l.length;e<f;e++)h[e]=[];e=0;for(f=l.length;e<f;e++)for(g=q[e],v=0;v<g.length;v++){k=g[v];n=!0;for(r=0;r<l.length;r++)d(k.p,l[r].p)&&(e!==r&&a.push({froms:e,tos:r,hole:v}),n?(n=!1,h[r].push(k)):p=!0);n&&h[e].push(k)}0<a.length&&(p||(q=h))}p=0;for(e=l.length;p<e;p++)for(h=l[p].s,
   b.push(h),a=q[p],f=0,g=a.length;f<g;f++)h.holes.push(a[f].h);return b}});Object.assign(fe.prototype,{isFont:!0,generateShapes:function(a,b){var c=b?b.size:null;c||(c=100);var d=[],e=this.data,f=Array.from?Array.from(a):String(a).split(""),g=c/e.resolution,h=(e.boundingBox.yMax-e.boundingBox.yMin+e.underlineThickness)*g;c=[];var k=0,l=0;if(b.justification){for(var q=0,n=a.length-1;0<=n&&(" "===a[n]&&q++," "===a[n]);n--);n=q*e.glyphs[" "].ha*g;b.justification.includes("L")&&(n=0);b.justification.includes("C")&&
   (n*=.5);k-=n;for(n=q=0;n<a.length&&(" "===a[n]&&q++," "===a[n]);n++);n=q*e.glyphs[" "].ha*g;b.justification.includes("L")&&(n=0);b.justification.includes("C")&&(n*=.5);k-=n}for(n=0;n<f.length;n++){var p=f[n];if("\n"===p)k=0,l-=h;else{b=g;a=k;q=l;if(p=e.glyphs[p]||e.glyphs["?"]){var t=new ee;if(p.o)for(var r=p._cachedOutline||(p._cachedOutline=p.o.split(" ")),v=0,z=r.length;v<z;)switch(r[v++]){case "m":var x=r[v++]*b+a;var w=r[v++]*b+q;t.moveTo(x,w);break;case "l":x=r[v++]*b+a;w=r[v++]*b+q;t.lineTo(x,
   w);break;case "q":var y=r[v++]*b+a;var A=r[v++]*b+q;var B=r[v++]*b+a;var C=r[v++]*b+q;t.quadraticCurveTo(B,C,y,A);break;case "b":y=r[v++]*b+a,A=r[v++]*b+q,B=r[v++]*b+a,C=r[v++]*b+q,x=r[v++]*b+a,w=r[v++]*b+q,t.bezierCurveTo(B,C,x,w,y,A)}b={offsetX:p.ha*b,path:t}}else b=void 0;k+=b.offsetX;c.push(b.path)}}e=0;for(f=c.length;e<f;e++)Array.prototype.push.apply(d,c[e].toShapes());return d}});Object.assign(kf.prototype,{load:function(a,b,c,d){var e=this,f=new Ja(this.manager);f.setPath(this.path);f.load(a,
   function(a){try{var c=JSON.parse(a)}catch(k){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),c=JSON.parse(a.substring(65,a.length-2))}a=e.parse(c);b&&b(a)},c,d)},parse:function(a){return new fe(a)},setPath:function(a){this.path=a;return this}});var Pd,ie={getContext:function(){void 0===Pd&&(Pd=new (window.AudioContext||window.webkitAudioContext));return Pd},setContext:function(a){Pd=a}};Object.assign(ge.prototype,{load:function(a,b,c,d){var e=
   new Ja(this.manager);e.setResponseType("arraybuffer");e.load(a,function(a){a=a.slice(0);ie.getContext().decodeAudioData(a,function(a){b(a)})},c,d)}});Object.assign(lf.prototype,{update:function(){var a,b,c,d,e,f,g,h,k=new M,l=new M;return function(m){if(a!==this||b!==m.focus||c!==m.fov||d!==m.aspect*this.aspect||e!==m.near||f!==m.far||g!==m.zoom||h!==this.eyeSep){a=this;b=m.focus;c=m.fov;d=m.aspect*this.aspect;e=m.near;f=m.far;g=m.zoom;var n=m.projectionMatrix.clone();h=this.eyeSep/2;var q=h*e/b,
   p=e*Math.tan(Q.DEG2RAD*c*.5)/g;l.elements[12]=-h;k.elements[12]=h;var r=-p*d+q;var v=p*d+q;n.elements[0]=2*e/(v-r);n.elements[8]=(v+r)/(v-r);this.cameraL.projectionMatrix.copy(n);r=-p*d-q;v=p*d-q;n.elements[0]=2*e/(v-r);n.elements[8]=(v+r)/(v-r);this.cameraR.projectionMatrix.copy(n)}this.cameraL.matrixWorld.copy(m.matrixWorld).multiply(l);this.cameraR.matrixWorld.copy(m.matrixWorld).multiply(k)}}()});cd.prototype=Object.create(B.prototype);cd.prototype.constructor=cd;he.prototype=Object.assign(Object.create(B.prototype),
   {constructor:he,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null);return this},getFilter:function(){return this.filter},setFilter:function(a){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination);this.filter=a;this.gain.connect(this.filter);
   this.filter.connect(this.context.destination);return this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(a){this.gain.gain.setTargetAtTime(a,this.context.currentTime,.01);return this},updateMatrixWorld:function(){var a=new p,b=new ia,c=new p,d=new p;return function(e){B.prototype.updateMatrixWorld.call(this,e);e=this.context.listener;var f=this.up;this.matrixWorld.decompose(a,b,c);d.set(0,0,-1).applyQuaternion(b);e.positionX?(e.positionX.setValueAtTime(a.x,this.context.currentTime),
   e.positionY.setValueAtTime(a.y,this.context.currentTime),e.positionZ.setValueAtTime(a.z,this.context.currentTime),e.forwardX.setValueAtTime(d.x,this.context.currentTime),e.forwardY.setValueAtTime(d.y,this.context.currentTime),e.forwardZ.setValueAtTime(d.z,this.context.currentTime),e.upX.setValueAtTime(f.x,this.context.currentTime),e.upY.setValueAtTime(f.y,this.context.currentTime),e.upZ.setValueAtTime(f.z,this.context.currentTime)):(e.setPosition(a.x,a.y,a.z),e.setOrientation(d.x,d.y,d.z,f.x,f.y,
   f.z))}}()});jc.prototype=Object.assign(Object.create(B.prototype),{constructor:jc,getOutput:function(){return this.gain},setNodeSource:function(a){this.hasPlaybackControl=!1;this.sourceType="audioNode";this.source=a;this.connect();return this},setMediaElementSource:function(a){this.hasPlaybackControl=!1;this.sourceType="mediaNode";this.source=this.context.createMediaElementSource(a);this.connect();return this},setBuffer:function(a){this.buffer=a;this.sourceType="buffer";this.autoplay&&this.play();
   return this},play:function(){if(!0===this.isPlaying)console.warn("THREE.Audio: Audio is already playing.");else if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else{var a=this.context.createBufferSource();a.buffer=this.buffer;a.loop=this.loop;a.onended=this.onEnded.bind(this);a.playbackRate.setValueAtTime(this.playbackRate,this.startTime);this.startTime=this.context.currentTime;a.start(this.startTime,this.offset);this.isPlaying=!0;this.source=a;return this.connect()}},
   pause:function(){if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else return!0===this.isPlaying&&(this.source.stop(),this.source.onended=null,this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this},stop:function(){if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else return this.source.stop(),this.source.onended=null,this.offset=0,this.isPlaying=!1,this},connect:function(){if(0<
   this.filters.length){this.source.connect(this.filters[0]);for(var a=1,b=this.filters.length;a<b;a++)this.filters[a-1].connect(this.filters[a]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var a=1,b=this.filters.length;a<b;a++)this.filters[a-1].disconnect(this.filters[a]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());
   return this},getFilters:function(){return this.filters},setFilters:function(a){a||(a=[]);!0===this.isPlaying?(this.disconnect(),this.filters=a,this.connect()):this.filters=a;return this},getFilter:function(){return this.getFilters()[0]},setFilter:function(a){return this.setFilters(a?[a]:[])},setPlaybackRate:function(a){if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else return this.playbackRate=a,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,
   this.context.currentTime),this},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(a){if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else return this.loop=a,!0===this.isPlaying&&(this.source.loop=this.loop),this},getVolume:function(){return this.gain.gain.value},
   setVolume:function(a){this.gain.gain.setTargetAtTime(a,this.context.currentTime,.01);return this}});je.prototype=Object.assign(Object.create(jc.prototype),{constructor:je,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(a){this.panner.refDistance=a;return this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(a){this.panner.rolloffFactor=a;return this},getDistanceModel:function(){return this.panner.distanceModel},
   setDistanceModel:function(a){this.panner.distanceModel=a;return this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(a){this.panner.maxDistance=a;return this},setDirectionalCone:function(a,b,c){this.panner.coneInnerAngle=a;this.panner.coneOuterAngle=b;this.panner.coneOuterGain=c;return this},updateMatrixWorld:function(){var a=new p,b=new ia,c=new p,d=new p;return function(e){B.prototype.updateMatrixWorld.call(this,e);e=this.panner;this.matrixWorld.decompose(a,b,
   c);d.set(0,0,1).applyQuaternion(b);e.setPosition(a.x,a.y,a.z);e.setOrientation(d.x,d.y,d.z)}}()});Object.assign(ke.prototype,{getFrequencyData:function(){this.analyser.getByteFrequencyData(this.data);return this.data},getAverageFrequency:function(){for(var a=0,b=this.getFrequencyData(),c=0;c<b.length;c++)a+=b[c];return a/b.length}});Object.assign(le.prototype,{accumulate:function(a,b){var c=this.buffer,d=this.valueSize;a=a*d+d;var e=this.cumulativeWeight;if(0===e){for(e=0;e!==d;++e)c[a+e]=c[e];e=
   b}else e+=b,this._mixBufferRegion(c,a,0,b/e,d);this.cumulativeWeight=e},apply:function(a){var b=this.valueSize,c=this.buffer;a=a*b+b;var d=this.cumulativeWeight,e=this.binding;this.cumulativeWeight=0;1>d&&this._mixBufferRegion(c,a,3*b,1-d,b);d=b;for(var f=b+b;d!==f;++d)if(c[d]!==c[d+b]){e.setValue(c,a);break}},saveOriginalState:function(){var a=this.buffer,b=this.valueSize,c=3*b;this.binding.getValue(a,c);for(var d=b;d!==c;++d)a[d]=a[c+d%b];this.cumulativeWeight=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,
   3*this.valueSize)},_select:function(a,b,c,d,e){if(.5<=d)for(d=0;d!==e;++d)a[b+d]=a[c+d]},_slerp:function(a,b,c,d){ia.slerpFlat(a,b,a,b,a,c,d)},_lerp:function(a,b,c,d,e){for(var f=1-d,g=0;g!==e;++g){var h=b+g;a[h]=a[h]*f+a[c+g]*d}}});Object.assign(nf.prototype,{getValue:function(a,b){this.bind();var c=this._bindings[this._targetGroup.nCachedObjects_];void 0!==c&&c.getValue(a,b)},setValue:function(a,b){for(var c=this._bindings,d=this._targetGroup.nCachedObjects_,e=c.length;d!==e;++d)c[d].setValue(a,
   b)},bind:function(){for(var a=this._bindings,b=this._targetGroup.nCachedObjects_,c=a.length;b!==c;++b)a[b].bind()},unbind:function(){for(var a=this._bindings,b=this._targetGroup.nCachedObjects_,c=a.length;b!==c;++b)a[b].unbind()}});Object.assign(Y,{Composite:nf,create:function(a,b,c){return a&&a.isAnimationObjectGroup?new Y.Composite(a,b,c):new Y(a,b,c)},sanitizeNodeName:function(){var a=/[\[\]\.:\/]/g;return function(b){return b.replace(/\s/g,"_").replace(a,"")}}(),parseTrackName:function(){var a=
   "[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",b=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]");a=/(WCOD+)?/.source.replace("WCOD",a);var c=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),d=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),e=new RegExp("^"+b+a+c+d+"$"),f=["material","materials","bones"];return function(a){var b=e.exec(a);if(!b)throw Error("PropertyBinding: Cannot parse trackName: "+a);b={nodeName:b[2],objectName:b[3],objectIndex:b[4],propertyName:b[5],
   propertyIndex:b[6]};var c=b.nodeName&&b.nodeName.lastIndexOf(".");if(void 0!==c&&-1!==c){var d=b.nodeName.substring(c+1);-1!==f.indexOf(d)&&(b.nodeName=b.nodeName.substring(0,c),b.objectName=d)}if(null===b.propertyName||0===b.propertyName.length)throw Error("PropertyBinding: can not parse propertyName from trackName: "+a);return b}}(),findNode:function(a,b){if(!b||""===b||"root"===b||"."===b||-1===b||b===a.name||b===a.uuid)return a;if(a.skeleton){var c=a.skeleton.getBoneByName(b);if(void 0!==c)return c}if(a.children){var d=
   function(a){for(var c=0;c<a.length;c++){var e=a[c];if(e.name===b||e.uuid===b||(e=d(e.children)))return e}return null};if(a=d(a.children))return a}return null}});Object.assign(Y.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(a,b){a[b]=this.node[this.propertyName]},function(a,b){for(var c=this.resolvedProperty,
   d=0,e=c.length;d!==e;++d)a[b++]=c[d]},function(a,b){a[b]=this.resolvedProperty[this.propertyIndex]},function(a,b){this.resolvedProperty.toArray(a,b)}],SetterByBindingTypeAndVersioning:[[function(a,b){this.targetObject[this.propertyName]=a[b]},function(a,b){this.targetObject[this.propertyName]=a[b];this.targetObject.needsUpdate=!0},function(a,b){this.targetObject[this.propertyName]=a[b];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(a,b){for(var c=this.resolvedProperty,d=0,e=c.length;d!==
   e;++d)c[d]=a[b++]},function(a,b){for(var c=this.resolvedProperty,d=0,e=c.length;d!==e;++d)c[d]=a[b++];this.targetObject.needsUpdate=!0},function(a,b){for(var c=this.resolvedProperty,d=0,e=c.length;d!==e;++d)c[d]=a[b++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(a,b){this.resolvedProperty[this.propertyIndex]=a[b]},function(a,b){this.resolvedProperty[this.propertyIndex]=a[b];this.targetObject.needsUpdate=!0},function(a,b){this.resolvedProperty[this.propertyIndex]=a[b];this.targetObject.matrixWorldNeedsUpdate=
   !0}],[function(a,b){this.resolvedProperty.fromArray(a,b)},function(a,b){this.resolvedProperty.fromArray(a,b);this.targetObject.needsUpdate=!0},function(a,b){this.resolvedProperty.fromArray(a,b);this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(a,b){this.bind();this.getValue(a,b)},setValue:function(a,b){this.bind();this.setValue(a,b)},bind:function(){var a=this.node,b=this.parsedPath,c=b.objectName,d=b.propertyName,e=b.propertyIndex;a||(this.node=a=Y.findNode(this.rootNode,b.nodeName)||
   this.rootNode);this.getValue=this._getValue_unavailable;this.setValue=this._setValue_unavailable;if(a){if(c){var f=b.objectIndex;switch(c){case "materials":if(!a.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!a.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}a=a.material.materials;break;case "bones":if(!a.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",
   this);return}a=a.skeleton.bones;for(c=0;c<a.length;c++)if(a[c].name===f){f=c;break}break;default:if(void 0===a[c]){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}a=a[c]}if(void 0!==f){if(void 0===a[f]){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,a);return}a=a[f]}}f=a[d];if(void 0===f)console.error("THREE.PropertyBinding: Trying to update property for track: "+b.nodeName+"."+d+" but it wasn't found.",
   a);else{b=this.Versioning.None;void 0!==a.needsUpdate?(b=this.Versioning.NeedsUpdate,this.targetObject=a):void 0!==a.matrixWorldNeedsUpdate&&(b=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=a);c=this.BindingType.Direct;if(void 0!==e){if("morphTargetInfluences"===d){if(!a.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(a.geometry.isBufferGeometry){if(!a.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",
   this);return}for(c=0;c<this.node.geometry.morphAttributes.position.length;c++)if(a.geometry.morphAttributes.position[c].name===e){e=c;break}}else{if(!a.geometry.morphTargets){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);return}for(c=0;c<this.node.geometry.morphTargets.length;c++)if(a.geometry.morphTargets[c].name===e){e=c;break}}}c=this.BindingType.ArrayElement;this.resolvedProperty=f;this.propertyIndex=e}else void 0!==
   f.fromArray&&void 0!==f.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=f):Array.isArray(f)?(c=this.BindingType.EntireArray,this.resolvedProperty=f):this.propertyName=d;this.getValue=this.GetterByBindingType[c];this.setValue=this.SetterByBindingTypeAndVersioning[c][b]}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null;this.getValue=this._getValue_unbound;this.setValue=this._setValue_unbound}});
   Object.assign(Y.prototype,{_getValue_unbound:Y.prototype.getValue,_setValue_unbound:Y.prototype.setValue});Object.assign(of.prototype,{isAnimationObjectGroup:!0,add:function(){for(var a=this._objects,b=a.length,c=this.nCachedObjects_,d=this._indicesByUUID,e=this._paths,f=this._parsedPaths,g=this._bindings,h=g.length,k=void 0,l=0,q=arguments.length;l!==q;++l){var n=arguments[l],p=n.uuid,t=d[p];if(void 0===t){t=b++;d[p]=t;a.push(n);p=0;for(var r=h;p!==r;++p)g[p].push(new Y(n,e[p],f[p]))}else if(t<c){k=
   a[t];var v=--c;r=a[v];d[r.uuid]=t;a[t]=r;d[p]=v;a[v]=n;p=0;for(r=h;p!==r;++p){var z=g[p],x=z[t];z[t]=z[v];void 0===x&&(x=new Y(n,e[p],f[p]));z[v]=x}}else a[t]!==k&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c},remove:function(){for(var a=this._objects,b=this.nCachedObjects_,c=this._indicesByUUID,d=this._bindings,e=d.length,f=0,g=arguments.length;f!==g;++f){var h=
   arguments[f],k=h.uuid,l=c[k];if(void 0!==l&&l>=b){var p=b++,n=a[p];c[n.uuid]=l;a[l]=n;c[k]=p;a[p]=h;h=0;for(k=e;h!==k;++h){n=d[h];var u=n[l];n[l]=n[p];n[p]=u}}}this.nCachedObjects_=b},uncache:function(){for(var a=this._objects,b=a.length,c=this.nCachedObjects_,d=this._indicesByUUID,e=this._bindings,f=e.length,g=0,h=arguments.length;g!==h;++g){var k=arguments[g].uuid,l=d[k];if(void 0!==l)if(delete d[k],l<c){k=--c;var p=a[k],n=--b,u=a[n];d[p.uuid]=l;a[l]=p;d[u.uuid]=k;a[k]=u;a.pop();p=0;for(u=f;p!==
   u;++p){var t=e[p],r=t[n];t[l]=t[k];t[k]=r;t.pop()}}else for(n=--b,u=a[n],d[u.uuid]=l,a[l]=u,a.pop(),p=0,u=f;p!==u;++p)t=e[p],t[l]=t[n],t.pop()}this.nCachedObjects_=c},subscribe_:function(a,b){var c=this._bindingsIndicesByPath,d=c[a],e=this._bindings;if(void 0!==d)return e[d];var f=this._paths,g=this._parsedPaths,h=this._objects,k=this.nCachedObjects_,l=Array(h.length);d=e.length;c[a]=d;f.push(a);g.push(b);e.push(l);c=k;for(d=h.length;c!==d;++c)l[c]=new Y(h[c],a,b);return l},unsubscribe_:function(a){var b=
   this._bindingsIndicesByPath,c=b[a];if(void 0!==c){var d=this._paths,e=this._parsedPaths,f=this._bindings,g=f.length-1,h=f[g];b[a[g]]=c;f[c]=h;f.pop();e[c]=e[g];e.pop();d[c]=d[g];d.pop()}}});Object.assign(pf.prototype,{play:function(){this._mixer._activateAction(this);return this},stop:function(){this._mixer._deactivateAction(this);return this.reset()},reset:function(){this.paused=!1;this.enabled=!0;this.time=0;this._loopCount=-1;this._startTime=null;return this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&
   !this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(a){this._startTime=a;return this},setLoop:function(a,b){this.loop=a;this.repetitions=b;return this},setEffectiveWeight:function(a){this.weight=a;this._effectiveWeight=this.enabled?a:0;return this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(a){return this._scheduleFading(a,0,1)},fadeOut:function(a){return this._scheduleFading(a,
   1,0)},crossFadeFrom:function(a,b,c){a.fadeOut(b);this.fadeIn(b);if(c){c=this._clip.duration;var d=a._clip.duration,e=c/d;a.warp(1,d/c,b);this.warp(e,1,b)}return this},crossFadeTo:function(a,b,c){return a.crossFadeFrom(this,b,c)},stopFading:function(){var a=this._weightInterpolant;null!==a&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(a));return this},setEffectiveTimeScale:function(a){this.timeScale=a;this._effectiveTimeScale=this.paused?0:a;return this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},
   setDuration:function(a){this.timeScale=this._clip.duration/a;return this.stopWarping()},syncWith:function(a){this.time=a.time;this.timeScale=a.timeScale;return this.stopWarping()},halt:function(a){return this.warp(this._effectiveTimeScale,0,a)},warp:function(a,b,c){var d=this._mixer,e=d.time,f=this._timeScaleInterpolant,g=this.timeScale;null===f&&(this._timeScaleInterpolant=f=d._lendControlInterpolant());d=f.parameterPositions;f=f.sampleValues;d[0]=e;d[1]=e+c;f[0]=a/g;f[1]=b/g;return this},stopWarping:function(){var a=
   this._timeScaleInterpolant;null!==a&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(a));return this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(a,b,c,d){if(this.enabled){var e=this._startTime;if(null!==e){b=(a-e)*c;if(0>b||0===c)return;this._startTime=null;b*=c}b*=this._updateTimeScale(a);c=this._updateTime(b);a=this._updateWeight(a);if(0<a){b=this._interpolants;
   e=this._propertyBindings;for(var f=0,g=b.length;f!==g;++f)b[f].evaluate(c),e[f].accumulate(d,a)}}else this._updateWeight(a)},_updateWeight:function(a){var b=0;if(this.enabled){b=this.weight;var c=this._weightInterpolant;if(null!==c){var d=c.evaluate(a)[0];b*=d;a>c.parameterPositions[1]&&(this.stopFading(),0===d&&(this.enabled=!1))}}return this._effectiveWeight=b},_updateTimeScale:function(a){var b=0;if(!this.paused){b=this.timeScale;var c=this._timeScaleInterpolant;if(null!==c){var d=c.evaluate(a)[0];
   b*=d;a>c.parameterPositions[1]&&(this.stopWarping(),0===b?this.paused=!0:this.timeScale=b)}}return this._effectiveTimeScale=b},_updateTime:function(a){var b=this.time+a,c=this._clip.duration,d=this.loop,e=this._loopCount,f=2202===d;if(0===a)return-1===e?b:f&&1===(e&1)?c-b:b;if(2200===d)a:{if(-1===e&&(this._loopCount=0,this._setEndings(!0,!0,!1)),b>=c)b=c;else if(0>b)b=0;else break a;this.clampWhenFinished?this.paused=!0:this.enabled=!1;this._mixer.dispatchEvent({type:"finished",action:this,direction:0>
   a?-1:1})}else{-1===e&&(0<=a?(e=0,this._setEndings(!0,0===this.repetitions,f)):this._setEndings(0===this.repetitions,!0,f));if(b>=c||0>b){d=Math.floor(b/c);b-=c*d;e+=Math.abs(d);var g=this.repetitions-e;0>=g?(this.clampWhenFinished?this.paused=!0:this.enabled=!1,b=0<a?c:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<a?1:-1})):(1===g?(a=0>a,this._setEndings(a,!a,f)):this._setEndings(!1,!1,f),this._loopCount=e,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:d}))}if(f&&
   1===(e&1))return this.time=b,c-b}return this.time=b},_setEndings:function(a,b,c){var d=this._interpolantSettings;c?(d.endingStart=2401,d.endingEnd=2401):(d.endingStart=a?this.zeroSlopeAtStart?2401:2400:2402,d.endingEnd=b?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(a,b,c){var d=this._mixer,e=d.time,f=this._weightInterpolant;null===f&&(this._weightInterpolant=f=d._lendControlInterpolant());d=f.parameterPositions;f=f.sampleValues;d[0]=e;f[0]=b;d[1]=e+a;f[1]=c;return this}});me.prototype=
   Object.assign(Object.create(ib.prototype),{constructor:me,_bindAction:function(a,b){var c=a._localRoot||this._root,d=a._clip.tracks,e=d.length,f=a._propertyBindings;a=a._interpolants;var g=c.uuid,h=this._bindingsByRootAndName,k=h[g];void 0===k&&(k={},h[g]=k);for(h=0;h!==e;++h){var l=d[h],p=l.name,n=k[p];if(void 0===n){n=f[h];if(void 0!==n){null===n._cacheIndex&&(++n.referenceCount,this._addInactiveBinding(n,g,p));continue}n=new le(Y.create(c,p,b&&b._propertyBindings[h].binding.parsedPath),l.ValueTypeName,
   l.getValueSize());++n.referenceCount;this._addInactiveBinding(n,g,p)}f[h]=n;a[h].resultBuffer=n.buffer}},_activateAction:function(a){if(!this._isActiveAction(a)){if(null===a._cacheIndex){var b=(a._localRoot||this._root).uuid,c=a._clip.uuid,d=this._actionsByClip[c];this._bindAction(a,d&&d.knownActions[0]);this._addInactiveAction(a,c,b)}b=a._propertyBindings;c=0;for(d=b.length;c!==d;++c){var e=b[c];0===e.useCount++&&(this._lendBinding(e),e.saveOriginalState())}this._lendAction(a)}},_deactivateAction:function(a){if(this._isActiveAction(a)){for(var b=
   a._propertyBindings,c=0,d=b.length;c!==d;++c){var e=b[c];0===--e.useCount&&(e.restoreOriginalState(),this._takeBackBinding(e))}this._takeBackAction(a)}},_initMemoryManager:function(){this._actions=[];this._nActiveActions=0;this._actionsByClip={};this._bindings=[];this._nActiveBindings=0;this._bindingsByRootAndName={};this._controlInterpolants=[];this._nActiveControlInterpolants=0;var a=this;this.stats={actions:{get total(){return a._actions.length},get inUse(){return a._nActiveActions}},bindings:{get total(){return a._bindings.length},
   get inUse(){return a._nActiveBindings}},controlInterpolants:{get total(){return a._controlInterpolants.length},get inUse(){return a._nActiveControlInterpolants}}}},_isActiveAction:function(a){a=a._cacheIndex;return null!==a&&a<this._nActiveActions},_addInactiveAction:function(a,b,c){var d=this._actions,e=this._actionsByClip,f=e[b];void 0===f?(f={knownActions:[a],actionByRoot:{}},a._byClipCacheIndex=0,e[b]=f):(b=f.knownActions,a._byClipCacheIndex=b.length,b.push(a));a._cacheIndex=d.length;d.push(a);
   f.actionByRoot[c]=a},_removeInactiveAction:function(a){var b=this._actions,c=b[b.length-1],d=a._cacheIndex;c._cacheIndex=d;b[d]=c;b.pop();a._cacheIndex=null;b=a._clip.uuid;c=this._actionsByClip;d=c[b];var e=d.knownActions,f=e[e.length-1],g=a._byClipCacheIndex;f._byClipCacheIndex=g;e[g]=f;e.pop();a._byClipCacheIndex=null;delete d.actionByRoot[(a._localRoot||this._root).uuid];0===e.length&&delete c[b];this._removeInactiveBindingsForAction(a)},_removeInactiveBindingsForAction:function(a){a=a._propertyBindings;
   for(var b=0,c=a.length;b!==c;++b){var d=a[b];0===--d.referenceCount&&this._removeInactiveBinding(d)}},_lendAction:function(a){var b=this._actions,c=a._cacheIndex,d=this._nActiveActions++,e=b[d];a._cacheIndex=d;b[d]=a;e._cacheIndex=c;b[c]=e},_takeBackAction:function(a){var b=this._actions,c=a._cacheIndex,d=--this._nActiveActions,e=b[d];a._cacheIndex=d;b[d]=a;e._cacheIndex=c;b[c]=e},_addInactiveBinding:function(a,b,c){var d=this._bindingsByRootAndName,e=d[b],f=this._bindings;void 0===e&&(e={},d[b]=
   e);e[c]=a;a._cacheIndex=f.length;f.push(a)},_removeInactiveBinding:function(a){var b=this._bindings,c=a.binding,d=c.rootNode.uuid;c=c.path;var e=this._bindingsByRootAndName,f=e[d],g=b[b.length-1];a=a._cacheIndex;g._cacheIndex=a;b[a]=g;b.pop();delete f[c];a:{for(var h in f)break a;delete e[d]}},_lendBinding:function(a){var b=this._bindings,c=a._cacheIndex,d=this._nActiveBindings++,e=b[d];a._cacheIndex=d;b[d]=a;e._cacheIndex=c;b[c]=e},_takeBackBinding:function(a){var b=this._bindings,c=a._cacheIndex,
   d=--this._nActiveBindings,e=b[d];a._cacheIndex=d;b[d]=a;e._cacheIndex=c;b[c]=e},_lendControlInterpolant:function(){var a=this._controlInterpolants,b=this._nActiveControlInterpolants++,c=a[b];void 0===c&&(c=new ad(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),c.__cacheIndex=b,a[b]=c);return c},_takeBackControlInterpolant:function(a){var b=this._controlInterpolants,c=a.__cacheIndex,d=--this._nActiveControlInterpolants,e=b[d];a.__cacheIndex=d;b[d]=a;e.__cacheIndex=
   c;b[c]=e},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(a,b){var c=b||this._root,d=c.uuid;c="string"===typeof a?Ca.findByName(c,a):a;a=null!==c?c.uuid:a;var e=this._actionsByClip[a],f=null;if(void 0!==e){f=e.actionByRoot[d];if(void 0!==f)return f;f=e.knownActions[0];null===c&&(c=f._clip)}if(null===c)return null;b=new pf(this,c,b);this._bindAction(b,f);this._addInactiveAction(b,a,d);return b},existingAction:function(a,b){var c=b||this._root;b=c.uuid;c="string"===typeof a?
   Ca.findByName(c,a):a;a=this._actionsByClip[c?c.uuid:a];return void 0!==a?a.actionByRoot[b]||null:null},stopAllAction:function(){for(var a=this._actions,b=this._nActiveActions,c=this._bindings,d=this._nActiveBindings,e=this._nActiveBindings=this._nActiveActions=0;e!==b;++e)a[e].reset();for(e=0;e!==d;++e)c[e].useCount=0;return this},update:function(a){a*=this.timeScale;for(var b=this._actions,c=this._nActiveActions,d=this.time+=a,e=Math.sign(a),f=this._accuIndex^=1,g=0;g!==c;++g)b[g]._update(d,a,e,
   f);a=this._bindings;b=this._nActiveBindings;for(g=0;g!==b;++g)a[g].apply(f);return this},getRoot:function(){return this._root},uncacheClip:function(a){var b=this._actions;a=a.uuid;var c=this._actionsByClip,d=c[a];if(void 0!==d){d=d.knownActions;for(var e=0,f=d.length;e!==f;++e){var g=d[e];this._deactivateAction(g);var h=g._cacheIndex,k=b[b.length-1];g._cacheIndex=null;g._byClipCacheIndex=null;k._cacheIndex=h;b[h]=k;b.pop();this._removeInactiveBindingsForAction(g)}delete c[a]}},uncacheRoot:function(a){a=
   a.uuid;var b=this._actionsByClip;for(d in b){var c=b[d].actionByRoot[a];void 0!==c&&(this._deactivateAction(c),this._removeInactiveAction(c))}var d=this._bindingsByRootAndName[a];if(void 0!==d)for(var e in d)a=d[e],a.restoreOriginalState(),this._removeInactiveBinding(a)},uncacheAction:function(a,b){a=this.existingAction(a,b);null!==a&&(this._deactivateAction(a),this._removeInactiveAction(a))}});Jd.prototype.clone=function(){return new Jd(void 0===this.value.clone?this.value:this.value.clone())};ne.prototype=
   Object.assign(Object.create(E.prototype),{constructor:ne,isInstancedBufferGeometry:!0,copy:function(a){E.prototype.copy.call(this,a);this.maxInstancedCount=a.maxInstancedCount;return this},clone:function(){return(new this.constructor).copy(this)}});oe.prototype=Object.assign(Object.create(sb.prototype),{constructor:oe,isInstancedInterleavedBuffer:!0,copy:function(a){sb.prototype.copy.call(this,a);this.meshPerAttribute=a.meshPerAttribute;return this}});pe.prototype=Object.assign(Object.create(P.prototype),
   {constructor:pe,isInstancedBufferAttribute:!0,copy:function(a){P.prototype.copy.call(this,a);this.meshPerAttribute=a.meshPerAttribute;return this}});Object.assign(qf.prototype,{linePrecision:1,set:function(a,b){this.ray.set(a,b)},setFromCamera:function(a,b){b&&b.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(b.matrixWorld),this.ray.direction.set(a.x,a.y,.5).unproject(b).sub(this.ray.origin).normalize()):b&&b.isOrthographicCamera?(this.ray.origin.set(a.x,a.y,(b.near+b.far)/(b.near-b.far)).unproject(b),
   this.ray.direction.set(0,0,-1).transformDirection(b.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(a,b,c){c=c||[];qe(a,this,c,b);c.sort(rf);return c},intersectObjects:function(a,b,c){c=c||[];if(!1===Array.isArray(a))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),c;for(var d=0,e=a.length;d<e;d++)qe(a[d],this,c,b);c.sort(rf);return c}});Object.assign(sf.prototype,{start:function(){this.oldTime=this.startTime=("undefined"===
   typeof performance?Date:performance).now();this.elapsedTime=0;this.running=!0},stop:function(){this.getElapsedTime();this.autoStart=this.running=!1},getElapsedTime:function(){this.getDelta();return this.elapsedTime},getDelta:function(){var a=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var b=("undefined"===typeof performance?Date:performance).now();a=(b-this.oldTime)/1E3;this.oldTime=b;this.elapsedTime+=a}return a}});Object.assign(tf.prototype,{set:function(a,b,c){this.radius=
   a;this.phi=b;this.theta=c;return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.radius=a.radius;this.phi=a.phi;this.theta=a.theta;return this},makeSafe:function(){this.phi=Math.max(1E-6,Math.min(Math.PI-1E-6,this.phi));return this},setFromVector3:function(a){this.radius=a.length();0===this.radius?this.phi=this.theta=0:(this.theta=Math.atan2(a.x,a.z),this.phi=Math.acos(Q.clamp(a.y/this.radius,-1,1)));return this}});Object.assign(uf.prototype,{set:function(a,b,
   c){this.radius=a;this.theta=b;this.y=c;return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.radius=a.radius;this.theta=a.theta;this.y=a.y;return this},setFromVector3:function(a){this.radius=Math.sqrt(a.x*a.x+a.z*a.z);this.theta=Math.atan2(a.x,a.z);this.y=a.y;return this}});Object.assign(re.prototype,{set:function(a,b){this.min.copy(a);this.max.copy(b);return this},setFromPoints:function(a){this.makeEmpty();for(var b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);
   return this},setFromCenterAndSize:function(){var a=new C;return function(b,c){c=a.copy(c).multiplyScalar(.5);this.min.copy(b).sub(c);this.max.copy(b).add(c);return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.min.copy(a.min);this.max.copy(a.max);return this},makeEmpty:function(){this.min.x=this.min.y=Infinity;this.max.x=this.max.y=-Infinity;return this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(a){void 0===
   a&&(console.warn("THREE.Box2: .getCenter() target is now required"),a=new C);return this.isEmpty()?a.set(0,0):a.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(a){void 0===a&&(console.warn("THREE.Box2: .getSize() target is now required"),a=new C);return this.isEmpty()?a.set(0,0):a.subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);
   this.max.addScalar(a);return this},containsPoint:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y},getParameter:function(a,b){void 0===b&&(console.warn("THREE.Box2: .getParameter() target is now required"),b=new C);return b.set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(a){return a.max.x<
   this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y?!1:!0},clampPoint:function(a,b){void 0===b&&(console.warn("THREE.Box2: .clampPoint() target is now required"),b=new C);return b.copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new C;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);return this},union:function(a){this.min.min(a.min);this.max.max(a.max);return this},translate:function(a){this.min.add(a);
   this.max.add(a);return this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)}});Object.assign(se.prototype,{set:function(a,b){this.start.copy(a);this.end.copy(b);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.start.copy(a.start);this.end.copy(a.end);return this},getCenter:function(a){void 0===a&&(console.warn("THREE.Line3: .getCenter() target is now required"),a=new p);return a.addVectors(this.start,this.end).multiplyScalar(.5)},
   delta:function(a){void 0===a&&(console.warn("THREE.Line3: .delta() target is now required"),a=new p);return a.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(a,b){void 0===b&&(console.warn("THREE.Line3: .at() target is now required"),b=new p);return this.delta(b).multiplyScalar(a).add(this.start)},closestPointToPointParameter:function(){var a=new p,b=new p;return function(c,
   d){a.subVectors(c,this.start);b.subVectors(this.end,this.start);c=b.dot(b);c=b.dot(a)/c;d&&(c=Q.clamp(c,0,1));return c}}(),closestPointToPoint:function(a,b,c){a=this.closestPointToPointParameter(a,b);void 0===c&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),c=new p);return this.delta(c).multiplyScalar(a).add(this.start)},applyMatrix4:function(a){this.start.applyMatrix4(a);this.end.applyMatrix4(a);return this},equals:function(a){return a.start.equals(this.start)&&a.end.equals(this.end)}});
   dd.prototype=Object.create(B.prototype);dd.prototype.constructor=dd;dd.prototype.isImmediateRenderObject=!0;ed.prototype=Object.create(W.prototype);ed.prototype.constructor=ed;ed.prototype.update=function(){var a=new p,b=new p,c=new la;return function(){var d=["a","b","c"];this.object.updateMatrixWorld(!0);c.getNormalMatrix(this.object.matrixWorld);var e=this.object.matrixWorld,f=this.geometry.attributes.position,g=this.object.geometry;if(g&&g.isGeometry)for(var h=g.vertices,k=g.faces,l=g=0,p=k.length;l<
   p;l++)for(var n=k[l],u=0,t=n.vertexNormals.length;u<t;u++){var r=n.vertexNormals[u];a.copy(h[n[d[u]]]).applyMatrix4(e);b.copy(r).applyMatrix3(c).normalize().multiplyScalar(this.size).add(a);f.setXYZ(g,a.x,a.y,a.z);g+=1;f.setXYZ(g,b.x,b.y,b.z);g+=1}else if(g&&g.isBufferGeometry)for(d=g.attributes.position,h=g.attributes.normal,u=g=0,t=d.count;u<t;u++)a.set(d.getX(u),d.getY(u),d.getZ(u)).applyMatrix4(e),b.set(h.getX(u),h.getY(u),h.getZ(u)),b.applyMatrix3(c).normalize().multiplyScalar(this.size).add(a),
   f.setXYZ(g,a.x,a.y,a.z),g+=1,f.setXYZ(g,b.x,b.y,b.z),g+=1;f.needsUpdate=!0}}();kc.prototype=Object.create(B.prototype);kc.prototype.constructor=kc;kc.prototype.dispose=function(){this.cone.geometry.dispose();this.cone.material.dispose()};kc.prototype.update=function(){var a=new p,b=new p;return function(){this.light.updateMatrixWorld();var c=this.light.distance?this.light.distance:1E3,d=c*Math.tan(this.light.angle);this.cone.scale.set(d,d,c);a.setFromMatrixPosition(this.light.matrixWorld);b.setFromMatrixPosition(this.light.target.matrixWorld);
   this.cone.lookAt(b.sub(a));void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}();lc.prototype=Object.create(W.prototype);lc.prototype.constructor=lc;lc.prototype.updateMatrixWorld=function(){var a=new p,b=new M,c=new M;return function(d){var e=this.bones,f=this.geometry,g=f.getAttribute("position");c.getInverse(this.root.matrixWorld);for(var h=0,k=0;h<e.length;h++){var l=e[h];l.parent&&l.parent.isBone&&(b.multiplyMatrices(c,l.matrixWorld),
   a.setFromMatrixPosition(b),g.setXYZ(k,a.x,a.y,a.z),b.multiplyMatrices(c,l.parent.matrixWorld),a.setFromMatrixPosition(b),g.setXYZ(k+1,a.x,a.y,a.z),k+=2)}f.getAttribute("position").needsUpdate=!0;B.prototype.updateMatrixWorld.call(this,d)}}();mc.prototype=Object.create(ra.prototype);mc.prototype.constructor=mc;mc.prototype.dispose=function(){this.geometry.dispose();this.material.dispose()};mc.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)};
   nc.prototype=Object.create(B.prototype);nc.prototype.constructor=nc;nc.prototype.dispose=function(){this.children[0].geometry.dispose();this.children[0].material.dispose()};nc.prototype.update=function(){var a=.5*this.light.width,b=.5*this.light.height,c=this.line.geometry.attributes.position,d=c.array;d[0]=a;d[1]=-b;d[2]=0;d[3]=a;d[4]=b;d[5]=0;d[6]=-a;d[7]=b;d[8]=0;d[9]=-a;d[10]=-b;d[11]=0;d[12]=a;d[13]=-b;d[14]=0;c.needsUpdate=!0;void 0!==this.color?this.line.material.color.set(this.color):this.line.material.color.copy(this.light.color)};
   oc.prototype=Object.create(B.prototype);oc.prototype.constructor=oc;oc.prototype.dispose=function(){this.children[0].geometry.dispose();this.children[0].material.dispose()};oc.prototype.update=function(){var a=new p,b=new G,c=new G;return function(){var d=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var e=d.geometry.getAttribute("color");b.copy(this.light.color);c.copy(this.light.groundColor);for(var f=0,g=e.count;f<g;f++){var h=f<g/2?b:c;e.setXYZ(f,h.r,h.g,h.b)}e.needsUpdate=
   !0}d.lookAt(a.setFromMatrixPosition(this.light.matrixWorld).negate())}}();fd.prototype=Object.create(W.prototype);fd.prototype.constructor=fd;Kd.prototype=Object.create(W.prototype);Kd.prototype.constructor=Kd;gd.prototype=Object.create(W.prototype);gd.prototype.constructor=gd;gd.prototype.update=function(){var a=new p,b=new p,c=new la;return function(){this.object.updateMatrixWorld(!0);c.getNormalMatrix(this.object.matrixWorld);var d=this.object.matrixWorld,e=this.geometry.attributes.position,f=
   this.object.geometry,g=f.vertices;f=f.faces;for(var h=0,k=0,l=f.length;k<l;k++){var p=f[k],n=p.normal;a.copy(g[p.a]).add(g[p.b]).add(g[p.c]).divideScalar(3).applyMatrix4(d);b.copy(n).applyMatrix3(c).normalize().multiplyScalar(this.size).add(a);e.setXYZ(h,a.x,a.y,a.z);h+=1;e.setXYZ(h,b.x,b.y,b.z);h+=1}e.needsUpdate=!0}}();pc.prototype=Object.create(B.prototype);pc.prototype.constructor=pc;pc.prototype.dispose=function(){this.lightPlane.geometry.dispose();this.lightPlane.material.dispose();this.targetLine.geometry.dispose();
   this.targetLine.material.dispose()};pc.prototype.update=function(){var a=new p,b=new p,c=new p;return function(){a.setFromMatrixPosition(this.light.matrixWorld);b.setFromMatrixPosition(this.light.target.matrixWorld);c.subVectors(b,a);this.lightPlane.lookAt(c);void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color));this.targetLine.lookAt(c);
   this.targetLine.scale.z=c.length()}}();hd.prototype=Object.create(W.prototype);hd.prototype.constructor=hd;hd.prototype.update=function(){function a(a,g,h,k){d.set(g,h,k).unproject(e);a=c[a];if(void 0!==a)for(g=b.getAttribute("position"),h=0,k=a.length;h<k;h++)g.setXYZ(a[h],d.x,d.y,d.z)}var b,c,d=new p,e=new Qa;return function(){b=this.geometry;c=this.pointMap;e.projectionMatrix.copy(this.camera.projectionMatrix);a("c",0,0,-1);a("t",0,0,1);a("n1",-1,-1,-1);a("n2",1,-1,-1);a("n3",-1,1,-1);a("n4",1,
   1,-1);a("f1",-1,-1,1);a("f2",1,-1,1);a("f3",-1,1,1);a("f4",1,1,1);a("u1",.7,1.1,-1);a("u2",-.7,1.1,-1);a("u3",0,2,-1);a("cf1",-1,0,1);a("cf2",1,0,1);a("cf3",0,-1,1);a("cf4",0,1,1);a("cn1",-1,0,-1);a("cn2",1,0,-1);a("cn3",0,-1,-1);a("cn4",0,1,-1);b.getAttribute("position").needsUpdate=!0}}();Hb.prototype=Object.create(W.prototype);Hb.prototype.constructor=Hb;Hb.prototype.update=function(){var a=new Va;return function(b){void 0!==b&&console.warn("THREE.BoxHelper: .update() has no longer arguments.");
   void 0!==this.object&&a.setFromObject(this.object);if(!a.isEmpty()){b=a.min;var c=a.max,d=this.geometry.attributes.position,e=d.array;e[0]=c.x;e[1]=c.y;e[2]=c.z;e[3]=b.x;e[4]=c.y;e[5]=c.z;e[6]=b.x;e[7]=b.y;e[8]=c.z;e[9]=c.x;e[10]=b.y;e[11]=c.z;e[12]=c.x;e[13]=c.y;e[14]=b.z;e[15]=b.x;e[16]=c.y;e[17]=b.z;e[18]=b.x;e[19]=b.y;e[20]=b.z;e[21]=c.x;e[22]=b.y;e[23]=b.z;d.needsUpdate=!0;this.geometry.computeBoundingSphere()}}}();Hb.prototype.setFromObject=function(a){this.object=a;this.update();return this};
   id.prototype=Object.create(W.prototype);id.prototype.constructor=id;id.prototype.updateMatrixWorld=function(a){var b=this.box;b.isEmpty()||(b.getCenter(this.position),b.getSize(this.scale),this.scale.multiplyScalar(.5),B.prototype.updateMatrixWorld.call(this,a))};jd.prototype=Object.create(ma.prototype);jd.prototype.constructor=jd;jd.prototype.updateMatrixWorld=function(a){var b=-this.plane.constant;1E-8>Math.abs(b)&&(b=1E-8);this.scale.set(.5*this.size,.5*this.size,b);this.children[0].material.side=
   0>b?1:0;this.lookAt(this.plane.normal);B.prototype.updateMatrixWorld.call(this,a)};var Ld,te;Ib.prototype=Object.create(B.prototype);Ib.prototype.constructor=Ib;Ib.prototype.setDirection=function(){var a=new p,b;return function(c){.99999<c.y?this.quaternion.set(0,0,0,1):-.99999>c.y?this.quaternion.set(1,0,0,0):(a.set(c.z,0,-c.x).normalize(),b=Math.acos(c.y),this.quaternion.setFromAxisAngle(a,b))}}();Ib.prototype.setLength=function(a,b,c){void 0===b&&(b=.2*a);void 0===c&&(c=.2*b);this.line.scale.set(1,
   Math.max(0,a-b),1);this.line.updateMatrix();this.cone.scale.set(c,b,c);this.cone.position.y=a;this.cone.updateMatrix()};Ib.prototype.setColor=function(a){this.line.material.color.copy(a);this.cone.material.color.copy(a)};kd.prototype=Object.create(W.prototype);kd.prototype.constructor=kd;L.create=function(a,b){console.log("THREE.Curve.create() has been deprecated");a.prototype=Object.create(L.prototype);a.prototype.constructor=a;a.prototype.getPoint=b;return a};Object.assign($a.prototype,{createPointsGeometry:function(a){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");
   a=this.getPoints(a);return this.createGeometry(a)},createSpacedPointsGeometry:function(a){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");a=this.getSpacedPoints(a);return this.createGeometry(a)},createGeometry:function(a){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var b=new K,c=0,d=a.length;c<d;c++){var e=a[c];b.vertices.push(new p(e.x,
   e.y,e.z||0))}return b}});Object.assign(Oa.prototype,{fromPoints:function(a){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints().");this.setFromPoints(a)}});wf.prototype=Object.create(wa.prototype);xf.prototype=Object.create(wa.prototype);ue.prototype=Object.create(wa.prototype);Object.assign(ue.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},
   reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}});fd.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")};lc.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")};Object.assign(ic.prototype,{extractUrlBase:function(a){console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead.");
   return ze.extractUrlBase(a)}});Object.assign(re.prototype,{center:function(a){console.warn("THREE.Box2: .center() has been renamed to .getCenter().");return this.getCenter(a)},empty:function(){console.warn("THREE.Box2: .empty() has been renamed to .isEmpty().");return this.isEmpty()},isIntersectionBox:function(a){console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox().");return this.intersectsBox(a)},size:function(a){console.warn("THREE.Box2: .size() has been renamed to .getSize().");
   return this.getSize(a)}});Object.assign(Va.prototype,{center:function(a){console.warn("THREE.Box3: .center() has been renamed to .getCenter().");return this.getCenter(a)},empty:function(){console.warn("THREE.Box3: .empty() has been renamed to .isEmpty().");return this.isEmpty()},isIntersectionBox:function(a){console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox().");return this.intersectsBox(a)},isIntersectionSphere:function(a){console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere().");
   return this.intersectsSphere(a)},size:function(a){console.warn("THREE.Box3: .size() has been renamed to .getSize().");return this.getSize(a)}});se.prototype.center=function(a){console.warn("THREE.Line3: .center() has been renamed to .getCenter().");return this.getCenter(a)};Object.assign(Q,{random16:function(){console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead.");return Math.random()},nearestPowerOfTwo:function(a){console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo().");
   return Q.floorPowerOfTwo(a)},nextPowerOfTwo:function(a){console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo().");return Q.ceilPowerOfTwo(a)}});Object.assign(la.prototype,{flattenToArrayOffset:function(a,b){console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.");return this.toArray(a,b)},multiplyVector3:function(a){console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.");return a.applyMatrix3(this)},
   multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(a){console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead.");return this.applyToBufferAttribute(a)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}});Object.assign(M.prototype,{extractPosition:function(a){console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().");
   return this.copyPosition(a)},flattenToArrayOffset:function(a,b){console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.");return this.toArray(a,b)},getPosition:function(){var a;return function(){void 0===a&&(a=new p);console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");return a.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(a){console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().");
   return this.makeRotationFromQuaternion(a)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(a){console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead.");return a.applyMatrix4(this)},multiplyVector4:function(a){console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.");return a.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},
   rotateAxis:function(a){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.");a.transformDirection(this)},crossVector:function(a){console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.");return a.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},
   rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(a){console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead.");return this.applyToBufferAttribute(a)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(a,b,c,d,e,f){console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead.");
   return this.makePerspective(a,b,d,c,e,f)}});Pa.prototype.isIntersectionLine=function(a){console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine().");return this.intersectsLine(a)};ia.prototype.multiplyVector3=function(a){console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.");return a.applyQuaternion(this)};Object.assign(qb.prototype,{isIntersectionBox:function(a){console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox().");
   return this.intersectsBox(a)},isIntersectionPlane:function(a){console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane().");return this.intersectsPlane(a)},isIntersectionSphere:function(a){console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere().");return this.intersectsSphere(a)}});Object.assign(Ba.prototype,{area:function(){console.warn("THREE.Triangle: .area() has been renamed to .getArea().");return this.getArea()},barycoordFromPoint:function(a,
   b){console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord().");return this.getBarycoord(a,b)},midpoint:function(a){console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint().");return this.getMidpoint(a)},normal:function(a){console.warn("THREE.Triangle: .normal() has been renamed to .getNormal().");return this.getNormal(a)},plane:function(a){console.warn("THREE.Triangle: .plane() has been renamed to .getPlane().");return this.getPlane(a)}});Object.assign(Ba,
   {barycoordFromPoint:function(a,b,c,d,e){console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord().");return Ba.getBarycoord(a,b,c,d,e)},normal:function(a,b,c,d){console.warn("THREE.Triangle: .normal() has been renamed to .getNormal().");return Ba.getNormal(a,b,c,d)}});Object.assign(hb.prototype,{extractAllPoints:function(a){console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead.");return this.extractPoints(a)},extrude:function(a){console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead.");
   return new vb(this,a)},makeGeometry:function(a){console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead.");return new xb(this,a)}});Object.assign(C.prototype,{fromAttribute:function(a,b,c){console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute().");return this.fromBufferAttribute(a,b,c)},distanceToManhattan:function(a){console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo().");return this.manhattanDistanceTo(a)},
   lengthManhattan:function(){console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength().");return this.manhattanLength()}});Object.assign(p.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(a){console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().");
   return this.setFromMatrixPosition(a)},getScaleFromMatrix:function(a){console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().");return this.setFromMatrixScale(a)},getColumnFromMatrix:function(a,b){console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().");return this.setFromMatrixColumn(b,a)},applyProjection:function(a){console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead.");return this.applyMatrix4(a)},
   fromAttribute:function(a,b,c){console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute().");return this.fromBufferAttribute(a,b,c)},distanceToManhattan:function(a){console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo().");return this.manhattanDistanceTo(a)},lengthManhattan:function(){console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength().");return this.manhattanLength()}});Object.assign(ca.prototype,
   {fromAttribute:function(a,b,c){console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute().");return this.fromBufferAttribute(a,b,c)},lengthManhattan:function(){console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength().");return this.manhattanLength()}});Object.assign(K.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}});
   Object.assign(B.prototype,{getChildByName:function(a){console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().");return this.getObjectByName(a)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(a,b){console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.");return this.translateOnAxis(b,a)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")}});
   Object.defineProperties(B.prototype,{eulerOrder:{get:function(){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order.");return this.rotation.order},set:function(a){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order.");this.rotation.order=a}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}});
   Object.defineProperties(Cc.prototype,{objects:{get:function(){console.warn("THREE.LOD: .objects has been renamed to .levels.");return this.levels}}});Object.defineProperty(Dc.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}});Object.defineProperty(L.prototype,"__arcLengthDivisions",{get:function(){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions.");
   return this.arcLengthDivisions},set:function(a){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions.");this.arcLengthDivisions=a}});ea.prototype.setLens=function(a,b){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup.");void 0!==b&&(this.filmGauge=b);this.setFocalLength(a)};Object.defineProperties(X.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(a){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov.");
   this.shadow.camera.fov=a}},shadowCameraLeft:{set:function(a){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left.");this.shadow.camera.left=a}},shadowCameraRight:{set:function(a){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right.");this.shadow.camera.right=a}},shadowCameraTop:{set:function(a){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top.");this.shadow.camera.top=a}},shadowCameraBottom:{set:function(a){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom.");
   this.shadow.camera.bottom=a}},shadowCameraNear:{set:function(a){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near.");this.shadow.camera.near=a}},shadowCameraFar:{set:function(a){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far.");this.shadow.camera.far=a}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(a){console.warn("THREE.Light: .shadowBias is now .shadow.bias.");
   this.shadow.bias=a}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(a){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width.");this.shadow.mapSize.width=a}},shadowMapHeight:{set:function(a){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height.");this.shadow.mapSize.height=a}}});Object.defineProperties(P.prototype,{length:{get:function(){console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead.");
   return this.array.length}},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")}});Object.assign(E.prototype,{addIndex:function(a){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex().");this.setIndex(a)},addDrawCall:function(a,b,c){void 0!==c&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset.");console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup().");this.addGroup(a,b)},
   clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups().");this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}});Object.defineProperties(E.prototype,{drawcalls:{get:function(){console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups.");return this.groups}},offsets:{get:function(){console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups.");
   return this.groups}}});Object.assign(Ra.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}});Object.defineProperties(Jd.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},
   onUpdate:{value:function(){console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead.");return this}}});Object.defineProperties(F.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},wrapRGB:{get:function(){console.warn("THREE.Material: .wrapRGB has been removed.");return new G}},shading:{get:function(){console.error("THREE."+this.type+
   ": .shading has been removed. Use the boolean .flatShading instead.")},set:function(a){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.");this.flatShading=1===a}}});Object.defineProperties(Ia.prototype,{metal:{get:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead.");return!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}});
   Object.defineProperties(Da.prototype,{derivatives:{get:function(){console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives.");return this.extensions.derivatives},set:function(a){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives.");this.extensions.derivatives=a}}});Object.assign(Wd.prototype,{animate:function(a){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop().");this.setAnimationLoop(a)},getCurrentRenderTarget:function(){console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget().");
   return this.getRenderTarget()},getMaxAnisotropy:function(){console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy().");return this.capabilities.getMaxAnisotropy()},getPrecision:function(){console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision.");return this.capabilities.precision},resetGLState:function(){console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset().");return this.state.reset()},supportsFloatTextures:function(){console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' ).");
   return this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' ).");return this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' ).");return this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' ).");
   return this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' ).");return this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' ).");return this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures.");
   return this.capabilities.vertexTextures},supportsInstancedArrays:function(){console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' ).");return this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(a){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest().");this.setScissorTest(a)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},
   addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")}});Object.defineProperties(Wd.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(a){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled.");
   this.shadowMap.enabled=a}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(a){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type.");this.shadowMap.type=a}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}}});Object.defineProperties(We.prototype,
   {cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},
   renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}});Object.defineProperties(md.prototype,{wrapS:{get:function(){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.");return this.texture.wrapS},set:function(a){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.");
   this.texture.wrapS=a}},wrapT:{get:function(){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.");return this.texture.wrapT},set:function(a){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.");this.texture.wrapT=a}},magFilter:{get:function(){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.");return this.texture.magFilter},set:function(a){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.");this.texture.magFilter=
   a}},minFilter:{get:function(){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.");return this.texture.minFilter},set:function(a){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.");this.texture.minFilter=a}},anisotropy:{get:function(){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.");return this.texture.anisotropy},set:function(a){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.");this.texture.anisotropy=
   a}},offset:{get:function(){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset.");return this.texture.offset},set:function(a){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset.");this.texture.offset=a}},repeat:{get:function(){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat.");return this.texture.repeat},set:function(a){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat.");this.texture.repeat=a}},format:{get:function(){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format.");
   return this.texture.format},set:function(a){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format.");this.texture.format=a}},type:{get:function(){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type.");return this.texture.type},set:function(a){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type.");this.texture.type=a}},generateMipmaps:{get:function(){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.");return this.texture.generateMipmaps},
   set:function(a){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.");this.texture.generateMipmaps=a}}});Object.defineProperties(Ye.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}}});jc.prototype.load=function(a){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var b=this;(new ge).load(a,function(a){b.setBuffer(a)});return this};ke.prototype.getData=function(){console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData().");
   return this.getFrequencyData()};cd.prototype.updateCubeMap=function(a,b){console.warn("THREE.CubeCamera: .updateCubeMap() is now .update().");return this.update(a,b)};jb.crossOrigin=void 0;jb.loadTexture=function(a,b,c,d){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var e=new td;e.setCrossOrigin(this.crossOrigin);a=e.load(a,c,void 0,d);b&&(a.mapping=b);return a};jb.loadTextureCube=function(a,b,c,d){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");
   var e=new Bf;e.setCrossOrigin(this.crossOrigin);a=e.load(a,c,void 0,d);b&&(a.mapping=b);return a};jb.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")};jb.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};l.WebGLRenderTargetCube=mf;l.WebGLRenderTarget=md;l.WebGLRenderer=Wd;l.ShaderLib=rb;l.UniformsLib=I;l.UniformsUtils=
   Ea;l.ShaderChunk=R;l.FogExp2=Nb;l.Fog=Ob;l.Scene=od;l.Sprite=Bc;l.LOD=Cc;l.SkinnedMesh=qd;l.Skeleton=Dc;l.Bone=pd;l.Mesh=ra;l.LineSegments=W;l.LineLoop=rd;l.Line=ma;l.Points=Qb;l.Group=Mb;l.VideoTexture=Xd;l.DataTexture=kb;l.CompressedTexture=Rb;l.CubeTexture=Md;l.CanvasTexture=fh;l.DepthTexture=Ec;l.Texture=ta;l.CompressedTextureLoader=gf;l.DataTextureLoader=$d;l.CubeTextureLoader=Bf;l.TextureLoader=td;l.ObjectLoader=jf;l.MaterialLoader=Id;l.BufferGeometryLoader=be;l.DefaultLoadingManager=sa;l.LoadingManager=
   ve;l.JSONLoader=ce;l.ImageLoader=Nd;l.ImageBitmapLoader=de;l.FontLoader=kf;l.FileLoader=Ja;l.Loader=ic;l.LoaderUtils=ze;l.Cache=ab;l.AudioLoader=ge;l.SpotLightShadow=vd;l.SpotLight=wd;l.PointLight=xd;l.RectAreaLight=Bd;l.HemisphereLight=ud;l.DirectionalLightShadow=yd;l.DirectionalLight=zd;l.AmbientLight=Ad;l.LightShadow=Gb;l.Light=X;l.StereoCamera=lf;l.PerspectiveCamera=ea;l.OrthographicCamera=Jb;l.CubeCamera=cd;l.ArrayCamera=zc;l.Camera=Qa;l.AudioListener=he;l.PositionalAudio=je;l.AudioContext=ie;
   l.AudioAnalyser=ke;l.Audio=jc;l.VectorKeyframeTrack=hc;l.StringKeyframeTrack=Hd;l.QuaternionKeyframeTrack=bd;l.NumberKeyframeTrack=gc;l.ColorKeyframeTrack=Fd;l.BooleanKeyframeTrack=Ed;l.PropertyMixer=le;l.PropertyBinding=Y;l.KeyframeTrack=qa;l.AnimationUtils=ha;l.AnimationObjectGroup=of;l.AnimationMixer=me;l.AnimationClip=Ca;l.Uniform=Jd;l.InstancedBufferGeometry=ne;l.BufferGeometry=E;l.Geometry=K;l.InterleavedBufferAttribute=Ac;l.InstancedInterleavedBuffer=oe;l.InterleavedBuffer=sb;l.InstancedBufferAttribute=
   pe;l.Face3=Wa;l.Object3D=B;l.Raycaster=qf;l.Layers=Rd;l.EventDispatcher=ib;l.Clock=sf;l.QuaternionLinearInterpolant=Gd;l.LinearInterpolant=ad;l.DiscreteInterpolant=Dd;l.CubicInterpolant=Cd;l.Interpolant=oa;l.Triangle=Ba;l.Math=Q;l.Spherical=tf;l.Cylindrical=uf;l.Plane=Pa;l.Frustum=ld;l.Sphere=za;l.Ray=qb;l.Matrix4=M;l.Matrix3=la;l.Box3=Va;l.Box2=re;l.Line3=se;l.Euler=lb;l.Vector4=ca;l.Vector3=p;l.Vector2=C;l.Quaternion=ia;l.Color=G;l.ImmediateRenderObject=dd;l.VertexNormalsHelper=ed;l.SpotLightHelper=
   kc;l.SkeletonHelper=lc;l.PointLightHelper=mc;l.RectAreaLightHelper=nc;l.HemisphereLightHelper=oc;l.GridHelper=fd;l.PolarGridHelper=Kd;l.FaceNormalsHelper=gd;l.DirectionalLightHelper=pc;l.CameraHelper=hd;l.BoxHelper=Hb;l.Box3Helper=id;l.PlaneHelper=jd;l.ArrowHelper=Ib;l.AxesHelper=kd;l.Shape=hb;l.Path=Oa;l.ShapePath=ee;l.Font=fe;l.CurvePath=$a;l.Curve=L;l.ImageUtils=jb;l.ShapeUtils=Ya;l.WebGLUtils=Xe;l.Extensions=Xa;l.WireframeGeometry=Sb;l.ParametricGeometry=Fc;l.ParametricBufferGeometry=Tb;l.TetrahedronGeometry=
   Hc;l.TetrahedronBufferGeometry=Ub;l.OctahedronGeometry=Ic;l.OctahedronBufferGeometry=tb;l.IcosahedronGeometry=Jc;l.IcosahedronBufferGeometry=Vb;l.DodecahedronGeometry=Kc;l.DodecahedronBufferGeometry=Wb;l.PolyhedronGeometry=Gc;l.PolyhedronBufferGeometry=ua;l.TubeGeometry=Lc;l.TubeBufferGeometry=Xb;l.TorusKnotGeometry=Mc;l.TorusKnotBufferGeometry=Yb;l.TorusGeometry=Nc;l.TorusBufferGeometry=Zb;l.TextGeometry=Sc;l.TextBufferGeometry=$b;l.SphereGeometry=Tc;l.SphereBufferGeometry=wb;l.RingGeometry=Uc;l.RingBufferGeometry=
   ac;l.PlaneGeometry=wc;l.PlaneBufferGeometry=pb;l.LatheGeometry=Vc;l.LatheBufferGeometry=bc;l.ShapeGeometry=xb;l.ShapeBufferGeometry=yb;l.ExtrudeGeometry=vb;l.ExtrudeBufferGeometry=Ra;l.EdgesGeometry=cc;l.ConeGeometry=Wc;l.ConeBufferGeometry=Xc;l.CylinderGeometry=zb;l.CylinderBufferGeometry=Za;l.CircleGeometry=Yc;l.CircleBufferGeometry=dc;l.BoxGeometry=Kb;l.BoxBufferGeometry=ob;l.ShadowMaterial=Ab;l.SpriteMaterial=gb;l.RawShaderMaterial=ec;l.ShaderMaterial=Da;l.PointsMaterial=Ha;l.MeshPhysicalMaterial=
   Bb;l.MeshStandardMaterial=Sa;l.MeshPhongMaterial=Ia;l.MeshToonMaterial=Cb;l.MeshNormalMaterial=Db;l.MeshLambertMaterial=Eb;l.MeshDepthMaterial=db;l.MeshDistanceMaterial=eb;l.MeshBasicMaterial=Aa;l.LineDashedMaterial=Fb;l.LineBasicMaterial=T;l.Material=F;l.Float64BufferAttribute=vc;l.Float32BufferAttribute=A;l.Uint32BufferAttribute=nb;l.Int32BufferAttribute=uc;l.Uint16BufferAttribute=mb;l.Int16BufferAttribute=tc;l.Uint8ClampedBufferAttribute=sc;l.Uint8BufferAttribute=rc;l.Int8BufferAttribute=qc;l.BufferAttribute=
   P;l.ArcCurve=fc;l.CatmullRomCurve3=wa;l.CubicBezierCurve=Ka;l.CubicBezierCurve3=Ta;l.EllipseCurve=ka;l.LineCurve=na;l.LineCurve3=La;l.QuadraticBezierCurve=Ma;l.QuadraticBezierCurve3=Ua;l.SplineCurve=Na;l.REVISION="95";l.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2};l.CullFaceNone=0;l.CullFaceBack=1;l.CullFaceFront=2;l.CullFaceFrontBack=3;l.FrontFaceDirectionCW=0;l.FrontFaceDirectionCCW=1;l.BasicShadowMap=0;l.PCFShadowMap=1;l.PCFSoftShadowMap=2;l.FrontSide=0;l.BackSide=1;l.DoubleSide=2;l.FlatShading=1;l.SmoothShading=
   2;l.NoColors=0;l.FaceColors=1;l.VertexColors=2;l.NoBlending=0;l.NormalBlending=1;l.AdditiveBlending=2;l.SubtractiveBlending=3;l.MultiplyBlending=4;l.CustomBlending=5;l.AddEquation=100;l.SubtractEquation=101;l.ReverseSubtractEquation=102;l.MinEquation=103;l.MaxEquation=104;l.ZeroFactor=200;l.OneFactor=201;l.SrcColorFactor=202;l.OneMinusSrcColorFactor=203;l.SrcAlphaFactor=204;l.OneMinusSrcAlphaFactor=205;l.DstAlphaFactor=206;l.OneMinusDstAlphaFactor=207;l.DstColorFactor=208;l.OneMinusDstColorFactor=
   209;l.SrcAlphaSaturateFactor=210;l.NeverDepth=0;l.AlwaysDepth=1;l.LessDepth=2;l.LessEqualDepth=3;l.EqualDepth=4;l.GreaterEqualDepth=5;l.GreaterDepth=6;l.NotEqualDepth=7;l.MultiplyOperation=0;l.MixOperation=1;l.AddOperation=2;l.NoToneMapping=0;l.LinearToneMapping=1;l.ReinhardToneMapping=2;l.Uncharted2ToneMapping=3;l.CineonToneMapping=4;l.UVMapping=300;l.CubeReflectionMapping=301;l.CubeRefractionMapping=302;l.EquirectangularReflectionMapping=303;l.EquirectangularRefractionMapping=304;l.SphericalReflectionMapping=
   305;l.CubeUVReflectionMapping=306;l.CubeUVRefractionMapping=307;l.RepeatWrapping=1E3;l.ClampToEdgeWrapping=1001;l.MirroredRepeatWrapping=1002;l.NearestFilter=1003;l.NearestMipMapNearestFilter=1004;l.NearestMipMapLinearFilter=1005;l.LinearFilter=1006;l.LinearMipMapNearestFilter=1007;l.LinearMipMapLinearFilter=1008;l.UnsignedByteType=1009;l.ByteType=1010;l.ShortType=1011;l.UnsignedShortType=1012;l.IntType=1013;l.UnsignedIntType=1014;l.FloatType=1015;l.HalfFloatType=1016;l.UnsignedShort4444Type=1017;
   l.UnsignedShort5551Type=1018;l.UnsignedShort565Type=1019;l.UnsignedInt248Type=1020;l.AlphaFormat=1021;l.RGBFormat=1022;l.RGBAFormat=1023;l.LuminanceFormat=1024;l.LuminanceAlphaFormat=1025;l.RGBEFormat=1023;l.DepthFormat=1026;l.DepthStencilFormat=1027;l.RGB_S3TC_DXT1_Format=33776;l.RGBA_S3TC_DXT1_Format=33777;l.RGBA_S3TC_DXT3_Format=33778;l.RGBA_S3TC_DXT5_Format=33779;l.RGB_PVRTC_4BPPV1_Format=35840;l.RGB_PVRTC_2BPPV1_Format=35841;l.RGBA_PVRTC_4BPPV1_Format=35842;l.RGBA_PVRTC_2BPPV1_Format=35843;l.RGB_ETC1_Format=
   36196;l.RGBA_ASTC_4x4_Format=37808;l.RGBA_ASTC_5x4_Format=37809;l.RGBA_ASTC_5x5_Format=37810;l.RGBA_ASTC_6x5_Format=37811;l.RGBA_ASTC_6x6_Format=37812;l.RGBA_ASTC_8x5_Format=37813;l.RGBA_ASTC_8x6_Format=37814;l.RGBA_ASTC_8x8_Format=37815;l.RGBA_ASTC_10x5_Format=37816;l.RGBA_ASTC_10x6_Format=37817;l.RGBA_ASTC_10x8_Format=37818;l.RGBA_ASTC_10x10_Format=37819;l.RGBA_ASTC_12x10_Format=37820;l.RGBA_ASTC_12x12_Format=37821;l.LoopOnce=2200;l.LoopRepeat=2201;l.LoopPingPong=2202;l.InterpolateDiscrete=2300;
   l.InterpolateLinear=2301;l.InterpolateSmooth=2302;l.ZeroCurvatureEnding=2400;l.ZeroSlopeEnding=2401;l.WrapAroundEnding=2402;l.TrianglesDrawMode=0;l.TriangleStripDrawMode=1;l.TriangleFanDrawMode=2;l.LinearEncoding=3E3;l.sRGBEncoding=3001;l.GammaEncoding=3007;l.RGBEEncoding=3002;l.LogLuvEncoding=3003;l.RGBM7Encoding=3004;l.RGBM16Encoding=3005;l.RGBDEncoding=3006;l.BasicDepthPacking=3200;l.RGBADepthPacking=3201;l.TangentSpaceNormalMap=0;l.ObjectSpaceNormalMap=1;l.CubeGeometry=Kb;l.Face4=function(a,b,
   c,d,e,f,g){console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead.");return new Wa(a,b,c,e,f,g)};l.LineStrip=0;l.LinePieces=1;l.MeshFaceMaterial=function(a){console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead.");return a};l.MultiMaterial=function(a){void 0===a&&(a=[]);console.warn("THREE.MultiMaterial has been removed. Use an Array instead.");a.isMultiMaterial=!0;a.materials=a;a.clone=function(){return a.slice()};return a};l.PointCloud=function(a,
   b){console.warn("THREE.PointCloud has been renamed to THREE.Points.");return new Qb(a,b)};l.Particle=function(a){console.warn("THREE.Particle has been renamed to THREE.Sprite.");return new Bc(a)};l.ParticleSystem=function(a,b){console.warn("THREE.ParticleSystem has been renamed to THREE.Points.");return new Qb(a,b)};l.PointCloudMaterial=function(a){console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial.");return new Ha(a)};l.ParticleBasicMaterial=function(a){console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial.");
   return new Ha(a)};l.ParticleSystemMaterial=function(a){console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial.");return new Ha(a)};l.Vertex=function(a,b,c){console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead.");return new p(a,b,c)};l.DynamicBufferAttribute=function(a,b){console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead.");return(new P(a,b)).setDynamic(!0)};l.Int8Attribute=function(a,
   b){console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead.");return new qc(a,b)};l.Uint8Attribute=function(a,b){console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead.");return new rc(a,b)};l.Uint8ClampedAttribute=function(a,b){console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead.");return new sc(a,b)};l.Int16Attribute=function(a,b){console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead.");
   return new tc(a,b)};l.Uint16Attribute=function(a,b){console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead.");return new mb(a,b)};l.Int32Attribute=function(a,b){console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead.");return new uc(a,b)};l.Uint32Attribute=function(a,b){console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead.");return new nb(a,b)};l.Float32Attribute=
   function(a,b){console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead.");return new A(a,b)};l.Float64Attribute=function(a,b){console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead.");return new vc(a,b)};l.ClosedSplineCurve3=wf;l.SplineCurve3=xf;l.Spline=ue;l.AxisHelper=function(a){console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper.");return new kd(a)};l.BoundingBoxHelper=function(a,b){console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead.");
   return new Hb(a,b)};l.EdgesHelper=function(a,b){console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead.");return new W(new cc(a.geometry),new T({color:void 0!==b?b:16777215}))};l.WireframeHelper=function(a,b){console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead.");return new W(new Sb(a.geometry),new T({color:void 0!==b?b:16777215}))};l.XHRLoader=function(a){console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader.");return new Ja(a)};
   l.BinaryTextureLoader=function(a){console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader.");return new $d(a)};l.GeometryUtils={merge:function(a,b,c){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");if(b.isMesh){b.matrixAutoUpdate&&b.updateMatrix();var d=b.matrix;b=b.geometry}a.merge(b,d,c)},center:function(a){console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead.");
   return a.center()}};l.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js.");this.projectVector=function(a,b){console.warn("THREE.Projector: .projectVector() is now vector.project().");a.project(b)};this.unprojectVector=function(a,b){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject().");a.unproject(b)};this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}};l.CanvasRenderer=
   function(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js");this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");this.clear=function(){};this.render=function(){};this.setClearColor=function(){};this.setSize=function(){}};l.SceneUtils={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},
   attach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")}};l.LensFlare=function(){console.error("THREE.LensFlare has been moved to /examples/js/objects/Lensflare.js")};Object.defineProperty(l,"__esModule",{value:!0})});
   
   /*! verb 2017-01-16 */
   !function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.verb=a()}}(function(){var a={},b=this,c=(new Function("try {return this===window;}catch(e){ return false;}"),new Function("try {return this===global;}catch(e){return false;}")),d=new Function("try {return typeof importScripts === 'function';}catch(e){return false;}");if(c()&&!d()&&(console.log(typeof e),Worker=require("webworker-threads").Worker),c()||d()){var e=b;if(d()){var f=function(a,c){var d=b;return a.split(".").forEach(function(a){d&&(d=d[a])}),d?d[c]:null};onmessage=function(a){if(a.data.className&&a.data.methodName){var b=f(a.data.className,a.data.methodName);return b?void postMessage({result:b.apply(null,a.data.args),id:a.data.id}):console.error("could not find "+a.data.className+"."+a.data.methodName)}}}}return function(a,b,c){"use strict";function d(a,b){function c(){}c.prototype=a;var d=new c;for(var e in b)d[e]=b[e];return b.toString!==Object.prototype.toString&&(d.toString=b.toString),d}function e(a){return a instanceof Array?function(){return i.iter(a)}:"function"==typeof a.iterator?f(a,a.iterator):a.iterator}function f(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=ib++);var c;return null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__],null==c&&(c=function(){return c.method.apply(c.scope,arguments)},c.scope=a,c.method=b,a.hx__closures__[b.__id__]=c),c}b.geom=b.geom||{},b.exe=b.exe||{},b.eval=b.eval||{},b.core=b.core||{},b.promhx=b.promhx||{};var g={},h=function(){return D.__string_rec(this,"")},i=function(){};g.HxOverrides=i,i.__name__=["HxOverrides"],i.strDate=function(a){var b=a.length;switch(b){case 8:var c=a.split(":"),d=new Date;return d.setTime(0),d.setUTCHours(c[0]),d.setUTCMinutes(c[1]),d.setUTCSeconds(c[2]),d;case 10:var e=a.split("-");return new Date(e[0],e[1]-1,e[2],0,0,0);case 19:var f=a.split(" "),g=f[0].split("-"),h=f[1].split(":");return new Date(g[0],g[1]-1,g[2],h[0],h[1],h[2]);default:throw new C("Invalid date format : "+a)}},i.cca=function(a,b){var c=a.charCodeAt(b);if(c==c)return c},i.substr=function(a,b,c){return null!=b&&0!=b&&null!=c&&c<0?"":(null==c&&(c=a.length),b<0?(b=a.length+b,b<0&&(b=0)):c<0&&(c=a.length+c-b),a.substr(b,c))},i.iter=function(a){return{cur:0,arr:a,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var j=function(){};g.Lambda=j,j.__name__=["Lambda"],j.fold=function(a,b,c){for(var d=e(a)();d.hasNext();){var f=d.next();c=b(f,c)}return c};var k=function(){this.length=0};g.List=k,k.__name__=["List"],k.prototype={add:function(a){var b=[a];null==this.h?this.h=b:this.q[1]=b,this.q=b,this.length++},pop:function(){if(null==this.h)return null;var a=this.h[0];return this.h=this.h[1],null==this.h&&(this.q=null),this.length--,a},isEmpty:function(){return null==this.h},__class__:k},Math.__name__=["Math"];var l=function(){};g.Reflect=l,l.__name__=["Reflect"],l.field=function(a,b){try{return a[b]}catch(c){return c instanceof C&&(c=c.val),null}},l.callMethod=function(a,b,c){return b.apply(a,c)},l.fields=function(a){var b=[];if(null!=a){var c=Object.prototype.hasOwnProperty;for(var d in a)"__id__"!=d&&"hx__closures__"!=d&&c.call(a,d)&&b.push(d)}return b},l.isFunction=function(a){return"function"==typeof a&&!(a.__name__||a.__ename__)},l.deleteField=function(a,b){return!!Object.prototype.hasOwnProperty.call(a,b)&&(delete a[b],!0)};var m=function(){};g.Std=m,m.__name__=["Std"],m.string=function(a){return D.__string_rec(a,"")},m.parseFloat=function(a){return parseFloat(a)};var n=function(){this.b=""};g.StringBuf=n,n.__name__=["StringBuf"],n.prototype={add:function(a){this.b+=m.string(a)},__class__:n};var o=function(){};g.StringTools=o,o.__name__=["StringTools"],o.fastCodeAt=function(a,b){return a.charCodeAt(b)};var p=g.ValueType={__ename__:["ValueType"],__constructs__:["TNull","TInt","TFloat","TBool","TObject","TFunction","TClass","TEnum","TUnknown"]};p.TNull=["TNull",0],p.TNull.toString=h,p.TNull.__enum__=p,p.TInt=["TInt",1],p.TInt.toString=h,p.TInt.__enum__=p,p.TFloat=["TFloat",2],p.TFloat.toString=h,p.TFloat.__enum__=p,p.TBool=["TBool",3],p.TBool.toString=h,p.TBool.__enum__=p,p.TObject=["TObject",4],p.TObject.toString=h,p.TObject.__enum__=p,p.TFunction=["TFunction",5],p.TFunction.toString=h,p.TFunction.__enum__=p,p.TClass=function(a){var b=["TClass",6,a];return b.__enum__=p,b.toString=h,b},p.TEnum=function(a){var b=["TEnum",7,a];return b.__enum__=p,b.toString=h,b},p.TUnknown=["TUnknown",8],p.TUnknown.toString=h,p.TUnknown.__enum__=p;var q=function(){};g.Type=q,q.__name__=["Type"],q.getClassName=function(a){var b=a.__name__;return null==b?null:b.join(".")},q.getEnumName=function(a){var b=a.__ename__;return b.join(".")},q.resolveClass=function(a){var b=g[a];return null!=b&&b.__name__?b:null},q.resolveEnum=function(a){var b=g[a];return null!=b&&b.__ename__?b:null},q.createEmptyInstance=function(a){function b(){}return b.prototype=a.prototype,new b},q.createEnum=function(a,b,c){var d=l.field(a,b);if(null==d)throw new C("No such constructor "+b);if(l.isFunction(d)){if(null==c)throw new C("Constructor "+b+" need parameters");return l.callMethod(a,d,c)}if(null!=c&&0!=c.length)throw new C("Constructor "+b+" does not need parameters");return d},q.getEnumConstructs=function(a){var b=a.__constructs__;return b.slice()},q.typeof=function(a){var b=typeof a;switch(b){case"boolean":return p.TBool;case"string":return p.TClass(String);case"number":return Math.ceil(a)==a%2147483648?p.TInt:p.TFloat;case"object":if(null==a)return p.TNull;var c=a.__enum__;if(null!=c)return p.TEnum(c);var d=D.getClass(a);return null!=d?p.TClass(d):p.TObject;case"function":return a.__name__||a.__ename__?p.TObject:p.TFunction;case"undefined":return p.TNull;default:return p.TUnknown}};var r=function(){};g["haxe.IMap"]=r,r.__name__=["haxe","IMap"];var s=function(a,b){this.high=a,this.low=b};g["haxe._Int64.___Int64"]=s,s.__name__=["haxe","_Int64","___Int64"],s.prototype={__class__:s};var t=function(){this.buf=new n,this.cache=[],this.useCache=t.USE_CACHE,this.useEnumIndex=t.USE_ENUM_INDEX,this.shash=new y,this.scount=0};g["haxe.Serializer"]=t,t.__name__=["haxe","Serializer"],t.prototype={toString:function(){return this.buf.b},serializeString:function(a){var b=this.shash.get(a);return null!=b?(this.buf.b+="R",void(null==b?this.buf.b+="null":this.buf.b+=""+b)):(this.shash.set(a,this.scount++),this.buf.b+="y",a=encodeURIComponent(a),null==a.length?this.buf.b+="null":this.buf.b+=""+a.length,this.buf.b+=":",void(null==a?this.buf.b+="null":this.buf.b+=""+a))},serializeRef:function(a){for(var b=typeof a,c=0,d=this.cache.length;c<d;){var e=c++,f=this.cache[e];if(typeof f==b&&f==a)return this.buf.b+="r",null==e?this.buf.b+="null":this.buf.b+=""+e,!0}return this.cache.push(a),!1},serializeFields:function(a){for(var b=0,c=l.fields(a);b<c.length;){var d=c[b];++b,this.serializeString(d),this.serialize(l.field(a,d))}this.buf.b+="g"},serialize:function(a){var b=q.typeof(a);switch(b[1]){case 0:this.buf.b+="n";break;case 1:var c=a;if(0==c)return void(this.buf.b+="z");this.buf.b+="i",null==c?this.buf.b+="null":this.buf.b+=""+c;break;case 2:var d=a;isNaN(d)?this.buf.b+="k":isFinite(d)?(this.buf.b+="d",null==d?this.buf.b+="null":this.buf.b+=""+d):d<0?this.buf.b+="m":this.buf.b+="p";break;case 3:a?this.buf.b+="t":this.buf.b+="f";break;case 6:var e=b[2];if(e==String)return void this.serializeString(a);if(this.useCache&&this.serializeRef(a))return;switch(e){case Array:var f=0;this.buf.b+="a";for(var g=a.length,h=0;h<g;){var i=h++;null==a[i]?f++:(f>0&&(1==f?this.buf.b+="n":(this.buf.b+="u",null==f?this.buf.b+="null":this.buf.b+=""+f),f=0),this.serialize(a[i]))}f>0&&(1==f?this.buf.b+="n":(this.buf.b+="u",null==f?this.buf.b+="null":this.buf.b+=""+f)),this.buf.b+="h";break;case k:this.buf.b+="l";for(var j=a,o=j.h,p=null;null!=o;){var r;p=o[0],o=o[1],r=p,this.serialize(r)}this.buf.b+="h";break;case Date:var s=a;this.buf.b+="v",this.buf.add(s.getTime());break;case y:this.buf.b+="b";for(var u=a,x=u.keys();x.hasNext();){var A=x.next();this.serializeString(A),this.serialize(null!=pb[A]?u.getReserved(A):u.h[A])}this.buf.b+="h";break;case v:this.buf.b+="q";for(var B=a,E=B.keys();E.hasNext();){var F=E.next();this.buf.b+=":",null==F?this.buf.b+="null":this.buf.b+=""+F,this.serialize(B.h[F])}this.buf.b+="h";break;case w:this.buf.b+="M";for(var G=a,H=G.keys();H.hasNext();){var I=H.next(),J=l.field(I,"__id__");l.deleteField(I,"__id__"),this.serialize(I),I.__id__=J,this.serialize(G.h[I.__id__])}this.buf.b+="h";break;case z:for(var K=a,L=0,M=K.length-2,N=new n,O=t.BASE64;L<M;){var P=K.get(L++),Q=K.get(L++),R=K.get(L++);N.add(O.charAt(P>>2)),N.add(O.charAt(63&(P<<4|Q>>4))),N.add(O.charAt(63&(Q<<2|R>>6))),N.add(O.charAt(63&R))}if(L==M){var S=K.get(L++),T=K.get(L++);N.add(O.charAt(S>>2)),N.add(O.charAt(63&(S<<4|T>>4))),N.add(O.charAt(T<<2&63))}else if(L==M+1){var U=K.get(L++);N.add(O.charAt(U>>2)),N.add(O.charAt(U<<4&63))}var V=N.b;this.buf.b+="s",null==V.length?this.buf.b+="null":this.buf.b+=""+V.length,this.buf.b+=":",null==V?this.buf.b+="null":this.buf.b+=""+V;break;default:this.useCache&&this.cache.pop(),null!=a.hxSerialize?(this.buf.b+="C",this.serializeString(q.getClassName(e)),this.useCache&&this.cache.push(a),a.hxSerialize(this),this.buf.b+="g"):(this.buf.b+="c",this.serializeString(q.getClassName(e)),this.useCache&&this.cache.push(a),this.serializeFields(a))}break;case 4:if(D.__instanceof(a,nb)){var W=q.getClassName(a);this.buf.b+="A",this.serializeString(W)}else if(D.__instanceof(a,ob))this.buf.b+="B",this.serializeString(q.getEnumName(a));else{if(this.useCache&&this.serializeRef(a))return;this.buf.b+="o",this.serializeFields(a)}break;case 7:var X=b[2];if(this.useCache){if(this.serializeRef(a))return;this.cache.pop()}this.useEnumIndex?this.buf.b+="j":this.buf.b+="w",this.serializeString(q.getEnumName(X)),this.useEnumIndex?(this.buf.b+=":",this.buf.b+=m.string(a[1])):this.serializeString(a[0]),this.buf.b+=":";var Y=a.length;this.buf.b+=m.string(Y-2);for(var Z=2;Z<Y;){var $=Z++;this.serialize(a[$])}this.useCache&&this.cache.push(a);break;case 5:throw new C("Cannot serialize function");default:throw new C("Cannot serialize "+m.string(a))}},__class__:t};var u=function(a){this.buf=a,this.length=a.length,this.pos=0,this.scache=[],this.cache=[];var b=u.DEFAULT_RESOLVER;null==b&&(b=q,u.DEFAULT_RESOLVER=b),this.setResolver(b)};g["haxe.Unserializer"]=u,u.__name__=["haxe","Unserializer"],u.initCodes=function(){for(var a=[],b=0,c=u.BASE64.length;b<c;){var d=b++;a[u.BASE64.charCodeAt(d)]=d}return a},u.prototype={setResolver:function(a){null==a?this.resolver={resolveClass:function(a){return null},resolveEnum:function(a){return null}}:this.resolver=a},get:function(a){return this.buf.charCodeAt(a)},readDigits:function(){for(var a=0,b=!1,c=this.pos;;){var d=this.buf.charCodeAt(this.pos);if(d!=d)break;if(45!=d){if(d<48||d>57)break;a=10*a+(d-48),this.pos++}else{if(this.pos!=c)break;b=!0,this.pos++}}return b&&(a*=-1),a},readFloat:function(){for(var a=this.pos;;){var b=this.buf.charCodeAt(this.pos);if(!(b>=43&&b<58||101==b||69==b))break;this.pos++}return m.parseFloat(i.substr(this.buf,a,this.pos-a))},unserializeObject:function(a){for(;;){if(this.pos>=this.length)throw new C("Invalid object");if(103==this.buf.charCodeAt(this.pos))break;var b=this.unserialize();if("string"!=typeof b)throw new C("Invalid object key");var c=this.unserialize();a[b]=c}this.pos++},unserializeEnum:function(a,b){if(58!=this.get(this.pos++))throw new C("Invalid enum format");var c=this.readDigits();if(0==c)return q.createEnum(a,b);for(var d=[];c-- >0;)d.push(this.unserialize());return q.createEnum(a,b,d)},unserialize:function(){var a=this.get(this.pos++);switch(a){case 110:return null;case 116:return!0;case 102:return!1;case 122:return 0;case 105:return this.readDigits();case 100:return this.readFloat();case 121:var b=this.readDigits();if(58!=this.get(this.pos++)||this.length-this.pos<b)throw new C("Invalid string length");var c=i.substr(this.buf,this.pos,b);return this.pos+=b,c=decodeURIComponent(c.split("+").join(" ")),this.scache.push(c),c;case 107:return NaN;case 109:return-(1/0);case 112:return 1/0;case 97:var d=(this.buf,[]);for(this.cache.push(d);;){var e=this.buf.charCodeAt(this.pos);if(104==e){this.pos++;break}if(117==e){this.pos++;var f=this.readDigits();d[d.length+f-1]=null}else d.push(this.unserialize())}return d;case 111:var g={};return this.cache.push(g),this.unserializeObject(g),g;case 114:var h=this.readDigits();if(h<0||h>=this.cache.length)throw new C("Invalid reference");return this.cache[h];case 82:var j=this.readDigits();if(j<0||j>=this.scache.length)throw new C("Invalid string reference");return this.scache[j];case 120:throw new C(this.unserialize());case 99:var l=this.unserialize(),m=this.resolver.resolveClass(l);if(null==m)throw new C("Class not found "+l);var n=q.createEmptyInstance(m);return this.cache.push(n),this.unserializeObject(n),n;case 119:var p=this.unserialize(),r=this.resolver.resolveEnum(p);if(null==r)throw new C("Enum not found "+p);var s=this.unserializeEnum(r,this.unserialize());return this.cache.push(s),s;case 106:var t=this.unserialize(),x=this.resolver.resolveEnum(t);if(null==x)throw new C("Enum not found "+t);this.pos++;var A=this.readDigits(),B=q.getEnumConstructs(x)[A];if(null==B)throw new C("Unknown enum index "+t+"@"+A);var D=this.unserializeEnum(x,B);return this.cache.push(D),D;case 108:var E=new k;this.cache.push(E);for(this.buf;104!=this.buf.charCodeAt(this.pos);)E.add(this.unserialize());return this.pos++,E;case 98:var F=new y;this.cache.push(F);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var G=this.unserialize();F.set(G,this.unserialize())}return this.pos++,F;case 113:var H=new v;this.cache.push(H);for(var I=(this.buf,this.get(this.pos++));58==I;){var J=this.readDigits();H.set(J,this.unserialize()),I=this.get(this.pos++)}if(104!=I)throw new C("Invalid IntMap format");return H;case 77:var K=new w;this.cache.push(K);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var L=this.unserialize();K.set(L,this.unserialize())}return this.pos++,K;case 118:var M;if(this.buf.charCodeAt(this.pos)>=48&&this.buf.charCodeAt(this.pos)<=57&&this.buf.charCodeAt(this.pos+1)>=48&&this.buf.charCodeAt(this.pos+1)<=57&&this.buf.charCodeAt(this.pos+2)>=48&&this.buf.charCodeAt(this.pos+2)<=57&&this.buf.charCodeAt(this.pos+3)>=48&&this.buf.charCodeAt(this.pos+3)<=57&&45==this.buf.charCodeAt(this.pos+4)){var N=i.substr(this.buf,this.pos,19);M=i.strDate(N),this.pos+=19}else{var O=this.readFloat(),P=new Date;P.setTime(O),M=P}return this.cache.push(M),M;case 115:var Q=this.readDigits(),R=this.buf;if(58!=this.get(this.pos++)||this.length-this.pos<Q)throw new C("Invalid bytes length");var S=u.CODES;null==S&&(S=u.initCodes(),u.CODES=S);var T,U=this.pos,V=3&Q;T=3*(Q>>2)+(V>=2?V-1:0);for(var W=U+(Q-V),X=z.alloc(T),Y=0;U<W;){var Z=S[o.fastCodeAt(R,U++)],$=S[o.fastCodeAt(R,U++)];X.set(Y++,Z<<2|$>>4);var _=S[o.fastCodeAt(R,U++)];X.set(Y++,$<<4|_>>2);var aa=S[o.fastCodeAt(R,U++)];X.set(Y++,_<<6|aa)}if(V>=2){var ba=S[o.fastCodeAt(R,U++)],ca=S[o.fastCodeAt(R,U++)];if(X.set(Y++,ba<<2|ca>>4),3==V){var da=S[o.fastCodeAt(R,U++)];X.set(Y++,ca<<4|da>>2)}}return this.pos+=Q,this.cache.push(X),X;case 67:var ea=this.unserialize(),fa=this.resolver.resolveClass(ea);if(null==fa)throw new C("Class not found "+ea);var ga=q.createEmptyInstance(fa);if(this.cache.push(ga),ga.hxUnserialize(this),103!=this.get(this.pos++))throw new C("Invalid custom data");return ga;case 65:var ha=this.unserialize(),ia=this.resolver.resolveClass(ha);if(null==ia)throw new C("Class not found "+ha);return ia;case 66:var ja=this.unserialize(),ka=this.resolver.resolveEnum(ja);if(null==ka)throw new C("Enum not found "+ja);return ka}throw this.pos--,new C("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos)},__class__:u};var v=function(){this.h={}};g["haxe.ds.IntMap"]=v,v.__name__=["haxe","ds","IntMap"],v.__interfaces__=[r],v.prototype={set:function(a,b){this.h[a]=b},remove:function(a){return!!this.h.hasOwnProperty(a)&&(delete this.h[a],!0)},keys:function(){var a=[];for(var b in this.h)this.h.hasOwnProperty(b)&&a.push(0|b);return i.iter(a)},__class__:v};var w=function(){this.h={},this.h.__keys__={}};g["haxe.ds.ObjectMap"]=w,w.__name__=["haxe","ds","ObjectMap"],w.__interfaces__=[r],w.prototype={set:function(a,b){var c=a.__id__||(a.__id__=++w.count);this.h[c]=b,this.h.__keys__[c]=a},keys:function(){var a=[];for(var b in this.h.__keys__)this.h.hasOwnProperty(b)&&a.push(this.h.__keys__[b]);return i.iter(a)},__class__:w};var x=g["haxe.ds.Option"]={__ename__:["haxe","ds","Option"],__constructs__:["Some","None"]};x.Some=function(a){var b=["Some",0,a];return b.__enum__=x,b.toString=h,b},x.None=["None",1],x.None.toString=h,x.None.__enum__=x;var y=function(){this.h={}};g["haxe.ds.StringMap"]=y,y.__name__=["haxe","ds","StringMap"],y.__interfaces__=[r],y.prototype={set:function(a,b){null!=pb[a]?this.setReserved(a,b):this.h[a]=b},get:function(a){return null!=pb[a]?this.getReserved(a):this.h[a]},setReserved:function(a,b){null==this.rh&&(this.rh={}),this.rh["$"+a]=b},getReserved:function(a){return null==this.rh?null:this.rh["$"+a]},keys:function(){var a=this.arrayKeys();return i.iter(a)},arrayKeys:function(){var a=[];for(var b in this.h)this.h.hasOwnProperty(b)&&a.push(b);if(null!=this.rh)for(var b in this.rh)36==b.charCodeAt(0)&&a.push(b.substr(1));return a},__class__:y};var z=function(a){this.length=a.byteLength,this.b=new rb(a),this.b.bufferValue=a,a.hxBytes=this,a.bytes=this.b};g["haxe.io.Bytes"]=z,z.__name__=["haxe","io","Bytes"],z.alloc=function(a){return new z(new qb(a))},z.prototype={get:function(a){return this.b[a]},set:function(a,b){this.b[a]=255&b},__class__:z};var A=g["haxe.io.Error"]={__ename__:["haxe","io","Error"],__constructs__:["Blocked","Overflow","OutsideBounds","Custom"]};A.Blocked=["Blocked",0],A.Blocked.toString=h,A.Blocked.__enum__=A,A.Overflow=["Overflow",1],A.Overflow.toString=h,A.Overflow.__enum__=A,A.OutsideBounds=["OutsideBounds",2],A.OutsideBounds.toString=h,A.OutsideBounds.__enum__=A,A.Custom=function(a){var b=["Custom",3,a];return b.__enum__=A,b.toString=h,b};var B=function(){};g["haxe.io.FPHelper"]=B,B.__name__=["haxe","io","FPHelper"],B.i32ToFloat=function(a){var b=1-(a>>>31<<1),c=a>>>23&255,d=8388607&a;return 0==d&&0==c?0:b*(1+Math.pow(2,-23)*d)*Math.pow(2,c-127)},B.floatToI32=function(a){if(0==a)return 0;var b;b=a<0?-a:a;var c=Math.floor(Math.log(b)/.6931471805599453);c<-127?c=-127:c>128&&(c=128);var d=8388607&Math.round(8388608*(b/Math.pow(2,c)-1));return(a<0?-2147483648:0)|c+127<<23|d},B.i64ToDouble=function(a,b){var c=1-(b>>>31<<1),d=(b>>20&2047)-1023,e=4294967296*(1048575&b)+2147483648*(a>>>31)+(2147483647&a);return 0==e&&d==-1023?0:c*(1+Math.pow(2,-52)*e)*Math.pow(2,d)},B.doubleToI64=function(a){var b=B.i64tmp;if(0==a)b.low=0,b.high=0;else{var c;c=a<0?-a:a;var d,e=Math.floor(Math.log(c)/.6931471805599453),f=4503599627370496*(c/Math.pow(2,e)-1);d=Math.round(f);var g=0|d,h=d/4294967296|0;b.low=g,b.high=(a<0?-2147483648:0)|e+1023<<20|h}return b};var C=function(a){Error.call(this),this.val=a,this.message=String(a),Error.captureStackTrace&&Error.captureStackTrace(this,C)};g["js._Boot.HaxeError"]=C,C.__name__=["js","_Boot","HaxeError"],C.__super__=Error,C.prototype=d(Error.prototype,{__class__:C});var D=function(){};g["js.Boot"]=D,D.__name__=["js","Boot"],D.getClass=function(a){if(a instanceof Array&&null==a.__enum__)return Array;var b=a.__class__;if(null!=b)return b;var c=D.__nativeClassName(a);return null!=c?D.__resolveNativeClass(c):null},D.__string_rec=function(a,b){if(null==a)return"null";if(b.length>=5)return"<...>";var c=typeof a;switch("function"==c&&(a.__name__||a.__ename__)&&(c="object"),c){case"object":if(a instanceof Array){if(a.__enum__){if(2==a.length)return a[0];var d=a[0]+"(";b+="\t";for(var e=2,f=a.length;e<f;){var g=e++;d+=2!=g?","+D.__string_rec(a[g],b):D.__string_rec(a[g],b)}return d+")"}var h=a.length,i="[";b+="\t";for(var j=0;j<h;){var k=j++;i+=(k>0?",":"")+D.__string_rec(a[k],b)}return i+="]"}var l;try{l=a.toString}catch(m){return m instanceof C&&(m=m.val),"???"}if(null!=l&&l!=Object.toString&&"function"==typeof l){var n=a.toString();if("[object Object]"!=n)return n}var o=null,p="{\n";b+="\t";var q=null!=a.hasOwnProperty;for(var o in a)q&&!a.hasOwnProperty(o)||"prototype"!=o&&"__class__"!=o&&"__super__"!=o&&"__interfaces__"!=o&&"__properties__"!=o&&(2!=p.length&&(p+=", \n"),p+=b+o+" : "+D.__string_rec(a[o],b));return b=b.substring(1),p+="\n"+b+"}";case"function":return"<function>";case"string":return a;default:return String(a)}},D.__interfLoop=function(a,b){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=c)for(var d=0,e=c.length;d<e;){var f=d++,g=c[f];if(g==b||D.__interfLoop(g,b))return!0}return D.__interfLoop(a.__super__,b)},D.__instanceof=function(a,b){if(null==b)return!1;switch(b){case jb:return(0|a)===a;case lb:return"number"==typeof a;case mb:return"boolean"==typeof a;case String:return"string"==typeof a;case Array:return a instanceof Array&&null==a.__enum__;case kb:return!0;default:if(null==a)return!1;if("function"==typeof b){if(a instanceof b)return!0;if(D.__interfLoop(D.getClass(a),b))return!0}else if("object"==typeof b&&D.__isNativeObj(b)&&a instanceof b)return!0;return b==nb&&null!=a.__name__||(b==ob&&null!=a.__ename__||a.__enum__==b)}},D.__nativeClassName=function(a){var b=D.__toStr.call(a).slice(8,-1);return"Object"==b||"Function"==b||"Math"==b||"JSON"==b?null:b},D.__isNativeObj=function(a){return null!=D.__nativeClassName(a)},D.__resolveNativeClass=function(a){return c[a]};var E=function(a){if(a instanceof Array&&null==a.__enum__)this.a=a,this.byteLength=a.length;else{var b=a;this.a=[];for(var c=0;c<b;){var d=c++;this.a[d]=0}this.byteLength=b}};g["js.html.compat.ArrayBuffer"]=E,E.__name__=["js","html","compat","ArrayBuffer"],E.sliceImpl=function(a,b){var c=new rb(this,a,null==b?null:b-a),d=new qb(c.byteLength),e=new rb(d);return e.set(c),d},E.prototype={slice:function(a,b){return new E(this.a.slice(a,b))},__class__:E};var F=function(a,b,c){if(this.buf=a,null==b?this.offset=0:this.offset=b,null==c?this.length=a.byteLength-this.offset:this.length=c,this.offset<0||this.length<0||this.offset+this.length>a.byteLength)throw new C(A.OutsideBounds)};g["js.html.compat.DataView"]=F,F.__name__=["js","html","compat","DataView"],F.prototype={getInt8:function(a){var b=this.buf.a[this.offset+a];return b>=128?b-256:b},getUint8:function(a){return this.buf.a[this.offset+a]},getInt16:function(a,b){var c=this.getUint16(a,b);return c>=32768?c-65536:c},getUint16:function(a,b){return b?this.buf.a[this.offset+a]|this.buf.a[this.offset+a+1]<<8:this.buf.a[this.offset+a]<<8|this.buf.a[this.offset+a+1]},getInt32:function(a,b){var c=this.offset+a,d=this.buf.a[c++],e=this.buf.a[c++],f=this.buf.a[c++],g=this.buf.a[c++];return b?d|e<<8|f<<16|g<<24:g|f<<8|e<<16|d<<24},getUint32:function(a,b){var c=this.getInt32(a,b);return c<0?c+4294967296:c},getFloat32:function(a,b){return B.i32ToFloat(this.getInt32(a,b))},getFloat64:function(a,b){var c=this.getInt32(a,b),d=this.getInt32(a+4,b);return B.i64ToDouble(b?c:d,b?d:c)},setInt8:function(a,b){b<0?this.buf.a[a+this.offset]=b+128&255:this.buf.a[a+this.offset]=255&b},setUint8:function(a,b){this.buf.a[a+this.offset]=255&b},setInt16:function(a,b,c){this.setUint16(a,b<0?b+65536:b,c)},setUint16:function(a,b,c){var d=a+this.offset;c?(this.buf.a[d]=255&b,this.buf.a[d++]=b>>8&255):(this.buf.a[d++]=b>>8&255,this.buf.a[d]=255&b)},setInt32:function(a,b,c){this.setUint32(a,b,c)},setUint32:function(a,b,c){var d=a+this.offset;c?(this.buf.a[d++]=255&b,this.buf.a[d++]=b>>8&255,this.buf.a[d++]=b>>16&255,this.buf.a[d++]=b>>>24):(this.buf.a[d++]=b>>>24,this.buf.a[d++]=b>>16&255,this.buf.a[d++]=b>>8&255,this.buf.a[d++]=255&b)},setFloat32:function(a,b,c){this.setUint32(a,B.floatToI32(b),c)},setFloat64:function(a,b,c){var d=B.doubleToI64(b);c?(this.setUint32(a,d.low),this.setUint32(a,d.high)):(this.setUint32(a,d.high),this.setUint32(a,d.low))},__class__:F};var G=function(){};g["js.html.compat.Uint8Array"]=G,G.__name__=["js","html","compat","Uint8Array"],G._new=function(a,b,c){var d;if("number"==typeof a){d=[];for(var e=0;e<a;){var f=e++;d[f]=0}d.byteLength=d.length,d.byteOffset=0,d.buffer=new E(d)}else if(D.__instanceof(a,E)){var g=a;null==b&&(b=0),null==c&&(c=g.byteLength-b),d=0==b?g.a:g.a.slice(b,b+c),d.byteLength=d.length,d.byteOffset=b,d.buffer=g}else{if(!(a instanceof Array&&null==a.__enum__))throw new C("TODO "+m.string(a));d=a.slice(),d.byteLength=d.length,d.byteOffset=0,d.buffer=new E(d)}return d.subarray=G._subarray,d.set=G._set,d},G._set=function(a,b){var c=this;if(D.__instanceof(a.buffer,E)){var d=a;if(a.byteLength+b>c.byteLength)throw new C("set() outside of range");for(var e=0,f=a.byteLength;e<f;){var g=e++;c[g+b]=d[g]}}else{if(!(a instanceof Array&&null==a.__enum__))throw new C("TODO");var h=a;if(h.length+b>c.byteLength)throw new C("set() outside of range");for(var i=0,j=h.length;i<j;){var k=i++;c[k+b]=h[k]}}},G._subarray=function(a,b){var c=this,d=G._new(c.slice(a,b));return d.byteOffset=a,d};var H=function(a){this._resolved=!1,this._pending=!1,this._errorPending=!1,this._fulfilled=!1,this._update=[],this._error=[],this._errored=!1,null!=a&&H.link(a,this,function(a){return a})};g["promhx.base.AsyncBase"]=H,H.__name__=["promhx","base","AsyncBase"],H.link=function(a,b,c){a._update.push({async:b,linkf:function(a){b.handleResolve(c(a))}}),H.immediateLinkUpdate(a,b,c)},H.immediateLinkUpdate=function(a,b,c){if(!a._errored||a._errorPending||a._error.length>0||b.handleError(a._errorVal),a._resolved&&!a._pending)try{b.handleResolve(c(a._val))}catch(d){d instanceof C&&(d=d.val),b.handleError(d)}},H.linkAll=function(a,b){for(var c=function(c,d,f){if(0==c.length||H.allFulfilled(c)){for(var g,h=[],i=e(a)();i.hasNext();){var j=i.next();h.push(j==d?f:j._val)}g=h,b.handleResolve(g)}},d=e(a)();d.hasNext();){var f=d.next();f._update.push({async:b,linkf:function(a,b,c){return function(d){a(b,c,d)}}(c,function(b){for(var c,d=[],g=e(a)();g.hasNext();){var h=g.next();h!=f&&d.push(h)}return c=d}(this),f)})}H.allFulfilled(a)&&b.handleResolve(function(b){for(var c,d=[],f=e(a)();f.hasNext();){var g=f.next();d.push(g._val)}return c=d}(this))},H.pipeLink=function(a,b,c){var d=!1,e=function(a){if(!d){d=!0;var e=c(a);e._update.push({async:b,linkf:f(b,b.handleResolve)}),H.immediateLinkUpdate(e,b,function(a){return a})}};if(a._update.push({async:b,linkf:e}),a._resolved&&!a._pending)try{e(a._val)}catch(g){g instanceof C&&(g=g.val),b.handleError(g)}},H.allResolved=function(a){for(var b=e(a)();b.hasNext();){var c=b.next();if(!c._resolved)return!1}return!0},H.allFulfilled=function(a){for(var b=e(a)();b.hasNext();){var c=b.next();if(!c._fulfilled)return!1}return!0},H.prototype={catchError:function(a){return this._error.push(a),this},errorThen:function(a){return this._errorMap=a,this},isResolved:function(){return this._resolved},isErrored:function(){return this._errored},isErrorHandled:function(){return this._error.length>0},isErrorPending:function(){return this._errorPending},isFulfilled:function(){return this._fulfilled},isPending:function(){return this._pending},handleResolve:function(a){this._resolve(a)},_resolve:function(a){var b=this;this._pending?M.enqueue(function(a,b){return function(){a(b)}}(f(this,this._resolve),a)):(this._resolved=!0,this._pending=!0,M.queue.add(function(){b._val=a;for(var c=0,d=b._update;c<d.length;){var e=d[c];++c;try{e.linkf(a)}catch(f){f instanceof C&&(f=f.val),e.async.handleError(f)}}b._fulfilled=!0,b._pending=!1}),M.continueOnNextLoop())},handleError:function(a){this._handleError(a)},_handleError:function(a){var b=this,c=function(a){if(b._error.length>0)for(var c=0,d=b._error;c<d.length;){var e=d[c];++c,e(a)}else{if(!(b._update.length>0))throw new C(a);for(var f=0,g=b._update;f<g.length;){var h=g[f];++f,h.async.handleError(a)}}b._errorPending=!1};this._errorPending||(this._errorPending=!0,this._errored=!0,this._errorVal=a,M.queue.add(function(){if(null!=b._errorMap)try{b._resolve(b._errorMap(a))}catch(d){d instanceof C&&(d=d.val),c(d)}else c(a)}),M.continueOnNextLoop())},then:function(a){var b=new H(null);return H.link(this,b,a),b},unlink:function(a){var b=this;M.queue.add(function(){b._update=b._update.filter(function(b){return b.async!=a})}),M.continueOnNextLoop()},isLinked:function(a){for(var b=!1,c=0,d=this._update;c<d.length;){var e=d[c];if(++c,e.async==a)return!0}return b},__class__:H};var I=b.promhx.Deferred=function(){H.call(this)};g["promhx.Deferred"]=I,I.__name__=["promhx","Deferred"],I.__super__=H,I.prototype=d(H.prototype,{resolve:function(a){this.handleResolve(a)},throwError:function(a){this.handleError(a)},promise:function(){return new J(this)},stream:function(){return new K(this)},publicStream:function(){return new L(this)},__class__:I});var J=b.promhx.Promise=function(a){H.call(this,a),this._rejected=!1};g["promhx.Promise"]=J,J.__name__=["promhx","Promise"],J.whenAll=function(a){var b=new J(null);return H.linkAll(a,b),b},J.promise=function(a){var b=new J;return b.handleResolve(a),b},J.__super__=H,J.prototype=d(H.prototype,{isRejected:function(){return this._rejected},reject:function(a){this._rejected=!0,this.handleError(a)},handleResolve:function(a){if(this._resolved){var b="Promise has already been resolved";throw new C(N.AlreadyResolved(b))}this._resolve(a)},then:function(a){var b=new J(null);return H.link(this,b,a),b},unlink:function(a){var b=this;M.queue.add(function(){if(b._fulfilled)b._update=b._update.filter(function(b){return b.async!=a});else{var c="Downstream Promise is not fullfilled";b.handleError(N.DownstreamNotFullfilled(c))}}),M.continueOnNextLoop()},handleError:function(a){this._rejected=!0,this._handleError(a)},pipe:function(a){var b=new J(null);return H.pipeLink(this,b,a),b},errorPipe:function(a){var b=new J;return this.catchError(function(c){var d=a(c);d.then(f(b,b._resolve))}),this.then(f(b,b._resolve)),b},__class__:J});var K=b.promhx.Stream=function(a){H.call(this,a),this._end_promise=new J};g["promhx.Stream"]=K,K.__name__=["promhx","Stream"],K.foreach=function(a){for(var b=new K(null),c=e(a)();c.hasNext();){var d=c.next();b.handleResolve(d)}return b.end(),b},K.wheneverAll=function(a){var b=new K(null);return H.linkAll(a,b),b},K.concatAll=function(a){for(var b=new K(null),c=e(a)();c.hasNext();){var d=c.next();b.concat(d)}return b},K.mergeAll=function(a){for(var b=new K(null),c=e(a)();c.hasNext();){var d=c.next();b.merge(d)}return b},K.stream=function(a){var b=new K(null);return b.handleResolve(a),b},K.__super__=H,K.prototype=d(H.prototype,{then:function(a){var b=new K(null);return H.link(this,b,a),this._end_promise._update.push({async:b._end_promise,linkf:function(a){b.end()}}),b},detachStream:function(a){for(var b=[],c=!1,d=0,e=this._update;d<e.length;){var f=e[d];++d,f.async==a?(this._end_promise._update=this._end_promise._update.filter(function(b){return b.async!=a._end_promise}),c=!0):b.push(f)}return this._update=b,c},first:function(){var a=new J(null);return this.then(function(b){a._resolved||a.handleResolve(b)}),a},handleResolve:function(a){this._end||this._pause||this._resolve(a)},pause:function(a){null==a&&(a=!this._pause),this._pause=a},pipe:function(a){var b=new K(null);return H.pipeLink(this,b,a),this._end_promise.then(function(a){b.end()}),b},errorPipe:function(a){var b=new K(null);return this.catchError(function(c){var d=a(c);d.then(f(b,b._resolve)),d._end_promise.then((hb=b._end_promise,f(hb,hb._resolve)))}),this.then(f(b,b._resolve)),this._end_promise.then(function(a){b.end()}),b},handleEnd:function(){if(this._pending)M.queue.add(f(this,this.handleEnd)),M.continueOnNextLoop();else{if(this._end_promise._resolved)return;this._end=!0;var a;a=this._resolved?x.Some(this._val):x.None,this._end_promise.handleResolve(a),this._update=[],this._error=[]}},end:function(){return M.queue.add(f(this,this.handleEnd)),M.continueOnNextLoop(),
   this},endThen:function(a){return this._end_promise.then(a)},filter:function(a){var b=new K(null);return this._update.push({async:b,linkf:function(c){a(c)&&b.handleResolve(c)}}),H.immediateLinkUpdate(this,b,function(a){return a}),b},concat:function(a){var b=new K(null);return this._update.push({async:b,linkf:f(b,b.handleResolve)}),H.immediateLinkUpdate(this,b,function(a){return a}),this._end_promise.then(function(c){a.pipe(function(a){return b.handleResolve(a),b}),a._end_promise.then(function(a){b.end()})}),b},merge:function(a){var b=new K(null);return this._update.push({async:b,linkf:f(b,b.handleResolve)}),a._update.push({async:b,linkf:f(b,b.handleResolve)}),H.immediateLinkUpdate(this,b,function(a){return a}),H.immediateLinkUpdate(a,b,function(a){return a}),b},__class__:K});var L=b.promhx.PublicStream=function(a){K.call(this,a)};g["promhx.PublicStream"]=L,L.__name__=["promhx","PublicStream"],L.publicstream=function(a){var b=new L(null);return b.handleResolve(a),b},L.__super__=K,L.prototype=d(K.prototype,{resolve:function(a){this.handleResolve(a)},throwError:function(a){this.handleError(a)},update:function(a){this.handleResolve(a)},__class__:L});var M=function(){};g["promhx.base.EventLoop"]=M,M.__name__=["promhx","base","EventLoop"],M.enqueue=function(a){M.queue.add(a),M.continueOnNextLoop()},M.set_nextLoop=function(a){if(null!=M.nextLoop)throw new C("nextLoop has already been set");return M.nextLoop=a,M.nextLoop},M.queueEmpty=function(){return M.queue.isEmpty()},M.finish=function(a){null==a&&(a=1e3);for(var b=null;a-- >0&&null!=(b=M.queue.pop());)b();return M.queue.isEmpty()},M.clear=function(){M.queue=new k},M.f=function(){var a=M.queue.pop();null!=a&&a(),M.queue.isEmpty()||M.continueOnNextLoop()},M.continueOnNextLoop=function(){null!=M.nextLoop?M.nextLoop(M.f):setImmediate(M.f)};var N=g["promhx.error.PromiseError"]={__ename__:["promhx","error","PromiseError"],__constructs__:["AlreadyResolved","DownstreamNotFullfilled"]};N.AlreadyResolved=function(a){var b=["AlreadyResolved",0,a];return b.__enum__=N,b.toString=h,b},N.DownstreamNotFullfilled=function(a){var b=["DownstreamNotFullfilled",1,a];return b.__enum__=N,b.toString=h,b};var O=function(){};g["verb.Verb"]=O,O.__name__=["verb","Verb"],O.main=function(){a.log("verb 2.0.0")};var P=function(){};g["verb.core.ArrayExtensions"]=P,P.__name__=["verb","core","ArrayExtensions"],P.alloc=function(a,b){if(!(b<0))for(;a.length<b;)a.push(null)},P.reversed=function(a){var b=a.slice();return b.reverse(),b},P.last=function(a){return a[a.length-1]},P.first=function(a){return a[0]},P.spliceAndInsert=function(a,b,c,d){a.splice(b,c),a.splice(b,0,d)},P.left=function(a){if(0==a.length)return[];var b=Math.ceil(a.length/2);return a.slice(0,b)},P.right=function(a){if(0==a.length)return[];var b=Math.ceil(a.length/2);return a.slice(b)},P.rightWithPivot=function(a){if(0==a.length)return[];var b=Math.ceil(a.length/2);return a.slice(b-1)},P.unique=function(a,b){if(0==a.length)return[];for(var c=[a.pop()];a.length>0;){for(var d=a.pop(),e=!0,f=0;f<c.length;){var g=c[f];if(++f,b(d,g)){e=!1;break}}e&&c.push(d)}return c};var Q=function(){};g["verb.core.Binomial"]=Q,Q.__name__=["verb","core","Binomial"],Q.get=function(a,b){if(0==b)return 1;if(0==a||b>a)return 0;if(b>a-b&&(b=a-b),Q.memo_exists(a,b))return Q.get_memo(a,b);for(var c=1,d=a,e=1,f=b+1;e<f;){var g=e++;Q.memo_exists(d,g)?(a--,c=Q.get_memo(d,g)):(c*=a--,c/=g,Q.memoize(d,g,c))}return c},Q.get_no_memo=function(a,b){if(0==b)return 1;if(0==a||b>a)return 0;b>a-b&&(b=a-b);for(var c=1,d=1,e=b+1;d<e;){var f=d++;c*=a--,c/=f}return c},Q.memo_exists=function(a,b){return Q.memo.h.hasOwnProperty(a)&&Q.memo.h[a].h.hasOwnProperty(b)},Q.get_memo=function(a,b){return Q.memo.h[a].h[b]},Q.memoize=function(a,b,c){Q.memo.h.hasOwnProperty(a)||Q.memo.set(a,new v),Q.memo.h[a].h[b]=c};var R=b.core.BoundingBox=function(a){this.max=null,this.min=null,this.dim=3,this.initialized=!1,null!=a&&this.addRange(a)};g["verb.core.BoundingBox"]=R,R.__name__=["verb","core","BoundingBox"],R.intervalsOverlap=function(a,b,c,d,e){null==e&&(e=-1);var f;f=e<-.5?S.TOLERANCE:e;var g=Math.min(a,b)-f,h=Math.max(a,b)+f,i=Math.min(c,d)-f,j=Math.max(c,d)+f;return g>=i&&g<=j||h>=i&&h<=j||i>=g&&i<=h||j>=g&&j<=h},R.prototype={fromPoint:function(a){return new R([a])},add:function(a){if(!this.initialized)return this.dim=a.length,this.min=a.slice(0),this.max=a.slice(0),this.initialized=!0,this;for(var b=0,c=this.dim;b<c;){var d=b++;a[d]>this.max[d]&&(this.max[d]=a[d]),a[d]<this.min[d]&&(this.min[d]=a[d])}return this},addRange:function(a){for(var b=a.length,c=0;c<b;){var d=c++;this.add(a[d])}return this},contains:function(a,b){return null==b&&(b=-1),!!this.initialized&&this.intersects(new R([a]),b)},intersects:function(a,b){if(null==b&&(b=-1),!this.initialized||!a.initialized)return!1;for(var c=this.min,d=this.max,e=a.min,f=a.max,g=0,h=this.dim;g<h;){var i=g++;if(!R.intervalsOverlap(c[i],d[i],e[i],f[i],b))return!1}return!0},clear:function(){return this.initialized=!1,this},getLongestAxis:function(){for(var a=0,b=0,c=0,d=this.dim;c<d;){var e=c++,f=this.getAxisLength(e);f>a&&(a=f,b=e)}return b},getAxisLength:function(a){return a<0||a>this.dim-1?0:Math.abs(this.min[a]-this.max[a])},intersect:function(a,b){if(!this.initialized)return null;var c=this.min,d=this.max,e=a.min,f=a.max;if(!this.intersects(a,b))return null;for(var g=[],h=[],i=0,j=this.dim;i<j;){var k=i++;g.push(Math.min(d[k],f[k])),h.push(Math.max(c[k],e[k]))}return new R([h,g])},__class__:R};var S=b.core.Constants=function(){};g["verb.core.Constants"]=S,S.__name__=["verb","core","Constants"];var T=b.core.SerializableBase=function(){};g["verb.core.SerializableBase"]=T,T.__name__=["verb","core","SerializableBase"],T.prototype={serialize:function(){var a=new t;return a.serialize(this),a.toString()},__class__:T};var U=b.core.Plane=function(a,b){this.origin=a,this.normal=b};g["verb.core.Plane"]=U,U.__name__=["verb","core","Plane"],U.__super__=T,U.prototype=d(T.prototype,{__class__:U});var V=b.core.Ray=function(a,b){this.origin=a,this.dir=b};g["verb.core.Ray"]=V,V.__name__=["verb","core","Ray"],V.__super__=T,V.prototype=d(T.prototype,{__class__:V});var W=b.core.NurbsCurveData=function(a,b,c){this.degree=a,this.controlPoints=c,this.knots=b};g["verb.core.NurbsCurveData"]=W,W.__name__=["verb","core","NurbsCurveData"],W.__super__=T,W.prototype=d(T.prototype,{__class__:W});var X=b.core.NurbsSurfaceData=function(a,b,c,d,e){this.degreeU=a,this.degreeV=b,this.knotsU=c,this.knotsV=d,this.controlPoints=e};g["verb.core.NurbsSurfaceData"]=X,X.__name__=["verb","core","NurbsSurfaceData"],X.__super__=T,X.prototype=d(T.prototype,{__class__:X});var Y=b.core.MeshData=function(a,b,c,d){this.faces=a,this.points=b,this.normals=c,this.uvs=d};g["verb.core.MeshData"]=Y,Y.__name__=["verb","core","MeshData"],Y.empty=function(){return new Y([],[],[],[])},Y.__super__=T,Y.prototype=d(T.prototype,{__class__:Y});var Z=b.core.PolylineData=function(a,b){this.points=a,this.params=b};g["verb.core.PolylineData"]=Z,Z.__name__=["verb","core","PolylineData"],Z.__super__=T,Z.prototype=d(T.prototype,{__class__:Z});var $=b.core.VolumeData=function(a,b,c,d,e,f,g){this.degreeU=a,this.degreeV=b,this.degreeW=c,this.knotsU=d,this.knotsV=e,this.knotsW=f,this.controlPoints=g};g["verb.core.VolumeData"]=$,$.__name__=["verb","core","VolumeData"],$.__super__=T,$.prototype=d(T.prototype,{__class__:$});var _=b.core.Pair=function(a,b){this.item0=a,this.item1=b};g["verb.core.Pair"]=_,_.__name__=["verb","core","Pair"],_.prototype={__class__:_};var aa=b.core.Interval=function(a,b){this.min=a,this.max=b};g["verb.core.Interval"]=aa,aa.__name__=["verb","core","Interval"],aa.prototype={__class__:aa};var ba=b.core.CurveCurveIntersection=function(a,b,c,d){this.point0=a,this.point1=b,this.u0=c,this.u1=d};g["verb.core.CurveCurveIntersection"]=ba,ba.__name__=["verb","core","CurveCurveIntersection"],ba.prototype={__class__:ba};var ca=b.core.CurveSurfaceIntersection=function(a,b,c,d){this.u=a,this.uv=b,this.curvePoint=c,this.surfacePoint=d};g["verb.core.CurveSurfaceIntersection"]=ca,ca.__name__=["verb","core","CurveSurfaceIntersection"],ca.prototype={__class__:ca};var da=b.core.MeshIntersectionPoint=function(a,b,c,d,e){this.visited=!1,this.adj=null,this.opp=null,this.uv0=a,this.uv1=b,this.point=c,this.faceIndex0,this.faceIndex1};g["verb.core.MeshIntersectionPoint"]=da,da.__name__=["verb","core","MeshIntersectionPoint"],da.prototype={__class__:da};var ea=b.core.PolylineMeshIntersection=function(a,b,c,d,e){this.point=a,this.u=b,this.uv=c,this.polylineIndex=d,this.faceIndex=e};g["verb.core.PolylineMeshIntersection"]=ea,ea.__name__=["verb","core","PolylineMeshIntersection"],ea.prototype={__class__:ea};var fa=b.core.SurfaceSurfaceIntersectionPoint=function(a,b,c,d){this.uv0=a,this.uv1=b,this.point=c,this.dist=d};g["verb.core.SurfaceSurfaceIntersectionPoint"]=fa,fa.__name__=["verb","core","SurfaceSurfaceIntersectionPoint"],fa.prototype={__class__:fa};var ga=b.core.TriSegmentIntersection=function(a,b,c,d){this.point=a,this.s=b,this.t=c,this.p=d};g["verb.core.TriSegmentIntersection"]=ga,ga.__name__=["verb","core","TriSegmentIntersection"],ga.prototype={__class__:ga};var ha=b.core.CurveTriPoint=function(a,b,c){this.u=a,this.point=b,this.uv=c};g["verb.core.CurveTriPoint"]=ha,ha.__name__=["verb","core","CurveTriPoint"],ha.prototype={__class__:ha};var ia=function(a,b,c,d,e){null==e&&(e=!1),null==d&&(d=-1),this.uv=c,this.point=a,this.normal=b,this.id=d,this.degen=e};g["verb.core.SurfacePoint"]=ia,ia.__name__=["verb","core","SurfacePoint"],ia.fromUv=function(a,b){return new ia(null,null,[a,b])},ia.prototype={__class__:ia};var ja=b.core.CurvePoint=function(a,b){this.u=a,this.pt=b};g["verb.core.CurvePoint"]=ja,ja.__name__=["verb","core","CurvePoint"],ja.prototype={__class__:ja};var ka=b.core.KdTree=function(a,b){this.dim=3,this.points=a,this.distanceFunction=b,this.dim=a[0].point.length,this.root=this.buildTree(a,0,null)};g["verb.core.KdTree"]=ka,ka.__name__=["verb","core","KdTree"],ka.prototype={buildTree:function(a,b,c){var d,e,f=b%this.dim;return 0==a.length?null:1==a.length?new na(a[0],f,c):(a.sort(function(a,b){var c=a.point[f]-b.point[f];return 0==c?0:c>0?1:-1}),d=Math.floor(a.length/2),e=new na(a[d],f,c),e.left=this.buildTree(a.slice(0,d),b+1,e),e.right=this.buildTree(a.slice(d+1),b+1,e),e)},nearest:function(a,b,c){var d,e=this,f=new la(function(a){return-a.item1}),g=null;g=function(c){for(var d,h,i=c.dimension,j=e.distanceFunction(a,c.kdPoint.point),k=[],l=0,m=e.dim;l<m;){l++;k.push(0)}h=k;for(var n,o,p=function(a,c){f.push(new _(a,c)),f.size()>b&&f.pop()},q=0,r=e.dim;q<r;){var s=q++;s==c.dimension?h[s]=a[s]:h[s]=c.kdPoint.point[s]}return n=e.distanceFunction(h,c.kdPoint.point),null==c.right&&null==c.left?void((f.size()<b||j<f.peek().item1)&&p(c,j)):(d=null==c.right?c.left:null==c.left?c.right:a[i]<c.kdPoint.point[i]?c.left:c.right,g(d),(f.size()<b||j<f.peek().item1)&&p(c,j),void((f.size()<b||Math.abs(n)<f.peek().item1)&&(o=d==c.left?c.right:c.left,null!=o&&g(o))))},d=g;for(var h=0;h<b;){h++;f.push(new _(null,c))}d(this.root);for(var i=[],j=0;j<b;){var k=j++;null!=f.content[k].item0&&i.push(new _(f.content[k].item0.kdPoint,f.content[k].item1))}return i},__class__:ka};var la=function(a){this.content=[],this.scoreFunction=a};g["verb.core.BinaryHeap"]=la,la.__name__=["verb","core","BinaryHeap"],la.prototype={push:function(a){this.content.push(a),this.bubbleUp(this.content.length-1)},pop:function(){var a=this.content[0],b=this.content.pop();return this.content.length>0&&(this.content[0]=b,this.sinkDown(0)),a},peek:function(){return this.content[0]},remove:function(a){for(var b=this.content.length,c=0;c<b;){var d=c++;if(this.content[d]==a){var e=this.content.pop();return void(d!=b-1&&(this.content[d]=e,this.scoreFunction(e)<this.scoreFunction(a)?this.bubbleUp(d):this.sinkDown(d)))}}throw new C("Node not found.")},size:function(){return this.content.length},bubbleUp:function(a){for(var b=this.content[a];a>0;){var c=Math.floor((a+1)/2)-1,d=this.content[c];if(!(this.scoreFunction(b)<this.scoreFunction(d)))break;this.content[c]=b,this.content[a]=d,a=c}},sinkDown:function(a){for(var b=this.content.length,c=this.content[a],d=this.scoreFunction(c);;){var e=2*(a+1),f=e-1,g=-1,h=0;if(f<b){var i=this.content[f];h=this.scoreFunction(i),h<d&&(g=f)}if(e<b){var j=this.content[e],k=this.scoreFunction(j);k<(g==-1?d:h)&&(g=e)}if(g==-1)break;this.content[a]=this.content[g],this.content[g]=c,a=g}},__class__:la};var ma=b.core.KdPoint=function(a,b){this.point=a,this.obj=b};g["verb.core.KdPoint"]=ma,ma.__name__=["verb","core","KdPoint"],ma.prototype={__class__:ma};var na=b.core.KdNode=function(a,b,c){this.kdPoint=a,this.left=null,this.right=null,this.parent=c,this.dimension=b};g["verb.core.KdNode"]=na,na.__name__=["verb","core","KdNode"],na.prototype={__class__:na};var oa=function(){};g["verb.eval.IBoundingBoxTree"]=oa,oa.__name__=["verb","eval","IBoundingBoxTree"],oa.prototype={__class__:oa};var pa=function(a,b){this._boundingBox=null,this._curve=a,null==b&&(b=Ca.domain(this._curve.knots)/64),this._knotTol=b};g["verb.core.LazyCurveBoundingBoxTree"]=pa,pa.__name__=["verb","core","LazyCurveBoundingBoxTree"],pa.__interfaces__=[oa],pa.prototype={split:function(){var a=P.first(this._curve.knots),b=P.last(this._curve.knots),c=b-a,d=Ga.curveSplit(this._curve,(b+a)/2+.1*c*Math.random());return new _(new pa(d[0],this._knotTol),new pa(d[1],this._knotTol))},boundingBox:function(){return null==this._boundingBox&&(this._boundingBox=new R(Ia.dehomogenize1d(this._curve.controlPoints))),this._boundingBox},yield:function(){return this._curve},indivisible:function(a){return Ca.domain(this._curve.knots)<this._knotTol},empty:function(){return!1},__class__:pa};var qa=function(a,b){if(this._boundingBox=null,this._mesh=a,null==b){for(var c=[],d=0,e=a.faces.length;d<e;){var f=d++;c.push(f)}b=c}this._faceIndices=b};g["verb.core.LazyMeshBoundingBoxTree"]=qa,qa.__name__=["verb","core","LazyMeshBoundingBoxTree"],qa.__interfaces__=[oa],qa.prototype={split:function(){var a=va.sortTrianglesOnLongestAxis(this.boundingBox(),this._mesh,this._faceIndices),b=P.left(a),c=P.right(a);return new _(new qa(this._mesh,b),new qa(this._mesh,c))},boundingBox:function(){return null==this._boundingBox&&(this._boundingBox=va.makeMeshAabb(this._mesh,this._faceIndices)),this._boundingBox},yield:function(){return this._faceIndices[0]},indivisible:function(a){return 1==this._faceIndices.length},empty:function(){return 0==this._faceIndices.length},__class__:qa};var ra=function(a,b){this._boundingBox=null,this._polyline=a,null==b&&(b=new aa(0,0!=a.points.length?a.points.length-1:0)),this._interval=b};g["verb.core.LazyPolylineBoundingBoxTree"]=ra,ra.__name__=["verb","core","LazyPolylineBoundingBoxTree"],ra.__interfaces__=[oa],ra.prototype={split:function(){var a=this._interval.min,b=this._interval.max,c=a+Math.ceil((b-a)/2),d=new aa(a,c),e=new aa(c,b);return new _(new ra(this._polyline,d),new ra(this._polyline,e))},boundingBox:function(){return null==this._boundingBox&&(this._boundingBox=new R(this._polyline.points)),this._boundingBox},yield:function(){return this._interval.min},indivisible:function(a){return this._interval.max-this._interval.min==1},empty:function(){return this._interval.max-this._interval.min==0},__class__:ra};var sa=function(a,b,c,d){null==b&&(b=!1),this._boundingBox=null,this._surface=a,this._splitV=b,null==c&&(c=Ca.domain(a.knotsU)/16),null==d&&(d=Ca.domain(a.knotsV)/16),this._knotTolU=c,this._knotTolV=d};g["verb.core.LazySurfaceBoundingBoxTree"]=sa,sa.__name__=["verb","core","LazySurfaceBoundingBoxTree"],sa.__interfaces__=[oa],sa.prototype={split:function(){var a,b;this._splitV?(a=P.first(this._surface.knotsV),b=P.last(this._surface.knotsV)):(a=P.first(this._surface.knotsU),b=P.last(this._surface.knotsU));var c=(a+b)/2,d=Ga.surfaceSplit(this._surface,c,this._splitV);return new _(new sa(d[0],!this._splitV,this._knotTolU,this._knotTolV),new sa(d[1],!this._splitV,this._knotTolU,this._knotTolV))},boundingBox:function(){if(null==this._boundingBox){this._boundingBox=new R;for(var a=0,b=this._surface.controlPoints;a<b.length;){var c=b[a];++a,this._boundingBox.addRange(Ia.dehomogenize1d(c))}}return this._boundingBox},yield:function(){return this._surface},indivisible:function(a){return Ca.domain(this._surface.knotsV)<this._knotTolV&&Ca.domain(this._surface.knotsU)<this._knotTolU},empty:function(){return!1},__class__:sa};var ta=b.core.Mat=function(){};g["verb.core.Mat"]=ta,ta.__name__=["verb","core","Mat"],ta.mul=function(a,b){for(var c=[],d=0,e=b.length;d<e;){var f=d++;c.push(Ca.mul(a,b[f]))}return c},ta.mult=function(a,b){var c,d,e,f,g,h,i,j;c=a.length,d=b.length,e=b[0].length,f=[];for(var k=c-1,l=0,m=0;k>=0;){for(g=[],h=a[k],m=e-1;m>=0;){for(i=h[d-1]*b[d-1][m],l=d-2;l>=1;)j=l-1,i+=h[l]*b[l][m]+h[j]*b[j][m],l-=2;0==l&&(i+=h[0]*b[0][m]),g[m]=i,m--}f[k]=g,k--}return f},ta.add=function(a,b){for(var c=[],d=0,e=a.length;d<e;){var f=d++;c.push(Ca.add(a[f],b[f]))}return c},ta.div=function(a,b){for(var c=[],d=0,e=a.length;d<e;){var f=d++;c.push(Ca.div(a[f],b))}return c},ta.sub=function(a,b){for(var c=[],d=0,e=a.length;d<e;){var f=d++;c.push(Ca.sub(a[f],b[f]))}return c},ta.dot=function(a,b){for(var c=[],d=0,e=a.length;d<e;){var f=d++;c.push(Ca.dot(a[f],b))}return c},ta.identity=function(a){for(var b=Ca.zeros2d(a,a),c=0;c<a;){var d=c++;b[d][d]=1}return b},ta.transpose=function(a){if(0==a.length)return[];for(var b=[],c=0,d=a[0].length;c<d;){var e=c++;b.push(function(b){for(var c,d=[],f=0,g=a.length;f<g;){var h=f++;d.push(a[h][e])}return c=d}(this))}return b},ta.solve=function(a,b){return ta.LUsolve(ta.LU(a),b)},ta.LUsolve=function(a,b){var c,d,e,f,g,h=a.LU,i=h.length,j=b.slice(),k=a.P;for(c=i-1;c!=-1;)j[c]=b[c],--c;for(c=0;c<i;){for(e=k[c],k[c]!=c&&(g=j[c],j[c]=j[e],j[e]=g),f=h[c],d=0;d<c;)j[c]-=j[d]*f[d],++d;++c}for(c=i-1;c>=0;){for(f=h[c],d=c+1;d<i;)j[c]-=j[d]*f[d],++d;j[c]/=f[c],--c}return j},ta.LU=function(a){for(var b,c,d,e,f,g,h,i,j,k=(Math.abs,[]),l=0,m=a.length;l<m;){var n=l++;k.push(a[n].slice())}a=k;var o=a.length,p=o-1,q=[];for(d=0;d<o;){for(h=d,g=a[d],j=Math.abs(g[d]),c=d+1;c<o;)e=Math.abs(a[c][d]),j<e&&(j=e,h=c),++c;for(q[d]=h,h!=d&&(a[d]=a[h],a[h]=g,g=a[d]),f=g[d],b=d+1;b<o;)a[b][d]/=f,++b;for(b=d+1;b<o;){for(i=a[b],c=d+1;c<p;)i[c]-=i[d]*g[c],++c,i[c]-=i[d]*g[c],++c;c==p&&(i[c]-=i[d]*g[c]),++b}++d}return new ua(a,q)};var ua=function(a,b){this.LU=a,this.P=b};g["verb.core._Mat.LUDecomp"]=ua,ua.__name__=["verb","core","_Mat","LUDecomp"],ua.prototype={__class__:ua};var va=b.core.Mesh=function(){};g["verb.core.Mesh"]=va,va.__name__=["verb","core","Mesh"],va.getTriangleNorm=function(a,b){var c=a[b[0]],d=a[b[1]],e=a[b[2]],f=Ca.sub(d,c),g=Ca.sub(e,c),h=Ca.cross(f,g);return Ca.mul(1/Ca.norm(h),h)},va.makeMeshAabb=function(a,b){for(var c=new R,d=0;d<b.length;){var e=b[d];++d,c.add(a.points[a.faces[e][0]]),c.add(a.points[a.faces[e][1]]),c.add(a.points[a.faces[e][2]])}return c},va.sortTrianglesOnLongestAxis=function(a,b,c){for(var d=a.getLongestAxis(),e=[],f=0;f<c.length;){var g=c[f];++f;var h=va.getMinCoordOnAxis(b.points,b.faces[g],d);e.push(new _(h,g))}e.sort(function(a,b){var c=a.item0,d=b.item0;return c==d?0:c>d?1:-1});for(var i=[],j=0,k=e.length;j<k;){var l=j++;i.push(e[l].item1)}return i},va.getMinCoordOnAxis=function(a,b,c){for(var d=1/0,e=0;e<3;){var f=e++,g=a[b[f]][c];g<d&&(d=g)}return d},va.getTriangleCentroid=function(a,b){for(var c=[0,0,0],d=0;d<3;)for(var e=d++,f=0;f<3;){var g=f++;c[g]+=a[b[e]][g]}for(var h=0;h<3;){var i=h++;c[i]/=3}return c},va.triangleUVFromPoint=function(a,b,c){var d=a.faces[b],e=a.points[d[0]],f=a.points[d[1]],g=a.points[d[2]],h=a.uvs[d[0]],i=a.uvs[d[1]],j=a.uvs[d[2]],k=Ca.sub(e,c),l=Ca.sub(f,c),m=Ca.sub(g,c),n=Ca.norm(Ca.cross(Ca.sub(e,f),Ca.sub(e,g))),o=Ca.norm(Ca.cross(l,m))/n,p=Ca.norm(Ca.cross(m,k))/n,q=Ca.norm(Ca.cross(k,l))/n;return Ca.add(Ca.mul(o,h),Ca.add(Ca.mul(p,i),Ca.mul(q,j)))};var wa=function(a,b){if(this._empty=!1,this._face=-1,null==b){for(var c=[],d=0,e=a.faces.length;d<e;){var f=d++;c.push(f)}b=c}if(this._boundingBox=va.makeMeshAabb(a,b),b.length<1)return void(this._empty=!0);if(b.length<2)return void(this._face=b[0]);var g=va.sortTrianglesOnLongestAxis(this._boundingBox,a,b),h=P.left(g),i=P.right(g);this._children=new _(new wa(a,h),new wa(a,i))};g["verb.core.MeshBoundingBoxTree"]=wa,wa.__name__=["verb","core","MeshBoundingBoxTree"],wa.__interfaces__=[oa],wa.prototype={split:function(){return this._children},boundingBox:function(){return this._boundingBox},yield:function(){return this._face},indivisible:function(a){return null==this._children},empty:function(){return this._empty},__class__:wa};var xa=b.core.Minimizer=function(){};g["verb.core.Minimizer"]=xa,xa.__name__=["verb","core","Minimizer"],xa.uncmin=function(a,b,c,d,e){null==c&&(c=1e-8),null==d&&(d=function(b){return xa.numericalGradient(a,b)}),null==e&&(e=1e3),b=b.slice(0);var f,g=b.length,h=a(b),i=h;if(isNaN(h))throw new C("uncmin: f(x0) is a NaN!");c=Math.max(c,S.EPSILON);var j,k,l,m,n,o,p,q,r,s=ta.identity(g),t=0,u=[],v="";for(k=d(b);t<e;){if(!Ca.all(Ca.finite(k))){v="Gradient has Infinity or NaN";break}if(j=Ca.neg(ta.dot(s,k)),!Ca.all(Ca.finite(j))){v="Search direction has Infinity or NaN";break}if(r=Ca.norm(j),r<c){v="Newton step smaller than tol";break}for(q=1,f=Ca.dot(k,j),m=b;t<e&&!(q*r<c)&&(u=Ca.mul(q,j),m=Ca.add(b,u),i=a(m),i-h>=.1*q*f||isNaN(i));)q*=.5,++t;if(q*r<c){v="Line search step size smaller than tol";break}if(t==e){v="maxit reached during line search";break}l=d(m),n=Ca.sub(l,k),p=Ca.dot(n,u),o=ta.dot(s,n),s=ta.sub(ta.add(s,ta.mul((p+Ca.dot(n,o))/(p*p),xa.tensor(u,u))),ta.div(ta.add(xa.tensor(o,u),xa.tensor(u,o)),p)),b=m,h=i,k=l,++t}return new ya(b,h,k,s,t,v)},xa.numericalGradient=function(a,b){var c=b.length,d=a(b);if(NaN==d)throw new C("gradient: f(x) is a NaN!");for(var e,f,g,h,i,j,k,l,m,n=b.slice(0),o=[],p=.001,q=0,r=0;r<c;)for(var s=r++,t=Math.max(1e-6*d,1e-8);;){if(++q,q>20)throw new C("Numerical gradient fails");if(n[s]=b[s]+t,e=a(n),n[s]=b[s]-t,f=a(n),n[s]=b[s],isNaN(e)||isNaN(f))t/=16;else{if(o[s]=(e-f)/(2*t),h=b[s]-t,i=b[s],j=b[s]+t,k=(e-d)/t,l=(d-f)/t,m=Ca.max([Math.abs(o[s]),Math.abs(d),Math.abs(e),Math.abs(f),Math.abs(h),Math.abs(i),Math.abs(j),1e-8]),g=Math.min(Ca.max([Math.abs(k-o[s]),Math.abs(l-o[s]),Math.abs(k-l)])/m,t/m),!(g>p))break;t/=16}}return o},xa.tensor=function(a,b){for(var c,d,e=a.length,f=b.length,g=[],h=e-1;h>=0;){c=[],d=a[h];for(var i=f-1;i>=3;)c[i]=d*b[i],--i,c[i]=d*b[i],--i,c[i]=d*b[i],--i,c[i]=d*b[i],--i;for(;i>=0;)c[i]=d*b[i],--i;g[h]=c,h--}return g};var ya=function(a,b,c,d,e,f){this.solution=a,this.value=b,this.gradient=c,this.invHessian=d,this.iterations=e,this.message=f};g["verb.core.MinimizationResult"]=ya,ya.__name__=["verb","core","MinimizationResult"],ya.prototype={__class__:ya};var za=function(){};g["verb.core.ISerializable"]=za,za.__name__=["verb","core","ISerializable"],za.prototype={__class__:za};var Aa=b.core.Deserializer=function(){};g["verb.core.Deserializer"]=Aa,Aa.__name__=["verb","core","Deserializer"],Aa.deserialize=function(a){var b=new u(a),c=b.unserialize();return c};var Ba=b.core.Trig=function(){};g["verb.core.Trig"]=Ba,Ba.__name__=["verb","core","Trig"],Ba.isPointInPlane=function(a,b,c){return Math.abs(Ca.dot(Ca.sub(a,b.origin),b.normal))<c},Ba.distToSegment=function(a,b,c){var d=Ba.segmentClosestPoint(b,a,c,0,1);return Ca.dist(b,d.pt)},Ba.rayClosestPoint=function(a,b,c){var d=Ca.sub(a,b),e=Ca.dot(d,c),f=Ca.add(b,Ca.mul(e,c));return f},Ba.distToRay=function(a,b,c){var d=Ba.rayClosestPoint(a,b,c),e=Ca.sub(d,a);return Ca.norm(e)},Ba.threePointsAreFlat=function(a,b,c,d){var e=Ca.sub(b,a),f=Ca.sub(c,a),g=Ca.cross(e,f),h=Ca.dot(g,g);return h<d},Ba.segmentClosestPoint=function(a,b,c,d,e){var f=Ca.sub(c,b),g=Ca.norm(f);if(g<S.EPSILON)return{u:d,pt:b};var h=b,i=Ca.mul(1/g,f),j=Ca.sub(a,h),k=Ca.dot(j,i);return k<0?{u:d,pt:b}:k>g?{u:e,pt:c}:{u:d+(e-d)*k/g,pt:Ca.add(h,Ca.mul(k,i))}};var Ca=b.core.Vec=function(){};g["verb.core.Vec"]=Ca,Ca.__name__=["verb","core","Vec"],Ca.angleBetween=function(a,b){return Math.acos(Ca.dot(a,b)/(Ca.norm(a)*Ca.norm(b)))},Ca.positiveAngleBetween=function(a,b,c){var d=Ca.cross(a,b),e=Ca.norm(a),f=Ca.norm(b),g=e*f,h=Ca.dot(a,b),i=Ca.norm(d)/g,j=h/g,k=Math.atan2(i,j),l=Ca.dot(c,d);return Math.abs(l)<S.EPSILON?k:l>0?k:-k},Ca.signedAngleBetween=function(a,b,c){var d=Ca.cross(a,b),e=Ca.norm(a),f=Ca.norm(b),g=e*f,h=Ca.dot(a,b),i=Ca.norm(d)/g,j=h/g,k=Math.atan2(i,j),l=Ca.dot(c,d);return l>0?k:2*Math.PI-k},Ca.angleBetweenNormalized2d=function(a,b){var c=a[0]*b[1]-a[1]*b[0];return Math.atan2(c,Ca.dot(a,b))},Ca.domain=function(a){return P.last(a)-P.first(a)},Ca.range=function(a){for(var b=[],c=0,d=0;d<a;){d++;b.push(c),c+=1}return b},Ca.span=function(a,b,c){if(null==c)return[];if(c<S.EPSILON)return[];if(a>b&&c>0)return[];if(b>a&&c<0)return[];for(var d=[],e=a;e<=b;)d.push(e),e+=c;return d},Ca.neg=function(a){return a.map(function(a){return-a})},Ca.min=function(a){return j.fold(a,function(a,b){return Math.min(a,b)},1/0)},Ca.max=function(a){return j.fold(a,function(a,b){return Math.max(a,b)},-(1/0))},Ca.all=function(a){return j.fold(a,function(a,b){return b&&a},!0)},Ca.finite=function(a){return a.map(function(a){return isFinite(a)})},Ca.onRay=function(a,b,c){return Ca.add(a,Ca.mul(c,b))},Ca.lerp=function(a,b,c){return Ca.add(Ca.mul(a,b),Ca.mul(1-a,c))},Ca.normalized=function(a){return Ca.div(a,Ca.norm(a))},Ca.cross=function(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]},Ca.dist=function(a,b){return Ca.norm(Ca.sub(a,b))},Ca.distSquared=function(a,b){return Ca.normSquared(Ca.sub(a,b))},Ca.sum=function(a){return j.fold(a,function(a,b){return b+a},0)},Ca.addAll=function(a){var b=e(a)();if(!b.hasNext())return null;var c=b.next().length;return j.fold(a,function(a,b){return Ca.add(b,a)},Ca.rep(c,0))},Ca.norm=function(a){var b=Ca.normSquared(a);return 0!=b?Math.sqrt(b):b},Ca.normSquared=function(a){return j.fold(a,function(a,b){return b+a*a},0)},Ca.rep=function(a,b){for(var c=[],d=0;d<a;){d++;c.push(b)}return c},Ca.zeros1d=function(a){for(var b=[],c=0;c<a;){c++;b.push(0)}return b},Ca.zeros2d=function(a,b){for(var c=[],d=0;d<a;){d++;c.push(Ca.zeros1d(b))}return c},Ca.zeros3d=function(a,b,c){for(var d=[],e=0;e<a;){e++;d.push(Ca.zeros2d(b,c))}return d},Ca.dot=function(a,b){for(var c=0,d=0,e=a.length;d<e;){var f=d++;c+=a[f]*b[f]}return c},Ca.add=function(a,b){for(var c=[],d=0,e=a.length;d<e;){var f=d++;c.push(a[f]+b[f])}return c},Ca.mul=function(a,b){for(var c=[],d=0,e=b.length;d<e;){var f=d++;c.push(a*b[f])}return c},Ca.div=function(a,b){for(var c=[],d=0,e=a.length;d<e;){var f=d++;c.push(a[f]/b)}return c},Ca.sub=function(a,b){for(var c=[],d=0,e=a.length;d<e;){var f=d++;c.push(a[f]-b[f])}return c},Ca.isZero=function(a){for(var b=0,c=a.length;b<c;){var d=b++;if(Math.abs(a[d])>S.TOLERANCE)return!1}return!0},Ca.sortedSetUnion=function(a,b){for(var c=[],d=0,e=0;d<a.length||e<b.length;)if(d>=a.length)c.push(b[e]),e++;else if(e>=b.length)c.push(a[d]),d++;else{var f=a[d]-b[e];Math.abs(f)<S.EPSILON?(c.push(a[d]),d++,e++):f>0?(c.push(b[e]),e++):(c.push(a[d]),d++)}return c},Ca.sortedSetSub=function(a,b){for(var c=[],d=0,e=0;d<a.length;)e>=b.length?(c.push(a[d]),d++):Math.abs(a[d]-b[e])<S.EPSILON?(d++,e++):(c.push(a[d]),d++);return c};var Da=b.eval.Analyze=function(){};g["verb.eval.Analyze"]=Da,Da.__name__=["verb","eval","Analyze"],Da.knotMultiplicities=function(a){for(var b=[new Ea(a[0],0)],c=b[0],d=0;d<a.length;){var e=a[d];++d,Math.abs(e-c.knot)>S.EPSILON&&(c=new Ea(e,0),b.push(c)),c.inc()}return b},Da.isRationalSurfaceClosed=function(a,b){null==b&&(b=!0);var c;c=b?a.controlPoints:ta.transpose(a.controlPoints);for(var d=0,e=c[0].length;d<e;){var f=d++,g=Ca.dist(P.first(c)[f],P.last(c)[f])<S.EPSILON;if(!g)return!1}return!0},Da.rationalSurfaceClosestPoint=function(a,b){var c=Da.rationalSurfaceClosestParam(a,b);return Ia.rationalSurfacePoint(a,c[0],c[1])},Da.rationalSurfaceClosestParam=function(a,b){for(var c,d,e,f=5,g=0,h=1e-4,i=5e-4,j=a.knotsU[0],k=P.last(a.knotsU),l=a.knotsV[0],m=P.last(a.knotsV),n=Da.isRationalSurfaceClosed(a),o=Da.isRationalSurfaceClosed(a,!1),p=Ma.rationalSurfaceAdaptive(a,new Na),q=1/0,r=0,s=p.points.length;r<s;){var t=r++,u=p.points[t],v=Ca.normSquared(Ca.sub(b,u));v<q&&(q=v,e=p.uvs[t])}for(var w=function(b){return Ia.rationalSurfaceDerivatives(a,b[0],b[1],2)},x=function(a,b,c){var d=b[1][0],e=b[0][1],f=b[2][0],g=b[0][2],h=b[1][1],i=b[1][1],j=Ca.dot(d,c),k=Ca.dot(e,c),l=[-j,-k],m=Ca.dot(d,d)+Ca.dot(f,c),n=Ca.dot(d,e)+Ca.dot(h,c),o=Ca.dot(d,e)+Ca.dot(i,c),p=Ca.dot(e,e)+Ca.dot(g,c),q=[[m,n],[o,p]],r=ta.solve(q,l);return Ca.add(r,a)};g<f;){c=w(e),d=Ca.sub(c[0][0],b);var y=Ca.norm(d),z=Ca.dot(c[1][0],d),A=Ca.norm(c[1][0])*y,B=Ca.dot(c[0][1],d),C=Ca.norm(c[0][1])*y,D=z/A,E=B/C,F=y<h,G=D<i,H=E<i;if(F&&G&&H)return e;var I=x(e,c,d);I[0]<j?I=n?[k-(I[0]-j),I[1]]:[j+S.EPSILON,I[1]]:I[0]>k&&(I=n?[j+(I[0]-k),I[1]]:[k-S.EPSILON,I[1]]),I[1]<l?I=o?[I[0],m-(I[1]-l)]:[I[0],l+S.EPSILON]:I[1]>m&&(I=o?[I[0],l+(I[0]-m)]:[I[0],m-S.EPSILON]);var J=Ca.norm(Ca.mul(I[0]-e[0],c[1][0])),K=Ca.norm(Ca.mul(I[1]-e[1],c[0][1]));if(J+K<h)return e;e=I,g++}return e},Da.rationalCurveClosestPoint=function(a,b){return Ia.rationalCurvePoint(a,Da.rationalCurveClosestParam(a,b))},Da.rationalCurveClosestParam=function(a,b){for(var c=1/0,d=0,e=Ma.rationalCurveRegularSample(a,a.controlPoints.length*a.degree,!0),f=0,g=e.length-1;f<g;){var h=f++,i=e[h][0],j=e[h+1][0],k=e[h].slice(1),l=e[h+1].slice(1),m=Ba.segmentClosestPoint(b,k,l,i,j),n=Ca.norm(Ca.sub(b,m.pt));n<c&&(c=n,d=m.u)}for(var o,p,q=5,r=0,s=1e-4,t=5e-4,u=a.knots[0],v=P.last(a.knots),w=Ca.normSquared(Ca.sub(a.controlPoints[0],P.last(a.controlPoints)))<S.EPSILON,x=d,y=function(b){return Ia.rationalCurveDerivatives(a,b,2)},z=function(a,b,c){var d=Ca.dot(b[1],c),e=Ca.dot(b[2],c),f=Ca.dot(b[1],b[1]),g=e+f;return a-d/g};r<q;){o=y(x),p=Ca.sub(o[0],b);var A=Ca.norm(p),B=Ca.dot(o[1],p),C=Ca.norm(o[1])*A,D=B/C,E=A<s,F=Math.abs(D)<t;if(E&&F)return x;var G=z(x,o,p);G<u?G=w?v-(G-u):u:G>v&&(G=w?u+(G-v):v);var H=Ca.norm(Ca.mul(G-x,o[1]));if(H<s)return x;x=G,r++}return x},Da.rationalCurveParamAtArcLength=function(a,b,c,d,e){if(null==c&&(c=.001),b<S.EPSILON)return a.knots[0];var f;f=null!=d?d:La.decomposeCurveIntoBeziers(a);var g,h=0,i=(f[h],-S.EPSILON);for(g=null!=e?e:[];i<b&&h<f.length;){if(h<g.length?g[h]=g[h]:g[h]=Da.rationalBezierCurveArcLength(a),i+=g[h],b<i+S.EPSILON)return Da.rationalBezierCurveParamAtArcLength(a,b,c,g[h]);h++}return-1},Da.rationalBezierCurveParamAtArcLength=function(a,b,c,d){if(b<0)return a.knots[0];var e;if(e=null!=d?d:Da.rationalBezierCurveArcLength(a),b>e)return P.last(a.knots);var f,g=a.knots[0],h=0,i=P.last(a.knots),j=e,k=0,l=0;for(f=null!=c?c:2*S.TOLERANCE;j-h>f;)k=(g+i)/2,l=Da.rationalBezierCurveArcLength(a,k),l>b?(i=k,j=l):(g=k,h=l);return(g+i)/2},Da.rationalCurveArcLength=function(a,b,c){null==c&&(c=16),b=null==b?P.last(a.knots):b;for(var d=La.decomposeCurveIntoBeziers(a),e=0,f=d[0],g=0;e<d.length&&f.knots[0]+S.EPSILON<b;){var h=Math.min(P.last(f.knots),b);g+=Da.rationalBezierCurveArcLength(f,h,c),f=d[++e]}return g},Da.rationalBezierCurveArcLength=function(a,b,c){null==c&&(c=16);var d;d=null==b?P.last(a.knots):b;for(var e,f,g=(d-a.knots[0])/2,h=0,i=a.degree+c,j=0;j<i;){var k=j++;e=g*Da.Tvalues[i][k]+g+a.knots[0],f=Ia.rationalCurveDerivatives(a,e,1),h+=Da.Cvalues[i][k]*Ca.norm(f[1])}return g*h};var Ea=b.eval.KnotMultiplicity=function(a,b){this.knot=a,this.mult=b};g["verb.eval.KnotMultiplicity"]=Ea,Ea.__name__=["verb","eval","KnotMultiplicity"],Ea.prototype={inc:function(){this.mult++},__class__:Ea};var Fa=b.eval.Check=function(){};g["verb.eval.Check"]=Fa,Fa.__name__=["verb","eval","Check"],Fa.isValidKnotVector=function(a,b){if(0==a.length)return!1;if(a.length<2*(b+1))return!1;for(var c=P.first(a),d=0,e=b+1;d<e;){var f=d++;if(Math.abs(a[f]-c)>S.EPSILON)return!1}c=P.last(a);for(var g=a.length-b-1,h=a.length;g<h;){var i=g++;if(Math.abs(a[i]-c)>S.EPSILON)return!1}return Fa.isNonDecreasing(a)},Fa.isNonDecreasing=function(a){for(var b=P.first(a),c=0,d=a.length;c<d;){var e=c++;if(a[e]<b-S.EPSILON)return!1;b=a[e]}return!0},
   Fa.isValidNurbsCurveData=function(a){if(null==a.controlPoints)throw new C("Control points array cannot be null!");if(null==a.degree)throw new C("Degree cannot be null!");if(a.degree<1)throw new C("Degree must be greater than 1!");if(null==a.knots)throw new C("Knots cannot be null!");if(a.knots.length!=a.controlPoints.length+a.degree+1)throw new C("controlPoints.length + degree + 1 must equal knots.length!");if(!Fa.isValidKnotVector(a.knots,a.degree))throw new C("Invalid knot vector format!  Should begin with degree + 1 repeats and end with degree + 1 repeats!");return a},Fa.isValidNurbsSurfaceData=function(a){if(null==a.controlPoints)throw new C("Control points array cannot be null!");if(null==a.degreeU)throw new C("DegreeU cannot be null!");if(null==a.degreeV)throw new C("DegreeV cannot be null!");if(a.degreeU<1)throw new C("DegreeU must be greater than 1!");if(a.degreeV<1)throw new C("DegreeV must be greater than 1!");if(null==a.knotsU)throw new C("KnotsU cannot be null!");if(null==a.knotsV)throw new C("KnotsV cannot be null!");if(a.knotsU.length!=a.controlPoints.length+a.degreeU+1)throw new C("controlPointsU.length + degreeU + 1 must equal knotsU.length!");if(a.knotsV.length!=a.controlPoints[0].length+a.degreeV+1)throw new C("controlPointsV.length + degreeV + 1 must equal knotsV.length!");if(!Fa.isValidKnotVector(a.knotsU,a.degreeU)||!Fa.isValidKnotVector(a.knotsV,a.degreeV))throw new C("Invalid knot vector format!  Should begin with degree + 1 repeats and end with degree + 1 repeats!");return a};var Ga=b.eval.Divide=function(){};g["verb.eval.Divide"]=Ga,Ga.__name__=["verb","eval","Divide"],Ga.surfaceSplit=function(a,b,c){null==c&&(c=!1);var d,e,f;c?(f=a.controlPoints,d=a.knotsV,e=a.degreeV):(f=ta.transpose(a.controlPoints),d=a.knotsU,e=a.degreeU);for(var g,h=[],i=0,j=e+1;i<j;){i++;h.push(b)}g=h;for(var k=[],l=[],m=Ia.knotSpan(e,b,d),n=null,o=0;o<f.length;){var p=f[o];++o,n=La.curveKnotRefine(new W(e,d,p),g),k.push(n.controlPoints.slice(0,m+1)),l.push(n.controlPoints.slice(m+1))}var q=n.knots.slice(0,m+e+2),r=n.knots.slice(m+1);return c?[new X(a.degreeU,e,a.knotsU.slice(),q,k),new X(a.degreeU,e,a.knotsU.slice(),r,l)]:(k=ta.transpose(k),l=ta.transpose(l),[new X(e,a.degreeV,q,a.knotsV.slice(),k),new X(e,a.degreeV,r,a.knotsV.slice(),l)])},Ga.curveSplit=function(a,b){for(var c,d=a.degree,e=(a.controlPoints,a.knots),f=[],g=0,h=d+1;g<h;){g++;f.push(b)}c=f;var i=La.curveKnotRefine(a,c),j=Ia.knotSpan(d,b,e),k=i.knots.slice(0,j+d+2),l=i.knots.slice(j+1),m=i.controlPoints.slice(0,j+1),n=i.controlPoints.slice(j+1);return[new W(d,k,m),new W(d,l,n)]},Ga.rationalCurveByEqualArcLength=function(a,b){var c=Da.rationalCurveArcLength(a),d=c/b;return Ga.rationalCurveByArcLength(a,d)},Ga.rationalCurveByArcLength=function(a,b){var c=La.decomposeCurveIntoBeziers(a),d=c.map(function(a){return Da.rationalBezierCurveArcLength(a)}),e=Ca.sum(d),f=[new Ha(a.knots[0],0)];if(b>e)return f;for(var g,h=b,i=0,j=h,k=0,l=0;i<c.length;){for(k+=d[i];j<k+S.EPSILON;)g=Da.rationalBezierCurveParamAtArcLength(c[i],j-l,S.TOLERANCE,d[i]),f.push(new Ha(g,j)),j+=h;l+=d[i],i++}return f};var Ha=b.eval.CurveLengthSample=function(a,b){this.u=a,this.len=b};g["verb.eval.CurveLengthSample"]=Ha,Ha.__name__=["verb","eval","CurveLengthSample"],Ha.prototype={__class__:Ha};var Ia=b.eval.Eval=function(){};g["verb.eval.Eval"]=Ia,Ia.__name__=["verb","eval","Eval"],Ia.rationalCurveTangent=function(a,b){var c=Ia.rationalCurveDerivatives(a,b,1);return c[1]},Ia.rationalSurfaceNormal=function(a,b,c){var d=Ia.rationalSurfaceDerivatives(a,b,c,1);return Ca.cross(d[1][0],d[0][1])},Ia.rationalSurfaceDerivatives=function(a,b,c,d){null==d&&(d=1);for(var e=Ia.surfaceDerivatives(a,b,c,d),f=Ia.rational2d(e),g=Ia.weight2d(e),h=[],i=f[0][0].length,j=0,k=d+1;j<k;){var l=j++;h.push([]);for(var m=0,n=d-l+1;m<n;){for(var o=m++,p=f[l][o],q=1,r=o+1;q<r;){var s=q++;p=Ca.sub(p,Ca.mul(Q.get(o,s)*g[0][s],h[l][o-s]))}for(var t=1,u=l+1;t<u;){var v=t++;p=Ca.sub(p,Ca.mul(Q.get(l,v)*g[v][0],h[l-v][o]));for(var w=Ca.zeros1d(i),x=1,y=o+1;x<y;){var z=x++;w=Ca.add(w,Ca.mul(Q.get(o,z)*g[v][z],h[l-v][o-z]))}p=Ca.sub(p,Ca.mul(Q.get(l,v),w))}h[l].push(Ca.mul(1/g[0][0],p))}}return h},Ia.rationalSurfacePoint=function(a,b,c){return Ia.dehomogenize(Ia.surfacePoint(a,b,c))},Ia.rationalCurveDerivatives=function(a,b,c){null==c&&(c=1);for(var d=Ia.curveDerivatives(a,b,c),e=Ia.rational1d(d),f=Ia.weight1d(d),g=[],h=0,i=c+1;h<i;){for(var j=h++,k=e[j],l=1,m=j+1;l<m;){var n=l++;k=Ca.sub(k,Ca.mul(Q.get(j,n)*f[n],g[j-n]))}g.push(Ca.mul(1/f[0],k))}return g},Ia.rationalCurvePoint=function(a,b){return Ia.dehomogenize(Ia.curvePoint(a,b))},Ia.surfaceDerivatives=function(a,b,c,d){var e=a.knotsU.length-a.degreeU-2,f=a.knotsV.length-a.degreeV-2;return Ia.surfaceDerivativesGivenNM(e,f,a,b,c,d)},Ia.surfaceDerivativesGivenNM=function(a,b,c,d,e,f){var g=c.degreeU,h=c.degreeV,i=c.controlPoints,j=c.knotsU,k=c.knotsV;if(!Ia.areValidRelations(g,i.length,j.length)||!Ia.areValidRelations(h,i[0].length,k.length))throw new C("Invalid relations between control points, knot vector, and n");var l,m=i[0][0].length;l=f<g?f:g;var n;n=f<h?f:h;for(var o=Ca.zeros3d(f+1,f+1,m),p=Ia.knotSpanGivenN(a,g,d,j),q=Ia.knotSpanGivenN(b,h,e,k),r=Ia.derivativeBasisFunctionsGivenNI(p,d,g,a,j),s=Ia.derivativeBasisFunctionsGivenNI(q,e,h,b,k),t=Ca.zeros2d(h+1,m),u=0,v=0,w=l+1;v<w;){for(var x=v++,y=0,z=h+1;y<z;){var A=y++;t[A]=Ca.zeros1d(m);for(var B=0,D=g+1;B<D;){var E=B++;t[A]=Ca.add(t[A],Ca.mul(r[x][E],i[p-g+E][q-h+A]))}}var F=f-x;u=F<n?F:n;for(var G=0,H=u+1;G<H;){var I=G++;o[x][I]=Ca.zeros1d(m);for(var J=0,K=h+1;J<K;){var L=J++;o[x][I]=Ca.add(o[x][I],Ca.mul(s[I][L],t[L]))}}}return o},Ia.surfacePoint=function(a,b,c){var d=a.knotsU.length-a.degreeU-2,e=a.knotsV.length-a.degreeV-2;return Ia.surfacePointGivenNM(d,e,a,b,c)},Ia.surfacePointGivenNM=function(a,b,c,d,e){var f=c.degreeU,g=c.degreeV,h=c.controlPoints,i=c.knotsU,j=c.knotsV;if(!Ia.areValidRelations(f,h.length,i.length)||!Ia.areValidRelations(g,h[0].length,j.length))throw new C("Invalid relations between control points, knot vector, and n");for(var k=h[0][0].length,l=Ia.knotSpanGivenN(a,f,d,i),m=Ia.knotSpanGivenN(b,g,e,j),n=Ia.basisFunctionsGivenKnotSpanIndex(l,d,f,i),o=Ia.basisFunctionsGivenKnotSpanIndex(m,e,g,j),p=l-f,q=m,r=Ca.zeros1d(k),s=Ca.zeros1d(k),t=0,u=g+1;t<u;){var v=t++;s=Ca.zeros1d(k),q=m-g+v;for(var w=0,x=f+1;w<x;){var y=w++;s=Ca.add(s,Ca.mul(n[y],h[p+y][q]))}r=Ca.add(r,Ca.mul(o[v],s))}return r},Ia.curveDerivatives=function(a,b,c){var d=a.knots.length-a.degree-2;return Ia.curveDerivativesGivenN(d,a,b,c)},Ia.curveDerivativesGivenN=function(a,b,c,d){var e=b.degree,f=b.controlPoints,g=b.knots;if(!Ia.areValidRelations(e,f.length,g.length))throw new C("Invalid relations between control points, knot vector, and n");var h,i=f[0].length;h=d<e?d:e;for(var j=Ca.zeros2d(d+1,i),k=Ia.knotSpanGivenN(a,e,c,g),l=Ia.derivativeBasisFunctionsGivenNI(k,c,e,h,g),m=0,n=h+1;m<n;)for(var o=m++,p=0,q=e+1;p<q;){var r=p++;j[o]=Ca.add(j[o],Ca.mul(l[o][r],f[k-e+r]))}return j},Ia.curvePoint=function(a,b){var c=a.knots.length-a.degree-2;return Ia.curvePointGivenN(c,a,b)},Ia.areValidRelations=function(a,b,c){return b+a+1-c==0},Ia.curvePointGivenN=function(a,b,c){var d=b.degree,e=b.controlPoints,f=b.knots;if(!Ia.areValidRelations(d,e.length,f.length))throw new C("Invalid relations between control points, knot Array, and n");for(var g=Ia.knotSpanGivenN(a,d,c,f),h=Ia.basisFunctionsGivenKnotSpanIndex(g,c,d,f),i=Ca.zeros1d(e[0].length),j=0,k=d+1;j<k;){var l=j++;i=Ca.add(i,Ca.mul(h[l],e[g-d+l]))}return i},Ia.volumePoint=function(a,b,c,d){var e=a.knotsU.length-a.degreeU-2,f=a.knotsV.length-a.degreeV-2,g=a.knotsW.length-a.degreeW-2;return Ia.volumePointGivenNML(a,e,f,g,b,c,d)},Ia.volumePointGivenNML=function(a,b,c,d,e,f,g){if(!Ia.areValidRelations(a.degreeU,a.controlPoints.length,a.knotsU.length)||!Ia.areValidRelations(a.degreeV,a.controlPoints[0].length,a.knotsV.length)||!Ia.areValidRelations(a.degreeW,a.controlPoints[0][0].length,a.knotsW.length))throw new C("Invalid relations between control points and knot vector");for(var h=a.controlPoints,i=a.degreeU,j=a.degreeV,k=a.degreeW,l=a.knotsU,m=a.knotsV,n=a.knotsW,o=h[0][0][0].length,p=Ia.knotSpanGivenN(b,i,e,l),q=Ia.knotSpanGivenN(c,j,f,m),r=Ia.knotSpanGivenN(d,k,g,n),s=Ia.basisFunctionsGivenKnotSpanIndex(p,e,i,l),t=Ia.basisFunctionsGivenKnotSpanIndex(q,f,j,m),u=Ia.basisFunctionsGivenKnotSpanIndex(r,g,k,n),v=p-i,w=Ca.zeros1d(o),x=Ca.zeros1d(o),y=Ca.zeros1d(o),z=0,A=k+1;z<A;){var B=z++;y=Ca.zeros1d(o);for(var D=r-k+B,E=0,F=j+1;E<F;){var G=E++;x=Ca.zeros1d(o);for(var H=q-j+G,I=0,J=i+1;I<J;){var K=I++;x=Ca.add(x,Ca.mul(s[K],h[v+K][H][D]))}y=Ca.add(y,Ca.mul(t[G],x))}w=Ca.add(w,Ca.mul(u[B],y))}return w},Ia.derivativeBasisFunctions=function(a,b,c){var d=Ia.knotSpan(b,a,c),e=c.length-1,f=e-b-1;return Ia.derivativeBasisFunctionsGivenNI(d,a,b,f,c)},Ia.derivativeBasisFunctionsGivenNI=function(a,b,c,d,e){var f=Ca.zeros2d(c+1,c+1),g=Ca.zeros1d(c+1),h=Ca.zeros1d(c+1),i=0,j=0;f[0][0]=1;for(var k=1,l=c+1;k<l;){var m=k++;g[m]=b-e[a+1-m],h[m]=e[a+m]-b,i=0;for(var n=0;n<m;){var o=n++;f[m][o]=h[o+1]+g[m-o],j=f[o][m-1]/f[m][o],f[o][m]=i+h[o+1]*j,i=g[m-o]*j}f[m][m]=i}for(var p=Ca.zeros2d(d+1,c+1),q=Ca.zeros2d(2,c+1),r=0,s=1,t=0,u=0,v=0,w=0,x=0,y=0,z=c+1;y<z;){var A=y++;p[0][A]=f[A][c]}for(var B=0,C=c+1;B<C;){var D=B++;r=0,s=1,q[0][0]=1;for(var E=1,F=d+1;E<F;){var G=E++;t=0,u=D-G,v=c-G,D>=G&&(q[s][0]=q[r][0]/f[v+1][u],t=q[s][0]*f[u][v]),w=u>=-1?1:-u,x=D-1<=v?G-1:c-D;for(var H=w,I=x+1;H<I;){var J=H++;q[s][J]=(q[r][J]-q[r][J-1])/f[v+1][u+J],t+=q[s][J]*f[u+J][v]}D<=v&&(q[s][G]=-q[r][G-1]/f[v+1][D],t+=q[s][G]*f[D][v]),p[G][D]=t;var K=r;r=s,s=K}}for(var L=c,M=1,N=d+1;M<N;){for(var O=M++,P=0,Q=c+1;P<Q;){var R=P++;p[O][R]*=L}L*=c-O}return p},Ia.basisFunctions=function(a,b,c){var d=Ia.knotSpan(b,a,c);return Ia.basisFunctionsGivenKnotSpanIndex(d,a,b,c)},Ia.basisFunctionsGivenKnotSpanIndex=function(a,b,c,d){var e=Ca.zeros1d(c+1),f=Ca.zeros1d(c+1),g=Ca.zeros1d(c+1),h=0,i=0;e[0]=1;for(var j=1,k=c+1;j<k;){var l=j++;f[l]=b-d[a+1-l],g[l]=d[a+l]-b,h=0;for(var m=0;m<l;){var n=m++;i=e[n]/(g[n+1]+f[l-n]),e[n]=h+g[n+1]*i,h=f[l-n]*i}e[l]=h}return e},Ia.knotSpan=function(a,b,c){return Ia.knotSpanGivenN(c.length-a-2,a,b,c)},Ia.knotSpanGivenN=function(a,b,c,d){if(c>d[a+1]-S.EPSILON)return a;if(c<d[b]+S.EPSILON)return b;for(var e=b,f=a+1,g=Math.floor((e+f)/2);c<d[g]||c>=d[g+1];)c<d[g]?f=g:e=g,g=Math.floor((e+f)/2);return g},Ia.dehomogenize=function(a){for(var b=a.length,c=[],d=a[b-1],e=a.length-1,f=0;f<e;){var g=f++;c.push(a[g]/d)}return c},Ia.rational1d=function(a){var b=a[0].length-1;return a.map(function(a){return a.slice(0,b)})},Ia.rational2d=function(a){return a.map(Ia.rational1d)},Ia.weight1d=function(a){var b=a[0].length-1;return a.map(function(a){return a[b]})},Ia.weight2d=function(a){return a.map(Ia.weight1d)},Ia.dehomogenize1d=function(a){return a.map(Ia.dehomogenize)},Ia.dehomogenize2d=function(a){return a.map(Ia.dehomogenize1d)},Ia.homogenize1d=function(a,b){var c,d=a.length,e=a[0].length,f=[],g=0,h=[];c=null!=b?b:Ca.rep(a.length,1);for(var i=0;i<d;){var j=i++,k=[];h=a[j],g=c[j];for(var l=0;l<e;){var m=l++;k.push(h[m]*g)}k.push(g),f.push(k)}return f},Ia.homogenize2d=function(a,b){var c,d=a.length,e=[];if(null!=b)c=b;else{for(var f=[],g=0;g<d;){g++;f.push(Ca.rep(a[0].length,1))}c=f}for(var h=0;h<d;){var i=h++;e.push(Ia.homogenize1d(a[i],c[i]))}return e};var Ja=b.eval.Intersect=function(){};g["verb.eval.Intersect"]=Ja,Ja.__name__=["verb","eval","Intersect"],Ja.surfaces=function(a,b,c){var d=Ma.rationalSurfaceAdaptive(a),e=Ma.rationalSurfaceAdaptive(b),f=Ja.meshes(d,e),g=f.map(function(d){return d.map(function(d){return Ja.surfacesAtPointWithEstimate(a,b,d.uv0,d.uv1,c)})});return g.map(function(a){return Ka.rationalInterpCurve(a.map(function(a){return a.point}),3)})},Ja.surfacesAtPointWithEstimate=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s=5,t=0;do{if(f=Ia.rationalSurfaceDerivatives(a,c[0],c[1],1),g=f[0][0],i=f[1][0],j=f[0][1],h=Ca.normalized(Ca.cross(i,j)),k=Ca.dot(h,g),l=Ia.rationalSurfaceDerivatives(b,d[0],d[1],1),m=l[0][0],o=l[1][0],p=l[0][1],n=Ca.normalized(Ca.cross(o,p)),q=Ca.dot(n,m),r=Ca.distSquared(g,m),r<e*e)break;var u=Ca.normalized(Ca.cross(h,n)),v=Ca.dot(u,g),w=Ja.threePlanes(h,k,n,q,u,v);if(null==w)throw new C("panic!");var x=Ca.sub(w,g),y=Ca.sub(w,m),z=Ca.cross(i,h),A=Ca.cross(j,h),B=Ca.cross(o,n),D=Ca.cross(p,n),E=Ca.dot(A,x)/Ca.dot(A,i),F=Ca.dot(z,x)/Ca.dot(z,j),G=Ca.dot(D,y)/Ca.dot(D,o),H=Ca.dot(B,y)/Ca.dot(B,p);c=Ca.add([E,F],c),d=Ca.add([G,H],d),t++}while(t<s);return new fa(c,d,g,r)},Ja.meshes=function(a,b,c,d){null==c&&(c=new qa(a)),null==d&&(d=new qa(b));var e=Ja.boundingBoxTrees(c,d,0),f=P.unique(e.map(function(c){return Ja.triangles(a,c.item0,b,c.item1)}).filter(function(a){return null!=a}).filter(function(a){return Ca.distSquared(a.min.point,a.max.point)>S.EPSILON}),function(a,b){var c=Ca.sub(a.min.uv0,b.min.uv0),d=Ca.dot(c,c),e=Ca.sub(a.max.uv0,b.max.uv0),f=Ca.dot(e,e),g=Ca.sub(a.min.uv0,b.max.uv0),h=Ca.dot(g,g),i=Ca.sub(a.max.uv0,b.min.uv0),j=Ca.dot(i,i);return d<S.EPSILON&&f<S.EPSILON||h<S.EPSILON&&j<S.EPSILON});return Ja.makeMeshIntersectionPolylines(f)},Ja.meshSlices=function(a,b,c,d){for(var e=new wa(a),f=e.boundingBox(),g=f.min[0],h=f.min[1],i=f.max[0],j=f.max[1],k=Ca.span(b,c,d),l=[],m=0;m<k.length;){var n=k[m];++m;var o=[[g,h,n],[i,h,n],[i,j,n],[g,j,n]],p=[[0,0],[1,0],[1,1],[0,1]],q=[[0,1,2],[0,2,3]],r=new Y(q,o,null,p);l.push(Ja.meshes(a,r,e))}return l},Ja.makeMeshIntersectionPolylines=function(a){if(0==a.length)return[];for(var b=0;b<a.length;){var c=a[b];++b,c.max.opp=c.min,c.min.opp=c.max}for(var d=Ja.kdTreeFromSegments(a),e=[],f=0;f<a.length;){var g=a[f];++f,e.push(g.min),e.push(g.max)}for(var h=0;h<e.length;){var i=e[h];if(++h,null==i.adj){var j=Ja.lookupAdjacentSegment(i,d,a.length);null!=j&&null==j.adj&&(i.adj=j,j.adj=i)}}var k=e.filter(function(a){return null==a.adj});0==k.length&&(k=e);for(var l=[],m=0,n=!1;0!=k.length;){var o=k.pop();if(!o.visited){for(var p=[],q=o;null!=q&&!q.visited&&(q.visited=!0,q.opp.visited=!0,p.push(q),m+=2,q=q.opp.adj,q!=o););p.length>0&&(p.push(p[p.length-1].opp),l.push(p))}if(0==k.length&&e.length>0&&(n||m<e.length)){n=!0;var r=e.pop();k.push(r)}}return l},Ja.kdTreeFromSegments=function(a){for(var b=[],c=0;c<a.length;){var d=a[c];++c,b.push(new ma(d.min.point,d.min)),b.push(new ma(d.max.point,d.max))}return new ka(b,Ca.distSquared)},Ja.lookupAdjacentSegment=function(a,b,c){var d=b.nearest(a.point,c,S.EPSILON).filter(function(b){return a!=b.item0.obj}).map(function(a){return a.item0.obj});return 1==d.length?d[0]:null},Ja.curveAndSurface=function(a,b,c,d,e){null==c&&(c=.001),d=null!=d?d:new pa(a),e=null!=e?e:new sa(b);var f=Ja.boundingBoxTrees(d,e,c);return P.unique(f.map(function(a){var b=a.item0,d=a.item1,e=P.first(b.knots),f=P.last(b.knots),g=(e+f)/2,h=P.first(d.knotsU),i=P.last(d.knotsU),j=P.first(d.knotsV),k=P.last(d.knotsV),l=[(h+i)/2,(j+k)/2];return Ja.curveAndSurfaceWithEstimate(b,d,[g].concat(l),c)}).filter(function(a){return Ca.distSquared(a.curvePoint,a.surfacePoint)<c*c}),function(a,b){return Math.abs(a.u-b.u)<.5*c})},Ja.curveAndSurfaceWithEstimate=function(a,b,c,d){null==d&&(d=.001);var e=function(c){var d=Ia.rationalCurvePoint(a,c[0]),e=Ia.rationalSurfacePoint(b,c[1],c[2]),f=Ca.sub(d,e);return Ca.dot(f,f)},f=function(c){var d=Ia.rationalCurveDerivatives(a,c[0],1),e=Ia.rationalSurfaceDerivatives(b,c[1],c[2],1),f=Ca.sub(e[0][0],d[0]),g=Ca.mul(-1,d[1]),h=e[1][0],i=e[0][1];return[2*Ca.dot(g,f),2*Ca.dot(h,f),2*Ca.dot(i,f)]},g=xa.uncmin(e,c,d*d,f),h=g.solution;return new ca(h[0],[h[1],h[2]],Ia.rationalCurvePoint(a,h[0]),Ia.rationalSurfacePoint(b,h[1],h[2]))},Ja.polylineAndMesh=function(a,b,c){for(var d=Ja.boundingBoxTrees(new ra(a),new qa(b),c),e=[],f=0;f<d.length;){var g=d[f];++f;var h=g.item0,i=g.item1,j=Ja.segmentWithTriangle(a.points[h],a.points[h+1],b.points,b.faces[i]);if(null!=j){var k=j.point,l=Ca.lerp(j.p,[a.params[h]],[a.params[h+1]])[0],m=va.triangleUVFromPoint(b,i,k);e.push(new ea(k,l,m,h,i))}}return e},Ja.boundingBoxTrees=function(a,b,c){null==c&&(c=1e-9);var d=[],e=[];d.push(a),e.push(b);for(var f=[];d.length>0;){var g=d.pop(),h=e.pop();if(!g.empty()&&!h.empty()&&g.boundingBox().intersects(h.boundingBox(),c)){var i=g.indivisible(c),j=h.indivisible(c);if(i&&j)f.push(new _(g.yield(),h.yield()));else if(!i||j)if(i||!j){var k=g.split(),l=h.split();d.push(k.item1),e.push(l.item1),d.push(k.item1),e.push(l.item0),d.push(k.item0),e.push(l.item1),d.push(k.item0),e.push(l.item0)}else{var m=g.split();d.push(m.item1),e.push(h),d.push(m.item0),e.push(h)}else{var n=h.split();d.push(g),e.push(n.item1),d.push(g),e.push(n.item0)}}}return f},Ja.curves=function(a,b,c){var d=Ja.boundingBoxTrees(new pa(a),new pa(b),0);return P.unique(d.map(function(d){return Ja.curvesWithEstimate(a,b,P.first(d.item0.knots),P.first(d.item1.knots),c)}).filter(function(a){return Ca.distSquared(a.point0,a.point1)<c}),function(a,b){return Math.abs(a.u0-b.u0)<5*c})},Ja.curvesWithEstimate=function(a,b,c,d,e){var f=function(c){var d=Ia.rationalCurvePoint(a,c[0]),e=Ia.rationalCurvePoint(b,c[1]),f=Ca.sub(d,e);return Ca.dot(f,f)},g=function(c){var d=Ia.rationalCurveDerivatives(a,c[0],1),e=Ia.rationalCurveDerivatives(b,c[1],1),f=Ca.sub(d[0],e[0]),g=d[1],h=Ca.mul(-1,e[1]);return[2*Ca.dot(g,f),2*Ca.dot(h,f)]},h=xa.uncmin(f,[c,d],e*e,g),i=h.solution[0],j=h.solution[1],k=Ia.rationalCurvePoint(a,i),l=Ia.rationalCurvePoint(b,j);return new ba(k,l,i,j)},Ja.triangles=function(a,b,c,d){var e=a.faces[b],f=c.faces[d],g=va.getTriangleNorm(a.points,e),h=va.getTriangleNorm(c.points,f),i=a.points[e[0]],j=c.points[f[0]],k=Ja.planes(i,g,j,h);if(null==k)return null;var l=Ja.clipRayInCoplanarTriangle(k,a,b);if(null==l)return null;var m=Ja.clipRayInCoplanarTriangle(k,c,d);if(null==m)return null;var n=Ja.mergeTriangleClipIntervals(l,m,a,b,c,d);return null==n?null:new aa(new da(n.min.uv0,n.min.uv1,n.min.point,b,d),new da(n.max.uv0,n.max.uv1,n.max.point,b,d))},Ja.clipRayInCoplanarTriangle=function(a,b,c){for(var d=b.faces[c],e=[b.points[d[0]],b.points[d[1]],b.points[d[2]]],f=[b.uvs[d[0]],b.uvs[d[1]],b.uvs[d[2]]],g=[Ca.sub(f[1],f[0]),Ca.sub(f[2],f[1]),Ca.sub(f[0],f[2])],h=[Ca.sub(e[1],e[0]),Ca.sub(e[2],e[1]),Ca.sub(e[0],e[2])],i=h.map(Ca.normalized),j=h.map(Ca.norm),k=null,l=null,m=0;m<3;){var n=m++,o=e[n],p=i[n],q=Ja.rays(o,p,a.origin,a.dir);if(null!=q){var r=q.u0,s=q.u1;r<-S.EPSILON||r>j[n]+S.EPSILON||((null==k||s<k.u)&&(k=new ha(s,Ca.onRay(a.origin,a.dir,s),Ca.onRay(f[n],g[n],r/j[n]))),(null==l||s>l.u)&&(l=new ha(s,Ca.onRay(a.origin,a.dir,s),Ca.onRay(f[n],g[n],r/j[n]))))}}return null==l||null==k?null:new aa(k,l)},Ja.mergeTriangleClipIntervals=function(a,b,c,d,e,f){if(b.min.u>a.max.u+S.EPSILON||a.min.u>b.max.u+S.EPSILON)return null;var g;g=a.min.u>b.min.u?new _(a.min,0):new _(b.min,1);var h;h=a.max.u<b.max.u?new _(a.max,0):new _(b.max,1);var i=new aa(new da(null,null,g.item0.point,d,f),new da(null,null,h.item0.point,d,f));return 0==g.item1?(i.min.uv0=g.item0.uv,i.min.uv1=va.triangleUVFromPoint(e,f,g.item0.point)):(i.min.uv0=va.triangleUVFromPoint(c,d,g.item0.point),i.min.uv1=g.item0.uv),0==h.item1?(i.max.uv0=h.item0.uv,i.max.uv1=va.triangleUVFromPoint(e,f,h.item0.point)):(i.max.uv0=va.triangleUVFromPoint(c,d,h.item0.point),i.max.uv1=h.item0.uv),i},Ja.planes=function(a,b,c,d){var e=Ca.cross(b,d);if(Ca.dot(e,e)<S.EPSILON)return null;var f=0,g=Math.abs(e[0]),h=Math.abs(e[1]),i=Math.abs(e[2]);h>g&&(f=1,g=h),i>g&&(f=2,g=i);var j,k,l,m;0==f?(j=b[1],k=b[2],l=d[1],m=d[2]):1==f?(j=b[0],k=b[2],l=d[0],m=d[2]):(j=b[0],k=b[1],l=d[0],m=d[1]);var n,o=-Ca.dot(a,b),p=-Ca.dot(c,d),q=j*m-k*l,r=(k*p-o*m)/q,s=(o*l-j*p)/q;return n=0==f?[0,r,s]:1==f?[r,0,s]:[r,s,0],new V(n,Ca.normalized(e))},Ja.threePlanes=function(a,b,c,d,e,f){var g=Ca.cross(c,e),h=Ca.dot(a,g);if(Math.abs(h)<S.EPSILON)return null;var i=Ca.sub(Ca.mul(f,c),Ca.mul(d,e)),j=Ca.add(Ca.mul(b,g),Ca.cross(a,i));return Ca.mul(1/h,j)},Ja.polylines=function(a,b,c){for(var d=Ja.boundingBoxTrees(new ra(a),new ra(b),c),e=[],f=0;f<d.length;){var g=d[f];++f;var h=g.item0,i=g.item1,j=Ja.segments(a.points[h],a.points[h+1],b.points[i],b.points[i+1],c);null!=j&&(j.u0=Ca.lerp(j.u0,[a.params[h]],[a.params[h+1]])[0],j.u1=Ca.lerp(j.u1,[b.params[i]],[b.params[i+1]])[0],e.push(j))}return e},Ja.segments=function(a,b,c,d,e){var f=Ca.sub(b,a),g=Math.sqrt(Ca.dot(f,f)),h=Ca.mul(1/g,f),i=Ca.sub(d,c),j=Math.sqrt(Ca.dot(i,i)),k=Ca.mul(1/j,i),l=Ja.rays(a,h,c,k);if(null!=l){var m=Math.min(Math.max(0,l.u0/g),1),n=Math.min(Math.max(0,l.u1/j),1),o=Ca.onRay(a,f,m),p=Ca.onRay(c,i,n),q=Ca.distSquared(o,p);if(q<e*e)return new ba(o,p,m,n)}return null},Ja.rays=function(a,b,c,d){var e=Ca.dot(b,d),f=Ca.dot(b,c),g=Ca.dot(b,a),h=Ca.dot(d,c),i=Ca.dot(d,a),j=Ca.dot(b,b),k=Ca.dot(d,d),l=j*k-e*e;if(Math.abs(l)<S.EPSILON)return null;var m=e*(f-g)-j*(h-i),n=m/l,o=(f-g+n*e)/j,p=Ca.onRay(a,b,o),q=Ca.onRay(c,d,n);return new ba(p,q,o,n)},Ja.segmentWithTriangle=function(a,b,c,d){var e=c[d[0]],f=c[d[1]],g=c[d[2]],h=Ca.sub(f,e),i=Ca.sub(g,e),j=Ca.cross(h,i),k=Ca.sub(b,a),l=Ca.sub(a,e),m=-Ca.dot(j,l),n=Ca.dot(j,k);if(Math.abs(n)<S.EPSILON)return null;var o=m/n;if(o<0||o>1)return null;var p=Ca.add(a,Ca.mul(o,k)),q=Ca.dot(h,i),r=Ca.dot(h,h),s=Ca.dot(i,i),t=Ca.sub(p,e),u=Ca.dot(t,h),v=Ca.dot(t,i),w=q*q-r*s;if(Math.abs(w)<S.EPSILON)return null;var x=(q*v-s*u)/w,y=(q*u-r*v)/w;return x>1+S.EPSILON||y>1+S.EPSILON||y<-S.EPSILON||x<-S.EPSILON||x+y>1+S.EPSILON?null:new ga(p,x,y,o)},Ja.segmentAndPlane=function(a,b,c,d){var e=Ca.dot(d,Ca.sub(b,a));if(Math.abs(e)<S.EPSILON)return null;var f=Ca.dot(d,Ca.sub(c,a)),g=f/e;return g>1+S.EPSILON||g<-S.EPSILON?null:{p:g}};var Ka=b.eval.Make=function(){};g["verb.eval.Make"]=Ka,Ka.__name__=["verb","eval","Make"],Ka.rationalTranslationalSurface=function(a,b){for(var c=Ia.rationalCurvePoint(b,P.first(b.knots)),d=P.first(b.knots),e=P.last(b.knots),f=2*b.controlPoints.length,g=(e-d)/(f-1),h=[],i=0;i<f;){var j=i++,k=Ca.sub(Ia.rationalCurvePoint(b,d+j*g),c),l=La.rationalCurveTransform(a,[[1,0,0,k[0]],[0,1,0,k[1]],[0,0,1,k[2]],[0,0,0,1]]);h.push(l)}return Ka.loftedSurface(h)},Ka.surfaceBoundaryCurves=function(a){var b=Ka.surfaceIsocurve(a,P.first(a.knotsU),!1),c=Ka.surfaceIsocurve(a,P.last(a.knotsU),!1),d=Ka.surfaceIsocurve(a,P.first(a.knotsV),!0),e=Ka.surfaceIsocurve(a,P.last(a.knotsV),!0);return[b,c,d,e]},Ka.surfaceIsocurve=function(a,b,c){null==c&&(c=!1);var d;d=c?a.knotsV:a.knotsU;var e;e=c?a.degreeV:a.degreeU;for(var f=Da.knotMultiplicities(d),g=-1,h=0,i=f.length;h<i;){var j=h++;if(Math.abs(b-f[j].knot)<S.EPSILON){g=j;break}}var k=e+1;g>=0&&(k-=f[g].mult);var l;l=k>0?La.surfaceKnotRefine(a,Ca.rep(k,b),c):a;var m=Ia.knotSpan(e,b,d);return Math.abs(b-P.first(d))<S.EPSILON?m=0:Math.abs(b-P.last(d))<S.EPSILON&&(m=(c?l.controlPoints[0].length:l.controlPoints.length)-1),c?new W(l.degreeU,l.knotsU,function(a){for(var b,c=[],d=0,e=l.controlPoints;d<e.length;){var f=e[d];++d,c.push(f[m])}return b=c}(this)):new W(l.degreeV,l.knotsV,l.controlPoints[m])},Ka.loftedSurface=function(a,b){a=La.unifyCurveKnotVectors(a);var c=a[0].degree;null==b&&(b=3),b>a.length-1&&(b=a.length-1);for(var d=a[0].knots,e=[],f=[],g=0,h=a[0].controlPoints.length;g<h;){var i=[g++],j=a.map(function(a){return function(b){return b.controlPoints[a[0]]}}(i)),k=Ka.rationalInterpCurve(j,b,!0);f.push(k.controlPoints),e=k.knots}return new X(c,b,d,e,f)},Ka.clonedCurve=function(a){return new W(a.degree,a.knots.slice(),a.controlPoints.map(function(a){return a.slice()}))},Ka.rationalBezierCurve=function(a,b){for(var c=a.length-1,d=[],e=0,f=c+1;e<f;){e++;d.push(0)}for(var g=0,h=c+1;g<h;){g++;d.push(1)}return null==b&&(b=Ca.rep(a.length,1)),new W(c,d,Ia.homogenize1d(a,b))},Ka.fourPointSurface=function(a,b,c,d,e){null==e&&(e=3);for(var f=e,g=[],h=0,i=e+1;h<i;){for(var j=h++,k=[],l=0,m=e+1;l<m;){var n=l++,o=1-j/f,p=Ca.lerp(o,a,b),q=Ca.lerp(o,d,c),r=Ca.lerp(1-n/f,p,q);r.push(1),k.push(r)}g.push(k)}var s=Ca.rep(e+1,0),t=Ca.rep(e+1,1);return new X(e,e,s.concat(t),s.concat(t),g)},Ka.ellipseArc=function(a,b,c,d,e){var f=Ca.norm(b),g=Ca.norm(c);b=Ca.normalized(b),c=Ca.normalized(c),e<d&&(e=2*Math.PI+d);var h=e-d,i=0;i=h<=Math.PI/2?1:h<=Math.PI?2:h<=3*Math.PI/2?3:4;var j=h/i,k=Math.cos(j/2),l=Ca.add(a,Ca.add(Ca.mul(f*Math.cos(d),b),Ca.mul(g*Math.sin(d),c))),m=Ca.sub(Ca.mul(Math.cos(d),c),Ca.mul(Math.sin(d),b)),n=[],o=Ca.zeros1d(2*i+3),p=0,q=d,r=Ca.zeros1d(2*i);n[0]=l,r[0]=1;for(var s=1,t=i+1;s<t;){var u=s++;q+=j;var v=Ca.add(a,Ca.add(Ca.mul(f*Math.cos(q),b),Ca.mul(g*Math.sin(q),c)));r[p+2]=1,n[p+2]=v;var w=Ca.sub(Ca.mul(Math.cos(q),c),Ca.mul(Math.sin(q),b)),x=Ja.rays(l,Ca.mul(1/Ca.norm(m),m),v,Ca.mul(1/Ca.norm(w),w)),y=Ca.add(l,Ca.mul(x.u0,m));r[p+1]=k,n[p+1]=y,p+=2,u<i&&(l=v,m=w)}for(var z=2*i+1,A=0;A<3;){var B=A++;o[B]=0,o[B+z]=1}switch(i){case 2:o[3]=o[4]=.5;break;case 3:o[3]=o[4]=.3333333333333333,o[5]=o[6]=.6666666666666666;break;case 4:o[3]=o[4]=.25,o[5]=o[6]=.5,o[7]=o[8]=.75}return new W(2,o,Ia.homogenize1d(n,r))},Ka.arc=function(a,b,c,d,e,f){return Ka.ellipseArc(a,Ca.mul(d,Ca.normalized(b)),Ca.mul(d,Ca.normalized(c)),e,f)},Ka.polyline=function(a){for(var b=[0,0],c=0,d=0,e=a.length-1;d<e;){var f=d++;c+=Ca.dist(a[f],a[f+1]),b.push(c)}b.push(c),b=Ca.mul(1/c,b);for(var g,h=[],i=0,j=a.length;i<j;){i++;h.push(1)}return g=h,new W(1,b,Ia.homogenize1d(a.slice(0),g))},Ka.extrudedSurface=function(a,b,c){for(var d=[[],[],[]],e=[[],[],[]],f=Ia.dehomogenize1d(c.controlPoints),g=Ia.weight1d(c.controlPoints),h=Ca.mul(b,a),i=Ca.mul(.5*b,a),j=0,k=f.length;j<k;){var l=j++;d[2][l]=f[l],d[1][l]=Ca.add(i,f[l]),d[0][l]=Ca.add(h,f[l]),e[0][l]=g[l],e[1][l]=g[l],e[2][l]=g[l]}return new X(2,c.degree,[0,0,0,1,1,1],c.knots,Ia.homogenize2d(d,e))},Ka.cylindricalSurface=function(a,b,c,d,e){var f=Ca.cross(a,b),g=(2*Math.PI,Ka.arc(c,b,f,e,0,2*Math.PI));return Ka.extrudedSurface(a,d,g)},Ka.revolvedSurface=function(a,b,c,d){var e,f,g=Ia.dehomogenize1d(a.controlPoints),h=Ia.weight1d(a.controlPoints);d<=Math.PI/2?(e=1,f=Ca.zeros1d(6+2*(e-1))):d<=Math.PI?(e=2,f=Ca.zeros1d(6+2*(e-1)),f[3]=f[4]=.5):d<=3*Math.PI/2?(e=3,f=Ca.zeros1d(6+2*(e-1)),f[3]=f[4]=.3333333333333333,f[5]=f[6]=.6666666666666666):(e=4,f=Ca.zeros1d(6+2*(e-1)),f[3]=f[4]=.25,f[5]=f[6]=.5,f[7]=f[8]=.75);for(var i=d/e,j=3+2*(e-1),k=0;k<3;){var l=k++;f[l]=0,f[j+l]=1}for(var m=Math.cos(i/2),n=0,o=Ca.zeros1d(e+1),p=Ca.zeros1d(e+1),q=Ca.zeros3d(2*e+1,g.length,3),r=Ca.zeros2d(2*e+1,g.length),s=1,t=e+1;s<t;){var u=s++;n+=i,p[u]=Math.cos(n),o[u]=Math.sin(n)}for(var v=0,w=g.length;v<w;){var x=v++,y=Ba.rayClosestPoint(g[x],b,c),z=Ca.sub(g[x],y),A=Ca.norm(z),B=Ca.cross(c,z);A>S.EPSILON&&(z=Ca.mul(1/A,z),B=Ca.mul(1/A,B)),q[0][x]=g[x];var C=g[x];r[0][x]=h[x];for(var D=B,E=0,F=1,G=e+1;F<G;){var H,I=F++;H=0==A?y:Ca.add(y,Ca.add(Ca.mul(A*p[I],z),Ca.mul(A*o[I],B))),q[E+2][x]=H,r[E+2][x]=h[x];var J=Ca.sub(Ca.mul(p[I],B),Ca.mul(o[I],z));if(0==A)q[E+1][x]=y;else{var K=Ja.rays(C,Ca.mul(1/Ca.norm(D),D),H,Ca.mul(1/Ca.norm(J),J)),L=Ca.add(C,Ca.mul(K.u0,D));q[E+1][x]=L}r[E+1][x]=m*h[x],E+=2,I<e&&(C=H,D=J)}}return new X(2,a.degree,f,a.knots,Ia.homogenize2d(q,r))},Ka.sphericalSurface=function(a,b,c,d){var e=Ka.arc(a,Ca.mul(-1,b),c,d,0,Math.PI);return Ka.revolvedSurface(e,a,b,2*Math.PI)},Ka.conicalSurface=function(a,b,c,d,e){var f=2*Math.PI,g=1,h=[Ca.add(c,Ca.mul(d,a)),Ca.add(c,Ca.mul(e,b))],i=[0,0,1,1],j=[1,1],k=new W(g,i,Ia.homogenize1d(h,j));return Ka.revolvedSurface(k,c,a,f)},Ka.rationalInterpCurve=function(a,b,c,d,e){if(null==c&&(c=!1),null==b&&(b=3),a.length<b+1)throw new C("You need to supply at least degree + 1 points! You only supplied "+a.length+" points.");for(var f=[0],g=1,h=a.length;g<h;){var i=g++,j=Ca.norm(Ca.sub(a[i],a[i-1])),k=f[f.length-1];f.push(k+j)}for(var l=f[f.length-1],m=0,n=f.length;m<n;){var o=m++;f[o]=f[o]/l}var p,q=Ca.rep(b+1,0),r=null!=d&&null!=e;p=r?0:1;var s;s=r?f.length-b+1:f.length-b;for(var t=p;t<s;){for(var u=t++,v=0,w=0;w<b;){var x=w++;v+=f[u+x]}q.push(1/b*v)}var y,z=q.concat(Ca.rep(b+1,1)),A=[];y=r?a.length+1:a.length-1;var B;B=r?1:0;var D;D=r?a.length-(b-1):a.length-(b+1);for(var E=0;E<f.length;){var F=f[E];++E;var G=Ia.knotSpanGivenN(y,b,F,z),H=Ia.basisFunctionsGivenKnotSpanIndex(G,F,b,z),I=G-b,J=Ca.zeros1d(I),K=Ca.zeros1d(D-I);A.push(J.concat(H).concat(K))}if(r){var L=A[0].length-2,M=[-1,1].concat(Ca.zeros1d(L)),N=Ca.zeros1d(L).concat([-1,1]);P.spliceAndInsert(A,1,0,M),P.spliceAndInsert(A,A.length-1,0,N)}for(var O=a[0].length,Q=[],R=(1-z[z.length-b-2])/b,S=z[b+1]/b,T=0;T<O;){var U,V=[T++];if(r){U=[a[0][V[0]]],U.push(S*d[V[0]]);for(var X=1,Y=a.length-1;X<Y;){var Z=X++;U.push(a[Z][V[0]])}U.push(R*e[V[0]]),U.push(P.last(a)[V[0]])}else U=a.map(function(a){return function(b){return b[a[0]]}}(V));var $=ta.solve(A,U);Q.push($)}var _=ta.transpose(Q);if(!c){var aa=Ca.rep(_.length,1);_=Ia.homogenize1d(_,aa)}return new W(b,z,_)};var La=b.eval.Modify=function(){};g["verb.eval.Modify"]=La,La.__name__=["verb","eval","Modify"],La.curveReverse=function(a){return new W(a.degree,La.knotsReverse(a.knots),P.reversed(a.controlPoints))},La.surfaceReverse=function(a,b){return null==b&&(b=!1),b?new X(a.degreeU,a.degreeV,a.knotsU,La.knotsReverse(a.knotsV),function(b){for(var c,d=[],e=0,f=a.controlPoints;e<f.length;){var g=f[e];++e,d.push(P.reversed(g))}return c=d}(this)):new X(a.degreeU,a.degreeV,La.knotsReverse(a.knotsU),a.knotsV,P.reversed(a.controlPoints))},La.knotsReverse=function(a){for(var b=P.first(a),c=(P.last(a),[b]),d=a.length,e=1;e<d;){var f=e++;c.push(c[f-1]+(a[d-f]-a[d-f-1]))}return c},La.unifyCurveKnotVectors=function(a){a=a.map(Ka.clonedCurve);for(var b=j.fold(a,function(a,b){return La.imax(a.degree,b)},0),c=0,d=a.length;c<d;){var e=c++;a[e].degree<b&&(a[e]=La.curveElevateDegree(a[e],b))}for(var f,g=[],h=0;h<a.length;){var i=a[h];++h,g.push(new aa(P.first(i.knots),P.last(i.knots)))}f=g;for(var k=0,l=a.length;k<l;){var m=k++,n=[f[m].min];a[m].knots=a[m].knots.map(function(a){return function(b){return b-a[0]}}(n))}for(var o=f.map(function(a){return a.max-a.min}),p=j.fold(o,function(a,b){return Math.max(a,b)},0),q=0,r=a.length;q<r;){var s=q++,t=[p/o[s]];a[s].knots=a[s].knots.map(function(a){return function(b){return b*a[0]}}(t))}for(var u=j.fold(a,function(a,b){return Ca.sortedSetUnion(a.knots,b)},[]),v=0,w=a.length;v<w;){var x=v++,y=Ca.sortedSetSub(u,a[x].knots);0==y.length&&(a[x]=a[x]),a[x]=La.curveKnotRefine(a[x],y)}return a},La.imin=function(a,b){return a<b?a:b},La.imax=function(a,b){return a>b?a:b},La.curveElevateDegree=function(a,b){if(b<=a.degree)return a;var c,d=a.knots.length-a.degree-2,e=a.degree,f=a.knots,g=a.controlPoints,h=b-a.degree,i=a.controlPoints[0].length,j=Ca.zeros2d(e+h+1,e+1),k=[],l=[],m=[],n=d+e+1,o=b,p=Math.floor(o/2),q=[],r=[];j[0][0]=1,j[o][e]=1;for(var s=1,t=p+1;s<t;)for(var u=s++,v=1/Q.get(o,u),w=La.imin(e,u),x=La.imax(0,u-h),y=w+1;x<y;){var z=x++;j[u][z]=v*Q.get(e,z)*Q.get(h,u-z)}for(var A=p+1;A<o;)for(var B=A++,C=La.imin(e,B),D=La.imax(0,B-h),E=C+1;D<E;){var F=D++;j[B][F]=j[o-B][e-F]}var G=o,H=o+1,I=-1,J=e,K=e+1,L=1,M=f[0];q[0]=g[0];for(var N=0,O=o+1;N<O;){var P=N++;r[P]=M}for(var R=0,S=e+1;R<S;){var T=R++;k[T]=g[T]}for(;K<n;){for(var U=K;K<n&&f[K]==f[K+1];)K+=1;var V=K-U+1,X=f[K],Y=I;I=e-V;var Z;Z=Y>0?Math.floor((Y+2)/2):1;var $;if($=I>0?Math.floor(o-(I+1)/2):o,I>0){for(var _=X-M,aa=[],ba=e;ba>V;)aa[ba-V-1]=_/(f[J+ba]-M),ba--;for(var ca=1,da=I+1;ca<da;){for(var ea=ca++,fa=I-ea,ga=V+ea,ha=e;ha>=ga;)k[ha]=Ca.add(Ca.mul(aa[ha-ga],k[ha]),Ca.mul(1-aa[ha-ga],k[ha-1])),ha--;m[fa]=k[e]}}for(var ia=Z,ja=o+1;ia<ja;){var ka=ia++;l[ka]=Ca.zeros1d(i);for(var la=La.imin(e,ka),ma=La.imax(0,ka-h),na=la+1;ma<na;){var oa=ma++;l[ka]=Ca.add(l[ka],Ca.mul(j[ka][oa],k[oa]))}}if(Y>1)for(var pa=H-2,qa=H,ra=X-M,sa=(X-r[H-1])/ra,ta=1;ta<Y;){for(var ua=ta++,va=pa,wa=qa,xa=wa-H+1;wa-va>ua;){if(va<L){var ya=(X-r[va])/(M-r[va]);q[va]=Ca.lerp(ya,q[va],q[va-1])}if(wa>=Z){if(wa-ua<=H-o+Y){var za=(X-r[wa-ua])/ra;l[xa]=Ca.lerp(za,l[xa],l[xa+1])}}else l[xa]=Ca.lerp(sa,l[xa],l[xa+1]);va+=1,wa-=1,xa-=1}pa-=1,qa+=1}if(J!=e)for(var Aa=0,Ba=o-Y;Aa<Ba;){Aa++;r[H]=M,H+=1}for(var Da=Z,Ea=$+1;Da<Ea;){var Fa=Da++;q[L]=l[Fa],L+=1}if(K<n){for(var Ga=0;Ga<I;){var Ha=Ga++;k[Ha]=m[Ha]}for(var Ia=I,Ja=e+1;Ia<Ja;){
   var Ka=Ia++;k[Ka]=g[K-e+Ka]}J=K,K+=1,M=X}else for(var Ma=0,Na=o+1;Ma<Na;){var Oa=Ma++;r[H+Oa]=X}}return c=G-o-1,new W(b,r,q)},La.rationalSurfaceTransform=function(a,b){for(var c=Ia.dehomogenize2d(a.controlPoints),d=0,e=c.length;d<e;)for(var f=d++,g=0,h=c[f].length;g<h;){var i=g++,j=c[f][i];j.push(1),c[f][i]=ta.dot(b,j).slice(0,j.length-1)}return new X(a.degreeU,a.degreeV,a.knotsU.slice(),a.knotsV.slice(),Ia.homogenize2d(c,Ia.weight2d(a.controlPoints)))},La.rationalCurveTransform=function(a,b){for(var c=Ia.dehomogenize1d(a.controlPoints),d=0,e=c.length;d<e;){var f=d++,g=c[f];g.push(1),c[f]=ta.dot(b,g).slice(0,g.length-1)}return new W(a.degree,a.knots.slice(),Ia.homogenize1d(c,Ia.weight1d(a.controlPoints)))},La.surfaceKnotRefine=function(a,b,c){var d,e,f,g=[];c?(f=a.controlPoints,d=a.knotsV,e=a.degreeV):(f=ta.transpose(a.controlPoints),d=a.knotsU,e=a.degreeU);for(var h=null,i=0;i<f.length;){var j=f[i];++i,h=La.curveKnotRefine(new W(e,d,j),b),g.push(h.controlPoints)}var k=h.knots;return c?new X(a.degreeU,a.degreeV,a.knotsU.slice(),k,g):(g=ta.transpose(g),new X(a.degreeU,a.degreeV,k,a.knotsV.slice(),g))},La.decomposeCurveIntoBeziers=function(a){for(var b=a.degree,c=a.controlPoints,d=a.knots,e=Da.knotMultiplicities(d),f=b+1,g=0;g<e.length;){var h=e[g];if(++g,h.mult<f){var i=Ca.rep(f-h.mult,h.knot),j=La.curveKnotRefine(new W(b,d,c),i);d=j.knots,c=j.controlPoints}}for(var k=(d.length/f-1,2*f),l=[],m=0;m<c.length;){var n=d.slice(m,m+k),o=c.slice(m,m+f);l.push(new W(b,n,o)),m+=f}return l},La.curveKnotRefine=function(a,b){if(0==b.length)return Ka.clonedCurve(a);for(var c=a.degree,d=a.controlPoints,e=a.knots,f=d.length-1,g=f+c+1,h=b.length-1,i=Ia.knotSpan(c,b[0],e),j=Ia.knotSpan(c,b[h],e),k=[],l=[],m=0,n=i-c+1;m<n;){var o=m++;k[o]=d[o]}for(var p=j-1,q=f+1;p<q;){var r=p++;k[r+h+1]=d[r]}for(var s=0,t=i+1;s<t;){var u=s++;l[u]=e[u]}for(var v=j+c,w=g+1;v<w;){var x=v++;l[x+h+1]=e[x]}for(var y=j+c-1,z=j+c+h,A=h;A>=0;){for(;b[A]<=e[y]&&y>i;)k[z-c-1]=d[y-c-1],l[z]=e[y],z-=1,y-=1;k[z-c-1]=k[z-c];for(var B=1,C=c+1;B<C;){var D=B++,E=z-c+D,F=l[z+D]-b[A];Math.abs(F)<S.EPSILON?k[E-1]=k[E]:(F/=l[z+D]-e[y-c+D],k[E-1]=Ca.add(Ca.mul(F,k[E-1]),Ca.mul(1-F,k[E])))}l[z]=b[A],z-=1,A--}return new W(c,l,k)},La.curveKnotInsert=function(a,b,c){for(var d=a.degree,e=a.controlPoints,f=a.knots,g=0,h=e.length,i=Ia.knotSpan(d,b,f),j=[],k=[],l=[],m=1,n=i+1;m<n;){var o=m++;k[o]=f[o]}for(var p=1,q=c+1;p<q;){var r=p++;k[i+r]=b}for(var s=i+1,t=f.length;s<t;){var u=s++;k[u+c]=f[u]}for(var v=0,w=i-d+1;v<w;){var x=v++;l[x]=e[x]}for(var y=i-g;y<h;){var z=y++;l[z+c]=e[z]}for(var A=0,B=d-g+1;A<B;){var C=A++;j[C]=e[i-d+C]}for(var D=0,E=0,F=1,G=c+1;F<G;){var H=F++;D=i-d+H;for(var I=0,J=d-H-g+1;I<J;){var K=I++;E=(b-f[D+K])/(f[K+i+1]-f[D+K]),j[K]=Ca.add(Ca.mul(E,j[K+1]),Ca.mul(1-E,j[K]))}l[D]=j[0],l[i+c-H-g]=j[d-H-g]}for(var L=D+1,M=i-g;L<M;){var N=L++;l[N]=j[N-D]}return new W(d,k,l)};var Ma=b.eval.Tess=function(){};g["verb.eval.Tess"]=Ma,Ma.__name__=["verb","eval","Tess"],Ma.rationalCurveRegularSample=function(a,b,c){return Ma.rationalCurveRegularSampleRange(a,a.knots[0],P.last(a.knots),b,c)},Ma.rationalCurveRegularSampleRange=function(a,b,c,d,e){d<1&&(d=2);for(var f=[],g=(c-b)/(d-1),h=0,i=0;i<d;){var j=i++;h=b+g*j,e?f.push([h].concat(Ia.rationalCurvePoint(a,h))):f.push(Ia.rationalCurvePoint(a,h))}return f},Ma.rationalCurveAdaptiveSample=function(a,b,c){if(null==c&&(c=!1),null==b&&(b=1e-6),1==a.degree){if(c){for(var d=[],e=0,f=a.controlPoints.length;e<f;){var g=e++;d.push([a.knots[g+1]].concat(Ia.dehomogenize(a.controlPoints[g])))}return d}return a.controlPoints.map(Ia.dehomogenize)}return Ma.rationalCurveAdaptiveSampleRange(a,a.knots[0],P.last(a.knots),b,c)},Ma.rationalCurveAdaptiveSampleRange=function(a,b,c,d,e){var f=Ia.rationalCurvePoint(a,b),g=Ia.rationalCurvePoint(a,c),h=.5+.2*Math.random(),i=b+(c-b)*h,j=Ia.rationalCurvePoint(a,i),k=Ca.sub(f,g),l=Ca.sub(f,j);if(Ca.dot(k,k)<d&&Ca.dot(l,l)>d||!Ba.threePointsAreFlat(f,j,g,d)){var m=b+.5*(c-b),n=Ma.rationalCurveAdaptiveSampleRange(a,b,m,d,e),o=Ma.rationalCurveAdaptiveSampleRange(a,m,c,d,e);return n.slice(0,-1).concat(o)}return e?[[b].concat(f),[c].concat(g)]:[f,g]},Ma.rationalSurfaceNaive=function(a,b,c){b<1&&(b=1),c<1&&(c=1);for(var d=(a.degreeU,a.degreeV,a.controlPoints,a.knotsU),e=a.knotsV,f=P.last(d)-d[0],g=P.last(e)-e[0],h=f/b,i=g/c,j=[],k=[],l=[],m=0,n=b+1;m<n;)for(var o=m++,p=0,q=c+1;p<q;){var r=p++,s=o*h,t=r*i;k.push([s,t]);var u=Ia.rationalSurfaceDerivatives(a,s,t,1),v=u[0][0];j.push(v);var w=Ca.normalized(Ca.cross(u[1][0],u[0][1]));l.push(w)}for(var x=[],y=0;y<b;)for(var z=y++,A=0;A<c;){var B=A++,C=z*(c+1)+B,D=(z+1)*(c+1)+B,E=D+1,F=C+1,G=[C,D,E],H=[C,E,F];x.push(G),x.push(H)}return new Y(x,j,l,k)},Ma.divideRationalSurfaceAdaptive=function(a,b){null==b&&(b=new Na),null!=b.minDivsU?b.minDivsU=b.minDivsU:b.minDivsU=1,null!=b.minDivsV?b.minDivsU=b.minDivsV:b.minDivsU=1,null!=b.refine?b.refine=b.refine:b.refine=!0;var c,d=2*(a.controlPoints.length-1),e=2*(a.controlPoints[0].length-1);c=b.minDivsU>d?b.minDivsU=b.minDivsU:b.minDivsU=d;var f;f=b.minDivsV>e?b.minDivsV=b.minDivsV:b.minDivsV=e;for(var g=P.last(a.knotsU),h=a.knotsU[0],i=P.last(a.knotsV),j=a.knotsV[0],k=(g-h)/c,l=(i-j)/f,m=[],n=[],o=0,p=f+1;o<p;){for(var q=o++,r=[],s=0,t=c+1;s<t;){var u=s++,v=h+k*u,w=j+l*q,x=Ia.rationalSurfaceDerivatives(a,v,w,1),y=Ca.normalized(Ca.cross(x[0][1],x[1][0]));r.push(new ia(x[0][0],y,[v,w],-1,Ca.isZero(y)))}n.push(r)}for(var z=0;z<f;)for(var A=z++,B=0;B<c;){var C=B++,D=[n[f-A-1][C],n[f-A-1][C+1],n[f-A][C+1],n[f-A][C]];m.push(new Oa(a,D))}if(!b.refine)return m;for(var E=0;E<f;)for(var F=E++,G=0;G<c;){var H=G++,I=F*c+H,J=Ma.north(I,F,H,c,f,m),K=Ma.east(I,F,H,c,f,m),L=Ma.south(I,F,H,c,f,m),M=Ma.west(I,F,H,c,f,m);m[I].neighbors=[L,K,J,M],m[I].divide(b)}return m},Ma.north=function(a,b,c,d,e,f){return 0==b?null:f[a-d]},Ma.south=function(a,b,c,d,e,f){return b==e-1?null:f[a+d]},Ma.east=function(a,b,c,d,e,f){return c==d-1?null:f[a+1]},Ma.west=function(a,b,c,d,e,f){return 0==c?null:f[a-1]},Ma.triangulateAdaptiveRefinementNodeTree=function(a){for(var b=Y.empty(),c=0;c<a.length;){var d=a[c];++c,d.triangulate(b)}return b},Ma.rationalSurfaceAdaptive=function(a,b){b=null!=b?b:new Na;var c=Ma.divideRationalSurfaceAdaptive(a,b);return Ma.triangulateAdaptiveRefinementNodeTree(c)};var Na=b.core.AdaptiveRefinementOptions=function(){this.minDivsV=1,this.minDivsU=1,this.refine=!0,this.maxDepth=10,this.minDepth=0,this.normTol=.025};g["verb.eval.AdaptiveRefinementOptions"]=Na,Na.__name__=["verb","eval","AdaptiveRefinementOptions"],Na.prototype={__class__:Na};var Oa=b.core.AdaptiveRefinementNode=function(a,b,c){if(this.srf=a,null==c?this.neighbors=[null,null,null,null]:this.neighbors=c,this.corners=b,null==this.corners){var d=a.knotsU[0],e=P.last(a.knotsU),f=a.knotsV[0],g=P.last(a.knotsV);this.corners=[ia.fromUv(d,f),ia.fromUv(e,f),ia.fromUv(e,g),ia.fromUv(d,g)]}};g["verb.eval.AdaptiveRefinementNode"]=Oa,Oa.__name__=["verb","eval","AdaptiveRefinementNode"],Oa.prototype={isLeaf:function(){return null==this.children},center:function(){return null!=this.centerPoint?this.centerPoint:this.evalSrf(this.u05,this.v05)},evalCorners:function(){this.u05=(this.corners[0].uv[0]+this.corners[2].uv[0])/2,this.v05=(this.corners[0].uv[1]+this.corners[2].uv[1])/2;for(var a=0;a<4;){var b=a++;if(null==this.corners[b].point){var c=this.corners[b];this.evalSrf(c.uv[0],c.uv[1],c)}}},evalSrf:function(a,b,c){var d=Ia.rationalSurfaceDerivatives(this.srf,a,b,1),e=d[0][0],f=Ca.cross(d[0][1],d[1][0]),g=Ca.isZero(f);return g||(f=Ca.normalized(f)),null!=c?(c.degen=g,c.point=e,c.normal=f,c):new ia(e,f,[a,b],-1,g)},getEdgeCorners:function(a){if(this.isLeaf())return[this.corners[a]];if(this.horizontal)switch(a){case 0:return this.children[0].getEdgeCorners(0);case 1:return this.children[0].getEdgeCorners(1).concat(this.children[1].getEdgeCorners(1));case 2:return this.children[1].getEdgeCorners(2);case 3:return this.children[1].getEdgeCorners(3).concat(this.children[0].getEdgeCorners(3))}switch(a){case 0:return this.children[0].getEdgeCorners(0).concat(this.children[1].getEdgeCorners(0));case 1:return this.children[1].getEdgeCorners(1);case 2:return this.children[1].getEdgeCorners(2).concat(this.children[0].getEdgeCorners(2));case 3:return this.children[0].getEdgeCorners(3)}return null},getAllCorners:function(a){var b=[this.corners[a]];if(null==this.neighbors[a])return b;var c=this.neighbors[a].getEdgeCorners((a+2)%4),d=a%2,e=S.EPSILON,f=this,g=[function(a){return a.uv[0]>f.corners[0].uv[0]+e&&a.uv[0]<f.corners[2].uv[0]-e},function(a){return a.uv[1]>f.corners[0].uv[1]+e&&a.uv[1]<f.corners[2].uv[1]-e}],h=c.filter(g[d]);return h.reverse(),b.concat(h)},midpoint:function(a){if(null==this.midPoints&&(this.midPoints=[null,null,null,null]),null!=this.midPoints[a])return this.midPoints[a];switch(a){case 0:this.midPoints[0]=this.evalSrf(this.u05,this.corners[0].uv[1]);break;case 1:this.midPoints[1]=this.evalSrf(this.corners[1].uv[0],this.v05);break;case 2:this.midPoints[2]=this.evalSrf(this.u05,this.corners[2].uv[1]);break;case 3:this.midPoints[3]=this.evalSrf(this.corners[0].uv[0],this.v05)}return this.midPoints[a]},hasBadNormals:function(){return this.corners[0].degen||this.corners[1].degen||this.corners[2].degen||this.corners[3].degen},fixNormals:function(){for(var a=this.corners.length,b=0;b<a;){var c=b++;this.corners[c];if(this.corners[c].degen){var d=this.corners[(c+1)%a],e=this.corners[(c+3)%a];d.degen?this.corners[c].normal=e.normal:this.corners[c].normal=d.normal}}},shouldDivide:function(a,b){if(b<a.minDepth)return!0;if(b>=a.maxDepth)return!1;if(this.hasBadNormals())return this.fixNormals(),!1;if(this.splitVert=Ca.normSquared(Ca.sub(this.corners[0].normal,this.corners[1].normal))>a.normTol||Ca.normSquared(Ca.sub(this.corners[2].normal,this.corners[3].normal))>a.normTol,this.splitHoriz=Ca.normSquared(Ca.sub(this.corners[1].normal,this.corners[2].normal))>a.normTol||Ca.normSquared(Ca.sub(this.corners[3].normal,this.corners[0].normal))>a.normTol,this.splitVert||this.splitHoriz)return!0;var c=this.center();return Ca.normSquared(Ca.sub(c.normal,this.corners[0].normal))>a.normTol||Ca.normSquared(Ca.sub(c.normal,this.corners[1].normal))>a.normTol||Ca.normSquared(Ca.sub(c.normal,this.corners[2].normal))>a.normTol||Ca.normSquared(Ca.sub(c.normal,this.corners[3].normal))>a.normTol},divide:function(a){null==a&&(a=new Na),null==a.normTol&&(a.normTol=.085),null==a.minDepth&&(a.minDepth=0),null==a.maxDepth&&(a.maxDepth=10),this._divide(a,0,!0)},_divide:function(a,b,c){if(this.evalCorners(),this.shouldDivide(a,b)){if(b++,this.splitVert&&!this.splitHoriz?c=!1:!this.splitVert&&this.splitHoriz&&(c=!0),this.horizontal=c,this.horizontal){var d=[this.corners[0],this.corners[1],this.midpoint(1),this.midpoint(3)],e=[this.midpoint(3),this.midpoint(1),this.corners[2],this.corners[3]];this.children=[new Oa(this.srf,d),new Oa(this.srf,e)],this.children[0].neighbors=[this.neighbors[0],this.neighbors[1],this.children[1],this.neighbors[3]],this.children[1].neighbors=[this.children[0],this.neighbors[1],this.neighbors[2],this.neighbors[3]]}else{var f=[this.corners[0],this.midpoint(0),this.midpoint(2),this.corners[3]],g=[this.midpoint(0),this.corners[1],this.corners[2],this.midpoint(2)];this.children=[new Oa(this.srf,f),new Oa(this.srf,g)],this.children[0].neighbors=[this.neighbors[0],this.children[1],this.neighbors[2],this.neighbors[3]],this.children[1].neighbors=[this.neighbors[0],this.neighbors[1],this.neighbors[2],this.children[0]]}for(var h=0,i=this.children;h<i.length;){var j=i[h];++h,j._divide(a,b,!c)}}},triangulate:function(a){if(null==a&&(a=Y.empty()),this.isLeaf())return this.triangulateLeaf(a);for(var b=0,c=this.children;b<c.length;){var d=c[b];if(++b,null==d)break;d.triangulate(a)}return a},triangulateLeaf:function(a){for(var b=a.points.length,c=[],d=[],e=0,f=0;f<4;){var g=f++,h=this.getAllCorners(g);2==h.length&&(e=g+1);for(var i=0,j=h.length;i<j;){var k=i++;c.push(h[k])}}for(var l=0;l<c.length;){var m=c[l];++l,m.id==-1?(a.uvs.push(m.uv),a.points.push(m.point),a.normals.push(m.normal),m.id=b,d.push(b),b++):d.push(m.id)}if(4==c.length)return a.faces.push([d[0],d[3],d[1]]),a.faces.push([d[3],d[2],d[1]]),a;if(5==c.length){var n=d.length;return a.faces.push([d[e],d[(e+2)%n],d[(e+1)%n]]),a.faces.push([d[(e+4)%n],d[(e+3)%n],d[e]]),a.faces.push([d[e],d[(e+3)%n],d[(e+2)%n]]),a}var o=this.center();a.uvs.push(o.uv),a.points.push(o.point),a.normals.push(o.normal);for(var p=a.points.length-1,q=0,r=c.length-1;q<c.length;)a.faces.push([p,d[q],d[r]]),r=q++;return a},__class__:Oa};var Pa=b.exe.Dispatcher=function(){};g["verb.exe.Dispatcher"]=Pa,Pa.__name__=["verb","exe","Dispatcher"],Pa.init=function(){Pa._init||(Pa._workerPool=new Qa(Pa.THREADS),Pa._init=!0)},Pa.dispatchMethod=function(a,b,c){Pa.init();var d=new I,e=function(a){d.resolve(a)};return Pa._workerPool.addWork(q.getClassName(a),b,c,e),new J(d)};var Qa=b.exe.WorkerPool=function(a,b){null==b&&(b="verb.js"),null==a&&(a=1),this._callbacks=new v,this._working=new v,this._pool=[],this._queue=[];for(var c=0;c<a;){var d;c++;try{d=new Worker(Qa.basePath+b)}catch(e){e instanceof C&&(e=e.val),d=new Worker(Qa.basePath+b.substring(0,-3)+".min.js")}this._pool.push(d)}};g["verb.exe.WorkerPool"]=Qa,Qa.__name__=["verb","exe","WorkerPool"],Qa.prototype={addWork:function(a,b,c,d){var e=new Ra(a,b,c);this._callbacks.set(e.id,d),this._queue.push(e),this.processQueue()},processQueue:function(){for(var b=this;this._queue.length>0&&this._pool.length>0;){var c=this._queue.shift(),d=[c.id],e=[this._pool.shift()];this._working.h[d[0]]=e[0],e[0].onmessage=function(c,d){return function(e){b._working.remove(d[0]),b._pool.push(c[0]);try{b._callbacks.h.hasOwnProperty(d[0])&&(b._callbacks.h[d[0]](e.data.result),b._callbacks.remove(d[0]))}catch(f){f instanceof C&&(f=f.val),a.log(f)}b.processQueue()}}(e,d),e[0].postMessage(c)}},__class__:Qa};var Ra=function(a,b,c){this.className=a,this.methodName=b,this.args=c,this.id=Ra.uuid++};g["verb.exe._WorkerPool.Work"]=Ra,Ra.__name__=["verb","exe","_WorkerPool","Work"],Ra.prototype={__class__:Ra};var Sa=function(){};g["verb.geom.ICurve"]=Sa,Sa.__name__=["verb","geom","ICurve"],Sa.__interfaces__=[za],Sa.prototype={__class__:Sa};var Ta=b.geom.NurbsCurve=function(a){this._data=Fa.isValidNurbsCurveData(a)};g["verb.geom.NurbsCurve"]=Ta,Ta.__name__=["verb","geom","NurbsCurve"],Ta.__interfaces__=[Sa],Ta.byKnotsControlPointsWeights=function(a,b,c,d){return new Ta(new W(a,b.slice(),Ia.homogenize1d(c,d)))},Ta.byPoints=function(a,b){return null==b&&(b=3),new Ta(Ka.rationalInterpCurve(a,b))},Ta.__super__=T,Ta.prototype=d(T.prototype,{degree:function(){return this._data.degree},knots:function(){return this._data.knots.slice(0)},controlPoints:function(){return Ia.dehomogenize1d(this._data.controlPoints)},weights:function(){return Ia.weight1d(this._data.controlPoints)},asNurbs:function(){return new W(this.degree(),this.knots(),Ia.homogenize1d(this.controlPoints(),this.weights()))},clone:function(){return new Ta(this._data)},domain:function(){return new aa(P.first(this._data.knots),P.last(this._data.knots))},transform:function(a){return new Ta(La.rationalCurveTransform(this._data,a))},transformAsync:function(a){return Pa.dispatchMethod(La,"rationalCurveTransform",[this._data,a]).then(function(a){return new Ta(a)})},point:function(a){return Ia.rationalCurvePoint(this._data,a)},pointAsync:function(a){return Pa.dispatchMethod(Ia,"rationalCurvePoint",[this._data,a])},tangent:function(a){return Ia.rationalCurveTangent(this._data,a)},tangentAsync:function(a){return Pa.dispatchMethod(Ia,"rationalCurveTangent",[this._data,a])},derivatives:function(a,b){return null==b&&(b=1),Ia.rationalCurveDerivatives(this._data,a,b)},derivativesAsync:function(a,b){return null==b&&(b=1),Pa.dispatchMethod(Ia,"rationalCurveDerivatives",[this._data,a,b])},closestPoint:function(a){return Da.rationalCurveClosestPoint(this._data,a)},closestPointAsync:function(a){return Pa.dispatchMethod(Da,"rationalCurveClosestPoint",[this._data,a])},closestParam:function(a){return Da.rationalCurveClosestParam(this._data,a)},closestParamAsync:function(a){return Pa.dispatchMethod(Da,"rationalCurveClosestParam",[this._data,a])},length:function(){return Da.rationalCurveArcLength(this._data)},lengthAsync:function(){return Pa.dispatchMethod(Da,"rationalCurveArcLength",[this._data])},lengthAtParam:function(a){return Da.rationalCurveArcLength(this._data,a)},lengthAtParamAsync:function(){return Pa.dispatchMethod(Da,"rationalCurveArcLength",[this._data])},paramAtLength:function(a,b){return Da.rationalCurveParamAtArcLength(this._data,a,b)},paramAtLengthAsync:function(a,b){return Pa.dispatchMethod(Da,"rationalCurveParamAtArcLength",[this._data,a,b])},divideByEqualArcLength:function(a){return Ga.rationalCurveByEqualArcLength(this._data,a)},divideByEqualArcLengthAsync:function(a){return Pa.dispatchMethod(Ga,"rationalCurveByEqualArcLength",[this._data,a])},divideByArcLength:function(a){return Ga.rationalCurveByArcLength(this._data,a)},divideByArcLengthAsync:function(a){return Pa.dispatchMethod(Ga,"rationalCurveByArcLength",[this._data,a])},split:function(a){return Ga.curveSplit(this._data,a).map(function(a){return new Ta(a)})},splitAsync:function(a){return Pa.dispatchMethod(Ga,"curveSplit",[this._data,a]).then(function(a){return a.map(function(a){return new Ta(a)})})},reverse:function(){return new Ta(La.curveReverse(this._data))},reverseAsync:function(){return Pa.dispatchMethod(La,"curveReverse",[this._data]).then(function(a){return new Ta(a)})},tessellate:function(a){return Ma.rationalCurveAdaptiveSample(this._data,a,!1)},tessellateAsync:function(a){return Pa.dispatchMethod(Ma,"rationalCurveAdaptiveSample",[this._data,a,!1])},__class__:Ta});var Ua=b.geom.Arc=function(a,b,c,d,e,f){Ta.call(this,Ka.arc(a,b,c,d,e,f)),this._center=a,this._xaxis=b,this._yaxis=c,this._radius=d,this._minAngle=e,this._maxAngle=f};g["verb.geom.Arc"]=Ua,Ua.__name__=["verb","geom","Arc"],Ua.__super__=Ta,Ua.prototype=d(Ta.prototype,{center:function(){return this._center},xaxis:function(){return this._xaxis},yaxis:function(){return this._yaxis},radius:function(){return this._radius},minAngle:function(){return this._minAngle},maxAngle:function(){return this._maxAngle},__class__:Ua});var Va=b.geom.BezierCurve=function(a,b){Ta.call(this,Ka.rationalBezierCurve(a,b))};g["verb.geom.BezierCurve"]=Va,Va.__name__=["verb","geom","BezierCurve"],Va.__super__=Ta,Va.prototype=d(Ta.prototype,{__class__:Va});var Wa=b.geom.Circle=function(a,b,c,d){Ua.call(this,a,b,c,d,0,2*Math.PI)};g["verb.geom.Circle"]=Wa,Wa.__name__=["verb","geom","Circle"],Wa.__super__=Ua,Wa.prototype=d(Ua.prototype,{__class__:Wa});var Xa=function(){};g["verb.geom.ISurface"]=Xa,Xa.__name__=["verb","geom","ISurface"],Xa.__interfaces__=[za],Xa.prototype={__class__:Xa};var Ya=b.geom.NurbsSurface=function(a){this._data=Fa.isValidNurbsSurfaceData(a)};g["verb.geom.NurbsSurface"]=Ya,Ya.__name__=["verb","geom","NurbsSurface"],Ya.__interfaces__=[Xa],Ya.byKnotsControlPointsWeights=function(a,b,c,d,e,f){return new Ya(new X(a,b,c,d,Ia.homogenize2d(e,f)))},Ya.byCorners=function(a,b,c,d){return new Ya(Ka.fourPointSurface(a,b,c,d))},Ya.byLoftingCurves=function(a,b){return new Ya(Ka.loftedSurface(function(b){for(var c,d=[],e=0;e<a.length;){var f=a[e];++e,d.push(f.asNurbs())}return c=d}(this),b))},Ya.__super__=T,Ya.prototype=d(T.prototype,{degreeU:function(){return this._data.degreeU},degreeV:function(){return this._data.degreeV},knotsU:function(){return this._data.knotsU.slice(0)},knotsV:function(){return this._data.knotsV.slice(0)},controlPoints:function(){return Ia.dehomogenize2d(this._data.controlPoints)},weights:function(){return Ia.weight2d(this._data.controlPoints)},asNurbs:function(){return new X(this.degreeU(),this.degreeV(),this.knotsU(),this.knotsV(),Ia.homogenize2d(this.controlPoints(),this.weights()))},clone:function(){return new Ya(this.asNurbs())},domainU:function(){return new aa(P.first(this._data.knotsU),P.last(this._data.knotsU))},domainV:function(){return new aa(P.first(this._data.knotsV),P.last(this._data.knotsV))},point:function(a,b){return Ia.rationalSurfacePoint(this._data,a,b)},pointAsync:function(a,b){return Pa.dispatchMethod(Ia,"rationalSurfacePoint",[this._data,a,b])},normal:function(a,b){return Ia.rationalSurfaceNormal(this._data,a,b)},normalAsync:function(a,b){return Pa.dispatchMethod(Ia,"rationalSurfaceNormal",[this._data,a,b])},derivatives:function(a,b,c){return null==c&&(c=1),Ia.rationalSurfaceDerivatives(this._data,a,b,c)},derivativesAsync:function(a,b,c){return null==c&&(c=1),Pa.dispatchMethod(Ia,"rationalSurfaceDerivatives",[this._data,a,b,c])},closestParam:function(a){return Da.rationalSurfaceClosestParam(this._data,a)},closestParamAsync:function(a){return Pa.dispatchMethod(Da,"rationalSurfaceClosestParam",[this._data,a])},closestPoint:function(a){return Da.rationalSurfaceClosestPoint(this._data,a)},closestPointAsync:function(a){return Pa.dispatchMethod(Da,"rationalSurfaceClosestPoint",[this._data,a])},split:function(a,b){return null==b&&(b=!1),Ga.surfaceSplit(this._data,a,b).map(function(a){return new Ya(a)})},splitAsync:function(a,b){return null==b&&(b=!1),Pa.dispatchMethod(Ga,"surfaceSplit",[this._data,a,b]).then(function(a){return a.map(function(a){return new Ya(a)})})},reverse:function(a){return null==a&&(a=!1),new Ya(La.surfaceReverse(this._data,a))},reverseAsync:function(a){return null==a&&(a=!1),Pa.dispatchMethod(La,"surfaceReverse",[this._data,a]).then(function(a){return new Ya(a)})},isocurve:function(a,b){return null==b&&(b=!1),new Ta(Ka.surfaceIsocurve(this._data,a,b))},isocurveAsync:function(a,b){return null==b&&(b=!1),Pa.dispatchMethod(Ka,"surfaceIsocurve",[this._data,a,b]).then(function(a){return new Ta(a)})},boundaries:function(a){return Ka.surfaceBoundaryCurves(this._data).map(function(a){return new Ta(a)})},boundariesAsync:function(a){return Pa.dispatchMethod(Ka,"surfaceBoundaryCurves",[this._data]).then(function(a){return a.map(function(a){return new Ta(a)})})},tessellate:function(a){return Ma.rationalSurfaceAdaptive(this._data,a)},tessellateAsync:function(a){return Pa.dispatchMethod(Ma,"rationalSurfaceAdaptive",[this._data,a])},transform:function(a){return new Ya(La.rationalSurfaceTransform(this._data,a))},transformAsync:function(a){return Pa.dispatchMethod(La,"rationalSurfaceTransform",[this._data,a]).then(function(a){return new Ya(a)})},__class__:Ya});var Za=b.geom.ConicalSurface=function(a,b,c,d,e){Ya.call(this,Ka.conicalSurface(a,b,c,d,e)),this._axis=a,this._xaxis=b,this._base=c,this._height=d,this._radius=e};g["verb.geom.ConicalSurface"]=Za,Za.__name__=["verb","geom","ConicalSurface"],Za.__super__=Ya,Za.prototype=d(Ya.prototype,{axis:function(){return this._axis},xaxis:function(){return this._xaxis},base:function(){return this._base},height:function(){return this._height},radius:function(){return this._radius},__class__:Za});var $a=b.geom.CylindricalSurface=function(a,b,c,d,e){Ya.call(this,Ka.cylindricalSurface(a,b,c,d,e)),this._axis=a,this._xaxis=b,this._base=c,this._height=d,this._radius=e};g["verb.geom.CylindricalSurface"]=$a,$a.__name__=["verb","geom","CylindricalSurface"],$a.__super__=Ya,$a.prototype=d(Ya.prototype,{axis:function(){return this._axis},xaxis:function(){return this._xaxis},base:function(){return this._base},height:function(){return this._height},radius:function(){return this._radius},__class__:$a});var _a=b.geom.EllipseArc=function(a,b,c,d,e){Ta.call(this,Ka.ellipseArc(a,b,c,d,e)),this._center=a,this._xaxis=b,this._yaxis=c,this._minAngle=d,this._maxAngle=e};g["verb.geom.EllipseArc"]=_a,_a.__name__=["verb","geom","EllipseArc"],_a.__super__=Ta,_a.prototype=d(Ta.prototype,{center:function(){return this._center},xaxis:function(){return this._xaxis},yaxis:function(){return this._yaxis},minAngle:function(){return this._minAngle},maxAngle:function(){return this._maxAngle},__class__:_a});var ab=b.geom.Ellipse=function(a,b,c){_a.call(this,a,b,c,0,2*Math.PI)};g["verb.geom.Ellipse"]=ab,ab.__name__=["verb","geom","Ellipse"],ab.__super__=_a,ab.prototype=d(_a.prototype,{__class__:ab});var bb=b.geom.ExtrudedSurface=function(a,b){Ya.call(this,Ka.extrudedSurface(Ca.normalized(b),Ca.norm(b),a.asNurbs())),this._profile=a,this._direction=b};g["verb.geom.ExtrudedSurface"]=bb,bb.__name__=["verb","geom","ExtrudedSurface"],bb.__super__=Ya,bb.prototype=d(Ya.prototype,{profile:function(){return this._profile},direction:function(){return this._direction},__class__:bb});var cb=b.geom.Intersect=function(){};g["verb.geom.Intersect"]=cb,cb.__name__=["verb","geom","Intersect"],cb.curves=function(a,b,c){return null==c&&(c=.001),Ja.curves(a.asNurbs(),b.asNurbs(),c)},cb.curvesAsync=function(a,b,c){return null==c&&(c=.001),Pa.dispatchMethod(Ja,"curves",[a.asNurbs(),b.asNurbs(),c])},cb.curveAndSurface=function(a,b,c){return null==c&&(c=.001),Ja.curveAndSurface(a.asNurbs(),b.asNurbs(),c)},cb.curveAndSurfaceAsync=function(a,b,c){return null==c&&(c=.001),Pa.dispatchMethod(Ja,"curveAndSurface",[a.asNurbs(),b.asNurbs(),c])},cb.surfaces=function(a,b,c){return null==c&&(c=.001),Ja.surfaces(a.asNurbs(),b.asNurbs(),c).map(function(a){return new Ta(a)})},cb.surfacesAsync=function(a,b,c){return null==c&&(c=.001),Pa.dispatchMethod(Ja,"surfaces",[a.asNurbs(),b.asNurbs(),c]).then(function(a){return a.map(function(a){return new Ta(a)})})};var db=b.geom.Line=function(a,b){Ta.call(this,Ka.polyline([a,b])),this._start=a,this._end=b};g["verb.geom.Line"]=db,db.__name__=["verb","geom","Line"],db.__super__=Ta,db.prototype=d(Ta.prototype,{start:function(){return this._start},end:function(){return this._end},__class__:db});var eb=b.geom.RevolvedSurface=function(a,b,c,d){Ya.call(this,Ka.revolvedSurface(a.asNurbs(),b,c,d)),this._profile=a,this._center=b,this._axis=c,this._angle=d};g["verb.geom.RevolvedSurface"]=eb,eb.__name__=["verb","geom","RevolvedSurface"],eb.__super__=Ya,eb.prototype=d(Ya.prototype,{profile:function(){return this._profile},center:function(){return this._center},axis:function(){return this._center},angle:function(){return this._angle},__class__:eb});var fb=b.geom.SphericalSurface=function(a,b){Ya.call(this,Ka.sphericalSurface(a,[0,0,1],[1,0,0],b)),this._center=a,this._radius=b};g["verb.geom.SphericalSurface"]=fb,fb.__name__=["verb","geom","SphericalSurface"],fb.__super__=Ya,fb.prototype=d(Ya.prototype,{center:function(){return this._center},radius:function(){return this._radius},__class__:fb});var gb=b.geom.SweptSurface=function(a,b){Ya.call(this,Ka.rationalTranslationalSurface(a.asNurbs(),b.asNurbs())),this._profile=a,this._rail=b};g["verb.geom.SweptSurface"]=gb,gb.__name__=["verb","geom","SweptSurface"],gb.__super__=Ya,gb.prototype=d(Ya.prototype,{profile:function(){return this._profile},rail:function(){return this._rail},__class__:gb});var hb,ib=0;g.Math=Math,String.prototype.__class__=g.String=String,String.__name__=["String"],g.Array=Array,Array.__name__=["Array"],Date.prototype.__class__=g.Date=Date,Date.__name__=["Date"];var jb=g.Int={__name__:["Int"]},kb=g.Dynamic={__name__:["Dynamic"]},lb=g.Float=Number;lb.__name__=["Float"];var mb=g.Bool=Boolean;mb.__ename__=["Bool"];var nb=g.Class={__name__:["Class"]},ob={};null==Array.prototype.map&&(Array.prototype.map=function(a){for(var b=[],c=0,d=this.length;c<d;){var e=c++;b[e]=a(this[e])}return b}),null==Array.prototype.filter&&(Array.prototype.filter=function(a){for(var b=[],c=0,d=this.length;c<d;){var e=c++,f=this[e];a(f)&&b.push(f)}return b});var pb={},qb=c.ArrayBuffer||E;null==qb.prototype.slice&&(qb.prototype.slice=E.sliceImpl);var rb=(c.DataView||F,c.Uint8Array||G._new);!function(a,b){function c(a){return o[n]=d.apply(b,a),n++}function d(a){var c=[].slice.call(arguments,1);return function(){"function"==typeof a?a.apply(b,c):new Function(""+a)()}}function e(a){if(p)setTimeout(d(e,a),0);else{var b=o[a];if(b){p=!0;try{b()}finally{f(a),p=!1}}}}function f(a){delete o[a]}function g(){m=function(){var a=c(arguments);return process.nextTick(d(e,a)),a}}function h(){if(a.postMessage&&!a.importScripts){var b=!0,c=a.onmessage;return a.onmessage=function(){b=!1},a.postMessage("","*"),a.onmessage=c,b}}function i(){var b="setImmediate$"+Math.random()+"$",d=function(c){c.source===a&&"string"==typeof c.data&&0===c.data.indexOf(b)&&e(+c.data.slice(b.length))};a.addEventListener?a.addEventListener("message",d,!1):a.attachEvent("onmessage",d),m=function(){var d=c(arguments);return a.postMessage(b+d,"*"),d}}function j(){var a=new MessageChannel;a.port1.onmessage=function(a){var b=a.data;e(b)},m=function(){var b=c(arguments);return a.port2.postMessage(b),b}}function k(){var a=q.documentElement;m=function(){var b=c(arguments),d=q.createElement("script");return d.onreadystatechange=function(){e(b),d.onreadystatechange=null,a.removeChild(d),d=null},a.appendChild(d),b}}function l(){m=function(){var a=c(arguments);return setTimeout(d(e,a),0),a}}if(!a.setImmediate){var m,n=1,o={},p=!1,q=a.document,r=Object.getPrototypeOf&&Object.getPrototypeOf(a);r=r&&r.setTimeout?r:a,"[object process]"==={}.toString.call(a.process)?g():h()?i():a.MessageChannel?j():q&&"onreadystatechange"in q.createElement("script")?k():l(),r.setImmediate=m,r.clearImmediate=f}}(new Function("return this")()),t.USE_CACHE=!1,t.USE_ENUM_INDEX=!1,t.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",u.DEFAULT_RESOLVER=q,u.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",w.count=0,B.i64tmp=function(a){var b,c=new s(0,0);return b=c}(this),D.__toStr={}.toString,G.BYTES_PER_ELEMENT=1,M.queue=new k,Q.memo=new v,S.TOLERANCE=1e-6,S.EPSILON=1e-10,S.VERSION="2.0.0",Da.Tvalues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],
   Da.Cvalues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],Pa.THREADS=1,Pa._init=!1,Qa.basePath="",Ra.uuid=0,O.main()}("undefined"!=typeof console?console:{log:function(){}},a,"undefined"!=typeof e?e:"undefined"!=typeof b?b:"undefined"!=typeof self?self:this),a});
   /* axios v0.19.0 | (c) 2019 by Matt Zabriskie */
   !function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.axios=t():e.axios=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){"use strict";function r(e){var t=new i(e),n=s(i.prototype.request,t);return o.extend(n,i.prototype,t),o.extend(n,t),n}var o=n(2),s=n(3),i=n(5),a=n(22),u=n(11),c=r(u);c.Axios=i,c.create=function(e){return r(a(c.defaults,e))},c.Cancel=n(23),c.CancelToken=n(24),c.isCancel=n(10),c.all=function(e){return Promise.all(e)},c.spread=n(25),e.exports=c,e.exports.default=c},function(e,t,n){"use strict";function r(e){return"[object Array]"===j.call(e)}function o(e){return"[object ArrayBuffer]"===j.call(e)}function s(e){return"undefined"!=typeof FormData&&e instanceof FormData}function i(e){var t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer}function a(e){return"string"==typeof e}function u(e){return"number"==typeof e}function c(e){return"undefined"==typeof e}function f(e){return null!==e&&"object"==typeof e}function p(e){return"[object Date]"===j.call(e)}function d(e){return"[object File]"===j.call(e)}function l(e){return"[object Blob]"===j.call(e)}function h(e){return"[object Function]"===j.call(e)}function m(e){return f(e)&&h(e.pipe)}function y(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams}function g(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}function x(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)}function v(e,t){if(null!==e&&"undefined"!=typeof e)if("object"!=typeof e&&(e=[e]),r(e))for(var n=0,o=e.length;n<o;n++)t.call(null,e[n],n,e);else for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.call(null,e[s],s,e)}function w(){function e(e,n){"object"==typeof t[n]&&"object"==typeof e?t[n]=w(t[n],e):t[n]=e}for(var t={},n=0,r=arguments.length;n<r;n++)v(arguments[n],e);return t}function b(){function e(e,n){"object"==typeof t[n]&&"object"==typeof e?t[n]=b(t[n],e):"object"==typeof e?t[n]=b({},e):t[n]=e}for(var t={},n=0,r=arguments.length;n<r;n++)v(arguments[n],e);return t}function E(e,t,n){return v(t,function(t,r){n&&"function"==typeof t?e[r]=S(t,n):e[r]=t}),e}var S=n(3),R=n(4),j=Object.prototype.toString;e.exports={isArray:r,isArrayBuffer:o,isBuffer:R,isFormData:s,isArrayBufferView:i,isString:a,isNumber:u,isObject:f,isUndefined:c,isDate:p,isFile:d,isBlob:l,isFunction:h,isStream:m,isURLSearchParams:y,isStandardBrowserEnv:x,forEach:v,merge:w,deepMerge:b,extend:E,trim:g}},function(e,t){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},function(e,t){/*!
       * Determine if an object is a Buffer
       *
       * @author   Feross Aboukhadijeh <https://feross.org>
       * @license  MIT
       */
   e.exports=function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}},function(e,t,n){"use strict";function r(e){this.defaults=e,this.interceptors={request:new i,response:new i}}var o=n(2),s=n(6),i=n(7),a=n(8),u=n(22);r.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{},e.url=arguments[0]):e=e||{},e=u(this.defaults,e),e.method=e.method?e.method.toLowerCase():"get";var t=[a,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)n=n.then(t.shift(),t.shift());return n},r.prototype.getUri=function(e){return e=u(this.defaults,e),s(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},o.forEach(["delete","get","head","options"],function(e){r.prototype[e]=function(t,n){return this.request(o.merge(n||{},{method:e,url:t}))}}),o.forEach(["post","put","patch"],function(e){r.prototype[e]=function(t,n,r){return this.request(o.merge(r||{},{method:e,url:t,data:n}))}}),e.exports=r},function(e,t,n){"use strict";function r(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var o=n(2);e.exports=function(e,t,n){if(!t)return e;var s;if(n)s=n(t);else if(o.isURLSearchParams(t))s=t.toString();else{var i=[];o.forEach(t,function(e,t){null!==e&&"undefined"!=typeof e&&(o.isArray(e)?t+="[]":e=[e],o.forEach(e,function(e){o.isDate(e)?e=e.toISOString():o.isObject(e)&&(e=JSON.stringify(e)),i.push(r(t)+"="+r(e))}))}),s=i.join("&")}if(s){var a=e.indexOf("#");a!==-1&&(e=e.slice(0,a)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}},function(e,t,n){"use strict";function r(){this.handlers=[]}var o=n(2);r.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},r.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},r.prototype.forEach=function(e){o.forEach(this.handlers,function(t){null!==t&&e(t)})},e.exports=r},function(e,t,n){"use strict";function r(e){e.cancelToken&&e.cancelToken.throwIfRequested()}var o=n(2),s=n(9),i=n(10),a=n(11),u=n(20),c=n(21);e.exports=function(e){r(e),e.baseURL&&!u(e.url)&&(e.url=c(e.baseURL,e.url)),e.headers=e.headers||{},e.data=s(e.data,e.headers,e.transformRequest),e.headers=o.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),o.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]});var t=e.adapter||a.adapter;return t(e).then(function(t){return r(e),t.data=s(t.data,t.headers,e.transformResponse),t},function(t){return i(t)||(r(e),t&&t.response&&(t.response.data=s(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})}},function(e,t,n){"use strict";var r=n(2);e.exports=function(e,t,n){return r.forEach(n,function(n){e=n(e,t)}),e}},function(e,t){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,n){"use strict";function r(e,t){!s.isUndefined(e)&&s.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}function o(){var e;return"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process)?e=n(13):"undefined"!=typeof XMLHttpRequest&&(e=n(13)),e}var s=n(2),i=n(12),a={"Content-Type":"application/x-www-form-urlencoded"},u={adapter:o(),transformRequest:[function(e,t){return i(t,"Accept"),i(t,"Content-Type"),s.isFormData(e)||s.isArrayBuffer(e)||s.isBuffer(e)||s.isStream(e)||s.isFile(e)||s.isBlob(e)?e:s.isArrayBufferView(e)?e.buffer:s.isURLSearchParams(e)?(r(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):s.isObject(e)?(r(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};u.headers={common:{Accept:"application/json, text/plain, */*"}},s.forEach(["delete","get","head"],function(e){u.headers[e]={}}),s.forEach(["post","put","patch"],function(e){u.headers[e]=s.merge(a)}),e.exports=u},function(e,t,n){"use strict";var r=n(2);e.exports=function(e,t){r.forEach(e,function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])})}},function(e,t,n){"use strict";var r=n(2),o=n(14),s=n(6),i=n(17),a=n(18),u=n(15);e.exports=function(e){return new Promise(function(t,c){var f=e.data,p=e.headers;r.isFormData(f)&&delete p["Content-Type"];var d=new XMLHttpRequest;if(e.auth){var l=e.auth.username||"",h=e.auth.password||"";p.Authorization="Basic "+btoa(l+":"+h)}if(d.open(e.method.toUpperCase(),s(e.url,e.params,e.paramsSerializer),!0),d.timeout=e.timeout,d.onreadystatechange=function(){if(d&&4===d.readyState&&(0!==d.status||d.responseURL&&0===d.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in d?i(d.getAllResponseHeaders()):null,r=e.responseType&&"text"!==e.responseType?d.response:d.responseText,s={data:r,status:d.status,statusText:d.statusText,headers:n,config:e,request:d};o(t,c,s),d=null}},d.onabort=function(){d&&(c(u("Request aborted",e,"ECONNABORTED",d)),d=null)},d.onerror=function(){c(u("Network Error",e,null,d)),d=null},d.ontimeout=function(){c(u("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",d)),d=null},r.isStandardBrowserEnv()){var m=n(19),y=(e.withCredentials||a(e.url))&&e.xsrfCookieName?m.read(e.xsrfCookieName):void 0;y&&(p[e.xsrfHeaderName]=y)}if("setRequestHeader"in d&&r.forEach(p,function(e,t){"undefined"==typeof f&&"content-type"===t.toLowerCase()?delete p[t]:d.setRequestHeader(t,e)}),e.withCredentials&&(d.withCredentials=!0),e.responseType)try{d.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&d.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&d.upload&&d.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(e){d&&(d.abort(),c(e),d=null)}),void 0===f&&(f=null),d.send(f)})}},function(e,t,n){"use strict";var r=n(15);e.exports=function(e,t,n){var o=n.config.validateStatus;!o||o(n.status)?e(n):t(r("Request failed with status code "+n.status,n.config,null,n.request,n))}},function(e,t,n){"use strict";var r=n(16);e.exports=function(e,t,n,o,s){var i=new Error(e);return r(i,t,n,o,s)}},function(e,t){"use strict";e.exports=function(e,t,n,r,o){return e.config=t,n&&(e.code=n),e.request=r,e.response=o,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},function(e,t,n){"use strict";var r=n(2),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,s,i={};return e?(r.forEach(e.split("\n"),function(e){if(s=e.indexOf(":"),t=r.trim(e.substr(0,s)).toLowerCase(),n=r.trim(e.substr(s+1)),t){if(i[t]&&o.indexOf(t)>=0)return;"set-cookie"===t?i[t]=(i[t]?i[t]:[]).concat([n]):i[t]=i[t]?i[t]+", "+n:n}}),i):i}},function(e,t,n){"use strict";var r=n(2);e.exports=r.isStandardBrowserEnv()?function(){function e(e){var t=e;return n&&(o.setAttribute("href",t),t=o.href),o.setAttribute("href",t),{href:o.href,protocol:o.protocol?o.protocol.replace(/:$/,""):"",host:o.host,search:o.search?o.search.replace(/^\?/,""):"",hash:o.hash?o.hash.replace(/^#/,""):"",hostname:o.hostname,port:o.port,pathname:"/"===o.pathname.charAt(0)?o.pathname:"/"+o.pathname}}var t,n=/(msie|trident)/i.test(navigator.userAgent),o=document.createElement("a");return t=e(window.location.href),function(n){var o=r.isString(n)?e(n):n;return o.protocol===t.protocol&&o.host===t.host}}():function(){return function(){return!0}}()},function(e,t,n){"use strict";var r=n(2);e.exports=r.isStandardBrowserEnv()?function(){return{write:function(e,t,n,o,s,i){var a=[];a.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),r.isString(o)&&a.push("path="+o),r.isString(s)&&a.push("domain="+s),i===!0&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()},function(e,t){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,n){"use strict";var r=n(2);e.exports=function(e,t){t=t||{};var n={};return r.forEach(["url","method","params","data"],function(e){"undefined"!=typeof t[e]&&(n[e]=t[e])}),r.forEach(["headers","auth","proxy"],function(o){r.isObject(t[o])?n[o]=r.deepMerge(e[o],t[o]):"undefined"!=typeof t[o]?n[o]=t[o]:r.isObject(e[o])?n[o]=r.deepMerge(e[o]):"undefined"!=typeof e[o]&&(n[o]=e[o])}),r.forEach(["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"],function(r){"undefined"!=typeof t[r]?n[r]=t[r]:"undefined"!=typeof e[r]&&(n[r]=e[r])}),n}},function(e,t){"use strict";function n(e){this.message=e}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,e.exports=n},function(e,t,n){"use strict";function r(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e});var n=this;e(function(e){n.reason||(n.reason=new o(e),t(n.reason))})}var o=n(23);r.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},r.source=function(){var e,t=new r(function(t){e=t});return{token:t,cancel:e}},e.exports=r},function(e,t){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}}])});
   
   'use strict';var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,a,c){b!=Array.prototype&&b!=Object.prototype&&(b[a]=c.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);
   $jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var b=0;return function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+b++}}();
   $jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.iterator;b||(b=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[b]&&$jscomp.defineProperty(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(b){var a=0;return $jscomp.iteratorPrototype(function(){return a<b.length?{done:!1,value:b[a++]}:{done:!0}})};
   $jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();b={next:b};b[$jscomp.global.Symbol.iterator]=function(){return this};return b};$jscomp.makeIterator=function(b){$jscomp.initSymbolIterator();var a=b[Symbol.iterator];return a?a.call(b):$jscomp.arrayIterator(b)};$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(b){var a=function(){};a.prototype=b;return new a};
   $jscomp.underscoreProtoCanBeSet=function(){var b={a:!0},a={};try{return a.__proto__=b,a.a}catch(c){}return!1};$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(b,a){b.__proto__=a;if(b.__proto__!==a)throw new TypeError(b+" is not extensible");return b}:null;
   $jscomp.inherits=function(b,a){b.prototype=$jscomp.objectCreate(a.prototype);b.prototype.constructor=b;if($jscomp.setPrototypeOf){var c=$jscomp.setPrototypeOf;c(b,a)}else for(c in a)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(a,c);d&&Object.defineProperty(b,c,d)}else b[c]=a[c];b.superClass_=a.prototype};$jscomp.arrayFromIterator=function(b){for(var a,c=[];!(a=b.next()).done;)c.push(a.value);return c};
   $jscomp.arrayFromIterable=function(b){return b instanceof Array?b:$jscomp.arrayFromIterator($jscomp.makeIterator(b))};$jscomp.checkStringArgs=function(b,a,c){if(null==b)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(a instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return b+""};
   $jscomp.polyfill=function(b,a,c,d){if(a){c=$jscomp.global;b=b.split(".");for(d=0;d<b.length-1;d++){var e=b[d];e in c||(c[e]={});c=c[e]}b=b[b.length-1];d=c[b];a=a(d);a!=d&&null!=a&&$jscomp.defineProperty(c,b,{configurable:!0,writable:!0,value:a})}};
   $jscomp.polyfill("String.prototype.repeat",function(b){return b?b:function(a){var b=$jscomp.checkStringArgs(this,null,"repeat");if(0>a||1342177279<a)throw new RangeError("Invalid count value");a|=0;for(var d="";a;)if(a&1&&(d+=b),a>>>=1)b+=b;return d}},"es6","es3");$jscomp.stringPadding=function(b,a){b=void 0!==b?String(b):" ";return 0<a&&b?b.repeat(Math.ceil(a/b.length)).substring(0,a):""};
   $jscomp.polyfill("String.prototype.padStart",function(b){return b?b:function(a,b){var c=$jscomp.checkStringArgs(this,null,"padStart");return $jscomp.stringPadding(b,a-c.length)+c}},"es8","es3");$jscomp.polyfill("String.prototype.padEnd",function(b){return b?b:function(a,b){var c=$jscomp.checkStringArgs(this,null,"padStart");return c+$jscomp.stringPadding(b,a-c.length)}},"es8","es3");
   $jscomp.polyfill("Math.clz32",function(b){return b?b:function(a){a=Number(a)>>>0;if(0===a)return 32;var b=0;0===(a&4294901760)&&(a<<=16,b+=16);0===(a&4278190080)&&(a<<=8,b+=8);0===(a&4026531840)&&(a<<=4,b+=4);0===(a&3221225472)&&(a<<=2,b+=2);0===(a&2147483648)&&b++;return b}},"es6","es3");$jscomp.checkEs6ConformanceViaProxy=function(){try{var b={},a=Object.create(new $jscomp.global.Proxy(b,{get:function(c,d,e){return c==b&&"q"==d&&e==a}}));return!0===a.q}catch(c){return!1}};
   $jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.owns=function(b,a){return Object.prototype.hasOwnProperty.call(b,a)};
   $jscomp.polyfill("WeakMap",function(b){function a(){if(!b||!Object.seal)return!1;try{var a=Object.seal({}),c=Object.seal({}),d=new b([[a,2],[c,3]]);if(2!=d.get(a)||3!=d.get(c))return!1;d.delete(a);d.set(c,4);return!d.has(a)&&4==d.get(c)}catch(m){return!1}}function c(a){$jscomp.owns(a,e)||$jscomp.defineProperty(a,e,{value:{}})}function d(a){var b=Object[a];b&&(Object[a]=function(a){c(a);return b(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(b&&$jscomp.ES6_CONFORMANCE)return b}else if(a())return b;
   var e="$jscomp_hidden_"+Math.random();d("freeze");d("preventExtensions");d("seal");var g=0,h=function(a){this.id_=(g+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};h.prototype.set=function(a,b){c(a);if(!$jscomp.owns(a,e))throw Error("WeakMap key fail: "+a);a[e][this.id_]=b;return this};h.prototype.get=function(a){return $jscomp.owns(a,e)?a[e][this.id_]:void 0};h.prototype.has=
   function(a){return $jscomp.owns(a,e)&&$jscomp.owns(a[e],this.id_)};h.prototype.delete=function(a){return $jscomp.owns(a,e)&&$jscomp.owns(a[e],this.id_)?delete a[e][this.id_]:!1};return h},"es6","es3");$jscomp.polyfill("String.prototype.endsWith",function(b){return b?b:function(a,b){var c=$jscomp.checkStringArgs(this,a,"endsWith");a+="";void 0===b&&(b=c.length);b=Math.max(0,Math.min(b|0,c.length));for(var e=a.length;0<e&&0<b;)if(c[--b]!=a[--e])return!1;return 0>=e}},"es6","es3");
   $jscomp.iteratorFromArray=function(b,a){$jscomp.initSymbolIterator();b instanceof String&&(b+="");var c=0,d={next:function(){if(c<b.length){var e=c++;return{value:a(e,b[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};$jscomp.polyfill("Array.prototype.keys",function(b){return b?b:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
   $jscomp.polyfill("Object.is",function(b){return b?b:function(a,b){return a===b?0!==a||1/a===1/b:a!==a&&b!==b}},"es6","es3");$jscomp.polyfill("Array.prototype.includes",function(b){return b?b:function(a,b){var c=this;c instanceof String&&(c=String(c));var e=c.length;b=b||0;for(0>b&&(b=Math.max(b+e,0));b<e;b++){var g=c[b];if(g===a||Object.is(g,a))return!0}return!1}},"es7","es3");
   $jscomp.polyfill("String.prototype.includes",function(b){return b?b:function(a,b){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,b||0)}},"es6","es3");$jscomp.findInternal=function(b,a,c){b instanceof String&&(b=String(b));for(var d=b.length,e=0;e<d;e++){var g=b[e];if(a.call(c,g,e,b))return{i:e,v:g}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.findIndex",function(b){return b?b:function(a,b){return $jscomp.findInternal(this,a,b).i}},"es6","es3");
   $jscomp.polyfill("Number.isNaN",function(b){return b?b:function(a){return"number"===typeof a&&isNaN(a)}},"es6","es3");$jscomp.FORCE_POLYFILL_PROMISE=!1;
   $jscomp.polyfill("Promise",function(b){function a(){this.batch_=null}function c(a){return a instanceof e?a:new e(function(b,c){b(a)})}if(b&&!$jscomp.FORCE_POLYFILL_PROMISE)return b;a.prototype.asyncExecute=function(a){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(a);return this};a.prototype.asyncExecuteBatch_=function(){var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})};var d=$jscomp.global.setTimeout;a.prototype.asyncExecuteFunction=function(a){d(a,
   0)};a.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var c=a[b];a[b]=null;try{c()}catch(l){this.asyncThrow_(l)}}}this.batch_=null};a.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var e=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(k){b.reject(k)}};e.prototype.createResolveAndReject_=
   function(){function a(a){return function(d){c||(c=!0,a.call(b,d))}}var b=this,c=!1;return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};e.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof e)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};e.prototype.resolveToNonPromiseObj_=function(a){var b=
   void 0;try{b=a.then}catch(k){this.reject_(k);return}"function"==typeof b?this.settleSameAsThenable_(b,a):this.fulfill_(a)};e.prototype.reject_=function(a){this.settle_(2,a)};e.prototype.fulfill_=function(a){this.settle_(1,a)};e.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=
   0;a<this.onSettledCallbacks_.length;++a)g.asyncExecute(this.onSettledCallbacks_[a]);this.onSettledCallbacks_=null}};var g=new a;e.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};e.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(l){c.reject(l)}};e.prototype.then=function(a,b){function c(a,b){return"function"==typeof a?function(b){try{d(a(b))}catch(t){g(t)}}:
   b}var d,g,h=new e(function(a,b){d=a;g=b});this.callWhenSettled_(c(a,d),c(b,g));return h};e.prototype.catch=function(a){return this.then(void 0,a)};e.prototype.callWhenSettled_=function(a,b){function c(){switch(d.state_){case 1:a(d.result_);break;case 2:b(d.result_);break;default:throw Error("Unexpected state: "+d.state_);}}var d=this;null==this.onSettledCallbacks_?g.asyncExecute(c):this.onSettledCallbacks_.push(c)};e.resolve=c;e.reject=function(a){return new e(function(b,c){c(a)})};e.race=function(a){return new e(function(b,
   d){for(var e=$jscomp.makeIterator(a),g=e.next();!g.done;g=e.next())c(g.value).callWhenSettled_(b,d)})};e.all=function(a){var b=$jscomp.makeIterator(a),d=b.next();return d.done?c([]):new e(function(a,e){function g(b){return function(c){h[b]=c;f--;0==f&&a(h)}}var h=[],f=0;do h.push(void 0),f++,c(d.value).callWhenSettled_(g(h.length-1),e),d=b.next();while(!d.done)})};return e},"es6","es3");
   $jscomp.polyfill("String.prototype.startsWith",function(b){return b?b:function(a,b){var c=$jscomp.checkStringArgs(this,a,"startsWith");a+="";var e=c.length,g=a.length;b=Math.max(0,Math.min(b|0,c.length));for(var h=0;h<g&&b<e;)if(c[b++]!=a[h++])return!1;return h>=g}},"es6","es3");$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6","es3");
   $jscomp.polyfill("Object.setPrototypeOf",function(b){return b||$jscomp.setPrototypeOf},"es6","es5");$jscomp.polyfill("Number.MAX_SAFE_INTEGER",function(){return 9007199254740991},"es6","es3");$jscomp.polyfill("Number.MIN_SAFE_INTEGER",function(){return-9007199254740991},"es6","es3");
   $jscomp.polyfill("Array.from",function(b){return b?b:function(a,b,d){$jscomp.initSymbolIterator();b=null!=b?b:function(a){return a};var c=[],g=a[Symbol.iterator];if("function"==typeof g)for(a=g.call(a);!(g=a.next()).done;)c.push(b.call(d,g.value));else{g=a.length;for(var h=0;h<g;h++)c.push(b.call(d,a[h]))}return c}},"es6","es3");
   $jscomp.polyfill("Promise.prototype.finally",function(b){return b?b:function(a){return this.then(function(b){return Promise.resolve(a()).then(function(){return b})},function(b){return Promise.resolve(a()).then(function(){throw b;})})}},"es8","es3");$jscomp.polyfill("Object.values",function(b){return b?b:function(a){var b=[],d;for(d in a)$jscomp.owns(a,d)&&b.push(a[d]);return b}},"es8","es3");
   $jscomp.polyfill("Math.sign",function(b){return b?b:function(a){a=Number(a);return 0===a||isNaN(a)?a:0<a?1:-1}},"es6","es3");$jscomp.assign="function"==typeof Object.assign?Object.assign:function(b,a){for(var c=1;c<arguments.length;c++){var d=arguments[c];if(d)for(var e in d)$jscomp.owns(d,e)&&(b[e]=d[e])}return b};$jscomp.polyfill("Object.assign",function(b){return b||$jscomp.assign},"es6","es3");
   $jscomp.polyfill("Array.prototype.values",function(b){return b?b:function(){return $jscomp.iteratorFromArray(this,function(a,b){return b})}},"es8","es3");$jscomp.polyfill("Number.parseInt",function(b){return b||parseInt},"es6","es3");var module$src$polyfills$CustomEvent={default:{}};
   (function(){function b(a,b){b=b||{bubbles:!1,cancelable:!1,detail:void 0};var c=document.createEvent("CustomEvent");c.initCustomEvent(a,b.bubbles,b.cancelable,b.detail);return c}if("function"===typeof window.CustomEvent)return!1;window.Event&&"function"===typeof window.Event&&(b.prototype=window.Event.prototype);window.CustomEvent=b})();var module$node_modules$tinycolor2$tinycolor={default:function(b,a){b=b?b:"";a=a||{};if(b instanceof module$node_modules$tinycolor2$tinycolor.default)return b;if(!(this instanceof module$node_modules$tinycolor2$tinycolor.default))return new module$node_modules$tinycolor2$tinycolor.default(b,a);var c=inputToRGB$$module$node_modules$tinycolor2$tinycolor(b);this._originalInput=b;this._r=c.r;this._g=c.g;this._b=c.b;this._a=c.a;this._roundA=mathRound$$module$node_modules$tinycolor2$tinycolor(100*this._a)/
   100;this._format=a.format||c.format;this._gradientType=a.gradientType;1>this._r&&(this._r=mathRound$$module$node_modules$tinycolor2$tinycolor(this._r));1>this._g&&(this._g=mathRound$$module$node_modules$tinycolor2$tinycolor(this._g));1>this._b&&(this._b=mathRound$$module$node_modules$tinycolor2$tinycolor(this._b));this._ok=c.ok;this._tc_id=tinyCounter$$module$node_modules$tinycolor2$tinycolor++}},Math$$module$node_modules$tinycolor2$tinycolor=Math,trimLeft$$module$node_modules$tinycolor2$tinycolor=
   /^\s+/,trimRight$$module$node_modules$tinycolor2$tinycolor=/\s+$/,tinyCounter$$module$node_modules$tinycolor2$tinycolor=0,mathRound$$module$node_modules$tinycolor2$tinycolor=Math$$module$node_modules$tinycolor2$tinycolor.round,mathMin$$module$node_modules$tinycolor2$tinycolor=Math$$module$node_modules$tinycolor2$tinycolor.min,mathMax$$module$node_modules$tinycolor2$tinycolor=Math$$module$node_modules$tinycolor2$tinycolor.max,mathRandom$$module$node_modules$tinycolor2$tinycolor=Math$$module$node_modules$tinycolor2$tinycolor.random;
   module$node_modules$tinycolor2$tinycolor.default.prototype={isDark:function(){return 128>this.getBrightness()},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var b=this.toRgb();return(299*b.r+587*b.g+114*b.b)/1E3},getLuminance:function(){var b=this.toRgb();var a=b.r/255;var c=b.g/255;b=b.b/255;a=.03928>=a?a/12.92:
   Math$$module$node_modules$tinycolor2$tinycolor.pow((a+.055)/1.055,2.4);c=.03928>=c?c/12.92:Math$$module$node_modules$tinycolor2$tinycolor.pow((c+.055)/1.055,2.4);b=.03928>=b?b/12.92:Math$$module$node_modules$tinycolor2$tinycolor.pow((b+.055)/1.055,2.4);return.2126*a+.7152*c+.0722*b},setAlpha:function(b){this._a=boundAlpha$$module$node_modules$tinycolor2$tinycolor(b);this._roundA=mathRound$$module$node_modules$tinycolor2$tinycolor(100*this._a)/100;return this},toHsv:function(){var b=rgbToHsv$$module$node_modules$tinycolor2$tinycolor(this._r,
   this._g,this._b);return{h:360*b.h,s:b.s,v:b.v,a:this._a}},toHsvString:function(){var b=rgbToHsv$$module$node_modules$tinycolor2$tinycolor(this._r,this._g,this._b),a=mathRound$$module$node_modules$tinycolor2$tinycolor(360*b.h),c=mathRound$$module$node_modules$tinycolor2$tinycolor(100*b.s);b=mathRound$$module$node_modules$tinycolor2$tinycolor(100*b.v);return 1==this._a?"hsv("+a+", "+c+"%, "+b+"%)":"hsva("+a+", "+c+"%, "+b+"%, "+this._roundA+")"},toHsl:function(){var b=rgbToHsl$$module$node_modules$tinycolor2$tinycolor(this._r,
   this._g,this._b);return{h:360*b.h,s:b.s,l:b.l,a:this._a}},toHslString:function(){var b=rgbToHsl$$module$node_modules$tinycolor2$tinycolor(this._r,this._g,this._b),a=mathRound$$module$node_modules$tinycolor2$tinycolor(360*b.h),c=mathRound$$module$node_modules$tinycolor2$tinycolor(100*b.s);b=mathRound$$module$node_modules$tinycolor2$tinycolor(100*b.l);return 1==this._a?"hsl("+a+", "+c+"%, "+b+"%)":"hsla("+a+", "+c+"%, "+b+"%, "+this._roundA+")"},toHex:function(b){return rgbToHex$$module$node_modules$tinycolor2$tinycolor(this._r,
   this._g,this._b,b)},toHexString:function(b){return"#"+this.toHex(b)},toHex8:function(b){return rgbaToHex$$module$node_modules$tinycolor2$tinycolor(this._r,this._g,this._b,this._a,b)},toHex8String:function(b){return"#"+this.toHex8(b)},toRgb:function(){return{r:mathRound$$module$node_modules$tinycolor2$tinycolor(this._r),g:mathRound$$module$node_modules$tinycolor2$tinycolor(this._g),b:mathRound$$module$node_modules$tinycolor2$tinycolor(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+
   mathRound$$module$node_modules$tinycolor2$tinycolor(this._r)+", "+mathRound$$module$node_modules$tinycolor2$tinycolor(this._g)+", "+mathRound$$module$node_modules$tinycolor2$tinycolor(this._b)+")":"rgba("+mathRound$$module$node_modules$tinycolor2$tinycolor(this._r)+", "+mathRound$$module$node_modules$tinycolor2$tinycolor(this._g)+", "+mathRound$$module$node_modules$tinycolor2$tinycolor(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:mathRound$$module$node_modules$tinycolor2$tinycolor(100*
   bound01$$module$node_modules$tinycolor2$tinycolor(this._r,255))+"%",g:mathRound$$module$node_modules$tinycolor2$tinycolor(100*bound01$$module$node_modules$tinycolor2$tinycolor(this._g,255))+"%",b:mathRound$$module$node_modules$tinycolor2$tinycolor(100*bound01$$module$node_modules$tinycolor2$tinycolor(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+mathRound$$module$node_modules$tinycolor2$tinycolor(100*bound01$$module$node_modules$tinycolor2$tinycolor(this._r,
   255))+"%, "+mathRound$$module$node_modules$tinycolor2$tinycolor(100*bound01$$module$node_modules$tinycolor2$tinycolor(this._g,255))+"%, "+mathRound$$module$node_modules$tinycolor2$tinycolor(100*bound01$$module$node_modules$tinycolor2$tinycolor(this._b,255))+"%)":"rgba("+mathRound$$module$node_modules$tinycolor2$tinycolor(100*bound01$$module$node_modules$tinycolor2$tinycolor(this._r,255))+"%, "+mathRound$$module$node_modules$tinycolor2$tinycolor(100*bound01$$module$node_modules$tinycolor2$tinycolor(this._g,
   255))+"%, "+mathRound$$module$node_modules$tinycolor2$tinycolor(100*bound01$$module$node_modules$tinycolor2$tinycolor(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":1>this._a?!1:hexNames$$module$node_modules$tinycolor2$tinycolor[rgbToHex$$module$node_modules$tinycolor2$tinycolor(this._r,this._g,this._b,!0)]||!1},toFilter:function(b){var a="#"+rgbaToArgbHex$$module$node_modules$tinycolor2$tinycolor(this._r,this._g,this._b,this._a),c=a,d=this._gradientType?
   "GradientType = 1, ":"";b&&(b=(0,module$node_modules$tinycolor2$tinycolor.default)(b),c="#"+rgbaToArgbHex$$module$node_modules$tinycolor2$tinycolor(b._r,b._g,b._b,b._a));return"progid:DXImageTransform.Microsoft.gradient("+d+"startColorstr="+a+",endColorstr="+c+")"},toString:function(b){var a=!!b;b=b||this._format;var c=!1,d=1>this._a&&0<=this._a;if(!a&&d&&("hex"===b||"hex6"===b||"hex3"===b||"hex4"===b||"hex8"===b||"name"===b))return"name"===b&&0===this._a?this.toName():this.toRgbString();"rgb"===
   b&&(c=this.toRgbString());"prgb"===b&&(c=this.toPercentageRgbString());if("hex"===b||"hex6"===b)c=this.toHexString();"hex3"===b&&(c=this.toHexString(!0));"hex4"===b&&(c=this.toHex8String(!0));"hex8"===b&&(c=this.toHex8String());"name"===b&&(c=this.toName());"hsl"===b&&(c=this.toHslString());"hsv"===b&&(c=this.toHsvString());return c||this.toHexString()},clone:function(){return(0,module$node_modules$tinycolor2$tinycolor.default)(this.toString())},_applyModification:function(b,a){b=b.apply(null,[this].concat([].slice.call(a)));
   this._r=b._r;this._g=b._g;this._b=b._b;this.setAlpha(b._a);return this},lighten:function(){return this._applyModification(lighten$$module$node_modules$tinycolor2$tinycolor,arguments)},brighten:function(){return this._applyModification(brighten$$module$node_modules$tinycolor2$tinycolor,arguments)},darken:function(){return this._applyModification(darken$$module$node_modules$tinycolor2$tinycolor,arguments)},desaturate:function(){return this._applyModification(desaturate$$module$node_modules$tinycolor2$tinycolor,
   arguments)},saturate:function(){return this._applyModification(saturate$$module$node_modules$tinycolor2$tinycolor,arguments)},greyscale:function(){return this._applyModification(greyscale$$module$node_modules$tinycolor2$tinycolor,arguments)},spin:function(){return this._applyModification(spin$$module$node_modules$tinycolor2$tinycolor,arguments)},_applyCombination:function(b,a){return b.apply(null,[this].concat([].slice.call(a)))},analogous:function(){return this._applyCombination(analogous$$module$node_modules$tinycolor2$tinycolor,
   arguments)},complement:function(){return this._applyCombination(complement$$module$node_modules$tinycolor2$tinycolor,arguments)},monochromatic:function(){return this._applyCombination(monochromatic$$module$node_modules$tinycolor2$tinycolor,arguments)},splitcomplement:function(){return this._applyCombination(splitcomplement$$module$node_modules$tinycolor2$tinycolor,arguments)},triad:function(){return this._applyCombination(triad$$module$node_modules$tinycolor2$tinycolor,arguments)},tetrad:function(){return this._applyCombination(tetrad$$module$node_modules$tinycolor2$tinycolor,
   arguments)}};module$node_modules$tinycolor2$tinycolor.default.fromRatio=function(b,a){if("object"==typeof b){var c={},d;for(d in b)b.hasOwnProperty(d)&&(c[d]="a"===d?b[d]:convertToPercentage$$module$node_modules$tinycolor2$tinycolor(b[d]));b=c}return(0,module$node_modules$tinycolor2$tinycolor.default)(b,a)};
   function inputToRGB$$module$node_modules$tinycolor2$tinycolor(b){var a={r:0,g:0,b:0},c=1,d,e=d=!1;"string"==typeof b&&(b=stringInputToObject$$module$node_modules$tinycolor2$tinycolor(b));"object"==typeof b&&(isValidCSSUnit$$module$node_modules$tinycolor2$tinycolor(b.r)&&isValidCSSUnit$$module$node_modules$tinycolor2$tinycolor(b.g)&&isValidCSSUnit$$module$node_modules$tinycolor2$tinycolor(b.b)?(a=rgbToRgb$$module$node_modules$tinycolor2$tinycolor(b.r,b.g,b.b),d=!0,e="%"===String(b.r).substr(-1)?"prgb":
   "rgb"):isValidCSSUnit$$module$node_modules$tinycolor2$tinycolor(b.h)&&isValidCSSUnit$$module$node_modules$tinycolor2$tinycolor(b.s)&&isValidCSSUnit$$module$node_modules$tinycolor2$tinycolor(b.v)?(a=convertToPercentage$$module$node_modules$tinycolor2$tinycolor(b.s),d=convertToPercentage$$module$node_modules$tinycolor2$tinycolor(b.v),a=hsvToRgb$$module$node_modules$tinycolor2$tinycolor(b.h,a,d),d=!0,e="hsv"):isValidCSSUnit$$module$node_modules$tinycolor2$tinycolor(b.h)&&isValidCSSUnit$$module$node_modules$tinycolor2$tinycolor(b.s)&&
   isValidCSSUnit$$module$node_modules$tinycolor2$tinycolor(b.l)&&(a=convertToPercentage$$module$node_modules$tinycolor2$tinycolor(b.s),d=convertToPercentage$$module$node_modules$tinycolor2$tinycolor(b.l),a=hslToRgb$$module$node_modules$tinycolor2$tinycolor(b.h,a,d),d=!0,e="hsl"),b.hasOwnProperty("a")&&(c=b.a));c=boundAlpha$$module$node_modules$tinycolor2$tinycolor(c);return{ok:d,format:b.format||e,r:mathMin$$module$node_modules$tinycolor2$tinycolor(255,mathMax$$module$node_modules$tinycolor2$tinycolor(a.r,
   0)),g:mathMin$$module$node_modules$tinycolor2$tinycolor(255,mathMax$$module$node_modules$tinycolor2$tinycolor(a.g,0)),b:mathMin$$module$node_modules$tinycolor2$tinycolor(255,mathMax$$module$node_modules$tinycolor2$tinycolor(a.b,0)),a:c}}
   function rgbToRgb$$module$node_modules$tinycolor2$tinycolor(b,a,c){return{r:255*bound01$$module$node_modules$tinycolor2$tinycolor(b,255),g:255*bound01$$module$node_modules$tinycolor2$tinycolor(a,255),b:255*bound01$$module$node_modules$tinycolor2$tinycolor(c,255)}}
   function rgbToHsl$$module$node_modules$tinycolor2$tinycolor(b,a,c){b=bound01$$module$node_modules$tinycolor2$tinycolor(b,255);a=bound01$$module$node_modules$tinycolor2$tinycolor(a,255);c=bound01$$module$node_modules$tinycolor2$tinycolor(c,255);var d=mathMax$$module$node_modules$tinycolor2$tinycolor(b,a,c),e=mathMin$$module$node_modules$tinycolor2$tinycolor(b,a,c),g=(d+e)/2;if(d==e)var h=e=0;else{var f=d-e;e=.5<g?f/(2-d-e):f/(d+e);switch(d){case b:h=(a-c)/f+(a<c?6:0);break;case a:h=(c-b)/f+2;break;
   case c:h=(b-a)/f+4}h/=6}return{h:h,s:e,l:g}}
   function hslToRgb$$module$node_modules$tinycolor2$tinycolor(b,a,c){function d(a,b,c){0>c&&(c+=1);1<c&&--c;return c<1/6?a+6*(b-a)*c:.5>c?b:c<2/3?a+(b-a)*(2/3-c)*6:a}b=bound01$$module$node_modules$tinycolor2$tinycolor(b,360);a=bound01$$module$node_modules$tinycolor2$tinycolor(a,100);c=bound01$$module$node_modules$tinycolor2$tinycolor(c,100);if(0===a)c=a=b=c;else{var e=.5>c?c*(1+a):c+a-c*a,g=2*c-e;c=d(g,e,b+1/3);a=d(g,e,b);b=d(g,e,b-1/3)}return{r:255*c,g:255*a,b:255*b}}
   function rgbToHsv$$module$node_modules$tinycolor2$tinycolor(b,a,c){b=bound01$$module$node_modules$tinycolor2$tinycolor(b,255);a=bound01$$module$node_modules$tinycolor2$tinycolor(a,255);c=bound01$$module$node_modules$tinycolor2$tinycolor(c,255);var d=mathMax$$module$node_modules$tinycolor2$tinycolor(b,a,c),e=mathMin$$module$node_modules$tinycolor2$tinycolor(b,a,c),g=d-e;if(d==e)var h=0;else{switch(d){case b:h=(a-c)/g+(a<c?6:0);break;case a:h=(c-b)/g+2;break;case c:h=(b-a)/g+4}h/=6}return{h:h,s:0===
   d?0:g/d,v:d}}function hsvToRgb$$module$node_modules$tinycolor2$tinycolor(b,a,c){b=6*bound01$$module$node_modules$tinycolor2$tinycolor(b,360);a=bound01$$module$node_modules$tinycolor2$tinycolor(a,100);c=bound01$$module$node_modules$tinycolor2$tinycolor(c,100);var d=Math$$module$node_modules$tinycolor2$tinycolor.floor(b),e=b-d;b=c*(1-a);var g=c*(1-e*a);a=c*(1-(1-e)*a);d%=6;return{r:255*[c,g,b,b,a,c][d],g:255*[a,c,c,g,b,b][d],b:255*[b,b,a,c,c,g][d]}}
   function rgbToHex$$module$node_modules$tinycolor2$tinycolor(b,a,c,d){b=[pad2$$module$node_modules$tinycolor2$tinycolor(mathRound$$module$node_modules$tinycolor2$tinycolor(b).toString(16)),pad2$$module$node_modules$tinycolor2$tinycolor(mathRound$$module$node_modules$tinycolor2$tinycolor(a).toString(16)),pad2$$module$node_modules$tinycolor2$tinycolor(mathRound$$module$node_modules$tinycolor2$tinycolor(c).toString(16))];return d&&b[0].charAt(0)==b[0].charAt(1)&&b[1].charAt(0)==b[1].charAt(1)&&b[2].charAt(0)==
   b[2].charAt(1)?b[0].charAt(0)+b[1].charAt(0)+b[2].charAt(0):b.join("")}
   function rgbaToHex$$module$node_modules$tinycolor2$tinycolor(b,a,c,d,e){b=[pad2$$module$node_modules$tinycolor2$tinycolor(mathRound$$module$node_modules$tinycolor2$tinycolor(b).toString(16)),pad2$$module$node_modules$tinycolor2$tinycolor(mathRound$$module$node_modules$tinycolor2$tinycolor(a).toString(16)),pad2$$module$node_modules$tinycolor2$tinycolor(mathRound$$module$node_modules$tinycolor2$tinycolor(c).toString(16)),pad2$$module$node_modules$tinycolor2$tinycolor(convertDecimalToHex$$module$node_modules$tinycolor2$tinycolor(d))];return e&&
   b[0].charAt(0)==b[0].charAt(1)&&b[1].charAt(0)==b[1].charAt(1)&&b[2].charAt(0)==b[2].charAt(1)&&b[3].charAt(0)==b[3].charAt(1)?b[0].charAt(0)+b[1].charAt(0)+b[2].charAt(0)+b[3].charAt(0):b.join("")}
   function rgbaToArgbHex$$module$node_modules$tinycolor2$tinycolor(b,a,c,d){return[pad2$$module$node_modules$tinycolor2$tinycolor(convertDecimalToHex$$module$node_modules$tinycolor2$tinycolor(d)),pad2$$module$node_modules$tinycolor2$tinycolor(mathRound$$module$node_modules$tinycolor2$tinycolor(b).toString(16)),pad2$$module$node_modules$tinycolor2$tinycolor(mathRound$$module$node_modules$tinycolor2$tinycolor(a).toString(16)),pad2$$module$node_modules$tinycolor2$tinycolor(mathRound$$module$node_modules$tinycolor2$tinycolor(c).toString(16))].join("")}
   module$node_modules$tinycolor2$tinycolor.default.equals=function(b,a){return b&&a?(0,module$node_modules$tinycolor2$tinycolor.default)(b).toRgbString()==(0,module$node_modules$tinycolor2$tinycolor.default)(a).toRgbString():!1};module$node_modules$tinycolor2$tinycolor.default.random=function(){return module$node_modules$tinycolor2$tinycolor.default.fromRatio({r:mathRandom$$module$node_modules$tinycolor2$tinycolor(),g:mathRandom$$module$node_modules$tinycolor2$tinycolor(),b:mathRandom$$module$node_modules$tinycolor2$tinycolor()})};
   function desaturate$$module$node_modules$tinycolor2$tinycolor(b,a){a=0===a?0:a||10;b=(0,module$node_modules$tinycolor2$tinycolor.default)(b).toHsl();b.s-=a/100;b.s=clamp01$$module$node_modules$tinycolor2$tinycolor(b.s);return(0,module$node_modules$tinycolor2$tinycolor.default)(b)}
   function saturate$$module$node_modules$tinycolor2$tinycolor(b,a){a=0===a?0:a||10;b=(0,module$node_modules$tinycolor2$tinycolor.default)(b).toHsl();b.s+=a/100;b.s=clamp01$$module$node_modules$tinycolor2$tinycolor(b.s);return(0,module$node_modules$tinycolor2$tinycolor.default)(b)}function greyscale$$module$node_modules$tinycolor2$tinycolor(b){return(0,module$node_modules$tinycolor2$tinycolor.default)(b).desaturate(100)}
   function lighten$$module$node_modules$tinycolor2$tinycolor(b,a){a=0===a?0:a||10;b=(0,module$node_modules$tinycolor2$tinycolor.default)(b).toHsl();b.l+=a/100;b.l=clamp01$$module$node_modules$tinycolor2$tinycolor(b.l);return(0,module$node_modules$tinycolor2$tinycolor.default)(b)}
   function brighten$$module$node_modules$tinycolor2$tinycolor(b,a){a=0===a?0:a||10;b=(0,module$node_modules$tinycolor2$tinycolor.default)(b).toRgb();b.r=mathMax$$module$node_modules$tinycolor2$tinycolor(0,mathMin$$module$node_modules$tinycolor2$tinycolor(255,b.r-mathRound$$module$node_modules$tinycolor2$tinycolor(255*-(a/100))));b.g=mathMax$$module$node_modules$tinycolor2$tinycolor(0,mathMin$$module$node_modules$tinycolor2$tinycolor(255,b.g-mathRound$$module$node_modules$tinycolor2$tinycolor(255*-(a/
   100))));b.b=mathMax$$module$node_modules$tinycolor2$tinycolor(0,mathMin$$module$node_modules$tinycolor2$tinycolor(255,b.b-mathRound$$module$node_modules$tinycolor2$tinycolor(255*-(a/100))));return(0,module$node_modules$tinycolor2$tinycolor.default)(b)}
   function darken$$module$node_modules$tinycolor2$tinycolor(b,a){a=0===a?0:a||10;b=(0,module$node_modules$tinycolor2$tinycolor.default)(b).toHsl();b.l-=a/100;b.l=clamp01$$module$node_modules$tinycolor2$tinycolor(b.l);return(0,module$node_modules$tinycolor2$tinycolor.default)(b)}function spin$$module$node_modules$tinycolor2$tinycolor(b,a){b=(0,module$node_modules$tinycolor2$tinycolor.default)(b).toHsl();a=(b.h+a)%360;b.h=0>a?360+a:a;return(0,module$node_modules$tinycolor2$tinycolor.default)(b)}
   function complement$$module$node_modules$tinycolor2$tinycolor(b){b=(0,module$node_modules$tinycolor2$tinycolor.default)(b).toHsl();b.h=(b.h+180)%360;return(0,module$node_modules$tinycolor2$tinycolor.default)(b)}
   function triad$$module$node_modules$tinycolor2$tinycolor(b){var a=(0,module$node_modules$tinycolor2$tinycolor.default)(b).toHsl(),c=a.h;return[(0,module$node_modules$tinycolor2$tinycolor.default)(b),(0,module$node_modules$tinycolor2$tinycolor.default)({h:(c+120)%360,s:a.s,l:a.l}),(0,module$node_modules$tinycolor2$tinycolor.default)({h:(c+240)%360,s:a.s,l:a.l})]}
   function tetrad$$module$node_modules$tinycolor2$tinycolor(b){var a=(0,module$node_modules$tinycolor2$tinycolor.default)(b).toHsl(),c=a.h;return[(0,module$node_modules$tinycolor2$tinycolor.default)(b),(0,module$node_modules$tinycolor2$tinycolor.default)({h:(c+90)%360,s:a.s,l:a.l}),(0,module$node_modules$tinycolor2$tinycolor.default)({h:(c+180)%360,s:a.s,l:a.l}),(0,module$node_modules$tinycolor2$tinycolor.default)({h:(c+270)%360,s:a.s,l:a.l})]}
   function splitcomplement$$module$node_modules$tinycolor2$tinycolor(b){var a=(0,module$node_modules$tinycolor2$tinycolor.default)(b).toHsl(),c=a.h;return[(0,module$node_modules$tinycolor2$tinycolor.default)(b),(0,module$node_modules$tinycolor2$tinycolor.default)({h:(c+72)%360,s:a.s,l:a.l}),(0,module$node_modules$tinycolor2$tinycolor.default)({h:(c+216)%360,s:a.s,l:a.l})]}
   function analogous$$module$node_modules$tinycolor2$tinycolor(b,a,c){a=a||6;c=c||30;var d=(0,module$node_modules$tinycolor2$tinycolor.default)(b).toHsl();c=360/c;b=[(0,module$node_modules$tinycolor2$tinycolor.default)(b)];for(d.h=(d.h-(c*a>>1)+720)%360;--a;)d.h=(d.h+c)%360,b.push((0,module$node_modules$tinycolor2$tinycolor.default)(d));return b}
   function monochromatic$$module$node_modules$tinycolor2$tinycolor(b,a){a=a||6;var c=(0,module$node_modules$tinycolor2$tinycolor.default)(b).toHsv();b=c.h;var d=c.s;c=c.v;for(var e=[],g=1/a;a--;)e.push((0,module$node_modules$tinycolor2$tinycolor.default)({h:b,s:d,v:c})),c=(c+g)%1;return e}
   module$node_modules$tinycolor2$tinycolor.default.mix=function(b,a,c){c=0===c?0:c||50;b=(0,module$node_modules$tinycolor2$tinycolor.default)(b).toRgb();a=(0,module$node_modules$tinycolor2$tinycolor.default)(a).toRgb();c/=100;return(0,module$node_modules$tinycolor2$tinycolor.default)({r:(a.r-b.r)*c+b.r,g:(a.g-b.g)*c+b.g,b:(a.b-b.b)*c+b.b,a:(a.a-b.a)*c+b.a})};
   module$node_modules$tinycolor2$tinycolor.default.readability=function(b,a){b=(0,module$node_modules$tinycolor2$tinycolor.default)(b);a=(0,module$node_modules$tinycolor2$tinycolor.default)(a);return(Math$$module$node_modules$tinycolor2$tinycolor.max(b.getLuminance(),a.getLuminance())+.05)/(Math$$module$node_modules$tinycolor2$tinycolor.min(b.getLuminance(),a.getLuminance())+.05)};
   module$node_modules$tinycolor2$tinycolor.default.isReadable=function(b,a,c){b=module$node_modules$tinycolor2$tinycolor.default.readability(b,a);a=!1;c=validateWCAG2Parms$$module$node_modules$tinycolor2$tinycolor(c);switch(c.level+c.size){case "AAsmall":case "AAAlarge":a=4.5<=b;break;case "AAlarge":a=3<=b;break;case "AAAsmall":a=7<=b}return a};
   module$node_modules$tinycolor2$tinycolor.default.mostReadable=function(b,a,c){var d=null,e=0;c=c||{};var g=c.includeFallbackColors;var h=c.level;var f=c.size;for(var k=0;k<a.length;k++){var l=module$node_modules$tinycolor2$tinycolor.default.readability(b,a[k]);l>e&&(e=l,d=(0,module$node_modules$tinycolor2$tinycolor.default)(a[k]))}if(module$node_modules$tinycolor2$tinycolor.default.isReadable(b,d,{level:h,size:f})||!g)return d;c.includeFallbackColors=!1;return module$node_modules$tinycolor2$tinycolor.default.mostReadable(b,
   ["#fff","#000"],c)};
   var names$$module$node_modules$tinycolor2$tinycolor=module$node_modules$tinycolor2$tinycolor.default.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",
   darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",
   forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",
   lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",
   moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",
   seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},hexNames$$module$node_modules$tinycolor2$tinycolor=module$node_modules$tinycolor2$tinycolor.default.hexNames=flip$$module$node_modules$tinycolor2$tinycolor(names$$module$node_modules$tinycolor2$tinycolor);
   function flip$$module$node_modules$tinycolor2$tinycolor(b){var a={},c;for(c in b)b.hasOwnProperty(c)&&(a[b[c]]=c);return a}function boundAlpha$$module$node_modules$tinycolor2$tinycolor(b){b=parseFloat(b);if(isNaN(b)||0>b||1<b)b=1;return b}
   function bound01$$module$node_modules$tinycolor2$tinycolor(b,a){isOnePointZero$$module$node_modules$tinycolor2$tinycolor(b)&&(b="100%");var c=isPercentage$$module$node_modules$tinycolor2$tinycolor(b);b=mathMin$$module$node_modules$tinycolor2$tinycolor(a,mathMax$$module$node_modules$tinycolor2$tinycolor(0,parseFloat(b)));c&&(b=parseInt(b*a,10)/100);return 1E-6>Math$$module$node_modules$tinycolor2$tinycolor.abs(b-a)?1:b%a/parseFloat(a)}
   function clamp01$$module$node_modules$tinycolor2$tinycolor(b){return mathMin$$module$node_modules$tinycolor2$tinycolor(1,mathMax$$module$node_modules$tinycolor2$tinycolor(0,b))}function parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(b){return parseInt(b,16)}function isOnePointZero$$module$node_modules$tinycolor2$tinycolor(b){return"string"==typeof b&&-1!=b.indexOf(".")&&1===parseFloat(b)}
   function isPercentage$$module$node_modules$tinycolor2$tinycolor(b){return"string"===typeof b&&-1!=b.indexOf("%")}function pad2$$module$node_modules$tinycolor2$tinycolor(b){return 1==b.length?"0"+b:""+b}function convertToPercentage$$module$node_modules$tinycolor2$tinycolor(b){1>=b&&(b=100*b+"%");return b}function convertDecimalToHex$$module$node_modules$tinycolor2$tinycolor(b){return Math$$module$node_modules$tinycolor2$tinycolor.round(255*parseFloat(b)).toString(16)}
   function convertHexToDecimal$$module$node_modules$tinycolor2$tinycolor(b){return parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(b)/255}
   var matchers$$module$node_modules$tinycolor2$tinycolor=function(){return{CSS_UNIT:/(?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?)/,rgb:/rgb[\s|\(]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))\s*\)?/,rgba:/rgba[\s|\(]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))\s*\)?/,hsl:/hsl[\s|\(]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))\s*\)?/,
   hsla:/hsla[\s|\(]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))\s*\)?/,hsv:/hsv[\s|\(]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))\s*\)?/,hsva:/hsva[\s|\(]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))\s*\)?/,
   hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function isValidCSSUnit$$module$node_modules$tinycolor2$tinycolor(b){return!!matchers$$module$node_modules$tinycolor2$tinycolor.CSS_UNIT.exec(b)}
   function stringInputToObject$$module$node_modules$tinycolor2$tinycolor(b){b=b.replace(trimLeft$$module$node_modules$tinycolor2$tinycolor,"").replace(trimRight$$module$node_modules$tinycolor2$tinycolor,"").toLowerCase();var a=!1;if(names$$module$node_modules$tinycolor2$tinycolor[b])b=names$$module$node_modules$tinycolor2$tinycolor[b],a=!0;else if("transparent"==b)return{r:0,g:0,b:0,a:0,format:"name"};var c;return(c=matchers$$module$node_modules$tinycolor2$tinycolor.rgb.exec(b))?{r:c[1],g:c[2],b:c[3]}:
   (c=matchers$$module$node_modules$tinycolor2$tinycolor.rgba.exec(b))?{r:c[1],g:c[2],b:c[3],a:c[4]}:(c=matchers$$module$node_modules$tinycolor2$tinycolor.hsl.exec(b))?{h:c[1],s:c[2],l:c[3]}:(c=matchers$$module$node_modules$tinycolor2$tinycolor.hsla.exec(b))?{h:c[1],s:c[2],l:c[3],a:c[4]}:(c=matchers$$module$node_modules$tinycolor2$tinycolor.hsv.exec(b))?{h:c[1],s:c[2],v:c[3]}:(c=matchers$$module$node_modules$tinycolor2$tinycolor.hsva.exec(b))?{h:c[1],s:c[2],v:c[3],a:c[4]}:(c=matchers$$module$node_modules$tinycolor2$tinycolor.hex8.exec(b))?
   {r:parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(c[1]),g:parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(c[2]),b:parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(c[3]),a:convertHexToDecimal$$module$node_modules$tinycolor2$tinycolor(c[4]),format:a?"name":"hex8"}:(c=matchers$$module$node_modules$tinycolor2$tinycolor.hex6.exec(b))?{r:parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(c[1]),g:parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(c[2]),b:parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(c[3]),
   format:a?"name":"hex"}:(c=matchers$$module$node_modules$tinycolor2$tinycolor.hex4.exec(b))?{r:parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(c[1]+""+c[1]),g:parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(c[2]+""+c[2]),b:parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(c[3]+""+c[3]),a:convertHexToDecimal$$module$node_modules$tinycolor2$tinycolor(c[4]+""+c[4]),format:a?"name":"hex8"}:(c=matchers$$module$node_modules$tinycolor2$tinycolor.hex3.exec(b))?{r:parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(c[1]+
   ""+c[1]),g:parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(c[2]+""+c[2]),b:parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(c[3]+""+c[3]),format:a?"name":"hex"}:!1}function validateWCAG2Parms$$module$node_modules$tinycolor2$tinycolor(b){b=b||{level:"AA",size:"small"};var a=(b.level||"AA").toUpperCase();b=(b.size||"small").toLowerCase();"AA"!==a&&"AAA"!==a&&(a="AA");"small"!==b&&"large"!==b&&(b="small");return{level:a,size:b}};var module$src$externals$three={};try{module$src$externals$three.default=eval("THREE")}catch(b){"function"===typeof require&&(module$src$externals$three.default=eval("require('three')"))};var module$src$polyfills$padStart={default:{}};String.prototype.padStart||(String.prototype.padStart=function(b,a){b>>=0;a=String("undefined"!==typeof a?a:" ");if(this.length>b)return String(this);b-=this.length;b>a.length&&(a+=a.repeat(b/a.length));return a.slice(0,b)+String(this)});var module$src$polyfills$padEnd={default:{}};String.prototype.padEnd||(String.prototype.padEnd=function(b,a){b>>=0;a=String("undefined"!==typeof a?a:" ");if(this.length>b)return String(this);b-=this.length;b>a.length&&(a+=a.repeat(b/a.length));return String(this)+a.slice(0,b)});var module$src$shared$util$toTinyColor={},tinycolor$$module$src$shared$util$toTinyColor=module$node_modules$tinycolor2$tinycolor.default;
   if(void 0===module$node_modules$tinycolor2$tinycolor.default.prototype.toThreeColor){var THREE$$module$src$shared$util$toTinyColor=module$src$externals$three.default;module$node_modules$tinycolor2$tinycolor.default.prototype.toThreeColor=function(){return new module$src$externals$three.default.Color(this.toRgbString())};module$node_modules$tinycolor2$tinycolor.default.prototype.toArray=function(){return[this._r,this._g,this._b,255*this._a]}}
   module$src$shared$util$toTinyColor.default=function(b,a){if(b.hasOwnProperty("getOriginalInput"))return b;var c=null;a&&(c=(0,module$node_modules$tinycolor2$tinycolor.default)(a));if("number"===typeof b)return b=b.toString(16),a=b.length,3>a?b=b.padStart(3,0):6>a?b=b.padStart(6,0):8>a&&(b=b.padEnd(8,0)),b=(0,module$node_modules$tinycolor2$tinycolor.default)(b),b.isValid()?b:c;if(b.isColor&&"function"==typeof b.getHexString)return b=(0,module$node_modules$tinycolor2$tinycolor.default)(b.getHexString()),
   b.isValid()?b:c;if(Array.isArray(b)&&(3==b.length||4==b.length)){a=!0;for(var d=0;3>d;++d)b[d]=parseFloat(b[d]),isNaN(b[d])&&(a=!1);if(!a)return c;a=(0,module$node_modules$tinycolor2$tinycolor.default)({r:Math.max(0,Math.min(b[0],255)),g:Math.max(0,Math.min(b[1],255)),b:Math.max(0,Math.min(b[2],255))});4==b.length&&(b=parseFloat(b[3]),isNaN(b)||a.setAlpha(Math.max(0,Math.min(b,255))/255));return a.isValid()?a:c}if("string"!==typeof b)return b=(0,module$node_modules$tinycolor2$tinycolor.default)(b),
   b.isValid()?b:c;b=b.replace("0x","#");if(null!==b.match(/^#[a-f0-9]{6}$/i))return b=(0,module$node_modules$tinycolor2$tinycolor.default)(b+"ff"),b.isValid()?b:c;if(null!==b.match(/^#[a-f0-9]{8}$/i))return b=(0,module$node_modules$tinycolor2$tinycolor.default)(b),b.isValid()?b:c;if(null!==b.match(/^#[a-f0-9]{7}$/i))return b=(0,module$node_modules$tinycolor2$tinycolor.default)(b.slice(0,7)+"0"+b.slice(-1)),b.isValid()?b:c;b=(0,module$node_modules$tinycolor2$tinycolor.default)(b);return b.isValid()?
   b:c};var module$src$shared$util$atobtoa={default:{}};module$src$shared$util$atobtoa.default.btoaUTF8=function(b,a){return originalBtoa$$module$src$shared$util$atobtoa((a?"\u00ef\u00bb\u00bf":"")+b.replace(/[\x80-\uD7ff\uDC00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]?/g,btoaReplacer$$module$src$shared$util$atobtoa))};
   module$src$shared$util$atobtoa.default.atobUTF8=function(b,a){a||"\u00ef\u00bb\u00bf"!==b.substring(0,3)||(b=b.substring(3));return originalAtob$$module$src$shared$util$atobtoa(b).replace(/[\xc0-\xff][\x80-\xbf]*/g,atobReplacer$$module$src$shared$util$atobtoa)};
   var log$$module$src$shared$util$atobtoa=Math.log,LN2$$module$src$shared$util$atobtoa=Math.LN2,clz32$$module$src$shared$util$atobtoa=Math.clz32||function(b){return 31-log$$module$src$shared$util$atobtoa(b>>>0)/LN2$$module$src$shared$util$atobtoa|0},fromCharCode$$module$src$shared$util$atobtoa=String.fromCharCode,originalAtob$$module$src$shared$util$atobtoa=atob,originalBtoa$$module$src$shared$util$atobtoa=btoa;
   function btoaReplacer$$module$src$shared$util$atobtoa(b){var a=b.charCodeAt(0);if(55296<=a&&56319>=a){var c=b.charCodeAt(1);if(c===c&&56320<=c&&57343>=c){if(a=1024*(a-55296)+c-56320+65536,65535<a)return fromCharCode$$module$src$shared$util$atobtoa(240|a>>>18,128|a>>>12&63,128|a>>>6&63,128|a&63)}else return fromCharCode$$module$src$shared$util$atobtoa(239,191,189)}return 127>=a?b:2047>=a?fromCharCode$$module$src$shared$util$atobtoa(192|a>>>6,128|a&63):fromCharCode$$module$src$shared$util$atobtoa(224|
   a>>>12,128|a>>>6&63,128|a&63)}function atobReplacer$$module$src$shared$util$atobtoa(b){var a=b.charCodeAt(0)<<24,c=clz32$$module$src$shared$util$atobtoa(~a),d=0,e=b.length,g="";if(5>c&&e>=c){a=a<<c>>>24+c;for(d=1;d<c;++d)a=a<<6|b.charCodeAt(d)&63;65535>=a?g+=fromCharCode$$module$src$shared$util$atobtoa(a):1114111>=a?(a-=65536,g+=fromCharCode$$module$src$shared$util$atobtoa((a>>10)+55296,(a&1023)+56320)):d=0}for(;d<e;++d)g+="\ufffd";return g};var module$src$shared$util$CopyManager={default:{}},__values$$module$src$shared$util$CopyManager=this&&module$src$shared$util$CopyManager.default.__values||function(b){var a="function"===typeof Symbol&&Symbol.iterator,c=a&&b[a],d=0;if(c)return c.call(b);if(b&&"number"===typeof b.length)return{next:function(){b&&d>=b.length&&(b=void 0);return{value:b&&b[d++],done:!b}}};throw new TypeError(a?"Object is not iterable.":"Symbol.iterator is not defined.");};
   Object.defineProperty(module$src$shared$util$CopyManager.default,"__esModule",{value:!0});
   var CopyManager$$module$src$shared$util$CopyManager=function(){function b(){this._nanString="___NaN___";this._negInfinity="___NegInfinity___";this._posInfinity="___PosInfinity___";this._replaceRegex=/\]$/;this._splitRegex=/[.[\]]+/;this._copyId=0}b.prototype.deepCopy=function(a,b){var c,e=this;void 0===b&&(b=[]);if("object"!==typeof a)return a;Array.isArray(b)||(b=[b]);if(0===b.length){var g=new WeakMap,h={};var f=JSON.stringify(a,function(a,b){return e.deepCopyReplacer(a,b,g,h)});return JSON.parse(f,
   function(a,b){return e.deepCopyReviver(a,b,h)})}var k=[];if(this.getPaths(a,k,"",b)||0===k.length)return this.deepCopy(a);var l={},m=function(c){var d,e,g=n.getAtPath(a,c);if(b.every(function(a){return c===a||c.endsWith("."+a)?!1:!0}))if(Array.isArray(g)){var h=g;g=[];try{for(var f=(d=void 0,__values$$module$src$shared$util$CopyManager(h)),m=f.next();!m.done;m=f.next())g.push(n.deepCopy(m.value,b))}catch(A){d={error:A}}finally{try{m&&!m.done&&(e=f.return)&&e.call(f)}finally{if(d)throw d.error;}}}else g=
   n.deepCopy(g);n.forceAtPath(l,c,g)},n=this;try{for(var q=__values$$module$src$shared$util$CopyManager(k),p=q.next();!p.done;p=q.next())m(p.value)}catch(u){f={error:u}}finally{try{p&&!p.done&&(c=q.return)&&c.call(q)}finally{if(f)throw f.error;}}return l};b.prototype.deepCopyReplacer=function(a,b,d,e){void 0===d&&(d=null);void 0===e&&(e=null);if("number"===typeof b&&isNaN(b))return this._nanString;if(b===Number.POSITIVE_INFINITY)return this._posInfinity;if(b===Number.NEGATIVE_INFINITY)return this._negInfinity;
   if(null!==d&&"object"===typeof b&&b)if(!d.has(b))a=this.createCopyId(),d.set(b,a),e[a]=b;else if(null!==e&&null!==d)return a=d.get(b);return b};b.prototype.deepCopyReviver=function(a,b,d){void 0===d&&(d=null);if("string"===typeof b){if(b===this._nanString)return Number.NaN;if(b===this._posInfinity)return Number.POSITIVE_INFINITY;if(b===this._negInfinity)return Number.NEGATIVE_INFINITY;if(null!==d&&d[b])return d[b]}return b};b.prototype.createCopyId=function(){return"___Copy___:"+this._copyId++};b.prototype.forceAt=
   function(a,b,d){if(void 0!==a&&"object"===typeof a){var c=b.pop();if("string"===typeof c)return 0<b.length&&(a=b.reduce(function(a,b){return a&&void 0!==a[b]&&"object"===typeof a[b]?a[b]:a[b]={}},a)),a[c]=d}};b.prototype.forceAtPath=function(a,b,d){b=b.replace(this._replaceRegex,"").split(this._splitRegex);return this.forceAt(a,b,d)};b.prototype.getAt=function(a,b){return b.reduce(function(a,b){return a&&void 0!==a[b]?a[b]:void 0},a)};b.prototype.getAtPath=function(a,b){b=b.replace(/\]$/,"").split(/[.[\]]+/);
   return this.getAt(a,b)};b.prototype.getPaths=function(a,b,d,e,g){var c=this;void 0===b&&(b=[]);void 0===d&&(d="");void 0===e&&(e=[]);void 0===g&&(g=!1);Array.isArray(b)||(b=[]);"string"!==typeof d&&(d="");Array.isArray(e)||(e=[]);"boolean"!==typeof g&&(g=!1);if(void 0===a||null===a||"object"!==typeof a||Array.isArray(a))return!0;if(g){var f=[];for(var k in a)f.push(k)}else f=Object.keys(a);if(0===f.length)return!0;f.forEach(function(h){var f=0===d.length?h:d+"."+h;e.includes(h)?b.push(f):c.getPaths(a[h],
   b,f,e,g)&&b.push(f)});return!1};return b}();module$src$shared$util$CopyManager.default.CopyManagerInstance=new CopyManager$$module$src$shared$util$CopyManager;var module$src$shared$util$FileUtil={default:{}};Object.defineProperty(module$src$shared$util$FileUtil.default,"__esModule",{value:!0});var FileUtil$$module$src$shared$util$FileUtil=function(){function b(){}b.prototype.guessMimeTypeFromFilename=function(a){a=a.toLowerCase();return a.endsWith(".dxf")?"application/dxf":a.endsWith(".obj")?"application/wavefront-obj":a.endsWith(".csv")?"text/csv":""};return b}();module$src$shared$util$FileUtil.default.FileUtilInstance=new FileUtil$$module$src$shared$util$FileUtil;var module$src$shared$util$GlobalUtils={},TOTINYCOLOR$$module$src$shared$util$GlobalUtils=module$src$shared$util$toTinyColor.default,THREE$$module$src$shared$util$GlobalUtils=module$src$externals$three.default,ATOBTOA$$module$src$shared$util$GlobalUtils=module$src$shared$util$atobtoa.default,CopyManagerInstance$$module$src$shared$util$GlobalUtils=module$src$shared$util$CopyManager.default.CopyManagerInstance,FileUtilInstance$$module$src$shared$util$GlobalUtils=module$src$shared$util$FileUtil.default.FileUtilInstance,
   GlobalUtils$$module$src$shared$util$GlobalUtils=function(){var b=this,a="undefined"!==typeof window&&window.navigator&&-1<window.navigator.userAgent.indexOf("Trident"),c=a||"undefined"!==typeof document&&"function"===typeof document.getElementById&&window&&"function"===typeof window.Event,d=!1;var e=c?(d=parent!==window)?document.referrer:window.location.origin:"direct";this.runningInIE=function(){return a};this.runningInBrowser=function(){return c};this.runningInIframe=function(){return d};this.embeddingOrigin=
   function(){return e+""};this.getNodeAttribute=function(a,b,d){return c&&a&&!Array.isArray(a)&&"function"===typeof a.hasAttribute&&a.hasAttribute(b)?a.getAttribute(b):d};this.getBooleanNodeAttribute=function(a,b,d){return c&&a&&!Array.isArray(a)&&"function"===typeof a.hasAttribute&&a.hasAttribute(b)?this.toBoolean(a.getAttribute(b),d):d};this.parseQueryString=function(a,b){b=void 0===b?!1:b;a=a.split("&");for(var c={},d=0;d<a.length;d++){var e=a[d].split("="),g=decodeURIComponent(e[0]);e=decodeURIComponent(e[1]);
   "undefined"===typeof c[g]?c[g]=e:b&&("string"===typeof c[g]?c[g]=[c[g],e]:c[g].push(e))}return c};this.guessMimeTypeFromFilename=function(a){return module$src$shared$util$FileUtil.default.FileUtilInstance.guessMimeTypeFromFilename(a)};this.storageAvailable=function(a){try{var b=window[a];b.setItem("__storage_test__","__storage_test__");b.removeItem("__storage_test__");return!0}catch(f){return f instanceof DOMException&&(22===f.code||1014===f.code||"QuotaExceededError"===f.name||"NS_ERROR_DOM_QUOTA_REACHED"===
   f.name)&&0!==b.length}};this.isArrayOfType=function(a,b){return Array.isArray(a)?-1===a.findIndex(function(a){return typeof a!==b}):!1};this.deepCopyReplacer=function(a,b){return module$src$shared$util$CopyManager.default.CopyManagerInstance.deepCopyReplacer(a,b)};this.deepCopyReviver=function(a,b){return module$src$shared$util$CopyManager.default.CopyManagerInstance.deepCopyReviver(a,b)};this.deepCopy=function(a,b){return module$src$shared$util$CopyManager.default.CopyManagerInstance.deepCopy(a,
   b)};this.setIfUndefined=function(a,b){return"undefined"===typeof a?b:a};this.inject=function(a,b,c){void 0===c&&(c=!0);Object.keys(a).forEach(function(d){if(c||!b.hasOwnProperty(d))b[d]=a[d]});return b};this.defineHiddenProperty=function(a,b){Object.defineProperty(this,a,{enumerable:!1,configurable:!1,writable:!0,value:b})};this.defineConstantProperty=function(a,b){Object.defineProperty(this,a,{enumerable:!0,configurable:!1,writable:!1,value:b})};this.stringChecksum=function(a){var b=0,c=a.length,
   d;if(0===c)return b;for(d=0;d<c;d++){var e=a.charCodeAt(d);b=(b<<5)-b+e;b&=b}return b};this.toNumber=function(a,b){a=Number(a);Number.isNaN(a)&&(a=b);return a};this.toBoolean=function(a,b){"boolean"!==typeof b&&(b=!1);return"boolean"===typeof a?a:"string"===typeof a?(a=a.toLowerCase(),b?"false"===a||"0"===a?!1:!0:"true"===a||"1"===a?!0:!1):!!a};this.createRandomId=function(){return Math.random().toString(36).substring(2,15)};this.getAt=function(a,b){return module$src$shared$util$CopyManager.default.CopyManagerInstance.getAt(a,
   b)};this.getAtPath=function(a,b){return module$src$shared$util$CopyManager.default.CopyManagerInstance.getAtPath(a,b)};this.setAt=function(a,b,c,d){var e=b.pop();if("string"===typeof e&&(0<b.length&&(a=b.reduce(function(a,b){return a&&void 0!==a[b]?a[b]:void 0},a)),a&&(void 0!==a[e]||d)))return a[e]=c};this.setAtPath=function(a,c,d,e){c=c.replace(/\]$/,"").split(/[.[\]]+/);return b.setAt(a,c,d,e)};this.forceAt=function(a,b,c){return module$src$shared$util$CopyManager.default.CopyManagerInstance.forceAt(a,
   b,c)};this.forceAtPath=function(a,b,c){return module$src$shared$util$CopyManager.default.CopyManagerInstance.forceAtPath(a,b,c)};this.deleteAt=function(a,b){var c=b.pop();if("string"===typeof c&&(0<b.length&&(a=b.reduce(function(a,b){return a&&void 0!==a[b]?a[b]:void 0},a)),a))return b=a[c],delete a[c],b};this.deleteAtPath=function(a,c){c=c.replace(/\]$/,"").split(/[.[\]]+/);return b.deleteAt(a,c)};this.getPaths=function(a,b,c,d,e){return module$src$shared$util$CopyManager.default.CopyManagerInstance.getPaths(a,
   b,c,d,e)};this.defaults=function(a,c,d){if(Array.isArray(c))return c.reduce(function(a,c){return b.defaults(a,c,d)},a);for(var e in c)a.hasOwnProperty(e)?Array.isArray(a[e])||"object"!==typeof a[e]||"object"!==typeof c[e]?d&&(a[e]=b.deepCopy(c[e])):b.defaults(a[e],c[e],d):a[e]=b.deepCopy(c[e]);return a};this.cartesianToPolar=function(a,b,c){var d=Math.sqrt(Math.pow(a,2)+Math.pow(b,2)+Math.pow(c,2));return[d,Math.acos(c/d),Math.atan2(b,a)]};this.polarToCartesian=function(a,b,c){return[a*Math.sin(b)*
   Math.cos(c),a*Math.sin(b)*Math.sin(c),a*Math.cos(b)]};this.check={any:function(){return!0},string:function(a){return"string"===typeof a||a instanceof String},number:function(a){return("number"===typeof a||a instanceof Number)&&!isNaN(a)},float:function(a){return("number"===typeof a||a instanceof Number)&&!isNaN(a)},notnegative:function(a){return("number"===typeof a||a instanceof Number)&&0<=a},notpositive:function(a){return("number"===typeof a||a instanceof Number)&&0>=a},negative:function(a){return("number"===
   typeof a||a instanceof Number)&&0>a},positive:function(a){return("number"===typeof a||a instanceof Number)&&0<a},factor:function(a){return("number"===typeof a||a instanceof Number)&&0<=a&&1>=a},color:function(a){return null!==(0,module$src$shared$util$toTinyColor.default)(a)},integer:function(a){return("number"===typeof a||a instanceof Number)&&!isNaN(a)&&a===parseInt(a,10)},boolean:function(a){return"boolean"===typeof a||a instanceof Boolean},object:function(a){return void 0!==a&&"object"===typeof a},
   function:function(a){return void 0!==a&&"function"===typeof a},hexadecimal:function(a){if(b.typeCheck(a,"string")){a=a.replace("#","");var c=parseInt(a,16);return!(!a.endsWith(c.toString(16))||0>c||16777215<c)}return b.typeCheck(a,"number")?!(0>a||16777215<a):!1},vector2obj:function(a){return!a.x&&0!==a.x||!a.y&&0!==a.y?!1:b.typeCheck(a.x,"number")&&b.typeCheck(a.y,"number")?!0:!1},vector2arr:function(a){return Array.isArray(a)&&2<=a.length?b.typeCheck(a[0],"number")&&b.typeCheck(a[1],"number")?!0:
   !1:!1},vector2any:function(a){return b.typeCheck(a,"vector2arr")||b.typeCheck(a,"vector2obj")?!0:!1},vector3obj:function(a){return!a.x&&0!==a.x||!a.y&&0!==a.y||!a.z&&0!==a.z?!1:b.typeCheck(a.x,"number")&&b.typeCheck(a.y,"number")&&b.typeCheck(a.z,"number")?!0:!1},vector3arr:function(a){return Array.isArray(a)&&3<=a.length?b.typeCheck(a[0],"number")&&b.typeCheck(a[1],"number")&&b.typeCheck(a[2],"number")?!0:!1:!1},vector3any:function(a){return b.typeCheck(a,"vector3arr")||b.typeCheck(a,"vector3obj")?
   !0:!1},matrix4x4obj:function(a){return!a.a&&0!==a.a||!a.b&&0!==a.b||!a.c&&0!==a.c||!a.d&&0!==a.d||!a.e&&0!==a.e||!a.f&&0!==a.f||!a.g&&0!==a.g||!a.h&&0!==a.h||!a.i&&0!==a.i||!a.j&&0!==a.j||!a.k&&0!==a.k||!a.l&&0!==a.l||!a.m&&0!==a.m||!a.n&&0!==a.n||!a.o&&0!==a.o||!a.p&&0!==a.p?!1:b.typeCheck(a.a,"number")&&b.typeCheck(a.b,"number")&&b.typeCheck(a.c,"number")&&b.typeCheck(a.d,"number")&&b.typeCheck(a.e,"number")&&b.typeCheck(a.f,"number")&&b.typeCheck(a.g,"number")&&b.typeCheck(a.h,"number")&&b.typeCheck(a.i,
   "number")&&b.typeCheck(a.j,"number")&&b.typeCheck(a.k,"number")&&b.typeCheck(a.l,"number")&&b.typeCheck(a.m,"number")&&b.typeCheck(a.n,"number")&&b.typeCheck(a.o,"number")&&b.typeCheck(a.p,"number")?!0:!1},matrix4x4arr:function(a){return Array.isArray(a)&&16<=a.length?b.typeCheck(a[0],"number")&&b.typeCheck(a[1],"number")&&b.typeCheck(a[2],"number")&&b.typeCheck(a[3],"number")&&b.typeCheck(a[4],"number")&&b.typeCheck(a[5],"number")&&b.typeCheck(a[6],"number")&&b.typeCheck(a[7],"number")&&b.typeCheck(a[8],
   "number")&&b.typeCheck(a[9],"number")&&b.typeCheck(a[10],"number")&&b.typeCheck(a[11],"number")&&b.typeCheck(a[12],"number")&&b.typeCheck(a[13],"number")&&b.typeCheck(a[14],"number")&&b.typeCheck(a[15],"number")?!0:!1:!1},matrix4x4any:function(a){return b.typeCheck(a,"matrix4x4arr")||b.typeCheck(a,"matrix4x4obj")?!0:!1},box3any:function(a){return a.min&&a.max&&b.typeCheck(a.min,"vector3any")&&b.typeCheck(a.max,"vector3any")?!0:!1}};this.typeCheck=function(a,b,c,d,e){for(var g=[],f=4;f<arguments.length;++f)g[f-
   4]=arguments[f];if(void 0===a){f="The given input is undefined.";var h=!1}else null===a?(f="The given input is null.",h=!1):(b=b.toLowerCase(),this.check[b]?f=(h=this.check[b](a))?"":"Value "+a+" is not a "+b:(f="No type check available for type "+b+". The possible types are ["+Object.getOwnPropertyNames(this.check).map(function(a){return" "+a})+" ]. Choose one of them.",h=!1));"function"===typeof c&&!1===h&&(d?c.apply(null,[d,f].concat($jscomp.arrayFromIterable(g))):c.apply(null,[f].concat($jscomp.arrayFromIterable(g))));
   return h};this.waitForTimeout=function(a){return new Promise(function(b){setInterval(b,a)})};this.toVector3=function(a){if(a.isVector3)return a;if(Array.isArray(a)&&2<=a.length){var b=new module$src$externals$three.default.Vector3;b.fromArray(a);return b}return new module$src$externals$three.default.Vector3(a.x,a.y,a.z)};this.versionStringLowerThan=function(a,b){a=a.split(".");b=b.split(".");if(a.length>b.length)for(var c=b.length;c<a.length;c++)b.push("0");else if(a.length<b.length)for(c=a.length;c<
   b.length;c++)a.push("0");a.reverse();b.reverse();var d=1;a.forEach(function(a){return d=a.length>d?a.length:d});b.forEach(function(a){return d=a.length>d?a.length:d});c=function(a,b,c){return a+Math.pow(10,c*d)*b};a=a.reduce(c,0);b=b.reduce(c,0);return a<b};this.ArrayToObject=function(a){if(!Array.isArray(a))return null;var b,c=a.length,d={};for(b=0;b<c;b++)d[""+b]=a[b];return d};this.ObjectToArray=function(a){if(null===a||"object"!==typeof a)return null;var b,c=[];for(b=0;;b++){var d=""+b;if(!a.hasOwnProperty(d))break;
   c.push(a[d])}return c};this.toTinyColor=module$src$shared$util$toTinyColor.default;this.atobUTF8=module$src$shared$util$atobtoa.default.atobUTF8;this.btoaUTF8=module$src$shared$util$atobtoa.default.btoaUTF8;return this};module$src$shared$util$GlobalUtils.default=new GlobalUtils$$module$src$shared$util$GlobalUtils;var module$build$build_data={default:{}};Object.defineProperty(module$build$build_data.default,"__esModule",{value:!0});module$build$build_data.default.build_data={build_version:"2.19.2",build_date:"2020-03-04T10:16:27.160Z",build_branch:"2.19.2",build_commit:"71d02b9d80148a685735bdc1a68e477b47baff09"};var module$src$api$v2$ApiReflectorV2_1={},GLOBAL_UTILS$$module$src$api$v2$ApiReflectorV2_1=module$src$shared$util$GlobalUtils.default,FUNCTION_PREFIX$$module$src$api$v2$ApiReflectorV2_1="___fn_",INCLUDE_PROTOTYPE$$module$src$api$v2$ApiReflectorV2_1=!1;
   module$src$api$v2$ApiReflectorV2_1.default=function(b,a,c,d){if(a.startsWith("http://")){var e=a.substring(7);var g="http://"}else a.startsWith("https://")?(e=a.substring(8),g="https://"):e=null;e&&(a=e.indexOf("/"),0<=a&&(e=e.substring(0,a)),e=g+e);d=d||"sdv-iframe";var h={},f={};"boolean"!==typeof c&&(c=!1);var k=function(a){a.iframeId=d;c&&console.log("POSTING MSG",a);e&&b.postMessage(a,e)},l=function(a){c&&console.log("RECEIVING MSG",a);if(e){var b=a.origin;if(b!==e)c&&console.log("ORIGIN MISMATCH",
   b,e);else{var g=a.data;if(g&&"object"===typeof g&&"string"===typeof g.id&&g.iframeId===d&&g.token)if(g.restore)q(g.restore,g.id)?k({id:g.id,token:g.token,result:!0}):k({id:g.id,token:g.token,error:"Restoring object failed"});else if(h.hasOwnProperty(g.id))if(b=h[g.id],g.command){a=module$src$shared$util$GlobalUtils.default.getAtPath(b,g.command);if("function"!==typeof a&&(g.command.endsWith("Async")&&(a=module$src$shared$util$GlobalUtils.default.getAtPath(b,g.command.slice(0,-5))),"function"!==typeof a)){c&&
   console.log("Could not find function "+g.id);return}b=Array.isArray(g.arguments)?g.arguments:null;null===b&&"string"===typeof g.arguments_id&&h.hasOwnProperty(g.arguments_id)&&(b=module$src$shared$util$GlobalUtils.default.ObjectToArray(h[g.arguments_id]));c&&console.log("Calling function with arguments",a,b);a=a.apply(null,b);a instanceof Promise?a.then(function(a){a.err&&a.err instanceof Error?k({id:g.id,token:g.token,error:a.err.message}):k({id:g.id,token:g.token,result:a})},function(a){a instanceof
   Error?k({id:g.id,token:g.token,error:a.message,reject:!0}):k({id:g.id,token:g.token,error:a,reject:!0})}):k({id:g.id,token:g.token,result:a})}else g.hasOwnProperty("result")?f.hasOwnProperty(g.token)&&(f[g.token].resolve(g.result),delete f[g.token]):g.error&&f.hasOwnProperty(g.token)&&(g.reject?f[g.token].reject(Error(g.error)):f[g.token].resolve({err:Error(g.error)}),delete f[g.token]);else c&&console.log("Could not find object "+g.id)}}else c&&console.log("NO TARGET ORIGIN TO CHECK AGAINST")},m=
   function(a,b,c){var d=[],e={};module$src$shared$util$GlobalUtils.default.getPaths(a,d,"",[],INCLUDE_PROTOTYPE$$module$src$api$v2$ApiReflectorV2_1);c="boolean"===typeof c?c:!1;d=d.filter(function(a){return a.endsWith("Async")?!0:!d.includes(a+"Async")});d.forEach(function(b){var d=module$src$shared$util$GlobalUtils.default.getAtPath(a,b);"function"===typeof d?b.endsWith("Async")||c?module$src$shared$util$GlobalUtils.default.forceAtPath(e,b,FUNCTION_PREFIX$$module$src$api$v2$ApiReflectorV2_1+b):b.endsWith("removeEventListener")||
   module$src$shared$util$GlobalUtils.default.forceAtPath(e,b+"Async",FUNCTION_PREFIX$$module$src$api$v2$ApiReflectorV2_1+b+"Async"):module$src$shared$util$GlobalUtils.default.forceAtPath(e,b,d)});h[b]=a;return p({id:b,restore:e})},n=function(a){var b=[];module$src$shared$util$GlobalUtils.default.getPaths(a,b,"",[],INCLUDE_PROTOTYPE$$module$src$api$v2$ApiReflectorV2_1);return!b.every(function(b){return"function"===typeof module$src$shared$util$GlobalUtils.default.getAtPath(a,b)?!1:!0})},q=function(a,
   b){if(h.hasOwnProperty(b))return null;var c=[],d={};module$src$shared$util$GlobalUtils.default.getPaths(a,c,"",[],INCLUDE_PROTOTYPE$$module$src$api$v2$ApiReflectorV2_1);c.forEach(function(c){var e=module$src$shared$util$GlobalUtils.default.getAtPath(a,c);"string"===typeof e?e.startsWith(FUNCTION_PREFIX$$module$src$api$v2$ApiReflectorV2_1)?module$src$shared$util$GlobalUtils.default.forceAtPath(d,c,u(b,c)):module$src$shared$util$GlobalUtils.default.forceAtPath(d,c,e):module$src$shared$util$GlobalUtils.default.forceAtPath(d,
   c,e)});return h[b]=d},p=function(a){var b=module$src$shared$util$GlobalUtils.default.createRandomId();a.token=b;k(a);return new Promise(function(a,c){f[b]={resolve:a,reject:c}})},u=function(a,b){return function(){var c=Array.prototype.slice.call(arguments),d=module$src$shared$util$GlobalUtils.default.ArrayToObject(c);if(n(d)){console.log("argsobj needs reflection:",d);var e=module$src$shared$util$GlobalUtils.default.createRandomId();return m(d,e,!0).then(function(){return p({id:a,command:b,arguments_id:e})})}return p({id:a,
   command:b,arguments:c})}};window.addEventListener("message",l,!1);g=function(){};g.prototype.reflect=function(a,b){return m(a,b)};g.prototype.get=function(a){return h.hasOwnProperty(a)?h[a]:null};g.prototype.destroy=function(){window.removeEventListener("message",l,!1)};g.prototype.receiveMessage=function(a){l(a)};return new g};var module$src$shared$constants$LoggingConstants={},loggingLevels$$module$src$shared$constants$LoggingConstants={NONE:-1,ERROR:0,WARN:1,INFO:2,DEBUG:3,LVLBITS:3,LOG_TO_SERVER:8,ERROR_S:8,WARN_S:9,INFO_S:10,DEBUG_S:11},defaultSettings$$module$src$shared$constants$LoggingConstants={loggingLevel:loggingLevels$$module$src$shared$constants$LoggingConstants.NONE},loggingConstants$$module$src$shared$constants$LoggingConstants={loggingLevels:loggingLevels$$module$src$shared$constants$LoggingConstants,defaultSettings:defaultSettings$$module$src$shared$constants$LoggingConstants},
   GlobalUtils$$module$src$shared$constants$LoggingConstants=module$src$shared$util$GlobalUtils.default;module$src$shared$constants$LoggingConstants.default=module$src$shared$util$GlobalUtils.default.deepCopy(loggingConstants$$module$src$shared$constants$LoggingConstants);var module$src$shared$constants$MessagingConstants={},GlobalUtils$$module$src$shared$constants$MessagingConstants=module$src$shared$util$GlobalUtils.default,messageTopics$$module$src$shared$constants$MessagingConstants={AR:"ar",DATA:"data",EXPORT:"export",EXPORT_AVAILABLE:"export.available",EXPORT_REGISTER:"export.register",EXPORT_REGISTERED:"export.registered",EXPORT_UPDATE:"export.update",EXPORT_STATUS:"export.status",PARAMETER:"parameter",PARAMETER_REGISTER:"parameter.register",PARAMETER_REGISTERED:"parameter.registered",
   PARAMETER_UPDATE:"parameter.update",PARAMETER_VALUE_UPDATE:"parameter.value.update",PLUGIN:"plugin",PLUGIN_ACTIVE:"plugin.active",PLUGIN_FAILED:"plugin.failed",PLUGIN_LOADED:"plugin.loaded",PLUGIN_REGISTERED:"plugin.registered",PLUGIN_UNLOADED:"plugin.unloaded",PROCESS:"process",SETTINGS:"settings",SETTINGS_REGISTER:"settings.register",SETTINGS_UPDATE:"settings.update",SETTINGS_REGISTERED:"settings.registered",SCENE:"scene",SCENE_ANCHOR:"scene.anchor",SCENE_ANCHOR_ADD:"scene.anchor.add",SCENE_ANCHOR_REMOVE:"scene.anchor.remove",
   SCENE_CAMERA:"scene.camera",SCENE_CAMERA_START:"scene.camera.start",SCENE_CAMERA_MOVE:"scene.camera.move",SCENE_CAMERA_END:"scene.camera.end",SCENE_DRAG:"scene.drag",SCENE_DRAG_START:"scene.drag.start",SCENE_DRAG_MOVE:"scene.drag.move",SCENE_DRAG_END:"scene.drag.end",SCENE_FRAMERATE:"scene.framerate",SCENE_HOVER:"scene.hover",SCENE_HOVER_ON:"scene.hover.on",SCENE_HOVER_OVER:"scene.hover.over",SCENE_HOVER_OFF:"scene.hover.off",SCENE_RENDER:"scene.render",SCENE_RENDER_BEAUTY:"scene.render.beauty",SCENE_RENDER_BEAUTY_START:"scene.render.beauty.start",
   SCENE_RENDER_BEAUTY_CANCEL:"scene.render.beauty.cancel",SCENE_RENDER_BEAUTY_END:"scene.render.beauty.end",SCENE_SELECT:"scene.select",SCENE_SELECT_ON:"scene.select.on",SCENE_SELECT_OFF:"scene.select.off",SCENE_SUBSCENE:"scene.subscene",SCENE_SUBSCENE_INIT:"scene.subscene.init",SCENE_SUBSCENE_OUTPUTVERSION:"scene.subscene.outputversion",SCENE_SUBSCENE_READY:"scene.subscene.ready",SCENE_SUBSCENE_PUBLISHED:"scene.subscene.published",SCENE_VISIBILITY:"scene.visibility",SCENE_VISIBILITY_ON:"scene.visibility.on",
   SCENE_VISIBILITY_OFF:"scene.visibility.off",STATUS:"status",STATUS_BUSY:"status.busy",STATUS_IDLE:"status.idle",STATUS_MESSAGE:"status.message",STATUS_FAILED:"status.failed",VIEWPORTS:"viewports",VIEWPORTS_CREATED:"viewports.created",VIEWPORTS_DESTROYED:"viewports.destroyed"},messageDataTypes$$module$src$shared$constants$MessagingConstants={GENERIC:"generic",ANCHOR_CREATE_IMAGE:"anchor.create.image",ANCHOR_UPDATE:"anchor.update",APP_SETTINGS:"app.settings",APP_STATUS:"app.status",DATA:"data",EXPORT_DEFINITION:"export.definition",
   EXPORT_RESULT:"export.result",EXPORT_STATUS:"export.status",OBJECT_PLACEMENT:"object.placement",PARAMETER_DEFINITION:"parameter.definition",PARAMETER_SETTINGS:"parameter.settings",PARAMETER_UPDATE:"parameter.update",PLUGIN_RUNTIME_ID:"plugin.runtimeId",PROCESS_ERROR:"process.error",PROCESS_ABORT:"process.abort",PROCESS_FORK:"process.fork",PROCESS_STATUS:"process.status",PROCESS_SUCCESS:"process.success",STATUS_TRACKING:"status.tracking",STATUS_MAPPING:"status.mapping",SCENE_CAMERA:"scene.camera",
   SCENE_INTERACTION:"scene.interaction",SCENE_ANCHORDATA:"scene.anchordata",SETTINGS_UPDATE:"settings.update",SUBSCENE_UPDATE:"subscene.update",SUBSCENE_OUTPUTVERSION_JSON:"subscene.outputversion.json",SUBSCENE_OUTPUTVERSION_OBJ:"subscene.outputversion.obj",SUBSCENE_INIT:"subscene.init",STATUS_MESSAGE:"status.message"},makeMessageToken$$module$src$shared$constants$MessagingConstants=function(b,a){var c={};"string"===typeof b?c.id=b+"":null!==b&&"object"===typeof b&&("string"===typeof b.id&&(c.id=b.id+
   ""),"string"===typeof b.creator&&(c.creator=b.creator+""),"number"===typeof b.serial&&(c.serial=b.serial+""),c.payload=b.payload,c.attributes=b.attributes);if("string"!==typeof c.id||0===c.id.length)c.id=module$src$shared$util$GlobalUtils.default.createRandomId();"string"!==typeof c.creator&&"string"===typeof a&&(c.creator=a+"");"number"!==typeof c.serial&&(c.serial=Date.now());return c},loggingConstants$$module$src$shared$constants$MessagingConstants=module$src$shared$constants$LoggingConstants.default,
   loggingLevels$$module$src$shared$constants$MessagingConstants=module$src$shared$constants$LoggingConstants.default.loggingLevels,defaultSettings$$module$src$shared$constants$MessagingConstants={messageLoggingLevel:loggingLevels$$module$src$shared$constants$MessagingConstants.NONE},messagingConstants$$module$src$shared$constants$MessagingConstants={messageTopics:messageTopics$$module$src$shared$constants$MessagingConstants,messageDataTypes:messageDataTypes$$module$src$shared$constants$MessagingConstants,
   defaultSettings:defaultSettings$$module$src$shared$constants$MessagingConstants};module$src$shared$constants$MessagingConstants.default=module$src$shared$util$GlobalUtils.default.deepCopy(messagingConstants$$module$src$shared$constants$MessagingConstants);module$src$shared$constants$MessagingConstants.default.makeMessageToken=makeMessageToken$$module$src$shared$constants$MessagingConstants;var module$src$app$ViewerAppConstants={},loggingConstants$$module$src$app$ViewerAppConstants=module$src$shared$constants$LoggingConstants.default,loggingLevels$$module$src$app$ViewerAppConstants=module$src$shared$constants$LoggingConstants.default.loggingLevels,messagingConstants$$module$src$app$ViewerAppConstants=module$src$shared$constants$MessagingConstants.default,messageTopics$$module$src$app$ViewerAppConstants=module$src$shared$constants$MessagingConstants.default.messageTopics,messageDataTypes$$module$src$app$ViewerAppConstants=
   module$src$shared$constants$MessagingConstants.default.messageDataTypes,DEFAULT_MATERIAL$$module$src$app$ViewerAppConstants={name:"Default material",version:"2.0",bumpAmplitude:1,color:[211,211,211,255],metalness:0,roughness:1},showSceneModes$$module$src$app$ViewerAppConstants={INSTANT:0,ON_SHOW:1,ON_FIRST_PLUGIN:2,ON_ALL_PLUGINS:3},defaultSettings$$module$src$app$ViewerAppConstants={blurSceneWhenBusy:!0,defaultMaterial:DEFAULT_MATERIAL$$module$src$app$ViewerAppConstants,ignoreSuperseded:!0,hasRestoredSettings:!1,
   loggingLevel:loggingLevels$$module$src$app$ViewerAppConstants.NONE,messageLoggingLevel:loggingLevels$$module$src$app$ViewerAppConstants.NONE,showMessages:!0,commitParameters:!1,commitSettings:!1,showScene:!1,showSceneMode:showSceneModes$$module$src$app$ViewerAppConstants.ON_FIRST_PLUGIN,showSceneTransition:"1s",strictMode:!1,useModelSettings:!0,ar:{enableCameraSync:!1,enableCameraSyncInitial:!1,enableLightingEstimation:!0,enableTouchControls:!0,enableTouchControlRotation:!0,enableAutomaticPlacement:!0,
   defaultHitTestType:"existingPlaneUsingGeometry"}},viewerAppConstants$$module$src$app$ViewerAppConstants={loggingLevels:loggingLevels$$module$src$app$ViewerAppConstants,messageTopics:messageTopics$$module$src$app$ViewerAppConstants,messageDataTypes:messageDataTypes$$module$src$app$ViewerAppConstants,showSceneModes:showSceneModes$$module$src$app$ViewerAppConstants,defaultSettings:defaultSettings$$module$src$app$ViewerAppConstants},GlobalUtils$$module$src$app$ViewerAppConstants=module$src$shared$util$GlobalUtils.default;
   module$src$app$ViewerAppConstants.default=module$src$shared$util$GlobalUtils.default.deepCopy(viewerAppConstants$$module$src$app$ViewerAppConstants);var module$src$externals$axios={};try{module$src$externals$axios.default=eval("axios")}catch(b){"function"===typeof require&&(module$src$externals$axios.default=eval("require('axios')"))};var module$src$plugins$comm$CommPluginConstants={},baseUrl$$module$src$plugins$comm$CommPluginConstants="https://model-view.shapediver.com:443",defaultSettings$$module$src$plugins$comm$CommPluginConstants={modelViewUrl:baseUrl$$module$src$plugins$comm$CommPluginConstants,ajaxTimeout:3E4,ignoreSuperseded:!0},commPluginConstants$$module$src$plugins$comm$CommPluginConstants={defaultSettings:defaultSettings$$module$src$plugins$comm$CommPluginConstants},GlobalUtils$$module$src$plugins$comm$CommPluginConstants=
   module$src$shared$util$GlobalUtils.default;module$src$plugins$comm$CommPluginConstants.default=module$src$shared$util$GlobalUtils.default.deepCopy(commPluginConstants$$module$src$plugins$comm$CommPluginConstants);var module$src$shared$constants$PluginConstantsGlobal={},pluginCapabilities$$module$src$shared$constants$PluginConstantsGlobal={NONE:0,SHAPEDIVER_MODEL_VIEW:1,INTERACTIVE:2,DRAGANDDROP:3,MESSAGECALLBACKS:4,LOGGING:5,SETTINGS:6,DEFAULTPARAM:7},pluginStatuses$$module$src$shared$constants$PluginConstantsGlobal={NONE:"none",READY:"ready",FAILED:"failed",LOADED:"loaded",ACTIVE:"active",UNLOADED:"unloaded"},setParameterResults$$module$src$shared$constants$PluginConstantsGlobal={PARAM_NOT_FOUND:"param_not_found",
   NO_VALUE:"no_value",VALUE_REJECT:"value_reject",VALUE_EXISTS:"value_exists",VALUE_OK:"value_ok",PLUGIN_NOT_FOUND:"plugin_not_found",UPLOAD_FAILED:"upload_failed",ERROR:"error",LIVE:"live",CACHE:"cache",LOAD:"load",ABORT:"abort"},requestExportResults$$module$src$shared$constants$PluginConstantsGlobal={EXPORT_NOT_FOUND:"export_not_found",PLUGIN_NOT_FOUND:"plugin_not_found",ERROR:"error",CACHE:"cache",LOAD:"load",ABORT:"abort"},pluginConstants$$module$src$shared$constants$PluginConstantsGlobal={pluginCapabilities:pluginCapabilities$$module$src$shared$constants$PluginConstantsGlobal,
   pluginStatuses:pluginStatuses$$module$src$shared$constants$PluginConstantsGlobal,setParameterResults:setParameterResults$$module$src$shared$constants$PluginConstantsGlobal,requestExportResults:requestExportResults$$module$src$shared$constants$PluginConstantsGlobal},GlobalUtils$$module$src$shared$constants$PluginConstantsGlobal=module$src$shared$util$GlobalUtils.default;module$src$shared$constants$PluginConstantsGlobal.default=module$src$shared$util$GlobalUtils.default.deepCopy(pluginConstants$$module$src$shared$constants$PluginConstantsGlobal);var module$src$plugins$PluginConstants={},loggingConstants$$module$src$plugins$PluginConstants=module$src$shared$constants$LoggingConstants.default,loggingLevels$$module$src$plugins$PluginConstants=module$src$shared$constants$LoggingConstants.default.loggingLevels,messagingConstants$$module$src$plugins$PluginConstants=module$src$shared$constants$MessagingConstants.default,messageTopics$$module$src$plugins$PluginConstants=module$src$shared$constants$MessagingConstants.default.messageTopics,messageDataTypes$$module$src$plugins$PluginConstants=
   module$src$shared$constants$MessagingConstants.default.messageDataTypes,pluginConstantsGlobal$$module$src$plugins$PluginConstants=module$src$shared$constants$PluginConstantsGlobal.default,defaultSettings$$module$src$plugins$PluginConstants={loggingLevel:loggingLevels$$module$src$plugins$PluginConstants.NONE},pluginConstants$$module$src$plugins$PluginConstants={loggingLevels:loggingLevels$$module$src$plugins$PluginConstants,messageTopics:messageTopics$$module$src$plugins$PluginConstants,messageDataTypes:messageDataTypes$$module$src$plugins$PluginConstants,
   pluginCapabilities:module$src$shared$constants$PluginConstantsGlobal.default.pluginCapabilities,pluginStatuses:module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses,setParameterResults:module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults,requestExportResults:module$src$shared$constants$PluginConstantsGlobal.default.requestExportResults,defaultSettings:defaultSettings$$module$src$plugins$PluginConstants},GlobalUtils$$module$src$plugins$PluginConstants=module$src$shared$util$GlobalUtils.default;
   module$src$plugins$PluginConstants.default=module$src$shared$util$GlobalUtils.default.deepCopy(pluginConstants$$module$src$plugins$PluginConstants);var module$src$shared$mixins$GlobalMixin={default:function(){this.jsify=function(b){return JSON.stringify(b,null,0)};return this}};var module$src$shared$messages$MessagePrototype={},GlobalUtils$$module$src$shared$messages$MessagePrototype=module$src$shared$util$GlobalUtils.default;
   module$src$shared$messages$MessagePrototype.default=function(b,a,c){var d=this;this.origin={};this.parts=[];this.addPart=function(a,b){void 0!==a&&d.parts.push({type:a,data:b})};this.addPart(b,a);this.getPartsByType=function(a){return d.parts.filter(function(b){return b.type===a})};this.getUniquePartByType=function(a){a=d.getPartsByType(a);if(1===a.length)return a[0]};this.token={};"string"===typeof c&&0<c.length?this.token={id:c}:null!==c&&"object"===typeof c&&"string"===typeof c.id&&0<c.id.length?
   this.token=c:this.token.id=module$src$shared$util$GlobalUtils.default.createRandomId();if(void 0===this.token.serial||"number"!==typeof this.token.serial)this.token.serial=Date.now();this.date=Date.now();return this};var module$src$shared$mixins$SettingsMixin={},GlobalUtils$$module$src$shared$mixins$SettingsMixin=module$src$shared$util$GlobalUtils.default,MessagePrototype$$module$src$shared$mixins$SettingsMixin=module$src$shared$messages$MessagePrototype.default,messagingConstants$$module$src$shared$mixins$SettingsMixin=module$src$shared$constants$MessagingConstants.default;
   module$src$shared$mixins$SettingsMixin.default=function(b,a,c,d){var e=this,g="function"===typeof e.warn?e.warn:function(){};if(void 0===b||"object"!==typeof b)b={};if(void 0===a||"object"!==typeof a)a={};var h=module$src$shared$util$GlobalUtils.default.deepCopy(b,d);module$src$shared$util$GlobalUtils.default.defaults(h,a);this.getSettings=function(a){if(void 0===a||!Array.isArray(a))return module$src$shared$util$GlobalUtils.default.deepCopy(h);var b={};a.forEach(function(a){e.hasSetting(a)&&module$src$shared$util$GlobalUtils.default.forceAtPath(b,
   a,e.getSetting(a))});return b};this.getSetting=function(a){return module$src$shared$util$GlobalUtils.default.deepCopy(module$src$shared$util$GlobalUtils.default.getAtPath(h,a))};this.getSettingShallow=function(a){return module$src$shared$util$GlobalUtils.default.getAtPath(h,a)};this.hasSetting=function(a){return void 0!==module$src$shared$util$GlobalUtils.default.getAtPath(h,a)};var f={},k=0;this.registerHook=function(a,b){a||(a=".*");if("string"===typeof a)a.startsWith("^")||(a="^"+a),a.endsWith("$")||
   (a+="$"),a=RegExp(a);else if(!(a instanceof RegExp))return;if("function"===typeof b){var c=k;f[k++]={r:a,cb:b};return c}};this.deregisterHook=function(a){if(!f.hasOwnProperty(a))return!1;delete f[a];return!0};this.deregisterAllHooks=function(){for(var a in f)delete f[a];return!0};var l={},m=0;this.registerTypeCheck=function(a,b){a||(a=".*");if("string"===typeof a)a.startsWith("^")||(a="^"+a),a.endsWith("$")||(a+="$"),a=RegExp(a);else if(!(a instanceof RegExp))return;if("function"===typeof b){var c=
   m;l[m++]={r:a,cb:b};return c}};this.deregisterTypeCheck=function(a){if(!l.hasOwnProperty(a))return!1;delete l[a];return!0};this.deregisterAllTypeChecks=function(){for(var a in l)delete l[a];return!0};var n={},q=0;this.registerNotifier=function(a,b){a||(a=".*");if("string"===typeof a)a.startsWith("^")||(a="^"+a),a.endsWith("$")||(a+="$"),a=RegExp(a);else if(!(a instanceof RegExp))return;if("function"===typeof b){var c=q;n[q++]={r:a,cb:b};return c}};this.deregisterNotifier=function(a){if(!n.hasOwnProperty(a))return!1;
   delete n[a];return!0};this.deregisterAllNotifiers=function(){for(var a in n)delete n[a];return!0};this.forceSetting=function(a,b){module$src$shared$util$GlobalUtils.default.forceAtPath(h,a,module$src$shared$util$GlobalUtils.default.deepCopy(b));return!0};this.updateSetting=function(a,b){if(!Object.keys(l).every(function(c){c=l[c];if(!c.r.test(a))return!0;c=c.cb(b,a);c instanceof Promise&&g("SettingsMixin.updateSetting","A typeCheck for "+a+" returned a Promise, which is always a truthy value, use SettingsMixin.updateSettingAsync instead for updates to this key");
   return c})||!Object.keys(f).every(function(c){c=f[c];if(!c.r.test(a))return!0;c=c.cb(b,a);c instanceof Promise&&g("SettingsMixin.updateSetting","A hook for "+a+" returned a Promise, which is always a truthy value, use SettingsMixin.updateSettingAsync instead for updates to this key");return c}))return!1;var c=e.getSetting(a);module$src$shared$util$GlobalUtils.default.forceAtPath(h,a,module$src$shared$util$GlobalUtils.default.deepCopy(b));Object.keys(n).forEach(function(d){d=n[d];if(d.r.test(a))try{d.cb(a,
   c,b)}catch(v){g("SettingsMixin.updateSetting","A notifier for setting "+d.r.toString()+" threw an exception",v)}});return!0};this.updateSettingAsync=function(a,b){var c=[];return Object.keys(l).every(function(d){d=l[d];if(!d.r.test(a))return!0;d=d.cb(b,a);return d instanceof Promise?(c.push(d),!0):d})?Promise.all(c).then(function(c){if(c.every(function(a){return a})){var d=[];return Object.keys(f).every(function(c){c=f[c];if(!c.r.test(a))return!0;c=c.cb(b,a);return c instanceof Promise?(d.push(c),
   !0):c})?Promise.all(d).then(function(c){if(c.every(function(a){return a})){var d=e.getSetting(a);module$src$shared$util$GlobalUtils.default.forceAtPath(h,a,module$src$shared$util$GlobalUtils.default.deepCopy(b));Object.keys(n).forEach(function(c){c=n[c];if(c.r.test(a))try{c.cb(a,d,b)}catch(A){g("SettingsMixin.updateSettingAsync","A notifier for setting "+c.r.toString()+" threw an exception",A)}});return!0}return!1},function(){return!1}):Promise.resolve(!1)}return!1},function(){return!1}):Promise.resolve(!1)};
   this.updateSettings=function(a,b){"boolean"!==typeof b&&(b=!1);var c=!0;if(void 0===a||"object"!==typeof a)return c;var d=[];module$src$shared$util$GlobalUtils.default.getPaths(a,d);d.forEach(function(d){b&&e.hasSetting(d)||e.updateSetting(d,module$src$shared$util$GlobalUtils.default.getAtPath(a,d))||(c=!1)});return c};this.updateSettingsAsync=function(){g("SettingsMixin.updateSettingsAsync","to be implemented");return Promise.reject(Error("SettingsMixin.updateSettingsAsyncto be implemented"))};this.isSettingPersistent=
   function(){return!1};this.getSection=function(a){var b=e.getSettingShallow(a);return void 0===b||"object"!==typeof b?!1:{getSettings:function(b){if(void 0===b||!Array.isArray(b))return b=e.getSettings([a]),module$src$shared$util$GlobalUtils.default.getAtPath(b,a);b=module$src$shared$util$GlobalUtils.default.deepCopy(b);for(var c=0;c<b.length;c++)b[c]=a+"."+b[c];return e.getSettings(b)},getSetting:function(b){return e.getSetting(a+"."+b)},getSettingShallow:function(b){return e.getSettingShallow(a+
   "."+b)},forceSetting:function(b,c){return e.forceSetting(a+"."+b,c)},hasSetting:function(b){return e.hasSetting(a+"."+b)},registerHook:function(b,c){if("string"!==typeof b)return!1;b.startsWith("^")&&(b=b.substring(1));var d=a.length+1;return e.registerHook(a+"."+b,function(a,b){return c(a,b.substring(d))})},deregisterHook:function(a){return e.deregisterHook(a)},registerNotifier:function(b,c){if("string"!==typeof b)return!1;b.startsWith("^")&&(b=b.substring(1));var d=a.length+1;return e.registerNotifier(a+
   "."+b,function(a,b,e){return c(a.substring(d),b,e)})},deregisterNotifier:function(a){return e.deregisterNotifier(a)},updateSetting:function(b,c){return e.updateSetting(a+"."+b,c)},updateSettingAsync:function(b,c){return e.updateSettingAsync(a+"."+b,c)},updateSettings:function(b,c){"boolean"!==typeof c&&(c=!1);var d=!0;if(void 0===b||"object"!==typeof b)return d;var g=[];module$src$shared$util$GlobalUtils.default.getPaths(b,g);g.forEach(function(g){var f=a+"."+g;c&&e.hasSetting(f)||e.updateSetting(f,
   module$src$shared$util$GlobalUtils.default.getAtPath(b,g))||(d=!1)});return d},updateSettingsAsync:function(){g("SettingsMixin.updateSettingsAsync","to be implemented");return Promise.reject(Error("SettingsMixin.updateSettingsAsyncto be implemented"))},isSettingPersistent:function(b){return e.isSettingPersistent(a+"."+b)},getSection:function(b){return e.getSection(a+"."+b)}}};module$src$shared$util$GlobalUtils.default.typeCheck(c,"string")&&e.registerNotifier("",function(a,b,d){a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SETTINGS_UPDATE,
   {key:a,valueNew:d,valueOld:b,namespace:c});e.message(module$src$shared$constants$MessagingConstants.default.messageTopics.SETTINGS_UPDATE,a)});return this};var module$src$shared$mixins$LoggingMixin={},loggingConstants$$module$src$shared$mixins$LoggingMixin=module$src$shared$constants$LoggingConstants.default;
   module$src$shared$mixins$LoggingMixin.default=function(){var b=this;this.getLoggingLevelName=function(a){var b=a.toString();Object.keys(module$src$shared$constants$LoggingConstants.default.loggingLevels).every(function(c){return module$src$shared$constants$LoggingConstants.default.loggingLevels[c]===a?(b=c,!1):!0});return b};this.logToConsole=function(){var a=1===arguments.length?[arguments[0]]:Array.apply(null,arguments),b=a[0]&module$src$shared$constants$LoggingConstants.default.loggingLevels.LVLBITS,
   d=a[1];a=a.slice(2);b===module$src$shared$constants$LoggingConstants.default.loggingLevels.ERROR?console.error.apply(console,["ERROR."+d,":"].concat($jscomp.arrayFromIterable(a))):b===module$src$shared$constants$LoggingConstants.default.loggingLevels.WARN?console.warn.apply(console,["WARN."+d,":"].concat($jscomp.arrayFromIterable(a))):b===module$src$shared$constants$LoggingConstants.default.loggingLevels.INFO?console.log.apply(console,["INFO."+d,":"].concat($jscomp.arrayFromIterable(a))):b===module$src$shared$constants$LoggingConstants.default.loggingLevels.DEBUG?
   console.log.apply(console,["DEBUG."+d,":"].concat($jscomp.arrayFromIterable(a))):console.log.apply(console,["UNKNOWN."+d,":"].concat($jscomp.arrayFromIterable(a)))};this.log=function(){(arguments[0]&module$src$shared$constants$LoggingConstants.default.loggingLevels.LVLBITS)<=b.getLoggingLevel()&&b.logToConsole.apply(b,arguments)};this.error=function(){b.log.apply(b,[module$src$shared$constants$LoggingConstants.default.loggingLevels.ERROR].concat($jscomp.arrayFromIterable(arguments)))};this.warn=function(){b.log.apply(b,
   [module$src$shared$constants$LoggingConstants.default.loggingLevels.WARN].concat($jscomp.arrayFromIterable(arguments)))};this.info=function(){b.log.apply(b,[module$src$shared$constants$LoggingConstants.default.loggingLevels.INFO].concat($jscomp.arrayFromIterable(arguments)))};this.debug=function(){b.log.apply(b,[module$src$shared$constants$LoggingConstants.default.loggingLevels.DEBUG].concat($jscomp.arrayFromIterable(arguments)))};this.setLoggingLevel=function(a){return b.updateSetting("loggingLevel",
   a)};this.getLoggingLevel=function(){return b.getSetting("loggingLevel")};return this};var module$src$shared$mixins$MessagingMixin={},messagingConstants$$module$src$shared$mixins$MessagingMixin=module$src$shared$constants$MessagingConstants.default,loggingConstants$$module$src$shared$mixins$MessagingMixin=module$src$shared$constants$LoggingConstants.default;
   module$src$shared$mixins$MessagingMixin.default=function(){var b=this;this.messageToLog=function(a,c){var d=b.getSetting("messageLoggingLevel");d!==module$src$shared$constants$LoggingConstants.default.loggingLevels.NONE&&b.log(d,a,c)};this.messageToPubSub=function(a,b,d,e){e&&"string"===typeof e.prefix&&(a=e.prefix.concat(".",a));e&&"string"===typeof e.postfix&&(a=a.concat(".",e.postfix));d.publish(a,b)};this.message=function(a,c){b.messageToLog(a,c)};this.hasSetting("messageLoggingLevel")||b.updateSetting("messageLoggingLevel",
   module$src$shared$constants$MessagingConstants.default.defaultSettings.messageLoggingLevel);return this};var module$src$externals$expo_three={default:null};var module$src$externals$expo_asset_utils={default:null};var module$src$shared$util$stringChecksum={default:function(b){var a=0,c=b.length,d;if(0===c)return a;for(d=0;d<c;d++){var e=b.charCodeAt(d);a=(a<<5)-a+e;a&=a}return a}};var module$src$shared$util$getImageBase64={},AXIOS$$module$src$shared$util$getImageBase64=module$src$externals$axios.default,_converterEngine$$module$src$shared$util$getImageBase64=function(b){b=new Uint8Array(b);for(var a=b.length,c=[];a--;)c[a]=String.fromCharCode(b[a]);return window.btoa(c.join(""))};
   module$src$shared$util$getImageBase64.default=function(b){return(0,module$src$externals$axios.default)({method:"GET",url:b,responseType:"arraybuffer"}).then(function(a){var b=_converterEngine$$module$src$shared$util$getImageBase64(a.data);return Promise.resolve({data:b,contentType:a.headers["content-type"]})})};var module$src$shared$singletons$TextureLoader={},AXIOS$$module$src$shared$singletons$TextureLoader=module$src$externals$axios.default,THREE$$module$src$shared$singletons$TextureLoader=module$src$externals$three.default,EXPOTHREE$$module$src$shared$singletons$TextureLoader=module$src$externals$expo_three.default,EXPOASSETUTILS$$module$src$shared$singletons$TextureLoader=module$src$externals$expo_asset_utils.default,ATOBTOA$$module$src$shared$singletons$TextureLoader=module$src$shared$util$atobtoa.default,
   textureCache$$module$src$shared$singletons$TextureLoader={},TextureLoader$$module$src$shared$singletons$TextureLoader=function(){this.loadTexture=function(a,c,d){return window&&window.navigator&&-1!==window.navigator.userAgent.indexOf("Safari")&&-1===window.navigator.userAgent.indexOf("Chrome")?b(a,c,d).then(function(){return b(a,c,d)}):b(a,c,d)};var b=function(a,b,d){b=b||{};d=d||{};var c=function(a){a.wrapS=[0,1,2].includes(b.wrapS)?1E3+b.wrapS:module$src$externals$three.default.RepeatWrapping;
   a.wrapT=[0,1,2].includes(b.wrapT)?1E3+b.wrapT:module$src$externals$three.default.RepeatWrapping;var c=b.offset||[0,0];a.offset=new module$src$externals$three.default.Vector2(c[0],c[1]);c=b.repeat||[1,1];a.repeat=new module$src$externals$three.default.Vector2(c[0],c[1]);a.rotation=b.rotation||0;c=b.center||[0,0];a.center=new module$src$externals$three.default.Vector2(c[0],c[1]);a.uvTransform=new module$src$externals$three.default.Matrix3;a.uvTransform.identity().translate(-a.center.x,-a.center.y).rotate(a.rotation).scale(a.repeat.x,
   a.repeat.y).translate(a.center.x,a.center.y).translate(a.offset.x,a.offset.y);a.needsUpdate=!0;return a};if("object"===typeof a&&null!==a&&1===a.nodeType&&"string"===typeof a.nodeName&&"CANVAS"===a.nodeName.toUpperCase()){var g=new module$src$externals$three.default.CanvasTexture(a);"function"!==typeof a._addTexture&&function(){var b=[];a._addTexture=function(a){return b.push(a)};Object.defineProperty(a,"needsUpdate",{set:function(a){return a&&b.forEach(function(a){return a.needsUpdate=!0})}})}();
   a._addTexture(g);return Promise.resolve(c(g))}if("string"!==typeof a)return Promise.reject(Error("Input is not a string"));var h="_"+(0,module$src$shared$util$stringChecksum.default)(a);if(textureCache$$module$src$shared$singletons$TextureLoader.hasOwnProperty(h))return textureCache$$module$src$shared$singletons$TextureLoader[h].then(function(a){var b=a.clone();module$src$externals$expo_three.default&&module$src$externals$expo_asset_utils.default&&a.isDataTexture&&!b.isDataTexture&&(b.isDataTexture=
   !0);return c(b)});var f=null,k=null,l=null,m=null;textureCache$$module$src$shared$singletons$TextureLoader[h]=Promise.resolve().then(function(){if("data:"==a.substring(0,5))return m=!0,f=a.substring(a.indexOf(":")+1,a.indexOf(";")),l=-1!==a.indexOf("base64"),k=a.substring(a.indexOf(",")+1),Promise.resolve();m=!1;var b={method:"GET",url:a,headers:{}};d.authorization&&(b.headers.Authorization=d.authorization);return(0,module$src$externals$axios.default)(b).then(function(a){f=a.headers["content-type"];
   -1<f.indexOf(";")&&(f=f.substr(0,f.indexOf(";")));k=a.data;l=!1;return Promise.resolve()},function(a){a.scope="TextureLoader._loadTexture";a.msg=a.response?"Loading texture failed with HTTP status code "+a.response.status:a.request?"Loading texture failed, no response from the server":"Loading texture failed, unknown error";return Promise.reject(a)})}).then(function(){var b,c;if(["image/jpeg","image/png","image/gif","image/bmp"].includes(f))return new Promise(function(b,c){if(module$src$externals$expo_three.default&&
   module$src$externals$expo_asset_utils.default){var d=f.split("/")[1].replace("e","");module$src$externals$expo_asset_utils.default.resolveAsync(a,{fileName:"H"+h.toString()+"."+d}).then(function(a){module$src$externals$expo_three.default.loadTextureAsync({asset:a}).then(function(a){a.minFilter=module$src$externals$three.default.LinearFilter;b(a)},function(a){a.scope="TextureLoader._loadTexture";a.msg="EXPOTHREE.loadAsync failed";c(a)})},function(a){a.scope="TextureLoader._loadTexture";a.msg="EXPOASSETUTILS.resolveAsync failed";
   c(a)})}else(new module$src$externals$three.default.TextureLoader).load(a,function(a){b(a)},function(){},function(a){a.scope="TextureLoader._loadTexture";a.msg="Texture file loading failed";c(a)})});if("image/svg+xml"===f){if(window&&window.navigator&&window.navigator.userAgent&&0<window.navigator.userAgent.indexOf("Trident/")){var d=Error("SVG textures not supported by Internet Explorer 11. Skipping the texture.");d.scope="TextureLoader._loadTexture";return Promise.reject(d)}var e=null;m?l?e=module$src$shared$util$atobtoa.default.atobUTF8(k):
   (e=k,e=(" "+e).slice(1)):e=k;d=document.createElement("DIV");d.id="svgc";d.innerHTML=e;var g=d.getElementsByTagName("svg"),r=[],v=[];for(d=0;d<g.length;++d){for(b=0;2>b;++b){var w=g[d].getElementsByTagName(["image","img"][b]);for(c=0;c<w.length;++c)"data:"!=w[c].href.baseVal.substring(0,5)&&r.push(w[c].href.baseVal)}c=g[d].getElementsByTagName("style");for(b=0;b<c.length;++b){w=/@import\x20url\(\s*(.*?)\s*\);/g;for(var y=void 0;null!==(y=w.exec(c[b].innerHTML));)v.push(y[1]);v=v.filter(function(a,
   b,c){return c.indexOf(a)===b})}}g=[];w=function(a){return new Promise(function(b,c){0<r[a].length?(0,module$src$shared$util$getImageBase64.default)(r[a]).then(function(c){e=e.replace(r[a],"data:"+c.contentType+";base64,"+c.data);b()}).catch(function(a){c(a)}):b()})};for(d=0;d<r.length;++d)c=w(d),g.push(c);w=function(c){return new Promise(function(d,g){module$src$externals$axios.default.get(c).then(function(a){return a.data}).then(function(f){for(var l=[],h=/url\(\s*(.*?)\s*\)/g,m;null!==(m=h.exec(f));)l.push(m[1]);
   h=[];m=function(a){return new Promise(function(b,c){(0,module$src$shared$util$getImageBase64.default)(a).then(function(c){c="data:"+c.contentType+";base64,"+c.data;0<a.length&&(f=f.replace(a,c));b()}).catch(function(){c(Error("Error converting "+a+" to base64"))})})};for(b=0;b<l.length;++b)h.push(m(l[b]));return Promise.all(h).then(function(){return f}).then(function(b){0<a.length&&(e=e.replace("@import url("+c+");",b));d()}).catch(function(){g(Error("Error converting CSS string."))})})})};for(d=
   0;d<v.length;++d)c=w(v[d]),g.push(c);return Promise.all(g).then(function(){return new Promise(function(a,b){var c="data:image/svg+xml,"+encodeURIComponent(e),d=document.createElement("canvas");d.width=2048;d.height=2048;var g=d.getContext("2d"),f=new Image;f.onload=function(){g.drawImage(f,0,0,2048,2048);var b=new module$src$externals$three.default.Texture(d);a(b)};f.onerror=function(a){b(a)};f.crossOrigin="Anonymous";f.src=c})})}return Promise.reject(Error("Unkonwn content-type "+f+" when downloading "+
   a))});return textureCache$$module$src$shared$singletons$TextureLoader[h].then(function(a){var b=a.clone();module$src$externals$expo_three.default&&module$src$externals$expo_asset_utils.default&&a.isDataTexture&&!b.isDataTexture&&(b.isDataTexture=!0);return c(b)})}};module$src$shared$singletons$TextureLoader.default=new TextureLoader$$module$src$shared$singletons$TextureLoader;var module$src$plugins$PluginPrototype={},pluginConstants$$module$src$plugins$PluginPrototype=module$src$plugins$PluginConstants.default,GlobalUtils$$module$src$plugins$PluginPrototype=module$src$shared$util$GlobalUtils.default,GlobalMixin$$module$src$plugins$PluginPrototype=module$src$shared$mixins$GlobalMixin.default,SettingsMixin$$module$src$plugins$PluginPrototype=module$src$shared$mixins$SettingsMixin.default,LoggingMixin$$module$src$plugins$PluginPrototype=module$src$shared$mixins$LoggingMixin.default,
   MessagingMixin$$module$src$plugins$PluginPrototype=module$src$shared$mixins$MessagingMixin.default,MessagePrototype$$module$src$plugins$PluginPrototype=module$src$shared$messages$MessagePrototype.default,TextureLoader$$module$src$plugins$PluginPrototype=module$src$shared$singletons$TextureLoader.default,THREE$$module$src$plugins$PluginPrototype=module$src$externals$three.default;
   module$src$plugins$PluginPrototype.default=function(b){var a=this;this.pluginConstants=module$src$plugins$PluginConstants.default;this.GlobalUtils=module$src$shared$util$GlobalUtils.default;this.MessagePrototype=module$src$shared$messages$MessagePrototype.default;a.TextureLoader=module$src$shared$singletons$TextureLoader.default;a.THREE=module$src$externals$three.default;module$src$shared$mixins$GlobalMixin.default.call(this);if(void 0===b.runtimeId||"string"!==typeof b.runtimeId)b.runtimeId=module$src$shared$util$GlobalUtils.default.createRandomId();
   module$src$shared$mixins$SettingsMixin.default.call(this,b,a.pluginConstants.defaultSettings);this.registerHook("runtimeId",function(){return!1});module$src$shared$mixins$LoggingMixin.default.call(this);module$src$shared$mixins$MessagingMixin.default.call(this);this.getRuntimeId=function(){return a.getSetting("runtimeId")};this.load=function(b){a.updateSettings(b);return!0};this.getStatus=function(){};this.setStatus=function(){};(function(){var b=a.pluginConstants.pluginStatuses.READY;a.getStatus=
   function(){return module$src$shared$util$GlobalUtils.default.deepCopy(b)};a.setStatus=function(c){if(b!==c){var d=a.pluginConstants.messageTopics.PLUGIN_FAILED;c===a.pluginConstants.pluginStatuses.FAILED?d=a.pluginConstants.messageTopics.PLUGIN_FAILED:c===a.pluginConstants.pluginStatuses.LOADED?d=a.pluginConstants.messageTopics.PLUGIN_LOADED:c===a.pluginConstants.pluginStatuses.ACTIVE?d=a.pluginConstants.messageTopics.PLUGIN_ACTIVE:c===a.pluginConstants.pluginStatuses.UNLOADED&&(d=a.pluginConstants.messageTopics.PLUGIN_UNLOADED);
   var g=new module$src$shared$messages$MessagePrototype.default(a.pluginConstants.messageDataTypes.PLUGIN_RUNTIME_ID,a.getRuntimeId());a.message(d,g);b=c}}}).call(this);this.getStatusDescription=function(){return{id:a.getRuntimeId(),status:a.getStatus(),name:a.getName(),shortName:a.getShortName()}};return this};var module$src$app$BuildDataAccessor={default:{}};Object.defineProperty(module$src$app$BuildDataAccessor.default,"__esModule",{value:!0});
   var build_data_1$$module$src$app$BuildDataAccessor=module$build$build_data.default,BuildDataAccessor$$module$src$app$BuildDataAccessor=function(){return function(){this.buildVersion=module$build$build_data.default.build_data.build_version;this.buildDate=module$build$build_data.default.build_data.build_date;this.buildBranch=module$build$build_data.default.build_data.build_branch;this.buildCommit=module$build$build_data.default.build_data.build_commit}}();
   module$src$app$BuildDataAccessor.default.BuildData=new BuildDataAccessor$$module$src$app$BuildDataAccessor;var module$src$plugins$comm$CommPlugin={},axios$$module$src$plugins$comm$CommPlugin=module$src$externals$axios.default,commPluginConstants$$module$src$plugins$comm$CommPlugin=module$src$plugins$comm$CommPluginConstants.default,pluginConstantsGlobal$$module$src$plugins$comm$CommPlugin=module$src$shared$constants$PluginConstantsGlobal.default,pluginPrototype$$module$src$plugins$comm$CommPlugin=module$src$plugins$PluginPrototype.default,messagingConstants$$module$src$plugins$comm$CommPlugin=module$src$shared$constants$MessagingConstants.default,
   loggingConstants$$module$src$plugins$comm$CommPlugin=module$src$shared$constants$LoggingConstants.default,GlobalUtils$$module$src$plugins$comm$CommPlugin=module$src$shared$util$GlobalUtils.default,MessagePrototype$$module$src$plugins$comm$CommPlugin=module$src$shared$messages$MessagePrototype.default,VIEWER_INSTANCE_ID$$module$src$plugins$comm$CommPlugin=module$src$shared$util$GlobalUtils.default.createRandomId(),BUILD_DATA$$module$src$plugins$comm$CommPlugin=module$src$app$BuildDataAccessor.default.BuildData;
   module$src$plugins$comm$CommPlugin.default=function(b){var a=this;"string"===typeof b.modelViewUrl&&0<b.modelViewUrl.length&&("eu-central-1"===b.modelViewUrl?b.modelViewUrl="https://sdeuc1.eu-central-1.shapediver.com":"us-east-1"===b.modelViewUrl?b.modelViewUrl="https://model-view.shapediver.com":"us-east-1-test"===b.modelViewUrl?b.modelViewUrl="https://sdtest.us-east-1.shapediver.com":b.modelViewUrl.startsWith("http")||(b.modelViewUrl="https://"+b.modelViewUrl));var c=module$src$shared$util$GlobalUtils.default.createRandomId();
   module$src$plugins$PluginPrototype.default.call(this,module$src$shared$util$GlobalUtils.default.inject(module$src$plugins$comm$CommPluginConstants.default.defaultSettings,module$src$shared$util$GlobalUtils.default.deepCopy(b),!1));var d=module$src$externals$axios.default.create({timeout:a.getSettingShallow("ajaxTimeout")});a.getSettingShallow("authorization")&&(d.defaults.headers.common.Authorization=a.getSetting("authorization"));if(this.hasSetting("ticket")){var e={},g=[module$src$shared$constants$PluginConstantsGlobal.default.pluginCapabilities.SHAPEDIVER_MODEL_VIEW],
   h={},f=function(b,c){return(new r(b)).then(function(b){if(b.hasOwnProperty("msg")){var d=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.STATUS_MESSAGE,{message:b.msg,scope:"Customization reply",messageLevel:module$src$shared$constants$LoggingConstants.default.loggingLevels.ERROR},c);a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.STATUS_MESSAGE,d)}if(!b.hasOwnProperty("outputs"))return Promise.reject("Invalid customization reply");
   var e=Object.keys(b.outputs);d=[];var g=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SUBSCENE_INIT,e.length,c);a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SUBSCENE_INIT,g);g=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_STATUS,{state:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SUBSCENE_INIT,
   progress:.25},c);a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,g);g={};e=$jscomp.makeIterator(e);for(var f=e.next();!f.done;g={outputId:g.outputId},f=e.next())g.outputId=f.value,f=(new Promise(function(d){return function(e,g){var f=b.outputs[d.outputId];if(f.hasOwnProperty("content"))e(f);else{var l=f.version;h[d.outputId]=l;var m=function(){return p(d.outputId,l).then(function(b){if(a.getSettingShallow("ignoreSuperseded")&&h[d.outputId]!==l)b=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT,
   "Subscene obsolete because of newer request",c),a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,b),e();else{if(b.hasOwnProperty("msg")){var f=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.STATUS_MESSAGE,{message:b.msg,scope:"Cache reply",messageLevel:module$src$shared$constants$LoggingConstants.default.loggingLevels.WARN},c);a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.STATUS_MESSAGE,
   f)}b.hasOwnProperty("outputs")&&b.outputs.hasOwnProperty(d.outputId)?(b=b.outputs[d.outputId],b.hasOwnProperty("version")&&b.version===l?b.hasOwnProperty("delay")?setTimeout(function(){m()},Math.max(100,parseInt(b.delay))):b.hasOwnProperty("content")?(b.id=d.outputId,e(b)):g(Error("No content nor delay in cache reply")):g(Error("Invalid cache reply"))):g(Error("Invalid cache reply"))}})};m()}}}(g))).then(function(b){return function(d){if(d){d.id=b.outputId;if(d.hasOwnProperty("msg")){var e=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.STATUS_MESSAGE,
   {message:d.msg,scope:"Output",messageLevel:module$src$shared$constants$LoggingConstants.default.loggingLevels.WARN},c);a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.STATUS_MESSAGE,e)}e=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SUBSCENE_OUTPUTVERSION_JSON,d,c);a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SUBSCENE_OUTPUTVERSION,e);return d}}}(g)),
   d.push(f);return Promise.all(d)})},k=function(b,c,d){var e=function(c){if(!c.hasOwnProperty("exports")||!c.exports.hasOwnProperty(b))return Promise.reject("Unexpected reply to export request");var g=c.exports[b];if(!g.hasOwnProperty("delay"))return g;c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_STATUS,{data:g},d);a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,c);c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_STATUS,
   g,d);a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.EXPORT_STATUS,c);return module$src$shared$util$GlobalUtils.default.waitForTimeout(Math.max(1E3,parseInt(g.delay))).then(function(){return t(b,g.version).then(e)})};return u(b,c).then(e)},l=function(){return q().then(function(b){a.debug("CommPlugin.initSession","Received session init reply",b);if(b.hasOwnProperty("msg")){var c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.STATUS_MESSAGE,
   {message:b.msg,scope:"Session init",messageLevel:module$src$shared$constants$LoggingConstants.default.loggingLevels.ERROR});a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.STATUS_MESSAGE,c)}c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.APP_SETTINGS,b.config);a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.SETTINGS_REGISTER,c);b.hasOwnProperty("parameters")&&
   (c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PARAMETER_DEFINITION,b.parameters),a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PARAMETER_REGISTER,c));b.hasOwnProperty("exports")&&(b=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_DEFINITION,b.exports),a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.EXPORT_REGISTER,
   b));a.getStatus()!==module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses.ACTIVE&&a.setStatus(module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses.ACTIVE)}).catch(function(b){a.error("CommPlugin.initSession","Session init failed",b);a.setStatus(module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses.FAILED);b=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.STATUS_MESSAGE,
   {messageScope:b.serverMessage||"Session initialisation failed"});a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.STATUS_FAILED,b)})},m=null,n=function(b,g,f,l){var h={method:g,url:b,headers:{}};f&&(h.data=f);h.headers["X-ShapeDiver-Origin"]=module$src$shared$util$GlobalUtils.default.embeddingOrigin();h.headers["X-ShapeDiver-CommPluginId"]=c;h.headers["X-ShapeDiver-ViewerId"]=VIEWER_INSTANCE_ID$$module$src$plugins$comm$CommPlugin;h.headers["X-ShapeDiver-BuildVersion"]=
   module$src$app$BuildDataAccessor.default.BuildData.buildVersion;h.headers["X-ShapeDiver-BuildDate"]=module$src$app$BuildDataAccessor.default.BuildData.buildDate;l&&(h.headers["Content-Type"]=l);a.getSettingShallow("authorization")&&(h.headers.Authorization=a.getSetting("authorization"));return d(h).then(function(b){b=b.data;if(b.hasOwnProperty("actions")){b.actions.forEach(function(a){a.hasOwnProperty("method")&&a.hasOwnProperty("href")&&a.hasOwnProperty("name")&&(e[a.name]=a)});if(e.hasOwnProperty("default")){var c=
   e.default.href.replace("/default","");c!==m&&(m=c,a.debug("CommPlugin.modelViewAjax","Setting base URL to",m))}delete b.actions}b.hasOwnProperty("templates")&&delete b.templates;return b},function(c){if(c.response){var d="",e="",h=c.response.data;switch(c.response.status){case 400:d="Bad request";break;case 401:d="Unauthorized";break;case 403:d="Forbidden";break;case 410:return e=module$src$shared$util$GlobalUtils.default.deepCopy(m),q().then(function(){var a=b.replace(e,m);return n(a,g,f,l)},function(b){a.setStatus(module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses.FAILED);
   var c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.STATUS_MESSAGE,{messageScope:b.serverMessage||"Session initialisation failed"});a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.STATUS_FAILED,c);return Promise.reject(b)});case 413:d="Payload too large";break;case 500:d="Internal server error";break;default:d="Communication failed with HTTP status"}var k="Request error: "+d+" ("+c.response.status+
   ")";d=Error(d);h&&h.message&&(d.serverMessage=h.message,k+=", "+h.message);a.error("CommPlugin.modelViewAjax",k,c);return Promise.reject(d)}if(c.request)return a.error("CommPlugin.modelViewAjax","Request error (no response)",c),Promise.reject(Error("Request error (no response)"));a.error("CommPlugin.modelViewAjax","Request error (unknown)",c);return Promise.reject(Error("Request error (unknown)"))})},q=function(){var b=a.getSettingShallow("modelViewUrl");return b?n(b+"/ticket/"+a.getSettingShallow("ticket"),
   "POST"):Promise.reject(Error("Base url not defined."))},p=function(a,b){return new Promise(function(c,d){e.hasOwnProperty("cache")&&e.cache.hasOwnProperty("method")&&e.cache.hasOwnProperty("href")?(d={},d[a]=b,c(n(e.cache.href,e.cache.method,d,"application/json"))):d(Error('Action "cache" is missing'))})},u=function(a,b){return new Promise(function(c,d){e.hasOwnProperty("export")&&e.export.hasOwnProperty("method")&&e.export.hasOwnProperty("href")||d(Error('Action "export" is missing'));c(n(e.export.href,
   e.export.method,{exports:{id:a},parameters:b},"application/json"))})},t=function(a,b){return new Promise(function(c,d){e.hasOwnProperty("export-cache")&&e["export-cache"].hasOwnProperty("method")&&e["export-cache"].hasOwnProperty("href")?(d={},d[a]=b,c(n(e["export-cache"].href,e["export-cache"].method,d,"application/json"))):d(Error('Action "export-cache" is missing'))})},r=function(a){return new Promise(function(b,c){e.hasOwnProperty("customize")&&e.customize.hasOwnProperty("method")&&e.customize.hasOwnProperty("href")||
   c(Error('Action "customize" is missing'));b(n(e.customize.href,e.customize.method,a,"application/json"))})};this.getName=function(){return"ShapeDiver Communications Plugin"};this.getShortName=function(){return"CommPlugin"};this.getCapabilities=function(){var a=module$src$shared$util$GlobalUtils.default.deepCopy(g);e.hasOwnProperty("log")&&a.push(module$src$shared$constants$PluginConstantsGlobal.default.pluginCapabilities.LOGGING);e.hasOwnProperty("configure")&&a.push(module$src$shared$constants$PluginConstantsGlobal.default.pluginCapabilities.SETTINGS);
   e.hasOwnProperty("defaultparam")&&a.push(module$src$shared$constants$PluginConstantsGlobal.default.pluginCapabilities.DEFAULTPARAM);return a};this.getMessageCallbacks=function(){return{}};this.load=function(b){a.updateSettings(b);l();a.debug("CommPlugin.load",'Loaded plugin "'+a.getName()+'" with capabilities '+JSON.stringify(a.getCapabilities())+" and runtime id "+a.getRuntimeId());a.setStatus(module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses.LOADED);return!0};this.logToServer=
   function(){var b=1===arguments.length?[arguments[0]]:Array.apply(null,arguments),c=b[0]&module$src$shared$constants$LoggingConstants.default.loggingLevels.LVLBITS,d=b[1],g=b.slice(2);0<g.length&&"string"===typeof g[0]&&(d+=": "+g[0],g=g.slice(1));return new Promise(function(b,f){e.hasOwnProperty("log")&&e.log.hasOwnProperty("method")&&e.log.hasOwnProperty("href")||f(Error("CommPlugin.logToServer: Session did not provide log action"));var l={level:2-Math.max(Math.min(c,2),0),message:d};1===g.length?
   l.err=g[0]:1<g.length&&(l.err={messages:g});n(e.log.href,e.log.method,l,"application/json").then(function(a){b(a)},function(b){b="CommPlugin.logToServer: Log message rejected by server "+a.jsify(b);f(Error(b))})})};this.setParameterValue=function(){a.warn("CommPlugin.setParameterValue","Not supported");return module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.ERROR};this.setMultipleParameterValues=function(){a.warn("CommPlugin.setMultipleParameterValues","Not supported");
   return module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.ERROR};this.setAllParameterValues=function(b,c){if(a.getStatus()!==module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses.ACTIVE)return b=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR,"Plugin not active",c),a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,b),module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.ERROR;
   f(b,c).catch(function(b){b=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR,b,c);a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,b)});return module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.LOAD};this.fileUpload=function(a){if(!e.hasOwnProperty("upload"))throw Error("CommPlugin.fileUpload: no upload action");return n(e.upload.href,e.upload.method,
   a.request,"application/json").then(function(b){var c={},e=[],g;for(g in a.data){var f=b[g];if(!f||!module$src$shared$util$GlobalUtils.default.typeCheck(f.id,"string")||!module$src$shared$util$GlobalUtils.default.typeCheck(f.href,"string"))throw Error("CommPlugin.fileUpload: invalid response");c[g]=f.id;f={method:"PUT",url:f.href,data:a.data[g],headers:{},transformRequest:[function(a,b){delete b.common.Authorization;delete b.Authorization;return a}]};f.headers["Content-Type"]=a.request[g].format;e.push(d(f))}return Promise.all(e).then(function(){return c})})};
   this.requestExport=function(b,c,d){if(a.getStatus()!==module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses.ACTIVE)return b=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR,"Plugin not active",d),a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,b),module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.ERROR;k(b,c,d).then(function(b){var c=
   new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_RESULT,b,d);a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.EXPORT_AVAILABLE,c);c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS,"Export available",d);c.addPart(module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_RESULT,
   b);a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,c)},function(b){b=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR,b,d);a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,b)});a.debug("CommPlugin.requestExport","Called with export "+b+", kvps "+a.jsify(c)+", token "+a.jsify(d));return a.pluginConstants.requestExportResults.LOAD};
   this.saveSettings=function(a){return e.hasOwnProperty("configure")?n(e.configure.href,e.configure.method,a,"application/json").then(function(){return!0}):Promise.resolve(!1)};this.saveDefaultParameterValues=function(a){return e.hasOwnProperty("defaultparam")?n(e.defaultparam.href,e.defaultparam.method,a,"application/json").then(function(){return!0}):Promise.resolve(!1)};this.registerHook("modelViewUrl",function(){return!1});this.registerHook("ticket",function(){return!1});this.setStatus(module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses.READY)}else a.error("CommPlugin.CommPlugin",
   "Plugin was initialized without a ticket."),a.setStatus(module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses.FAILED)};var module$src$interfaces$api$apps$sd_controls$interfaces={default:{}};Object.defineProperty(module$src$interfaces$api$apps$sd_controls$interfaces.default,"__esModule",{value:!0});var SettingsGroups$$module$src$interfaces$api$apps$sd_controls$interfaces;
   (function(b){b[b.WORLD=1]="WORLD";b[b.LIGHTS=2]="LIGHTS";b[b.BACKGROUND=3]="BACKGROUND";b[b.CAMERA=4]="CAMERA"})(SettingsGroups$$module$src$interfaces$api$apps$sd_controls$interfaces=module$src$interfaces$api$apps$sd_controls$interfaces.default.SettingsGroups||(module$src$interfaces$api$apps$sd_controls$interfaces.default.SettingsGroups={}));var module$src$api$apps$sd_controls$settings$GroupSettings={default:{}};Object.defineProperty(module$src$api$apps$sd_controls$settings$GroupSettings.default,"__esModule",{value:!0});
   var interfaces_1$$module$src$api$apps$sd_controls$settings$GroupSettings=module$src$interfaces$api$apps$sd_controls$interfaces.default,Icon$$module$src$api$apps$sd_controls$settings$GroupSettings=function(){function b(a){this.html='<a><span uk-icon="'+a+'"></span></a>'}b.prototype.toString=function(){return this.html};return b}(),groupSettings$$module$src$api$apps$sd_controls$settings$GroupSettings=[{groupId:module$src$interfaces$api$apps$sd_controls$interfaces.default.SettingsGroups.WORLD,icon:new Icon$$module$src$api$apps$sd_controls$settings$GroupSettings("world")},
   {groupId:module$src$interfaces$api$apps$sd_controls$interfaces.default.SettingsGroups.LIGHTS,icon:new Icon$$module$src$api$apps$sd_controls$settings$GroupSettings("bolt")},{groupId:module$src$interfaces$api$apps$sd_controls$interfaces.default.SettingsGroups.BACKGROUND,icon:new Icon$$module$src$api$apps$sd_controls$settings$GroupSettings("image")},{groupId:module$src$interfaces$api$apps$sd_controls$interfaces.default.SettingsGroups.CAMERA,icon:new Icon$$module$src$api$apps$sd_controls$settings$GroupSettings("video-camera")}];
   module$src$api$apps$sd_controls$settings$GroupSettings.default.GroupSettings=function(){function b(a,b){var c=this;this._domManager=b;this._indexGroups=[];this.groups={};var e=this._domManager.createDomElement("ul",null,a,["uk-margin-remove","uk-width-1-1","sdv-control-panel-row-border","shapediver-settings-tabs"],{"uk-tab":"swiping: false;"}),g=this._domManager.createDomElement("ul",null,a,["uk-switcher","uk-width-1-1","uk-margin-remove-top"]);groupSettings$$module$src$api$apps$sd_controls$settings$GroupSettings.forEach(function(a){var b=
   c._domManager.createDomElement("li",null,e,["uk-padding-remove","uk-width-1-4"]);b.innerHTML=a.icon.toString();var d=c._domManager.createDomElement("li",null,g,["uk-width-1-1","uk-margin-remove"],{"uk-grid":""});c.groups[a.groupId]={contentEl:d,headerEl:b,id:a.groupId};c._indexGroups.push(c.groups[a.groupId])})}b.prototype.getGroup=function(a){return this.groups[a].contentEl};b.prototype.getGroupByIndex=function(a){return this._indexGroups[a-1].contentEl};b.prototype.headersClick=function(a){var b=
   this,d=function(c){e.groups[c].headerEl.addEventListener("click",function(){return a(b.groups[c].id)})},e=this,g;for(g in this.groups)d(g)};return b}();var module$src$modules$shapediver_lights_drag_controls$src$enums$enums={default:{}};Object.defineProperty(module$src$modules$shapediver_lights_drag_controls$src$enums$enums.default,"__esModule",{value:!0});var LightControlsEvents$$module$src$modules$shapediver_lights_drag_controls$src$enums$enums;
   (function(b){b.UPDATED="updated"})(LightControlsEvents$$module$src$modules$shapediver_lights_drag_controls$src$enums$enums=module$src$modules$shapediver_lights_drag_controls$src$enums$enums.default.LightControlsEvents||(module$src$modules$shapediver_lights_drag_controls$src$enums$enums.default.LightControlsEvents={}));var module$src$modules$shapediver_generic_event$GenericEvent={default:{}};Object.defineProperty(module$src$modules$shapediver_generic_event$GenericEvent.default,"__esModule",{value:!0});
   module$src$modules$shapediver_generic_event$GenericEvent.default.GenericEvent=function(){function b(a){var b=this;void 0===a&&(a=[]);this.handlers={};a.forEach(function(a){return b.handlers[a]=[]})}b.prototype.on=function(a,b){this.handlers[a]||(this.handlers[a]=[]);this.handlers[a].push(b)};b.prototype.off=function(a,b){this.handlers[a]=this.handlers[a].splice(0).filter(function(a){return a!==b})};b.prototype.clear=function(a){this.handlers[a]=[]};b.prototype.trigger=function(a,b){this.handlers[a]||
   (this.handlers[a]=[]);this.handlers[a].forEach(function(a){return a(b)})};return b}();var module$src$modules$shapediver_lights_drag_controls$src$ApiLightHelperWrapper={default:{}},__awaiter$$module$src$modules$shapediver_lights_drag_controls$src$ApiLightHelperWrapper=this&&module$src$modules$shapediver_lights_drag_controls$src$ApiLightHelperWrapper.default.__awaiter||function(b,a,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,h){function g(a){try{l(d.next(a))}catch(n){h(n)}}function k(a){try{l(d["throw"](a))}catch(n){h(n)}}
   function l(a){a.done?c(a.value):e(a.value).then(g,k)}l((d=d.apply(b,a||[])).next())})},__generator$$module$src$modules$shapediver_lights_drag_controls$src$ApiLightHelperWrapper=this&&module$src$modules$shapediver_lights_drag_controls$src$ApiLightHelperWrapper.default.__generator||function(b,a){function c(a){return function(b){return d([a,b])}}function d(c){if(g)throw new TypeError("Generator is already executing.");for(;e;)try{if(g=1,h&&(f=c[0]&2?h["return"]:c[0]?h["throw"]||((f=h["return"])&&f.call(h),
   0):h.next)&&!(f=f.call(h,c[1])).done)return f;if(h=0,f)c=[c[0]&2,f.value];switch(c[0]){case 0:case 1:f=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++;h=c[1];c=[0];continue;case 7:c=e.ops.pop();e.trys.pop();continue;default:if(!(f=e.trys,f=0<f.length&&f[f.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!f||c[1]>f[0]&&c[1]<f[3]))e.label=c[1];else if(6===c[0]&&e.label<f[1])e.label=f[1],f=c;else if(f&&e.label<f[2])e.label=f[2],e.ops.push(c);else{f[2]&&e.ops.pop();e.trys.pop();
   continue}}c=a.call(b,e)}catch(m){c=[6,m],h=0}finally{g=f=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},g,h,f,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k};Object.defineProperty(module$src$modules$shapediver_lights_drag_controls$src$ApiLightHelperWrapper.default,"__esModule",{value:!0});
   module$src$modules$shapediver_lights_drag_controls$src$ApiLightHelperWrapper.default.ApiLightHelperWrapper=function(){function b(a){this.api=a}b.prototype.addAnchorAddListener=function(a){this.api.scene.addEventListener(this.api.scene.EVENTTYPE.ANCHOR_ADD,a)};b.prototype.addAnchorRemoveListener=function(a){this.api.scene.addEventListener(this.api.scene.EVENTTYPE.ANCHOR_REMOVE,a)};b.prototype.addDragEndListener=function(a){this.api.scene.addEventListener(this.api.scene.EVENTTYPE.DRAG_END,a)};b.prototype.addDragMoveListener=
   function(a){this.api.scene.addEventListener(this.api.scene.EVENTTYPE.DRAG_MOVE,a)};b.prototype.addDragStartListener=function(a){this.api.scene.addEventListener(this.api.scene.EVENTTYPE.DRAG_START,a)};b.prototype.appendElementToVieweport=function(a,b){this.api.viewports.get(a).getContainer().appendChild(b)};b.prototype.convertTo2D=function(a){return this.api.scene.convertTo2D(a).data[0]};b.prototype.createInteractionsGroup=function(){return this.api.scene.updateInteractionGroups([{id:"dragGroup",selectable:!1,
   draggable:!0,hoverable:!1}])};b.prototype.getLight=function(a){return this.api.scene.lights.getLight(a).data};b.prototype.getLightScene=function(){return this.api.scene.lights.getLightScene().data};b.prototype.getLightHelpersVisible=function(){return this.lightHelpersVisible};b.prototype.getSceneBoundingBox=function(){return this.api.scene.getBoundingBox().data};b.prototype.isDirectionalLight=function(a){return a.type===this.api.scene.lights.LIGHTTYPE.DIRECTIONAL};b.prototype.isPointLight=function(a){return a.type===
   this.api.scene.lights.LIGHTTYPE.POINT};b.prototype.isSpotLight=function(a){return a.type===this.api.scene.lights.LIGHTTYPE.SPOT};b.prototype.removeAsync=function(a){return __awaiter$$module$src$modules$shapediver_lights_drag_controls$src$ApiLightHelperWrapper(this,void 0,void 0,function(){return __generator$$module$src$modules$shapediver_lights_drag_controls$src$ApiLightHelperWrapper(this,function(b){return[2,this.api.scene.removeAsync(a,"lightHelpers")]})})};b.prototype.setLightHelpers=function(a){this.api.updateSettingAsync("scene.lights.helper",
   a);this.lightHelpersVisible=a};b.prototype.toggleGeometry=function(a){this.api.scene.toggleGeometry([],a)};b.prototype.updateAsync=function(a){return __awaiter$$module$src$modules$shapediver_lights_drag_controls$src$ApiLightHelperWrapper(this,void 0,void 0,function(){var b,d,e,g;return __generator$$module$src$modules$shapediver_lights_drag_controls$src$ApiLightHelperWrapper(this,function(c){switch(c.label){case 0:return b="scene.camera.autoAdjust",(d=this.api.getSetting(b))?[4,this.api.updateSettingAsync(b,
   !1)]:[3,2];case 1:return c.sent(),e=this.api.scene.updateAsync(a,"lightHelpers"),g=this.api.scene.addEventListener(this.api.scene.EVENTTYPE.SUBSCENE_PUBLISHED,function(){this.api.updateSettingAsync(b,!0);this.api.scene.removeEventListener(g.data[0])}),[2,e];case 2:return[2,this.api.scene.updateAsync(a,"lightHelpers")]}})})};b.prototype.updateLight=function(a){return this.api.scene.lights.updateLight(a).data};b.prototype.zoomAsync=function(a){this.api.scene.camera.zoomAsync(a)};return b}();var module$src$modules$shapediver_lights_drag_controls$src$CreateDefinitions={default:{}};Object.defineProperty(module$src$modules$shapediver_lights_drag_controls$src$CreateDefinitions.default,"__esModule",{value:!0});
   module$src$modules$shapediver_lights_drag_controls$src$CreateDefinitions.default.CreateDefinitions=function(){function b(a){this.three=a}b.prototype.createAnchorAssetDefinition=function(){return{id:"anchor",group:"anchor_group",content:[{format:"anchor",data:[{version:"1.0",location:{x:0,y:0,z:0},format:"light_anchor",data:{text:null}}]}]}};b.prototype.createGeometryAssetDefinition=function(){return{id:"geometry",group:"geometry_group",interactionGroup:"dragGroup",interactionMode:"global",content:[{format:"three",
   data:{threeObject:null}}]}};return b}();var module$src$modules$shapediver_lights_drag_controls$src$DragControlsCache={default:{}};Object.defineProperty(module$src$modules$shapediver_lights_drag_controls$src$DragControlsCache.default,"__esModule",{value:!0});
   module$src$modules$shapediver_lights_drag_controls$src$DragControlsCache.default.DragControlsCache=function(){function b(a){this._apiWrapper=a;this._anchors={};this._geometry={};this._obj={};this._svgs={}}b.prototype.clear=function(a,b,d){var c=this;a&&Object.keys(this._svgs).forEach(function(a){document.getElementById(c._svgs[a].id).remove();delete c._svgs[a]});if(d||b)a=function(a){Object.keys(a).forEach(function(b){c._apiWrapper.removeAsync({id:a[b].id});delete a[b]})},d&&a(this._geometry),b&&
   a(this._anchors)};b.prototype.clearWithKey=function(a,b,d,e){var c=this;if(e||d){var h=function(b){c._apiWrapper.removeAsync({id:a});delete b[a]};e&&h(this._geometry);d&&h(this._anchors)}b&&delete this._svgs[a]};b.prototype.get=function(a,b){a=this.getLightDefPropertyKey(a,b);return this.getFromKey(a)};b.prototype.getAllAsArray=function(a,b,d){var c=[],g=function(a){return Object.keys(a).forEach(function(b){return c.push(a[b])})};a&&g(this._svgs);b&&g(this._anchors);d&&g(this._geometry);return c};
   b.prototype.getFromKey=function(a){this._obj.anchor=this._anchors[a];this._obj.svg=this._svgs[a];this._obj.geometry=this._geometry[a];return this._obj};b.prototype.put=function(a,b,d,e,g){a=this.getLightDefPropertyKey(a,b);this.putWithkey(a,d,e,g)};b.prototype.putWithkey=function(a,b,d,e){b&&(this._svgs[a]=b);d&&(this._anchors[a]=d);e&&(this._geometry[a]=e)};b.prototype.getLightDefPropertyKey=function(a,b){return a.type+"_"+a.id+"_"+b};return b}();var module$src$modules$shapediver_lights_drag_controls$src$DragControlsScenePathHelper={default:{}};Object.defineProperty(module$src$modules$shapediver_lights_drag_controls$src$DragControlsScenePathHelper.default,"__esModule",{value:!0});
   module$src$modules$shapediver_lights_drag_controls$src$DragControlsScenePathHelper.default.DragControlsScenePathHelper=function(){function b(){}b.prototype.extractLightIdFromPath=function(a){a=a.substring(a.indexOf("_")+1);return a.substring(0,a.lastIndexOf("_"))};b.prototype.extractPropertyFromPath=function(a){return a.substring(a.lastIndexOf("_")+1)};return b}();var module$src$modules$shapediver_lights_drag_controls$src$LightControls={default:{}};Object.defineProperty(module$src$modules$shapediver_lights_drag_controls$src$LightControls.default,"__esModule",{value:!0});
   var enums_1$$module$src$modules$shapediver_lights_drag_controls$src$LightControls=module$src$modules$shapediver_lights_drag_controls$src$enums$enums.default,GenericEvent_1$$module$src$modules$shapediver_lights_drag_controls$src$LightControls=module$src$modules$shapediver_generic_event$GenericEvent.default,ApiLightHelperWrapper_1$$module$src$modules$shapediver_lights_drag_controls$src$LightControls=module$src$modules$shapediver_lights_drag_controls$src$ApiLightHelperWrapper.default,CreateDefinitions_1$$module$src$modules$shapediver_lights_drag_controls$src$LightControls=
   module$src$modules$shapediver_lights_drag_controls$src$CreateDefinitions.default,DragControlsCache_1$$module$src$modules$shapediver_lights_drag_controls$src$LightControls=module$src$modules$shapediver_lights_drag_controls$src$DragControlsCache.default,DragControlsScenePathHelper_1$$module$src$modules$shapediver_lights_drag_controls$src$LightControls=module$src$modules$shapediver_lights_drag_controls$src$DragControlsScenePathHelper.default;
   module$src$modules$shapediver_lights_drag_controls$src$LightControls.default.LightControls=function(){function b(a,b){this.three=b;this._chevronString='<polyline fill="none" stroke="#000" stroke-width="1.03" points="10 6 14 10 10 14"></polyline><polyline fill="none" stroke="#000" stroke-width="1.03" points="6 6 10 10 6 14"></polyline>';this._events=new module$src$modules$shapediver_generic_event$GenericEvent.default.GenericEvent;this._offsets={};this._polygonString='<polygon fill="none" stroke="#000" stroke-width="1.01" points="10 2 12.63 7.27 18.5 8.12 14.25 12.22 15.25 18 10 15.27 4.75 18 5.75 12.22 1.5 8.12 7.37 7.27"></polygon>';
   this._svgScaling=2E3;this._currentScale=50;this._isEnabled=this._dragging=!1;this._apiWrapper=new module$src$modules$shapediver_lights_drag_controls$src$ApiLightHelperWrapper.default.ApiLightHelperWrapper(a);this._createDefinitions=new module$src$modules$shapediver_lights_drag_controls$src$CreateDefinitions.default.CreateDefinitions(this.three);this._dragControlsCache=new module$src$modules$shapediver_lights_drag_controls$src$DragControlsCache.default.DragControlsCache(this._apiWrapper);this._scenePathHelper=
   new module$src$modules$shapediver_lights_drag_controls$src$DragControlsScenePathHelper.default.DragControlsScenePathHelper;this.addEventListeners()}Object.defineProperty(b.prototype,"events",{get:function(){return this._events},enumerable:!0,configurable:!0});b.prototype.disableDragging=function(){this._dragControlsCache.clear(!1,!0,!0)};b.prototype.enableDragging=function(a){var b=this,d=this._apiWrapper.getLight(a);if(d){if(this._apiWrapper.isSpotLight(d)){var e=d.type+"_"+a+"_position",g=this.createAssetDefinition(e,
   d.properties.position);a=d.type+"_"+a+"_target";var h=this.createAssetDefinition(a,d.properties.target);this._dragControlsCache.put(d,"position",null,g.anchorAssetDefinition,g.geometryAssetDefinition);this._dragControlsCache.put(d,"target",null,h.anchorAssetDefinition,h.geometryAssetDefinition);this._offsets[e]=new this.three.Vector3(d.properties.position.x,d.properties.position.y,d.properties.position.z);this._offsets[a]=new this.three.Vector3(d.properties.target.x,d.properties.target.y,d.properties.target.z)}else this._apiWrapper.isPointLight(d)?
   (e=d.type+"_"+a+"_position",g=this.createAssetDefinition(e,d.properties.position),this._dragControlsCache.put(d,"position",null,g.anchorAssetDefinition,g.geometryAssetDefinition),this._offsets[e]=new this.three.Vector3(d.properties.position.x,d.properties.position.y,d.properties.position.z)):this._apiWrapper.isDirectionalLight(d)&&(g=this.getBoundingSphere(),e=g.center,g=g.radius,h=(new this.three.Vector3(d.properties.direction.x,d.properties.direction.y,d.properties.direction.z)).normalize(),h.multiplyScalar(2.35*
   g),h.add(e),e=d.type+"_"+a+"_position",g=this.createAssetDefinition(e,h),this._dragControlsCache.put(d,"position",null,g.anchorAssetDefinition,g.geometryAssetDefinition),this._offsets[e]=h);d=this._dragControlsCache.getAllAsArray(!1,!0,!0);this._apiWrapper.updateAsync(d).then(function(a){var c=[];b._dragControlsCache.getAllAsArray(!1,!1,!0).forEach(function(b){a.data.forEach(function(a){a.id==b.id&&c.push(a.scenePath)})});b._apiWrapper.toggleGeometry(c)})}};b.prototype.makeLightDraggableAndZoomAsync=
   function(a){this.makeLightDraggable(a);this._apiWrapper.zoomAsync(this.getSceneAndLightBoundingBox())};b.prototype.makeLightDraggable=function(a){if(!this._isEnabled){var b=this._apiWrapper.getSceneBoundingBox();this._dist=.025*b.min.distanceTo(b.max);this._apiWrapper.createInteractionsGroup();this._isEnabled=!0}this.disableDragging();this.enableDragging(a)};b.prototype.makeLightDraggableAndZoom=function(a){this.makeLightDraggable(a);this._apiWrapper.zoomAsync(this.getSceneAndLightBoundingBox())};
   b.prototype.update=function(a){this.makeLightDraggable(a.id)};b.prototype.useLightHelpers=function(a){this._apiWrapper.setLightHelpers(a);this._dragControlsCache.getAllAsArray(!0,!1,!1).forEach(function(b){return b.style.visibility=a?"visible":"hidden"});!1===a&&this.disableDragging()};b.prototype.zoomAsync=function(){this._apiWrapper.zoomAsync(this.getSceneAndLightBoundingBox())};b.prototype.addEventListeners=function(){var a=this;this._apiWrapper.addAnchorAddListener(function(b){for(var c=0,e=b.anchors.length;c<
   e;c++){var g=b.anchors[c];if("light_anchor"===g.format){var h=g.viewport+"-shapediver-lights-domElements";a._domEl=document.getElementById(h);a._domEl||(a._domEl=document.createElement("div"),a._domEl.style.pointerEvents="none",a._domEl.style.position="absolute",a._domEl.style.width="100%",a._domEl.style.height="100%",a._domEl.style.top="0",a._domEl.style.left="0",a._domEl.id=h,a._apiWrapper.appendElementToVieweport(g.viewport,a._domEl));h=document.createElementNS("http://www.w3.org/2000/svg","svg");
   h.style.position="absolute";h.style.color="#000000";h.style.cursor="pointer";h.setAttribute("viewBox","0 0 20 20");h.setAttribute("width","20");h.setAttribute("height","20");if(g.data.text.includes("position"))h.appendChild(a.createPolygonElement());else{var f=a.createPolylineHtmlElements();h.appendChild(f[0]);h.appendChild(f[1])}h.id=g.data.text;(f=a._dragControlsCache.getFromKey(h.id).svg)&&a._domEl.removeChild(f);a._domEl.appendChild(h);a._dragControlsCache.putWithkey(h.id,h);var k=a._offsets[g.data.text];
   a._domRect=a._domEl.getBoundingClientRect();var l=f=void 0;k?(f=new a.three.Vector3(g.location.x,g.location.y,g.location.z),k=a._apiWrapper.convertTo2D(f),f=k.clientX,l=k.clientY):(f=g.clientX,l=g.clientY);a.setSvgPositionAndScale(h,f,l);g.updateFunction(function(b){if(!a._dragging){a._currentScale=1/(b.distance/a._dist)*a._svgScaling;var c=a._dragControlsCache.getFromKey(b.data.text).svg;a.setSvgPositionAndScale(c,b.clientX,b.clientY)}})}}});this._apiWrapper.addAnchorRemoveListener(function(b){for(var c=
   0,e=b.anchors.length;c<e;c++){var g=b.anchors[c];if("light_anchor"===g.format){var h=document.getElementById(g.viewport+"-shapediver-lights-domElements");g=g.data.text;var f=a._dragControlsCache.getFromKey(g).svg;a._dragControlsCache.clearWithKey(g,!0,!1,!1);h.removeChild(f)}}});this._apiWrapper.addDragStartListener(function(b){a._dragging=!0;b=a._apiWrapper.getSceneBoundingBox();b=new a.three.Box3(b.min,b.max);a._boundingSphere=new a.three.Sphere;b.getBoundingSphere(a._boundingSphere)});this._apiWrapper.addDragMoveListener(function(b){var c=
   b.scenePath.substring(b.scenePath.indexOf(".lightHelperGeometry_")+21),e=a._offsets[c],g=a._scenePathHelper.extractPropertyFromPath(c);c=a.getLightDefinitionFromItemId(c);b=b.obj.position.clone().add(e);a.handlePositionAndLightDefinitionFromDirectionalLight(b,c);e=a._apiWrapper.convertTo2D(b);var h=a._dragControlsCache.get(c,g).svg;a.setSvgPositionAndScale(h,e.clientX,e.clientY);c.properties[g]={x:b.x,y:b.y,z:b.z};a._apiWrapper.updateLight(c);a._events.trigger(module$src$modules$shapediver_lights_drag_controls$src$enums$enums.default.LightControlsEvents.UPDATED,
   c)});this._apiWrapper.addDragEndListener(function(b){a._dragging=!1;var c=[],e=b.scenePath.substring(b.scenePath.indexOf(".lightHelperGeometry_")+21),g=a._offsets[e];g=b.obj.position.clone().add(g);var h=!1;b=a.getLightDefinitionFromItemId(e);if(a._apiWrapper.isDirectionalLight(b)){new a.three.Vector3(0,0,0);h=a.getBoundingSphere();g=h.center;h=h.radius;var f=(new a.three.Vector3(b.properties.direction.x,b.properties.direction.y,b.properties.direction.z)).normalize();f.multiplyScalar(2.35*h);g=f.add(g);
   h=!0}f=a.createAssetDefinition(e,g);h&&(c.push(f.geometryAssetDefinition),a._offsets[e]=new a.three.Vector3(g.x,g.y,g.z));a._dragControlsCache.put(b,"position",null,f.anchorAssetDefinition,h?f.geometryAssetDefinition:null);c.push(f.anchorAssetDefinition);a._apiWrapper.updateAsync(c)})};b.prototype.createAssetDefinition=function(a,b){var c=new this.three.Mesh(new this.three.SphereGeometry(this._dist,2,2),new this.three.MeshBasicMaterial({color:16776960,opacity:0,transparent:!0}));c.geometry.applyMatrix((new this.three.Matrix4).makeTranslation(b.x,
   b.y,b.z));var e=this._createDefinitions.createGeometryAssetDefinition();e.id="lightHelperGeometry_"+a;e.content[0].data.threeObject=c;c=this._createDefinitions.createAnchorAssetDefinition();c.id="lightHelperAnchor_"+a;c.content[0].data[0].location=b;c.content[0].data[0].data.text=a;return{geometryAssetDefinition:e,anchorAssetDefinition:c}};b.prototype.createPolygonElement=function(){var a=document.createElementNS("http://www.w3.org/2000/svg","polygon");a.setAttribute("fill","none");a.setAttribute("stroke",
   "#000");a.setAttribute("stroke-width","1.03");a.setAttribute("points","10 2 12.63 7.27 18.5 8.12 14.25 12.22 15.25 18 10 15.27 4.75 18 5.75 12.22 1.5 8.12 7.37 7.27");return a};b.prototype.createPolylineHtmlElements=function(){var a=document.createElementNS("http://www.w3.org/2000/svg","polyline");a.setAttribute("fill","none");a.setAttribute("stroke","#000");a.setAttribute("stroke-width","1.03");a.setAttribute("points","10 6 14 10 10 14");var b=document.createElementNS("http://www.w3.org/2000/svg",
   "polyline");b.setAttribute("fill","none");b.setAttribute("stroke","#000");b.setAttribute("stroke-width","1.03");b.setAttribute("points","6 6 10 10 6 14");return[a,b]};b.prototype.getBoundingSphere=function(a){void 0===a&&(a=!1);if(!this._boundingSphere||a)a=this._apiWrapper.getSceneBoundingBox(),a=new this.three.Box3(a.min,a.max),this._boundingSphere=new this.three.Sphere,a.getBoundingSphere(this._boundingSphere);return this._boundingSphere};b.prototype.getLightDefinitionFromItemId=function(a){return this._apiWrapper.getLight(this._scenePathHelper.extractLightIdFromPath(a))};
   b.prototype.getSceneAndLightBoundingBox=function(){var a=this._apiWrapper.getSceneBoundingBox();a=new this.three.Box3(a.min,a.max);var b=a.getBoundingSphere(),d=b.center;b=b.radius;var e=this._apiWrapper.getLightScene().lights,g;for(g in e){var h=e[g];this._apiWrapper.isSpotLight(h)&&a.union((new this.three.Box3).setFromPoints([new this.three.Vector3(h.properties.position.x,h.properties.position.y,h.properties.position.z),d.clone().add(d.clone().sub(new this.three.Vector3(h.properties.position.x,
   h.properties.position.y,h.properties.position.z))),new this.three.Vector3(h.properties.target.x,h.properties.target.y,h.properties.target.z),d.clone().add(d.clone().sub(new this.three.Vector3(h.properties.target.x,h.properties.target.y,h.properties.target.z)))]));this._apiWrapper.isDirectionalLight(h)&&a.union((new this.three.Box3).setFromPoints([d.clone().add((new this.three.Vector3(h.properties.direction.x,h.properties.direction.y,h.properties.direction.z)).normalize().multiplyScalar(2.35*b)),d.clone().add((new this.three.Vector3(h.properties.direction.x,
   h.properties.direction.y,h.properties.direction.z)).normalize().multiplyScalar(-2.35*b))]));this._apiWrapper.isPointLight(h)&&a.union((new this.three.Box3).setFromPoints([new this.three.Vector3(h.properties.position.x,h.properties.position.y,h.properties.position.z),d.clone().add(d.clone().sub(new this.three.Vector3(h.properties.position.x,h.properties.position.y,h.properties.position.z)))]))}return a};b.prototype.handlePositionAndLightDefinitionFromDirectionalLight=function(a,b){if(this._apiWrapper.isDirectionalLight(b)){var c=
   this.getBoundingSphere(),e=c.center;c=c.radius;b.properties.direction=(new this.three.Vector3(a.x,a.y,a.z)).sub(new this.three.Vector3(e.x,e.y,e.z)).normalize();b=b.properties.direction.clone();b.multiplyScalar(2.35*c);e=(new this.three.Vector3(e.x,e.y,e.z)).add(b);a.x=e.x;a.y=e.y;a.z=e.z}};b.prototype.setSvgPositionAndScale=function(a,b,d){if(a.firstElementChild||a.innerHTML){b=b-this._currentScale/2-this._domRect.left;d=d-this._currentScale/2-this._domRect.top;var c=this._domEl.clientWidth-a.clientWidth,
   g=this._domEl.clientHeight-a.clientHeight;c=!(0>b||b>c||0>d||d>g);this._apiWrapper.getLightHelpersVisible()&&c?(a.style.visibility="visible",a.setAttribute("width",this._currentScale),a.setAttribute("height",this._currentScale),a.style.left=b+"px",a.style.top=d+"px"):a.style.visibility="hidden"}};return b}();var module$src$modules$shapediver_lights_drag_controls$app={default:{}};Object.defineProperty(module$src$modules$shapediver_lights_drag_controls$app.default,"__esModule",{value:!0});var LightControls_1$$module$src$modules$shapediver_lights_drag_controls$app=module$src$modules$shapediver_lights_drag_controls$src$LightControls.default,enums_1$$module$src$modules$shapediver_lights_drag_controls$app=module$src$modules$shapediver_lights_drag_controls$src$enums$enums.default;
   module$src$modules$shapediver_lights_drag_controls$app.default.ShapeDiverDragControls=function(){function b(a,b){var c=this;this.api=a;this.three=b;this.registeredLightEvents={};this.controls=new module$src$modules$shapediver_lights_drag_controls$src$LightControls.default.LightControls(a,b);this.controls.events.on(module$src$modules$shapediver_lights_drag_controls$src$enums$enums.default.LightControlsEvents.UPDATED,function(a){c.registeredLightEvents[a.id]&&c.registeredLightEvents[a.id].forEach(function(b){return b(a)})})}
   b.prototype.clearOnLightUpdateEvents=function(a){delete this.registeredLightEvents[a]};b.prototype.makeLightDraggable=function(a){this.controls.makeLightDraggable(a)};b.prototype.makeLightDraggableAndZoomAsync=function(a){this.controls.makeLightDraggableAndZoomAsync(a)};b.prototype.onLightUpdate=function(a,b){this.registeredLightEvents[a]?this.registeredLightEvents[a].push(b):this.registeredLightEvents[a]=[b]};b.prototype.updateLight=function(a){this.controls.update(a)};b.prototype.useLightHelpers=
   function(a){this.controls.useLightHelpers(a)};b.prototype.zoomAsync=function(){this.controls.zoomAsync()};return b}();var module$src$api$apps$sd_controls$SDControlsManager={default:{}},__awaiter$$module$src$api$apps$sd_controls$SDControlsManager=this&&module$src$api$apps$sd_controls$SDControlsManager.default.__awaiter||function(b,a,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,h){function g(a){try{l(d.next(a))}catch(n){h(n)}}function k(a){try{l(d["throw"](a))}catch(n){h(n)}}function l(a){a.done?c(a.value):e(a.value).then(g,k)}l((d=d.apply(b,a||[])).next())})},
   __generator$$module$src$api$apps$sd_controls$SDControlsManager=this&&module$src$api$apps$sd_controls$SDControlsManager.default.__generator||function(b,a){function c(a){return function(b){return d([a,b])}}function d(c){if(g)throw new TypeError("Generator is already executing.");for(;e;)try{if(g=1,h&&(f=c[0]&2?h["return"]:c[0]?h["throw"]||((f=h["return"])&&f.call(h),0):h.next)&&!(f=f.call(h,c[1])).done)return f;if(h=0,f)c=[c[0]&2,f.value];switch(c[0]){case 0:case 1:f=c;break;case 4:return e.label++,
   {value:c[1],done:!1};case 5:e.label++;h=c[1];c=[0];continue;case 7:c=e.ops.pop();e.trys.pop();continue;default:if(!(f=e.trys,f=0<f.length&&f[f.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!f||c[1]>f[0]&&c[1]<f[3]))e.label=c[1];else if(6===c[0]&&e.label<f[1])e.label=f[1],f=c;else if(f&&e.label<f[2])e.label=f[2],e.ops.push(c);else{f[2]&&e.ops.pop();e.trys.pop();continue}}c=a.call(b,e)}catch(m){c=[6,m],h=0}finally{g=f=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e=
   {label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},g,h,f,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k},__read$$module$src$api$apps$sd_controls$SDControlsManager=this&&module$src$api$apps$sd_controls$SDControlsManager.default.__read||function(b,a){var c="function"===typeof Symbol&&b[Symbol.iterator];if(!c)return b;b=c.call(b);var d,e=[];try{for(;(void 0===a||0<a--)&&!(d=b.next()).done;)e.push(d.value)}catch(h){var g=
   {error:h}}finally{try{d&&!d.done&&(c=b["return"])&&c.call(b)}finally{if(g)throw g.error;}}return e},__spread$$module$src$api$apps$sd_controls$SDControlsManager=this&&module$src$api$apps$sd_controls$SDControlsManager.default.__spread||function(){for(var b=[],a=0;a<arguments.length;a++)b=b.concat(__read$$module$src$api$apps$sd_controls$SDControlsManager(arguments[a]));return b};Object.defineProperty(module$src$api$apps$sd_controls$SDControlsManager.default,"__esModule",{value:!0});
   var interfaces_1$$module$src$api$apps$sd_controls$SDControlsManager=module$src$interfaces$api$apps$sd_controls$interfaces.default;
   module$src$api$apps$sd_controls$SDControlsManager.default.SDControlsManager=function(){function b(a,b,d,e,g,h,f,k,l,m,n,q,p,u,t,r){var c=this;void 0===r&&(r=!1);this._api=a;this._sdParametersHandler=b;this._sdSettingsHandler=d;this._sdControlsEditManager=e;this._dependenciesResolver=g;this._controlsEvents=h;this._sdSettings=f;this._groups=k;this._container=l;this._sortManager=m;this._controlsContracts=n;this._parameterLinker=q;this._inputComponentsFactory=p;this._resizeManager=u;this._lightDragControls=
   t;this._editMode=r;this._parameterControls=[];this._settingsControls=[];this._userControls=[];this._viewerResizedEvent=null;this._dependenciesResolved=!1;this._container.parentElement.addEventListener("viewer-resized",function(a){c.resizeControls(a)});if(this._sdParametersHandler)this._sdParametersHandler.onParameterRegistered(function(a){return c.createShapeDiverParameterAsync(a)}),this._sdParametersHandler.onExportRegistered(function(a){return c.createShapeDiverParameterAsync(a)}),this._sdParametersHandler.onExportUpdated(function(a){return c.updateShapeDiverParameterAsync(a)}),
   this._sdParametersHandler.onParameterUpdate(function(a){return c.updateShapeDiverParameterAsync(a)});else if(this._sdSettingsHandler){this._inputComponentsFactory.onSettingCreated(function(a,b){return c.onSettingCreated(a,b)});this._controlsEvents.on("clear.lights",function(){return c._settingsControls.filter(function(a){return"light_definition"===a.type}).forEach(function(a){return a.destroy()})});this._controlsEvents.on("remove_setting",function(a){return c.removeSetting(a)});this._controlsEvents.on("create_setting",
   function(a){c._sdSettings.settings[a.key]=a.definition;c.createShapediverSettingAsync(a.definition)});a={};for(var w in this._sdSettings.settings)b=this._sdSettings.settings[w],a[b.groupId]||(a[b.groupId]=[]),a[b.groupId].push(b);for(w in a)a[w].sort(function(a,b){return a.order-b.order}).forEach(function(a){return c.createShapediverSettingAsync(a)});this._groups.headersClick(function(a){a==module$src$interfaces$api$apps$sd_controls$interfaces.default.SettingsGroups.LIGHTS?(c._lightDragControls.useLightHelpers(!0),
   c._lightDragControls.zoomAsync()):(c._lightDragControls.useLightHelpers(!1),c._settingsControls.filter(function(a){return"light_definition"==a.type}).forEach(function(a){return a.close()}))})}this.resort()}b.prototype.createShapeDiverParameterAsync=function(a){return __awaiter$$module$src$api$apps$sd_controls$SDControlsManager(this,void 0,void 0,function(){var b,d,e=this;return __generator$$module$src$api$apps$sd_controls$SDControlsManager(this,function(c){switch(c.label){case 0:return[4,this.resolveDependenciesAsync()];
   case 1:c.sent();b=null;if(b=this._api.parameters.get().data.find(function(b){return b.id===a.id}))a=b,a.isParameter=!0;else if(b=this._api.exports.get().data.find(function(b){return b.id===a.id}))a=b,a.isParameter=!1;if(!this._sdParametersHandler||this._parameterControls.some(function(b){return b.id==a.id}))return[2,Promise.resolve("")];d=this._inputComponentsFactory.createShapeDiverParameter(a,this._container,this._editMode);if(!d)return[2,Promise.resolve("")];this._parameterControls.push(d);this._sdControlsEditManager.registerComponent(d);
   this._sortManager.sort(__spread$$module$src$api$apps$sd_controls$SDControlsManager(this._userControls,this._parameterControls));this.resizeControls();d.onDestroy(function(a){for(var b=0;b<e._parameterControls.length;b++)if(e._parameterControls[b].id===a){e._parameterControls.splice(b,1);break}});return[2,Promise.resolve(d.id)]}})})};b.prototype.createShapediverSettingAsync=function(a){return __awaiter$$module$src$api$apps$sd_controls$SDControlsManager(this,void 0,void 0,function(){var b;return __generator$$module$src$api$apps$sd_controls$SDControlsManager(this,
   function(c){switch(c.label){case 0:return[4,this.resolveDependenciesAsync()];case 1:c.sent();if(!this._settingsControls||this._settingsControls.some(function(b){return b.id==a.id}))return[2,Promise.resolve("")];b=this._inputComponentsFactory.createShapeDiverSetting(a,this._groups.getGroupByIndex(a.groupId));this.onSettingCreated(b,a);return[2,Promise.resolve(b.id)]}})})};b.prototype.createUserDefinedParameterAsync=function(a){return __awaiter$$module$src$api$apps$sd_controls$SDControlsManager(this,
   void 0,void 0,function(){var b;return __generator$$module$src$api$apps$sd_controls$SDControlsManager(this,function(c){switch(c.label){case 0:return a=this._parameterLinker.createLinkIfDefined(a),this._controlsContracts.controlParameterDefinitionContract(a),[4,this.resolveDependenciesAsync()];case 1:return c.sent(),b=this._inputComponentsFactory.createUserDefinedParameter(a,this._container,this._editMode),this._userControls.push(b),this._sortManager.sort(__spread$$module$src$api$apps$sd_controls$SDControlsManager(this._userControls,
   this._parameterControls)),this.resizeControls(null,[b]),[2,Promise.resolve(b.id)]}})})};b.prototype.destroyParameters=function(){this._parameterControls.forEach(function(a){return a.destroy()});this._userControls.forEach(function(a){return a.destroy()});this._parameterControls.length=0;this._userControls.length=0};b.prototype.removeSetting=function(a){var b;delete this._sdSettings.settings[a];null===(b=this._settingsControls.find(function(b){return b.id===a}))||void 0===b?void 0:b.destroy()};b.prototype.removeShapeDiverParameter=
   function(a){throw Error("Method not implemented.");};b.prototype.removeUserDefinedParameter=function(a){return this.removeParameter(this._userControls,a)};b.prototype.resort=function(){var a=this;this._resortTimeout=window.setTimeout(function(){a._resortTimeout&&window.clearTimeout(a._resortTimeout);a._sortManager.sort(__spread$$module$src$api$apps$sd_controls$SDControlsManager(a._userControls,a._parameterControls))},500)};b.prototype.saveParameters=function(){var a=this;!0===this._editMode&&this._parameterControls.forEach(function(b){var c=
   {id:b.id,hidden:b.hidden,order:b.order,name:null};b.wasEdited&&null!==b.newName&&b.newName!==b.name&&(c.name=b.newName);!0===b.isParameter?a._api.parameters.updateProperties(c):!0===b.isExport&&a._api.exports.updateProperties(c);b.name=b.label.innerHTML})};b.prototype.onSettingCreated=function(a,b){var c=this,e=Object.keys(this._sdSettings.settings).map(function(a){return 0<a.lastIndexOf("_")?a.substring(0,a.lastIndexOf("_")):a}).includes(b.id);b="light_definition"==b.type;if(e||b){this._settingsControls.push(a);
   var g={};this._settingsControls.forEach(function(a){return Array.isArray(g[a.groupId])?g[a.groupId].push(a):g[a.groupId]=[a]});Object.keys(g).forEach(function(a){return c._sortManager.sort(__spread$$module$src$api$apps$sd_controls$SDControlsManager(g[a]),!0)});a.onDestroy(function(a){for(var b=0;b<c._settingsControls.length;b++)if(c._settingsControls[b].id===a){c._settingsControls.splice(b,1);delete c._sdSettings.settings[a];break}});this.resizeControls(null,[a])}};b.prototype.removeParameter=function(a,
   b){for(var c=a.length-1;0<=c;c--){var e=a[c];if(e.children&&0<e.children.length&&this.removeParameter(e.children,b))return!0;if(e.id===b)return a.splice(c,1),e.destroy(),!0}return!1};b.prototype.resizeControls=function(a,b){void 0===a&&(a=null);void 0===b&&(b=null);var c,e;b=null!==b&&void 0!==b?b:this._sortManager.sort(__spread$$module$src$api$apps$sd_controls$SDControlsManager(this._userControls,this._parameterControls,this._settingsControls),!1);null!=a&&(this._viewerResizedEvent=a);this._resizeManager.resize(b,
   null===(c=this._viewerResizedEvent)||void 0===c?void 0:c.detail.mode,null===(e=this._viewerResizedEvent)||void 0===e?void 0:e.detail.clientWidth)};b.prototype.resolveDependenciesAsync=function(){return __awaiter$$module$src$api$apps$sd_controls$SDControlsManager(this,void 0,void 0,function(){var a;return __generator$$module$src$api$apps$sd_controls$SDControlsManager(this,function(b){switch(b.label){case 0:if(!0===this._dependenciesResolved)return[3,2];a=this;return[4,this._dependenciesResolver.resolveDependenciesAsync()];
   case 1:a._dependenciesResolved=b.sent(),b.label=2;case 2:return[2,Promise.resolve()]}})})};b.prototype.updateShapeDiverParameterAsync=function(a){var b=this,d=!1;this._parameterControls.forEach(function(c){c.id===a.id&&(d=!0,a.name&&a.name!==c.name&&(c.name=a.name),"number"===typeof a.order&&a.order!=c.order&&(c.order=a.order),b._editMode&&a.hidden?c.hidden=a.hidden:a.hidden&&c.destroy())});this.resort();a.id&&0==d&&!1===a.hidden&&this.createShapeDiverParameterAsync(a)};return b}();var module$src$api$apps$sd_controls$managers$SDControlsDomManager={default:{}},__awaiter$$module$src$api$apps$sd_controls$managers$SDControlsDomManager=this&&module$src$api$apps$sd_controls$managers$SDControlsDomManager.default.__awaiter||function(b,a,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,h){function g(a){try{l(d.next(a))}catch(n){h(n)}}function k(a){try{l(d["throw"](a))}catch(n){h(n)}}function l(a){a.done?c(a.value):e(a.value).then(g,
   k)}l((d=d.apply(b,a||[])).next())})},__generator$$module$src$api$apps$sd_controls$managers$SDControlsDomManager=this&&module$src$api$apps$sd_controls$managers$SDControlsDomManager.default.__generator||function(b,a){function c(a){return function(b){return d([a,b])}}function d(c){if(g)throw new TypeError("Generator is already executing.");for(;e;)try{if(g=1,h&&(f=c[0]&2?h["return"]:c[0]?h["throw"]||((f=h["return"])&&f.call(h),0):h.next)&&!(f=f.call(h,c[1])).done)return f;if(h=0,f)c=[c[0]&2,f.value];
   switch(c[0]){case 0:case 1:f=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++;h=c[1];c=[0];continue;case 7:c=e.ops.pop();e.trys.pop();continue;default:if(!(f=e.trys,f=0<f.length&&f[f.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!f||c[1]>f[0]&&c[1]<f[3]))e.label=c[1];else if(6===c[0]&&e.label<f[1])e.label=f[1],f=c;else if(f&&e.label<f[2])e.label=f[2],e.ops.push(c);else{f[2]&&e.ops.pop();e.trys.pop();continue}}c=a.call(b,e)}catch(m){c=[6,m],h=0}finally{g=f=0}if(c[0]&
   5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},g,h,f,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k};Object.defineProperty(module$src$api$apps$sd_controls$managers$SDControlsDomManager.default,"__esModule",{value:!0});
   module$src$api$apps$sd_controls$managers$SDControlsDomManager.default.SDControlsDomManager=function(){function b(){this._mobileOrTabletRegex=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/;this._mobileOrTabletRegex2=
   /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i;
   this._mobileRegex=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i;this._mobileRegex2=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i;
   this._userAgent=navigator.userAgent||navigator.vendor||window.opera;this._isTableOrMobileDevice=this._isMobileDevice=this._isIPadOrIPhone=null;this._domSupportsHtml5Color=this.checkDomSupportsHtml5Color();this._useSpectrum=!(this._domSupportsHtml5Color&&this.userAgentIsMobileDevice)}Object.defineProperty(b.prototype,"useSpectrum",{get:function(){return this._useSpectrum},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"domSupportsHtml5Color",{get:function(){return this._domSupportsHtml5Color},
   enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"userAgentIsIPadOrIPhone",{get:function(){null===this._isIPadOrIPhone&&(this._isIPadOrIPhone=(/iPad|iPhone|iPod/.test(navigator.platform)||"MacIntel"===navigator.platform&&1<navigator.maxTouchPoints)&&!window.MSStream);return this._isIPadOrIPhone},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"userAgentIsMobileDevice",{get:function(){null===this._isMobileDevice&&(this._isMobileDevice=this._mobileRegex.test(this._userAgent)||
   this._mobileRegex2.test(this._userAgent.substr(0,4)));return this._isMobileDevice},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"userAgentIsMobileOrTabletDevice",{get:function(){null===this._isTableOrMobileDevice&&(this._isTableOrMobileDevice=this._mobileOrTabletRegex.test(this._userAgent)||this._mobileOrTabletRegex2.test(this._userAgent.substr(0,4)));return this._isTableOrMobileDevice},enumerable:!0,configurable:!0});b.prototype.createDomElement=function(a,b,d,e,g){void 0===
   e&&(e=[]);void 0===g&&(g={});var c=document.createElement(a);b&&(c.id=b);d&&d.appendChild(c);e.forEach(function(a){return c.classList.add(a)});for(var f in g)c.setAttribute(f,g[f]);return c};b.prototype.isEventSupported=function(a,b){b=document.createElement(b);a="on"+a;var c=a in b;c||(b.setAttribute(a,"return;"),c="function"==typeof b[a]);b.remove();return c};b.prototype.setDomEventListener=function(a,b,d,e){var c=this;void 0===d&&(d=null);if(d){var h=null;a.addEventListener(b,function(b){var g=
   a.value;null!==h&&clearTimeout(h);h=setTimeout(function(){return __awaiter$$module$src$api$apps$sd_controls$managers$SDControlsDomManager(c,void 0,void 0,function(){return __generator$$module$src$api$apps$sd_controls$managers$SDControlsDomManager(this,function(a){h=null;e(g,b);return[2]})})},d)})}else a.addEventListener(b,function(b){return e(a.value,b)})};b.prototype.checkDomSupportsHtml5Color=function(){try{var a=document.createElement("input");a.type="color";a.value="!";return"color"===a.type&&
   "!"!==a.value}catch(c){return!1}};return b}();var module$src$api$apps$sd_controls$managers$SDControlsDependenciesResolver={default:{}},__awaiter$$module$src$api$apps$sd_controls$managers$SDControlsDependenciesResolver=this&&module$src$api$apps$sd_controls$managers$SDControlsDependenciesResolver.default.__awaiter||function(b,a,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,h){function g(a){try{l(d.next(a))}catch(n){h(n)}}function k(a){try{l(d["throw"](a))}catch(n){h(n)}}function l(a){a.done?
   c(a.value):e(a.value).then(g,k)}l((d=d.apply(b,a||[])).next())})},__generator$$module$src$api$apps$sd_controls$managers$SDControlsDependenciesResolver=this&&module$src$api$apps$sd_controls$managers$SDControlsDependenciesResolver.default.__generator||function(b,a){function c(a){return function(b){return d([a,b])}}function d(c){if(g)throw new TypeError("Generator is already executing.");for(;e;)try{if(g=1,h&&(f=c[0]&2?h["return"]:c[0]?h["throw"]||((f=h["return"])&&f.call(h),0):h.next)&&!(f=f.call(h,
   c[1])).done)return f;if(h=0,f)c=[c[0]&2,f.value];switch(c[0]){case 0:case 1:f=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++;h=c[1];c=[0];continue;case 7:c=e.ops.pop();e.trys.pop();continue;default:if(!(f=e.trys,f=0<f.length&&f[f.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!f||c[1]>f[0]&&c[1]<f[3]))e.label=c[1];else if(6===c[0]&&e.label<f[1])e.label=f[1],f=c;else if(f&&e.label<f[2])e.label=f[2],e.ops.push(c);else{f[2]&&e.ops.pop();e.trys.pop();continue}}c=a.call(b,
   e)}catch(m){c=[6,m],h=0}finally{g=f=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},g,h,f,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k};Object.defineProperty(module$src$api$apps$sd_controls$managers$SDControlsDependenciesResolver.default,"__esModule",{value:!0});
   module$src$api$apps$sd_controls$managers$SDControlsDependenciesResolver.default.SDControlsDependenciesResolver=function(){function b(a){this._useSpectrum=a;this._dependenciesPromise=null;this.resolveDependenciesAsync()}b.prototype.resolveDependenciesAsync=function(){return __awaiter$$module$src$api$apps$sd_controls$managers$SDControlsDependenciesResolver(this,void 0,void 0,function(){var a=this;return __generator$$module$src$api$apps$sd_controls$managers$SDControlsDependenciesResolver(this,function(b){null==
   this._dependenciesPromise&&(this._dependenciesPromise=new Promise(function(b){return __awaiter$$module$src$api$apps$sd_controls$managers$SDControlsDependenciesResolver(a,void 0,void 0,function(){return __generator$$module$src$api$apps$sd_controls$managers$SDControlsDependenciesResolver(this,function(a){switch(a.label){case 0:return this._useSpectrum?[4,this.resolveScript("sdv-jquery","https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js","sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=")]:
   [3,3];case 1:return a.sent(),[4,this.resolveScript("sdv-spectrum","https://viewer.shapediver.com/external/spectrum.js?v=1908130856")];case 2:a.sent(),a.label=3;case 3:return b(!0),[2]}})})}));return[2,this._dependenciesPromise]})})};b.prototype.resolveLink=function(a,b,d){return __awaiter$$module$src$api$apps$sd_controls$managers$SDControlsDependenciesResolver(this,void 0,void 0,function(){return __generator$$module$src$api$apps$sd_controls$managers$SDControlsDependenciesResolver(this,function(c){return[2,
   new Promise(function(c){var e=document.getElementById(a);null==e&&(e=document.createElement("link"),e.id=a,e.rel="stylesheet",e.type="text/css",e.media="all",e.crossOrigin="anonymous",d&&(e.integrity=d),e.addEventListener("load",function(){e.setAttribute("loaded","true");c(!0)}),document.head.appendChild(e),e.href=b);"true"===e.getAttribute("loaded")?c(!0):e.addEventListener("load",function(){e.setAttribute("loaded","true");c(!0)})})]})})};b.prototype.resolveScript=function(a,b,d){return __awaiter$$module$src$api$apps$sd_controls$managers$SDControlsDependenciesResolver(this,
   void 0,void 0,function(){return __generator$$module$src$api$apps$sd_controls$managers$SDControlsDependenciesResolver(this,function(c){return[2,new Promise(function(c){var e=document.getElementById(a);null==e&&(e=document.createElement("script"),e.id=a,e.crossOrigin="anonymous",d&&(e.integrity=d),e.addEventListener("load",function(){e.setAttribute("loaded","true");c(!0)}),document.head.appendChild(e),e.src=b);"true"==e.getAttribute("loaded")?c(!0):e.addEventListener("load",function(){e.setAttribute("loaded",
   "true");c(!0)})})]})})};return b}();var module$src$modules$shapediver_file_helper$SDFileHelper={default:{}};Object.defineProperty(module$src$modules$shapediver_file_helper$SDFileHelper.default,"__esModule",{value:!0});module$src$modules$shapediver_file_helper$SDFileHelper.default.SDFileHelper=function(){function b(){}b.prototype.guessMimeTypeFromFilename=function(a){a=a.toLowerCase();var b="";a.endsWith(".dxf")?b="application/dxf":a.endsWith(".obj")?b="application/wavefront-obj":a.endsWith(".csv")&&(b="text/csv");return b};return b}();var module$src$api$apps$sd_controls$managers$SDControlComponentContracts={default:{}},__extends$$module$src$api$apps$sd_controls$managers$SDControlComponentContracts=this&&module$src$api$apps$sd_controls$managers$SDControlComponentContracts.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return b(a,c)};return function(a,c){function d(){this.constructor=
   a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$managers$SDControlComponentContracts.default,"__esModule",{value:!0});
   var ControlParameterDefinitionMissingPropertyError$$module$src$api$apps$sd_controls$managers$SDControlComponentContracts=function(b){function a(a,d){return b.call(this,"Custom parameter definition of type "+a.type+" is missing property "+d)||this}__extends$$module$src$api$apps$sd_controls$managers$SDControlComponentContracts(a,b);return a}(Error),ControlParameterDefinitionWrongPropertyTypeError$$module$src$api$apps$sd_controls$managers$SDControlComponentContracts=function(b){function a(a,d,e,g){return b.call(this,
   "Custom parameter definition property "+d+" has a wrong type assigned. Expected type: "+g+", current type: "+e+". Parameter type: "+a.type)||this}__extends$$module$src$api$apps$sd_controls$managers$SDControlComponentContracts(a,b);return a}(Error),SDControlComponentsContracts$$module$src$api$apps$sd_controls$managers$SDControlComponentContracts=function(){function b(){}b.prototype.controlParameterDefinitionContract=function(a){this.checkProperty(a,"type","string");"checkbox"===a.type?this.checkboxContract(a):
   "string"===a.type?this.stringContract(a):"button"===a.type?this.buttonContract(a):"checklist"===a.type?this.checklistContract(a):"color"===a.type?this.colorContract(a):"dropdown"===a.type?this.dropdownContract(a):"file"===a.type?this.fileContract(a):"modal"===a.type?this.modalContract(a):"group"===a.type?this.multipleContract(a):"slider"===a.type?this.sliderContract(a):"vector3"===a.type?this.vectorContract(a):"statichtml"===a.type&&this.staticHTMLContract(a)};b.prototype.settingDefinitionContract=
   function(a){this.checkProperty(a,"type","string");this.checkProperty(a,"id","string");"statichtml"===a.type&&this.staticHTMLContract(a)};b.prototype.buttonContract=function(a){this.checkProperty(a,"update","function")};b.prototype.checkArrayProperty=function(a,b){this.checkProperty(a,b,"object");if(!Array.isArray(a[b]))throw new ControlParameterDefinitionWrongPropertyTypeError$$module$src$api$apps$sd_controls$managers$SDControlComponentContracts(a,b,typeof a[b],"array");};b.prototype.checkProperty=
   function(a,b,d){if(!a.hasOwnProperty(b))throw new ControlParameterDefinitionMissingPropertyError$$module$src$api$apps$sd_controls$managers$SDControlComponentContracts(a,b);if(d&&typeof a[b]!==d)throw new ControlParameterDefinitionWrongPropertyTypeError$$module$src$api$apps$sd_controls$managers$SDControlComponentContracts(a,b,typeof a[b],d);};b.prototype.checkboxContract=function(a){this.checkProperty(a,"update","function")};b.prototype.checklistContract=function(a){this.checkProperty(a,"update","function");
   this.checkArrayProperty(a,"choices")};b.prototype.colorContract=function(a){this.checkProperty(a,"update","function")};b.prototype.dropdownContract=function(a){this.checkProperty(a,"update","function");this.checkArrayProperty(a,"choices")};b.prototype.fileContract=function(a){this.checkProperty(a,"update","function")};b.prototype.modalContract=function(a){this.checkProperty(a,"modalContent","string")};b.prototype.multipleContract=function(a){this.checkArrayProperty(a,"parameters")};b.prototype.sliderContract=
   function(a){this.checkProperty(a,"update","function")};b.prototype.staticHTMLContract=function(a){this.checkProperty(a,"content","string")};b.prototype.stringContract=function(a){this.checkProperty(a,"update","function")};b.prototype.vectorContract=function(a){this.checkProperty(a,"update","function")};return b}();module$src$api$apps$sd_controls$managers$SDControlComponentContracts.default.SDControlComponentsContractsInstance=new SDControlComponentsContracts$$module$src$api$apps$sd_controls$managers$SDControlComponentContracts;var module$src$api$apps$sd_controls$enums$enums={default:{}};Object.defineProperty(module$src$api$apps$sd_controls$enums$enums.default,"__esModule",{value:!0});var DefaultControlParameterType$$module$src$api$apps$sd_controls$enums$enums;
   (function(b){b.STRING="string";b.CHECKBOX="checkbox";b.VECTOR3="vector3";b.BUTTON="button";b.CHECKLIST="checklist";b.GROUP="group";b.COLOR="color";b.DROPDOWN="dropdown";b.FILE="file";b.MODAL="modal";b.SLIDER="slider";b.STATICHTML="statichtml"})(DefaultControlParameterType$$module$src$api$apps$sd_controls$enums$enums=module$src$api$apps$sd_controls$enums$enums.default.DefaultControlParameterType||(module$src$api$apps$sd_controls$enums$enums.default.DefaultControlParameterType={}));var module$src$api$apps$sd_controls$managers$SDControlsParameterHandler={default:{}},__awaiter$$module$src$api$apps$sd_controls$managers$SDControlsParameterHandler=this&&module$src$api$apps$sd_controls$managers$SDControlsParameterHandler.default.__awaiter||function(b,a,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,h){function g(a){try{l(d.next(a))}catch(n){h(n)}}function k(a){try{l(d["throw"](a))}catch(n){h(n)}}function l(a){a.done?c(a.value):
   e(a.value).then(g,k)}l((d=d.apply(b,a||[])).next())})},__generator$$module$src$api$apps$sd_controls$managers$SDControlsParameterHandler=this&&module$src$api$apps$sd_controls$managers$SDControlsParameterHandler.default.__generator||function(b,a){function c(a){return function(b){return d([a,b])}}function d(c){if(g)throw new TypeError("Generator is already executing.");for(;e;)try{if(g=1,h&&(f=c[0]&2?h["return"]:c[0]?h["throw"]||((f=h["return"])&&f.call(h),0):h.next)&&!(f=f.call(h,c[1])).done)return f;
   if(h=0,f)c=[c[0]&2,f.value];switch(c[0]){case 0:case 1:f=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++;h=c[1];c=[0];continue;case 7:c=e.ops.pop();e.trys.pop();continue;default:if(!(f=e.trys,f=0<f.length&&f[f.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!f||c[1]>f[0]&&c[1]<f[3]))e.label=c[1];else if(6===c[0]&&e.label<f[1])e.label=f[1],f=c;else if(f&&e.label<f[2])e.label=f[2],e.ops.push(c);else{f[2]&&e.ops.pop();e.trys.pop();continue}}c=a.call(b,e)}catch(m){c=
   [6,m],h=0}finally{g=f=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},g,h,f,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k};Object.defineProperty(module$src$api$apps$sd_controls$managers$SDControlsParameterHandler.default,"__esModule",{value:!0});
   module$src$api$apps$sd_controls$managers$SDControlsParameterHandler.default.SDControlsParameterHandler=function(){function b(a,b){var c=this;this._api=a;this._sdDependenciesResolver=b;this._exportRegisteredEvents=[];this._exportUpdateEvents=[];this._parameterRegisteredEvents=[];this._parametersUpdateEvents=[];this._typesMap={"parameter.Int":"slider","parameter.Odd":"slider","parameter.Even":"slider","parameter.Float":"slider","parameter.String":"string","parameter.Bool":"checkbox","parameter.Color":"color",
   "parameter.StringList.checklist":"checklist","parameter.StringList.sequence":"dropdown","parameter.StringList.cycle":"dropdown","parameter.StringList.dropdown":"dropdown","parameter.File":"file"};this._api.parameters.addEventListener(this._api.parameters.EVENTTYPE.REGISTERED,function(a){return __awaiter$$module$src$api$apps$sd_controls$managers$SDControlsParameterHandler(c,void 0,void 0,function(){var b;return __generator$$module$src$api$apps$sd_controls$managers$SDControlsParameterHandler(this,function(c){switch(c.label){case 0:return b=
   this.resolveParameter(a),[4,this._sdDependenciesResolver.resolveDependenciesAsync()];case 1:return c.sent(),this._parameterRegisteredEvents.forEach(function(a){return a(b)}),[2]}})})});this._api.exports.addEventListener(this._api.exports.EVENTTYPE.REGISTERED,function(a){return __awaiter$$module$src$api$apps$sd_controls$managers$SDControlsParameterHandler(c,void 0,void 0,function(){var b;return __generator$$module$src$api$apps$sd_controls$managers$SDControlsParameterHandler(this,function(c){switch(c.label){case 0:return b=
   this.resolveExport(a),[4,this._sdDependenciesResolver.resolveDependenciesAsync()];case 1:return c.sent(),this._exportRegisteredEvents.forEach(function(a){return a(b)}),[2]}})})});this._api.parameters.addEventListener(this._api.parameters.EVENTTYPE.UPDATE,function(a){return __awaiter$$module$src$api$apps$sd_controls$managers$SDControlsParameterHandler(c,void 0,void 0,function(){return __generator$$module$src$api$apps$sd_controls$managers$SDControlsParameterHandler(this,function(b){switch(b.label){case 0:return[4,
   this._sdDependenciesResolver.resolveDependenciesAsync()];case 1:return b.sent(),this.handleUpdateEvent(a),[2]}})})});this._api.exports.addEventListener(this._api.exports.EVENTTYPE.UPDATE,function(a){return __awaiter$$module$src$api$apps$sd_controls$managers$SDControlsParameterHandler(c,void 0,void 0,function(){return __generator$$module$src$api$apps$sd_controls$managers$SDControlsParameterHandler(this,function(b){switch(b.label){case 0:return[4,this._sdDependenciesResolver.resolveDependenciesAsync()];
   case 1:return b.sent(),this.handleUpdateEvent(a),[2]}})})})}b.prototype.onExportRegistered=function(a){this._exportRegisteredEvents.push(a)};b.prototype.onExportUpdated=function(a){this._exportUpdateEvents.push(a)};b.prototype.onParameterRegistered=function(a){this._parameterRegisteredEvents.push(a)};b.prototype.onParameterUpdate=function(a){this._parametersUpdateEvents.push(a)};b.prototype.convertParameterType=function(a){var b=this._typesMap["parameter"+a.type+"."+a.visualization];b||(b=this._typesMap["parameter."+
   a.type]);b||(b=this._typesMap.parameter);return b};b.prototype.handleUpdateEvent=function(a){var b=this,d=!!a.parameter,e=d?a.parameter:a.export;e.id?d?this._parametersUpdateEvents.forEach(function(a){return a(e)}):this._exportUpdateEvents.forEach(function(a){return a(e)}):Object.keys(e).forEach(function(a){d?b._parametersUpdateEvents.forEach(function(b){return b(e[a])}):b._exportUpdateEvents.forEach(function(b){return b(e[a])})})};b.prototype.resolveExport=function(a){if(a.export){var b=Object.keys(a.export)[0];
   a=a.export[b];a.elementType="button";a.hidden=a.hidden?a.hidden:!1;a.order=a.order?a.order:Number.MAX_SAFE_INTEGER;a.isParameter=!1;return a}};b.prototype.resolveParameter=function(a){if(a.parameter){var b=Object.keys(a.parameter)[0];a=a.parameter[b];a.elementType=this.convertParameterType(a);a.hidden=a.hidden?a.hidden:!1;a.order=a.order?a.order:Number.MAX_SAFE_INTEGER;a.isParameter=!0;return a}};return b}();var module$src$shared$util$TinyColorUtil={default:{}},__importDefault$$module$src$shared$util$TinyColorUtil=this&&module$src$shared$util$TinyColorUtil.default.__importDefault||function(b){return b&&b.__esModule?b:{"default":b}};Object.defineProperty(module$src$shared$util$TinyColorUtil.default,"__esModule",{value:!0});
   var tinycolor2_1$$module$src$shared$util$TinyColorUtil=__importDefault$$module$src$shared$util$TinyColorUtil(module$node_modules$tinycolor2$tinycolor.default),three_1$$module$src$shared$util$TinyColorUtil=__importDefault$$module$src$shared$util$TinyColorUtil(module$src$externals$three.default);
   void 0===tinycolor2_1$$module$src$shared$util$TinyColorUtil.default.prototype.toThreeColor&&(tinycolor2_1$$module$src$shared$util$TinyColorUtil.default.prototype.toThreeColor=function(){return new three_1$$module$src$shared$util$TinyColorUtil.default.Color(this.toRgbString())},tinycolor2_1$$module$src$shared$util$TinyColorUtil.default.prototype.toArray=function(){return[this._r,this._g,this._b,255*this._a]});
   var TinyColorUtil$$module$src$shared$util$TinyColorUtil=function(){function b(){}b.prototype.toTinyColor=function(a,b){if(a.hasOwnProperty("getOriginalInput"))return a;var c=null;b&&(c=tinycolor2_1$$module$src$shared$util$TinyColorUtil.default(b));if("number"===typeof a)return a=a.toString(16),b=a.length,3>b?a=a.padStart(3,"0"):6>b?a=a.padStart(6,"0"):8>b&&(a=a.padEnd(8,"0")),a=tinycolor2_1$$module$src$shared$util$TinyColorUtil.default(a),a.isValid()?a:c;if(a.isColor&&"function"==typeof a.getHexString)return a=
   tinycolor2_1$$module$src$shared$util$TinyColorUtil.default(a.getHexString()),a.isValid()?a:c;if(Array.isArray(a)&&(3==a.length||4==a.length)){b=!0;for(var e=0;3>e;++e)a[e]=parseFloat(a[e]),isNaN(a[e])&&(b=!1);if(!b)return c;b=tinycolor2_1$$module$src$shared$util$TinyColorUtil.default({r:Math.max(0,Math.min(a[0],255)),g:Math.max(0,Math.min(a[1],255)),b:Math.max(0,Math.min(a[2],255))});4==a.length&&(a=parseFloat(a[3]),isNaN(a)||b.setAlpha(Math.max(0,Math.min(a,255))/255));return b.isValid()?b:c}if("string"!==
   typeof a)return a=tinycolor2_1$$module$src$shared$util$TinyColorUtil.default(a),a.isValid()?a:c;a=a.replace("0x","#");if(null!==a.match(/^#[a-f0-9]{6}$/i))return a=tinycolor2_1$$module$src$shared$util$TinyColorUtil.default(a+"ff"),a.isValid()?a:c;if(null!==a.match(/^#[a-f0-9]{8}$/i))return a=tinycolor2_1$$module$src$shared$util$TinyColorUtil.default(a),a.isValid()?a:c;if(null!==a.match(/^#[a-f0-9]{7}$/i))return a=tinycolor2_1$$module$src$shared$util$TinyColorUtil.default(a.slice(0,7)+"0"+a.slice(-1)),
   a.isValid()?a:c;a=tinycolor2_1$$module$src$shared$util$TinyColorUtil.default(a);return a.isValid()?a:c};return b}();module$src$shared$util$TinyColorUtil.default.TinyColorUtilInstance=new TinyColorUtil$$module$src$shared$util$TinyColorUtil;var module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util={default:{}};
   module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement=function(b,a){b=document.createElement(b);var c,d,e;for(c in a){var g=a[c];if("classList"===c)if(Array.isArray(g)){var h=0;for(e=g.length;h<e;h++)b.classList.add(g[h])}else b.classList.add(g);else if("parent"===c)g.appendChild(b);else if("attributes"===c)for(d in g)b.setAttribute(d,g[d]);else void 0!==g&&null!==g&&(b[c]=g)}return b};
   module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.setDomElementEventListener=function(b,a,c,d,e,g,h,f){var k,l=h||0,m,n;h=function(e){b||_destroy();c.valueConversion.update&&c.valueConversion.f?(m=d[c.valueConversion.update],n=c.valueConversion.f(c,d,e)):m="string"===typeof c.valueConversion?n=d[c.valueConversion]:n=c.valueConversion(c,d,e);g(m,e)&&(clearTimeout(k),k=setTimeout(function(){var d=!0;if("function"===typeof f){var g={val1:m,val2:n};d=f(g,e);m=
   g.val1;n=g.val2}d&&(!0===c.parameter?c.parametersQueue&&c.parametersQueue.use?c.parametersQueue.add(c,a,n):(b.parameters.updateAsync({id:a,value:n}),c.setStackToLast()):!0===c.export?b.exports.requestAsync({id:a}):"function"===typeof c.customUpdate?c.customUpdate(a,n,e,c):(b.updateSettingAsync(a,n),c.setStackToLast()))},l))};d.addEventListener(e,h);return h};module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.isMobileDevice=function(){return _isMobile$$module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util};
   module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.isMobileOrTabletDevice=function(){return _isMobileOrTable$$module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util};module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.isIPadOrIPhone=function(){return _isIPadOrIPhone$$module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util};
   module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.isEventSupported=function(b,a){var c={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};a=document.createElement(a||c||"div");b="on"+b;c=b in a;c||(a.setAttribute(b,"return;"),c="function"==typeof a[b]);return c};
   module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.domSupportsHtml5Color=function(){try{return colorInput=document.createElement("input"),colorInput.type="color",colorInput.value="!","color"===colorInput.type&&"!"!==colorInput.value}catch(b){return!1}};var _isMobile$$module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util=!1;
   (function(b){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(b)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(b.substr(0,
   4)))_isMobile$$module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util=!0})(navigator.userAgent||navigator.vendor||window.opera);var _isMobileOrTable$$module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util=!1;
   (function(b){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(b)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(b.substr(0,
   4)))_isMobileOrTable$$module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util=!0})(navigator.userAgent||navigator.vendor||window.opera);var _isIPadOrIPhone$$module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util=!1;_isIPadOrIPhone$$module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util=(/iPad|iPhone|iPod/.test(navigator.platform)||"MacIntel"===navigator.platform&&1<navigator.maxTouchPoints)&&!window.MSStream;var module$src$api$apps$sd_controls$commit_queues$SDCommitQueue={default:{}},__importDefault$$module$src$api$apps$sd_controls$commit_queues$SDCommitQueue=this&&module$src$api$apps$sd_controls$commit_queues$SDCommitQueue.default.__importDefault||function(b){return b&&b.__esModule?b:{"default":b}};Object.defineProperty(module$src$api$apps$sd_controls$commit_queues$SDCommitQueue.default,"__esModule",{value:!0});
   var sd_controls_components_dom_dom_util_js_1$$module$src$api$apps$sd_controls$commit_queues$SDCommitQueue=__importDefault$$module$src$api$apps$sd_controls$commit_queues$SDCommitQueue(module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default);
   module$src$api$apps$sd_controls$commit_queues$SDCommitQueue.default.SDCommitQueue=function(){function b(a,b,d){this._api=a;this._parentContainer=b;this._numOfElementsForCommit=0;this._queue={}}Object.defineProperty(b.prototype,"use",{get:function(){return this._use&&!this._executing},set:function(a){a?(this.container.removeAttribute("hidden"),this._use=!0):(this.container.setAttribute("hidden","true"),this._use=!1)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"api",{get:function(){return this._api},
   enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"queue",{get:function(){return this._queue},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0});b.prototype.add=function(a,b,d){this.queue[a.id]={element:a,value:b,event:d};a.isCurrentValueSameAsInital()?(this.removeCommitClass(a),!0===a.isChanged&&(this._numOfElementsForCommit--,a.isChanged=!1)):(this.addCommitClass(a),!1===a.isChanged&&
   (a.isChanged=!0,this._numOfElementsForCommit++));this.enableDisableCommitButtons()};b.prototype.clear=function(){for(var a in this._queue){var b=this._queue[a].element;b.setToInitalValueAndClearStack();b.isChanged=!1;this.removeCommitClass(b)}this._queue={};this._numOfElementsForCommit=0;this.enableDisableCommitButtons()};b.prototype.createElements=function(){var a=this;if(!(this._container&&this._commitBtn&&this._commitBtn)){this._container=sd_controls_components_dom_dom_util_js_1$$module$src$api$apps$sd_controls$commit_queues$SDCommitQueue.default.createDomElement("div",
   {parent:this._parentContainer,classList:["sd-commit-container","uk-margin-remove"],attributes:{"uk-grid":""}});var b="uk-button uk-button-default uk-button-small uk-width-1-2 sd-commit-button uk-padding-remove".split(" ");this._commitBtn=sd_controls_components_dom_dom_util_js_1$$module$src$api$apps$sd_controls$commit_queues$SDCommitQueue.default.createDomElement("button",{parent:this.container,innerHTML:"Apply",classList:b});this._cancelBtn=sd_controls_components_dom_dom_util_js_1$$module$src$api$apps$sd_controls$commit_queues$SDCommitQueue.default.createDomElement("button",
   {parent:this.container,innerHTML:"cancel",classList:b});this._commitBtn.onclick=function(){return a.execute()};this._cancelBtn.onclick=function(){return a.clear()};this.enableDisableCommitButtons()}};b.prototype.execute=function(){var a=this;this._executing=!0;Object.keys(this._queue).forEach(function(b){a._queue[b].element.queueCommitExecuted(a.queue[b].value,a.queue[b].event)});this._executing=!1;this.clear()};b.prototype.addCommitClass=function(a){a.row.classList.add("sd-commit")};b.prototype.enableDisableCommitButtons=
   function(){0<this._numOfElementsForCommit?(this._commitBtn.removeAttribute("disabled"),this._cancelBtn.removeAttribute("disabled")):(this._commitBtn.setAttribute("disabled","true"),this._cancelBtn.setAttribute("disabled","true"))};b.prototype.removeCommitClass=function(a){a.row.classList.remove("sd-commit")};return b}();var module$src$api$apps$sd_controls$commit_queues$SDParameterCommitQueue={default:{}},__extends$$module$src$api$apps$sd_controls$commit_queues$SDParameterCommitQueue=this&&module$src$api$apps$sd_controls$commit_queues$SDParameterCommitQueue.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return b(a,c)};return function(a,c){function d(){this.constructor=
   a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$commit_queues$SDParameterCommitQueue.default,"__esModule",{value:!0});var SDCommitQueue_1$$module$src$api$apps$sd_controls$commit_queues$SDParameterCommitQueue=module$src$api$apps$sd_controls$commit_queues$SDCommitQueue.default;
   module$src$api$apps$sd_controls$commit_queues$SDParameterCommitQueue.default.SDParametersCommitQueue=function(b){function a(a,d,e){var c=b.call(this,a,d,e)||this;a.addEventListener(a.EVENTTYPE.SETTINGS_UPDATE,function(a){"commitParameters"===a.settings.key&&(c.createElements(),c.use=a.settings.valueNew,c.clear())});return c}__extends$$module$src$api$apps$sd_controls$commit_queues$SDParameterCommitQueue(a,b);return a}(module$src$api$apps$sd_controls$commit_queues$SDCommitQueue.default.SDCommitQueue);/*
    MIT
   */
   var module$src$shared$util$Sortable={};
   module$src$shared$util$Sortable.default=function(){function b(a,b){if(!a||!a.nodeType||1!==a.nodeType)throw"Sortable: `el` must be HTMLElement, and not "+{}.toString.call(a);this.el=a;this.options=b=t({},b);a[D]=this;var c={group:Math.random(),sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,draggable:/[uo]l/i.test(a.nodeName)?"li":">*",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",ignore:"a, img",filter:null,animation:0,setData:function(a,b){a.setData("Text",
   b.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1},e;for(e in c)e in b||(b[e]=c[e]);W(b);for(var g in this)"_"===g.charAt(0)&&(this[g]=this[g].bind(this));this.nativeDraggable=b.forceFallback?!1:P;d(a,"mousedown",this._onTapStart);d(a,"touchstart",this._onTapStart);this.nativeDraggable&&(d(a,"dragover",this),d(a,"dragenter",this));O.push(this._onDragOver);b.store&&this.sort(b.store.get(this))}function a(a){y&&
   y.state!==a&&(h(y,"display",a?"none":""),!a&&y.state&&x.insertBefore(y,r),y.state=a)}function c(a,b,c){if(a){c=c||M;b=b.split(".");var d=b.shift().toUpperCase(),e=new RegExp("\\s("+b.join("|")+")(?=\\s)","g");do if(">*"===d&&a.parentNode===c||!(""!==d&&a.nodeName.toUpperCase()!=d||b.length&&((" "+a.className+" ").match(e)||[]).length!=b.length))return a;while(a!==c&&(a=a.parentNode))}return null}function d(a,b,c){a.addEventListener(b,c,!1)}function e(a,b,c){a.removeEventListener(b,c,!1)}function g(a,
   b,c){if(a)if(a.classList)a.classList[c?"add":"remove"](b);else{var d=(" "+a.className+" ").replace(S," ").replace(" "+b+" "," ");a.className=(d+(c?" "+b:"")).replace(S," ")}}function h(a,b,c){var d=a&&a.style;if(d){if(void 0===c)return M.defaultView&&M.defaultView.getComputedStyle?c=M.defaultView.getComputedStyle(a,""):a.currentStyle&&(c=a.currentStyle),void 0===b?c:c[b];b in d||(b="-webkit-"+b);d[b]=c+("string"===typeof c?"":"px")}}function f(a,b,c){if(a){a=a.getElementsByTagName(b);b=0;var d=a.length;
   if(c)for(;b<d;b++)c(a[b],b);return a}return[]}function k(a,b,c,d,e,g,f){var h=M.createEvent("Event"),l=(a||b[D]).options,m="on"+c.charAt(0).toUpperCase()+c.substr(1);h.initEvent(c,!0,!0);h.to=b;h.from=e||b;h.item=d||b;h.clone=y;h.oldIndex=g;h.newIndex=f;b.dispatchEvent(h);l[m]&&l[m].call(a,h)}function l(a,b,c,d,e,g){var f=a[D],h=f.options.onMove,l;var m=M.createEvent("Event");m.initEvent("move",!0,!0);m.to=b;m.from=a;m.dragged=c;m.draggedRect=d;m.related=e||b;m.relatedRect=g||b.getBoundingClientRect();
   a.dispatchEvent(m);h&&(l=h.call(f,m));return l}function m(a){a.draggable=!1}function n(){U=!1}function q(a){a=a.tagName+a.className+a.src+a.href+a.textContent;for(var b=a.length,c=0;b--;)c+=a.charCodeAt(b);return c.toString(36)}function p(a){var b=0;if(!a||!a.parentNode)return-1;for(;a&&(a=a.previousElementSibling);)"TEMPLATE"!==a.nodeName.toUpperCase()&&b++;return b}function u(a,b){var c,d;return function(){void 0===c&&(c=arguments,d=this,setTimeout(function(){1===c.length?a.call(d,c[0]):a.apply(d,
   c);c=void 0},b))}}function t(a,b){if(a&&b)for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}var r,v,w,y,x,A,z,B,J,F,E,G,H,C,I={},K,L,Q,S=/\s+/g,D="Sortable"+(new Date).getTime(),N=window,M=N.document,V=N.parseInt,P=!!("draggable"in M.createElement("div")),Y=function(a){a=M.createElement("x");a.style.cssText="pointer-events:auto";return"auto"===a.style.pointerEvents}(),U=!1,T=Math.abs,O=[],R=u(function(a,b,c){if(c&&b.scroll){var d=b.scrollSensitivity,e=b.scrollSpeed,g=a.clientX;a=a.clientY;
   var f=window.innerWidth,h=window.innerHeight;if(B!==c&&(z=b.scroll,B=c,!0===z)){z=c;do if(z.offsetWidth<z.scrollWidth||z.offsetHeight<z.scrollHeight)break;while(z=z.parentNode)}if(z){var l=z;b=z.getBoundingClientRect();var m=(T(b.right-g)<=d)-(T(b.left-g)<=d);var k=(T(b.bottom-a)<=d)-(T(b.top-a)<=d)}m||k||(m=(f-g<=d)-(g<=d),k=(h-a<=d)-(a<=d),(m||k)&&(l=N));if(I.vx!==m||I.vy!==k||I.el!==l)I.el=l,I.vx=m,I.vy=k,clearInterval(I.pid),l&&(I.pid=setInterval(function(){l===N?N.scrollTo(N.pageXOffset+m*e,
   N.pageYOffset+k*e):(k&&(l.scrollTop+=k*e),m&&(l.scrollLeft+=m*e))},24))}},30),W=function(a){var b=a.group;b&&"object"==typeof b||(b=a.group={name:b});["pull","put"].forEach(function(a){a in b||(b[a]=!0)});a.groups=" "+b.name+(b.put.join?" "+b.put.join(" "):"")+" "};b.prototype={constructor:b,_onTapStart:function(a){var b=this,d=this.el,e=this.options,g=a.touches&&a.touches[0],f=(g||a).target,h=f,l=e.filter;if(!("mousedown"===a.type&&0!==a.button||e.disabled)&&(f=c(f,e.draggable,d))){G=p(f);if("function"===
   typeof l){if(l.call(this,a,f,this)){k(b,h,"filter",f,d,G);a.preventDefault();return}}else if(l&&(l=l.split(",").some(function(a){if(a=c(h,a.trim(),d))return k(b,a,"filter",f,d,G),!0}))){a.preventDefault();return}e.handle&&!c(h,e.handle,d)||this._prepareDragStart(a,g,f)}},_prepareDragStart:function(a,b,c){var e=this,h=e.el,l=e.options,k=h.ownerDocument;c&&!r&&c.parentNode===h&&(K=a,x=h,r=c,v=r.parentNode,A=r.nextSibling,C=l.group,a=function(){e._disableDelayedDrag();r.draggable=!0;g(r,e.options.chosenClass,
   !0);e._triggerDragStart(b)},l.ignore.split(",").forEach(function(a){f(r,a.trim(),m)}),d(k,"mouseup",e._onDrop),d(k,"touchend",e._onDrop),d(k,"touchcancel",e._onDrop),l.delay?(d(k,"mouseup",e._disableDelayedDrag),d(k,"touchend",e._disableDelayedDrag),d(k,"touchcancel",e._disableDelayedDrag),d(k,"mousemove",e._disableDelayedDrag),d(k,"touchmove",e._disableDelayedDrag),e._dragStartTimer=setTimeout(a,l.delay)):a())},_disableDelayedDrag:function(){var a=this.el.ownerDocument;clearTimeout(this._dragStartTimer);
   e(a,"mouseup",this._disableDelayedDrag);e(a,"touchend",this._disableDelayedDrag);e(a,"touchcancel",this._disableDelayedDrag);e(a,"mousemove",this._disableDelayedDrag);e(a,"touchmove",this._disableDelayedDrag)},_triggerDragStart:function(a){a?(K={target:r,clientX:a.clientX,clientY:a.clientY},this._onDragStart(K,"touch")):this.nativeDraggable?(d(r,"dragend",this),d(x,"dragstart",this._onDragStart)):this._onDragStart(K,!0);try{M.selection?M.selection.empty():window.getSelection().removeAllRanges()}catch(Z){}},
   _dragStarted:function(){x&&r&&(g(r,this.options.ghostClass,!0),b.active=this,k(this,x,"start",r,x,G))},_emulateDragOver:function(){if(L&&(this._lastX!==L.clientX||this._lastY!==L.clientY)){this._lastX=L.clientX;this._lastY=L.clientY;Y||h(w,"display","none");var a=M.elementFromPoint(L.clientX,L.clientY),b=a,c=" "+this.options.group.name,d=O.length;if(b){do{if(b[D]&&-1<b[D].options.groups.indexOf(c)){for(;d--;)O[d]({clientX:L.clientX,clientY:L.clientY,target:a,rootEl:b});break}a=b}while(b=b.parentNode)
   }Y||h(w,"display","")}},_onTouchMove:function(a){if(K){b.active||this._dragStarted();this._appendGhost();var c=a.touches?a.touches[0]:a,d=c.clientX-K.clientX,e=c.clientY-K.clientY;d=a.touches?"translate3d("+d+"px,"+e+"px,0)":"translate("+d+"px,"+e+"px)";Q=!0;L=c;h(w,"webkitTransform",d);h(w,"mozTransform",d);h(w,"msTransform",d);h(w,"transform",d);a.preventDefault()}},_appendGhost:function(){if(!w){var a=r.getBoundingClientRect(),b=h(r),c=this.options;w=r.cloneNode(!0);g(w,c.ghostClass,!1);g(w,c.fallbackClass,
   !0);h(w,"top",a.top-V(b.marginTop,10));h(w,"left",a.left-V(b.marginLeft,10));h(w,"width",a.width);h(w,"height",a.height);h(w,"opacity","0.8");h(w,"position","fixed");h(w,"zIndex","100000");h(w,"pointerEvents","none");c.fallbackOnBody&&M.body.appendChild(w)||x.appendChild(w);b=w.getBoundingClientRect();h(w,"width",2*a.width-b.width);h(w,"height",2*a.height-b.height)}},_onDragStart:function(a,b){a=a.dataTransfer;var c=this.options;this._offUpEvents();"clone"==C.pull&&(y=r.cloneNode(!0),h(y,"display",
   "none"),x.insertBefore(y,r));b?("touch"===b?(d(M,"touchmove",this._onTouchMove),d(M,"touchend",this._onDrop),d(M,"touchcancel",this._onDrop)):(d(M,"mousemove",this._onTouchMove),d(M,"mouseup",this._onDrop)),this._loopId=setInterval(this._emulateDragOver,50)):(a&&(a.effectAllowed="move",c.setData&&c.setData.call(this,a,r)),d(M,"drop",this),setTimeout(this._dragStarted,0))},_onDragOver:function(b){var d=this.el,e;var g=this.options;var f=g.group;var m=f.put,k=C===f,u=g.sort;void 0!==b.preventDefault&&
   (b.preventDefault(),!g.dragoverBubble&&b.stopPropagation());Q=!0;if(C&&!g.disabled&&(k?u||(e=!x.contains(r)):C.pull&&m&&(C.name===f.name||m.indexOf&&~m.indexOf(C.name)))&&(void 0===b.rootEl||b.rootEl===this.el)&&(R(b,g,this.el),!U))if(f=c(b.target,g.draggable,d),g=r.getBoundingClientRect(),e)a(!0),y||A?x.insertBefore(r,y||A):u||x.appendChild(r);else if(!(e=0===d.children.length||d.children[0]===w)&&(e=d===b.target)&&(f=d.lastElementChild,e=f.getBoundingClientRect(),e=f=(5<b.clientY-(e.top+e.height)||
   5<b.clientX-(e.right+e.width))&&f),e){if(f){if(f.animated)return;q=f.getBoundingClientRect()}a(k);!1!==l(x,d,r,g,f,q)&&(r.contains(d)||(d.appendChild(r),v=d),this._animate(g,r),f&&this._animate(q,f))}else if(f&&!f.animated&&f!==r&&void 0!==f.parentNode[D]){J!==f&&(J=f,F=h(f),E=h(f.parentNode));var q=f.getBoundingClientRect(),t=q.right-q.left,p=q.bottom-q.top;u=/left|right|inline/.test(F.cssFloat+F.display)||"flex"==E.display&&0===E["flex-direction"].indexOf("row");e=f.offsetWidth>r.offsetWidth;m=
   f.offsetHeight>r.offsetHeight;t=.5<(u?(b.clientX-q.left)/t:(b.clientY-q.top)/p);b=f.nextElementSibling;p=l(x,d,r,g,f,q);!1!==p&&(U=!0,setTimeout(n,30),a(k),1===p||-1===p?k=1===p:u?(k=r.offsetTop,u=f.offsetTop,k=k===u?f.previousElementSibling===r&&!e||t&&e:u>k):k=b!==r&&!m||t&&m,r.contains(d)||(k&&!b?d.appendChild(r):f.parentNode.insertBefore(r,k?b:f)),v=r.parentNode,this._animate(g,r),this._animate(q,f))}},_animate:function(a,b){var c=this.options.animation;if(c){var d=b.getBoundingClientRect();h(b,
   "transition","none");h(b,"transform","translate3d("+(a.left-d.left)+"px,"+(a.top-d.top)+"px,0)");h(b,"transition","all "+c+"ms");h(b,"transform","translate3d(0,0,0)");clearTimeout(b.animated);b.animated=setTimeout(function(){h(b,"transition","");h(b,"transform","");b.animated=!1},c)}},_offUpEvents:function(){var a=this.el.ownerDocument;e(M,"touchmove",this._onTouchMove);e(a,"mouseup",this._onDrop);e(a,"touchend",this._onDrop);e(a,"touchcancel",this._onDrop)},_onDrop:function(a){var c=this.el,d=this.options;
   clearInterval(this._loopId);clearInterval(I.pid);clearTimeout(this._dragStartTimer);e(M,"mousemove",this._onTouchMove);this.nativeDraggable&&(e(M,"drop",this),e(c,"dragstart",this._onDragStart));this._offUpEvents();if(a){Q&&(a.preventDefault(),!d.dropBubble&&a.stopPropagation());w&&w.parentNode.removeChild(w);if(r&&(this.nativeDraggable&&e(r,"dragend",this),m(r),g(r,this.options.ghostClass,!1),g(r,this.options.chosenClass,!1),x!==v?(H=p(r),0<=H&&(k(null,v,"sort",r,x,G,H),k(this,x,"sort",r,x,G,H),
   k(null,v,"add",r,x,G,H),k(this,x,"remove",r,x,G,H))):(y&&y.parentNode.removeChild(y),r.nextSibling!==A&&(H=p(r),0<=H&&(k(this,x,"update",r,x,G,H),k(this,x,"sort",r,x,G,H)))),b.active)){if(null===H||-1===H)H=G;k(this,x,"end",r,x,G,H);this.save()}x=r=v=w=A=y=z=B=K=L=Q=H=J=F=C=b.active=null}},handleEvent:function(a){var b=a.type;"dragover"===b||"dragenter"===b?r&&(this._onDragOver(a),a.dataTransfer&&(a.dataTransfer.dropEffect="move"),a.preventDefault()):"drop"!==b&&"dragend"!==b||this._onDrop(a)},toArray:function(){for(var a=
   [],b,d=this.el.children,e=0,g=d.length,f=this.options;e<g;e++)b=d[e],c(b,f.draggable,this.el)&&a.push(b.getAttribute(f.dataIdAttr)||q(b));return a},sort:function(a){var b={},d=this.el;this.toArray().forEach(function(a,e){e=d.children[e];c(e,this.options.draggable,d)&&(b[a]=e)},this);a.forEach(function(a){b[a]&&(d.removeChild(b[a]),d.appendChild(b[a]))})},save:function(){var a=this.options.store;a&&a.set(this)},closest:function(a,b){return c(a,b||this.options.draggable,this.el)},option:function(a,
   b){var c=this.options;if(void 0===b)return c[a];c[a]=b;"group"===a&&W(c)},destroy:function(){var a=this.el;a[D]=null;e(a,"mousedown",this._onTapStart);e(a,"touchstart",this._onTapStart);this.nativeDraggable&&(e(a,"dragover",this),e(a,"dragenter",this));Array.prototype.forEach.call(a.querySelectorAll("[draggable]"),function(a){a.removeAttribute("draggable")});O.splice(O.indexOf(this._onDragOver),1);this._onDrop();this.el=a=null}};b.utils={on:d,off:e,css:h,find:f,is:function(a,b){return!!c(a,b,a)},
   extend:t,throttle:u,closest:c,toggleClass:g,index:p};b.create=function(a,c){return new b(a,c)};b.version="1.4.2";return b}();var module$src$api$apps$sd_controls$managers$SDControlsEditManager={default:{}},__importDefault$$module$src$api$apps$sd_controls$managers$SDControlsEditManager=this&&module$src$api$apps$sd_controls$managers$SDControlsEditManager.default.__importDefault||function(b){return b&&b.__esModule?b:{"default":b}};Object.defineProperty(module$src$api$apps$sd_controls$managers$SDControlsEditManager.default,"__esModule",{value:!0});
   var Sortable_1$$module$src$api$apps$sd_controls$managers$SDControlsEditManager=__importDefault$$module$src$api$apps$sd_controls$managers$SDControlsEditManager(module$src$shared$util$Sortable.default);
   module$src$api$apps$sd_controls$managers$SDControlsEditManager.default.SDControlsEditManager=function(){function b(a,b,d){void 0===d&&(d="sdv-control-panel-row-container");this._editMode=a;this._sortManager=b;this._containerClass=d;this._components=[]}b.prototype.registerComponent=function(a){var b=this;this._components.push(a);this._components=this._sortManager.sort(this._components,!1);this._editMode&&(a.setEditable(!0),this._sortableCreateTimeout&&window.clearTimeout(this._sortableCreateTimeout),
   this._sortableCreateTimeout=window.setTimeout(function(){Sortable_1$$module$src$api$apps$sd_controls$managers$SDControlsEditManager.default.create(document.getElementsByClassName(b._containerClass)[1],{handle:".jq-sdv-sort-bars",onEnd:function(a){var c=document.getElementById("sd-elements-container-parameters").children;a=function(a){var d=c[a];b._components.find(function(a){return d.id.includes(a.id)}).order=a};for(var d=0;d<c.length;d++)a(d)}})},1E3))};return b}();var module$src$api$apps$sd_controls$managers$SDControlsParametersLinker={default:{}};Object.defineProperty(module$src$api$apps$sd_controls$managers$SDControlsParametersLinker.default,"__esModule",{value:!0});
   module$src$api$apps$sd_controls$managers$SDControlsParametersLinker.default.SDControlsParameterLinker=function(){function b(a){this._api=a}b.prototype.createLinkIfDefined=function(a){var b=this;"group"===a.type&&a.parameters.forEach(function(a){return b.createLinkIfDefined(a)});if(a.link){var d=a.link,e=d.choiceMap;a.update="checklist"===a.type?function(c){c=c.map(function(b){b=a.choices.indexOf(b);return e&&e.length>b?e[b]:b});b._api.parameters.updateAsync({id:d.id,idOrName:d.idOrName,name:d.name,
   plugin:d.plugin,value:c})}:"dropdown"===a.type?function(c){c=a.choices.indexOf(c);c=e&&e.length>c?e[c]:c;b._api.parameters.updateAsync({id:d.id,idOrName:d.idOrName,name:d.name,plugin:d.plugin,value:c})}:function(a){return b._api.parameters.updateAsync({id:d.id,idOrName:d.idOrName,name:d.name,plugin:d.plugin,value:a})}}return a};return b}();var module$src$api$apps$sd_controls$settings$SDControlsSettings={default:{}};Object.defineProperty(module$src$api$apps$sd_controls$settings$SDControlsSettings.default,"__esModule",{value:!0});
   module$src$api$apps$sd_controls$settings$SDControlsSettings.default.SDControlsSettings=function(){function b(a,b){this._api=a;this._editMode=b;this._settings={};this._settingsDefinitions=this._api.getSettingDefinitions();this.createHeaders();this.createGeneralSettings();this.createLightSettings();this.createBackgroundSettings();this.createCameraSettings()}Object.defineProperty(b.prototype,"settings",{get:function(){return this._settings},enumerable:!0,configurable:!0});b.prototype.createLightSetting=
   function(a){var c=[],d;for(d in a.properties)switch(d){case "intensity":c.push({type:"light_slider",min:0,max:5,id:d,groupId:2,name:d,step:.01,lightDef:a,value:a.properties.intensity});break;case "angle":case "penumbra":c.push({type:"light_slider",min:0,max:Math.PI/2,id:d,groupId:2,name:d,step:.01,lightDef:a,value:"angle"==d?a.properties.angle:a.properties.penumbra});break;case "distance":c.push({type:"light_slider",id:d,groupId:2,name:d,lightDef:a,value:a.properties.distance});break;case "decay":c.push({type:"light_slider",
   min:0,max:2,id:d,groupId:2,name:d,step:.01,lightDef:a,value:a.properties.decay});break;case "color":c.push({id:d,name:d,groupId:2,lightDef:a,type:"light_color",value:a.properties.color});break;case "groundColor":c.push({id:d,name:"Ground Color",groupId:2,lightDef:a,type:"light_color",value:a.properties.groundColor});break;case "skyColor":c.push({id:d,name:"Sky Color",groupId:2,lightDef:a,type:"light_color",value:a.properties.skyColor});break;case "direction":case "position":case "target":c.push({type:"light_vector",
   id:d,groupId:2,name:d,step:.01,lightDef:a,value:a.properties[d]});break;case "castShadow":c.push({type:"light_checkbox",id:d,groupId:2,name:"Cast Shadow",lightDef:a,value:a.properties[d]})}return{id:a.id,order:b.lightOrderId++,groupId:2,type:"light_definition",name:a.id,lightDef:a,title:"Click to edit the properties of this light source.",parameters:c}};b.prototype.createBackgroundSettings=function(){this.settings["render.clearColor"]={value:this._api.getSetting("render.clearColor"),setting:"render.clearColor",
   id:"render.clearColor",type:"color",name:"Background Color",title:"Background color of the viewer if no environment is visible",groupId:3,order:1};this.settings["render.clearAlpha"]={id:"render.clearAlpha",setting:"render.clearAlpha",type:"slider",name:"Background Alpha",title:"Background transparency of the viewer if no environment is visible",order:2,groupId:3,min:0,max:1,step:.01};this.settings["material.environmentMapAsBackground"]={setting:"material.environmentMapAsBackground",id:"material.environmentMapAsBackground",
   type:"checkbox",name:"Show Environment",title:"Make the environment map visible",order:3,groupId:3};this.settings["material.environmentMap_1"]={groupId:3,order:4,id:"material.environmentMap",setting:"material.environmentMap",type:"dropdown",name:"Choose Environment",title:"Choose an environment map",choices:"none default default_bw blurred_lights georgentor georgentor_blur georgentor_blue_blur georgentor_bw_blur levelsets lythwood_field mountains ocean piazza_san_marco residential_garden room_abstract_1 sky storage_room storm subway_entrance subway_entrance_bw_blur white yokohama".split(" ")};
   this.settings["material.environmentMapResolution"]={groupId:3,order:5,id:"material.environmentMapResolution",setting:"material.environmentMapResolution",type:"dropdown",name:"Environment resolution",title:"Choose the pixel resolution of the environment map",choices:["256","512","1024","2048"]};this.settings["material.environmentMap_2"]={groupId:3,order:6,id:"material.environmentMap_2",setting:"material.environmentMap",type:"string",name:"Custom Environment",title:"Enter the url of a custom cube map",
   max:500}};b.prototype.createGeneralSettings=function(){this.settings["render.shadows"]={id:"render.shadows",setting:"render.shadows",type:"checkbox",name:"Shadows",value:this._api.getSetting("scene.render.shadows"),title:this._settingsDefinitions["scene.render.shadows"].description,order:1,groupId:1};this.settings["render.ambientOcclusion"]={setting:"render.ambientOcclusion",id:"render.ambientOcclusion",value:this._api.getSetting("render.ambientOcclusion"),type:"checkbox",name:"Ambient Occlusion",
   title:this._settingsDefinitions["scene.render.ambientOcclusion"].description,order:2,groupId:1};this.settings["defaultMaterial.bumpAmplitude"]={id:"defaultMaterial.bumpAmplitude",groupId:1,order:3,value:this._api.getSetting("defaultMaterial.bumpAmplitude"),setting:"defaultMaterial.bumpAmplitude",type:"slider",name:"Bump Amplitude",title:this._settingsDefinitions["defaultMaterial.bumpAmplitude"].description,step:.001,max:1+b.EPS};this.settings.groundPlaneVisibility={value:this._api.getSetting("groundPlaneVisibility"),
   setting:"groundPlaneVisibility",id:"groundPlaneVisibility",type:"checkbox",name:"Ground Plane",title:this._settingsDefinitions["scene.groundPlaneVisibility"].description,order:4,groupId:1};this.settings.gridVisibility={value:this._api.getSetting("groundPlaneVisgridVisibilityibility"),setting:"gridVisibility",id:"gridVisibility",type:"checkbox",name:"Grid",title:this._settingsDefinitions["scene.gridVisibility"].description,order:5,groupId:1};this.settings["render.pointSize"]={value:this._api.getSetting("render.pointSize"),
   id:"render.pointSize",order:6,groupId:1,setting:"render.pointSize",name:"Point Size",title:this._settingsDefinitions["scene.render.pointSize"].description,type:"slider",min:.001,max:100+b.EPS,step:.001};this.settings["defaultMaterial.color"]={value:this._api.getSetting("defaultMaterial.color"),id:"defaultMaterial.color",order:7,groupId:1,setting:"defaultMaterial.color",name:"Default Material Color",title:this._settingsDefinitions["defaultMaterial.color"].description,type:"color"};this.settings.commitParameters=
   {value:this._api.getSetting("commitParameters"),setting:"commitParameters",id:"commitParameters",type:"checkbox",name:"Parameter validation",title:this._settingsDefinitions.commitParameters.description,order:8,groupId:1}};b.prototype.createHeaders=function(){this._settings["documentation.general"]={content:'<div class="uk-text-center uk-padding-small uk-width-1-1 uk-background-muted"><span>General&nbsp;<a href="https://www.shapediver.com/support/viewer/settings/general" class="sdv-control-brand-color" target="_blank" uk-icon="icon:question"></a></span></div>',
   id:"documentation.general",type:"statichtml",groupId:1,order:0};this._settings["documentation.lights"]={content:'<div class="uk-text-center uk-padding-small uk-width-1-1 uk-background-muted"><span>Lighting&nbsp;<a href="https://www.shapediver.com/support/viewer/settings/lighting" class="sdv-control-brand-color" target="_blank" uk-icon="icon:question"></a></span></div>',id:"documentation.lights",type:"statichtml",groupId:2,order:0};this._settings["documentation.environment"]={content:'<div class="uk-text-center uk-padding-small uk-width-1-1 uk-background-muted"><span>Environment&nbsp;<a href="https://www.shapediver.com/support/viewer/settings/environment" class="sdv-control-brand-color" target="_blank" uk-icon="icon:question"></a></span></div>',
   id:"documentation.environment",type:"statichtml",groupId:3,order:0};this._settings["documentation.camera"]={content:'<div class="uk-text-center uk-padding-small uk-width-1-1 uk-background-muted"><span>Camera&nbsp;<a href="https://www.shapediver.com/support/viewer/settings/camera" class="sdv-control-brand-color" target="_blank" uk-icon="icon:question"></a></span></div>',id:"documentation.camera",type:"statichtml",groupId:4,order:0}};b.prototype.createLightSettings=function(){var a=this._api.scene.lights.getLightScene().data,
   b;for(b in a.lights){var d=a.lights[b];this.settings[d.id]=this.createLightSetting(d)}this.settings["add.lights.scene"]={type:"add_light_modal",id:"add.lights.scene",groupId:2,order:997};this._editMode&&(this.settings["save.lights.scene"]={type:"save_light_scene_modal",id:"save.lights.scene",groupId:2,order:998});this.settings["lights.lightScene"]={id:"lights.lightScene",type:"load_light_scene",groupId:2,order:999}};b.prototype.createCameraSettings=function(){this.settings["camera.cameraTypes.active"]=
   {groupId:4,setting:"camera.cameraTypes.active",order:1,id:"camera.cameraTypes.active",type:"camera",name:"Camera Type",title:"Choose an environment map",value:this._api.getSetting("camera.cameraTypes.active"),choices:"Perspective Top Bottom Right Left Back Front".split(" ")};this.settings["camera.zoomExtentsFactor"]={value:this._api.getSetting("camera.zoomExtentsFactor"),id:"camera.zoomExtentsFactor",order:11,groupId:4,setting:"camera.zoomExtentsFactor",name:"Zoom Factor",title:this._settingsDefinitions["scene.camera.zoomExtentsFactor"].description,
   type:"slider",min:.1,max:10+b.EPS,step:.01};this.settings["camera.autoAdjust"]={id:"camera.autoAdjust",setting:"camera.autoAdjust",type:"checkbox",name:"Camera adjust",title:this._settingsDefinitions["scene.camera.autoAdjust"].description,groupId:4,order:12};this.settings["camera.cameraMovementDuration"]={value:this._api.getSetting("camera.cameraMovementDuration"),id:"camera.cameraMovementDuration",order:13,groupId:4,setting:"camera.cameraMovementDuration",name:"Adjust duration [msec]",title:this._settingsDefinitions["scene.camera.cameraMovementDuration"].description,
   type:"slider",min:0,max:2500};this.settings["camera.revertAtMouseUp"]={id:"camera.revertAtMouseUp",setting:"camera.revertAtMouseUp",type:"checkbox",name:"Camera revert",title:this._settingsDefinitions["scene.camera.revertAtMouseUp"].description,groupId:4,order:14};this.settings["camera.revertAtMouseUpDuration"]={value:this._api.getSetting("camera.revertAtMouseUpDuration"),id:"camera.revertAtMouseUpDuration",order:15,groupId:4,setting:"camera.revertAtMouseUpDuration",name:"Revert duration [msec]",
   title:this._settingsDefinitions["scene.camera.revertAtMouseUpDuration"].description,type:"slider",min:0,max:2500}};b.lightOrderId=1;b.EPS=1E-6;return b}();var module$src$api$apps$sd_controls$managers$SDControlsResizeManager={default:{}},__extends$$module$src$api$apps$sd_controls$managers$SDControlsResizeManager=this&&module$src$api$apps$sd_controls$managers$SDControlsResizeManager.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return b(a,c)};return function(a,c){function d(){this.constructor=a}b(a,
   c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__values$$module$src$api$apps$sd_controls$managers$SDControlsResizeManager=this&&module$src$api$apps$sd_controls$managers$SDControlsResizeManager.default.__values||function(b){var a="function"===typeof Symbol&&Symbol.iterator,c=a&&b[a],d=0;if(c)return c.call(b);if(b&&"number"===typeof b.length)return{next:function(){b&&d>=b.length&&(b=void 0);return{value:b&&b[d++],done:!b}}};throw new TypeError(a?"Object is not iterable.":
   "Symbol.iterator is not defined.");};Object.defineProperty(module$src$api$apps$sd_controls$managers$SDControlsResizeManager.default,"__esModule",{value:!0});
   var ShapeDiverRowSizeDoesNotExists$$module$src$api$apps$sd_controls$managers$SDControlsResizeManager=function(b){function a(a){return b.call(this,"Row size "+a+' does not exist. Possible sizes are "1,2,4"')||this}__extends$$module$src$api$apps$sd_controls$managers$SDControlsResizeManager(a,b);return a}(Error),Rows$$module$src$api$apps$sd_controls$managers$SDControlsResizeManager=function(){function b(){this._elements=[];this._currentRow=[];this._spaceTaken=0}Object.defineProperty(b.prototype,"isFull",
   {get:function(){return this.rowSize>=b.MAX_SIZE},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"rowSize",{get:function(){var a,b=0;try{for(var d=__values$$module$src$api$apps$sd_controls$managers$SDControlsResizeManager(this._currentRow),e=d.next();!e.done;e=d.next())b+=e.value[1]}catch(h){var g={error:h}}finally{try{e&&!e.done&&(a=d.return)&&a.call(d)}finally{if(g)throw g.error;}}return b},enumerable:!0,configurable:!0});b.prototype.addElement=function(a,c){this._spaceTaken+c>
   b.MAX_SIZE&&(this.resolveRow(),this._currentRow=[],this._spaceTaken=0);this._spaceTaken+=c;this._currentRow.push([a,c])};b.prototype.finalize=function(){if(this.isFull){var a=this._currentRow.pop();this.resolveRow();this._currentRow=[a]}this.resolveRow();return this._elements};b.prototype.resolveRow=function(){var a=this;if(!this.isFull){for(var b=0;b<this._currentRow.length;b++){var d=this._currentRow[b];if(1==d[1]&&(d[1]=2,this.isFull))break}if(!this.isFull)for(b=0;b<this._currentRow.length&&(d=
   this._currentRow[b],2!=d[1]||(d[1]=4,!this.isFull));b++);}this._currentRow.forEach(function(b){return a._elements.push(b)});this._currentRow=[]};b.MAX_SIZE=4;return b}();
   module$src$api$apps$sd_controls$managers$SDControlsResizeManager.default.SDControlsResizeManager=function(){function b(a){var b;this._isMobileDevice=a;this._possibleClasses={landscape:["sd-landscape-max-width","uk-width-1-1"],fullWidth:["uk-width-1-1","sd-max-width-4"],quarter:["uk-width-1-4","sd-max-width-1"],half:["uk-width-1-2","sd-max-width-2"],all:"uk-width-1-1 uk-width-1-2 uk-width-1-4 uk-width-expand sd-max-width-1 sd-max-width-2 sd-max-width-4 sd-landscape-max-width".split(" ")};this._spacesRequiredMap=
   (b={},b[1]=1,b[2]=2,b[4]=4,b);this._clientWidth=1920;this._isClientSizeSmall=!1;this._mode="landscape"}b.prototype.resize=function(a,b,d,e){var c=this;void 0===e&&(e=100);b&&(this._mode=b);d&&(this._clientWidth=d);this._resizeTimeout=window.setTimeout(function(){c._resizeTimeout&&1<a.length&&window.clearTimeout(c._resizeTimeout);var b="landscape"===c._mode;c.adjustSpaceRequiredAccordingToClientWidth(c._clientWidth);c.resizeHandle(a,b)},e)};b.prototype.addClassesToElem=function(a,b){this._possibleClasses.all.forEach(function(b){a.row.classList.contains(b)&&
   a.row.classList.remove(b)});b.forEach(function(b){return a.row.classList.add(b)})};b.prototype.adjustSpaceRequiredAccordingToClientWidth=function(a){this._isClientSizeSmall=a<b.CLIENT_WIDTH_ADJUST_SIZE;this._spacesRequiredMap[2]=this._isClientSizeSmall?4:2;this._spacesRequiredMap[1]=this._isClientSizeSmall?2:1};b.prototype.handleFullWidth=function(a){var b;try{for(var d=__values$$module$src$api$apps$sd_controls$managers$SDControlsResizeManager(a),e=d.next();!e.done;e=d.next())this.addClassesToElem(e.value,
   this._possibleClasses.landscape)}catch(h){var g={error:h}}finally{try{e&&!e.done&&(b=d.return)&&b.call(d)}finally{if(g)throw g.error;}}};b.prototype.handleResizable=function(a){var b,d,e,g=function(a){h._possibleClasses.all.forEach(function(b){return a.row.classList.remove(b)})},h=this;try{for(var f=__values$$module$src$api$apps$sd_controls$managers$SDControlsResizeManager(a),k=f.next();!k.done;k=f.next()){var l=k.value;g(l)}}catch(w){var m={error:w}}finally{try{k&&!k.done&&(b=f.return)&&b.call(f)}finally{if(m)throw m.error;
   }}m=new Rows$$module$src$api$apps$sd_controls$managers$SDControlsResizeManager;try{for(var n=__values$$module$src$api$apps$sd_controls$managers$SDControlsResizeManager(a),q=n.next();!q.done;q=n.next())l=q.value,m.addElement(l,this._spacesRequiredMap[l.size])}catch(w){var p={error:w}}finally{try{q&&!q.done&&(d=n.return)&&d.call(n)}finally{if(p)throw p.error;}}a=m.finalize();try{for(var u=__values$$module$src$api$apps$sd_controls$managers$SDControlsResizeManager(a),t=u.next();!t.done;t=u.next()){var r=
   t.value;switch(r[1]){case 1:this.addClassesToElem(r[0],this._possibleClasses.quarter);break;case 2:this.addClassesToElem(r[0],this._possibleClasses.half);break;case 4:this.addClassesToElem(r[0],this._possibleClasses.fullWidth);break;default:throw new ShapeDiverRowSizeDoesNotExists$$module$src$api$apps$sd_controls$managers$SDControlsResizeManager(r[1]);}}}catch(w){var v={error:w}}finally{try{t&&!t.done&&(e=u.return)&&e.call(u)}finally{if(v)throw v.error;}}};b.prototype.resizeHandle=function(a,b){var c;
   b?this.handleFullWidth(a):this.handleResizable(a);try{for(var e=__values$$module$src$api$apps$sd_controls$managers$SDControlsResizeManager(a),g=e.next();!g.done;g=e.next())this.resizeHandle(g.value.children,b)}catch(f){var h={error:f}}finally{try{g&&!g.done&&(c=e.return)&&c.call(e)}finally{if(h)throw h.error;}}};b.CLIENT_WIDTH_ADJUST_SIZE=640;return b}();var module$src$api$apps$sd_controls$custom_components$BaseCustomComponent={default:{}};Object.defineProperty(module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default,"__esModule",{value:!0});
   module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default.BaseCustomComponent=function(){function b(a,b,d,e,g,h,f){void 0===f&&(f=!1);this._type=a;this._id=b;this._parameterDefinition=d;this._parent=e;this._domManager=g;this._queue=h;this._editMode=f;this._children=[];this._destroyEvents=[];this._labelClasses="uk-width-expand uk-form-label uk-text-small uk-margin-small-bottom uk-padding-remove uk-text-uppercase uk-text-truncate".split(" ");this._limit=50;this._valueStack=[];this._inputContainerClasses=
   ["uk-width-1-1","uk-padding-remove"];this._isChanged=!1;this._rowId=this._id+"-controlmenu-row";this._labelId=this._id+"-label";this._inputContainerId=this._id+"-input-container";this._initalValue=this.parameterDefinition.value}Object.defineProperty(b.prototype,"children",{get:function(){return this._children},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"inputComponent",{get:function(){return this._inputComponent},
   enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"inputContainer",{get:function(){return this._inputContainer},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"isChanged",{get:function(){return this._isChanged},set:function(a){this._isChanged=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"order",{get:function(){var a;return a=this._parameterDefinition.order,
   null!==a&&void 0!==a?a:0},set:function(a){this._parameterDefinition.order=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"parameterDefinition",{get:function(){return this._parameterDefinition},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"row",{get:function(){return this._row},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"value",
   {get:function(){return this._inputComponent.value},set:function(a){this._inputComponent.value=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"valueStack",{get:function(){return this._valueStack},enumerable:!0,configurable:!0});b.prototype.destroy=function(){var a=this;this._row.remove();this._destroyEvents.forEach(function(b){return b(a.id)})};b.prototype.insertBefore=function(a){var b;null===(b=this.row.parentNode)||void 0===b?void 0:b.insertBefore(this.row,a.row)};b.prototype.isCurrentValueSameAsInital=
   function(){return this.value===this._initalValue};b.prototype.onDestroy=function(a){this._destroyEvents.push(a)};b.prototype.queueCommitExecuted=function(a,b){this.update(a,b);this.value=a;Array.isArray(this.value)?this._initalValue=this.value.map(function(a){return a}):this._initalValue=this.value;this._valueStack=[]};b.prototype.setToInitalValueAndClearStack=function(){this.value=this._initalValue;this._valueStack=[]};b.prototype.createElement=function(){this.createRow();this.createLabel();this.createInputContainer();
   this.createInput()};b.prototype.createInputContainer=function(){this._inputContainer=this._domManager.createDomElement("div",this._inputContainerId,this._row,this._inputContainerClasses)};b.prototype.createLabel=function(){var a=this;this._label=this._domManager.createDomElement("label",this._labelId,this._row,this._labelClasses,{title:this._parameterDefinition.title||this._parameterDefinition.name});this._label.innerHTML=this._parameterDefinition.name;this._editMode&&this._label.classList.add("sdv-edit-mode");
   var b=function(){var b=a._label.innerText;b.length>a._limit&&(a._label.innerText=b.substr(0,a._limit))};this._label.onkeyup=b;this._label.onkeydown=b};b.prototype.createRow=function(){this._row=this._domManager.createDomElement("div",this._rowId,this._parent,["sd-max-width-1","uk-padding-small","uk-margin-remove","sdv-control-panel-row-border"],{"uk-grid":'margin: "";'})};b.prototype.update=function(a,b){var c,e;(null===(c=this._queue)||void 0===c?0:c.use)?this._queue.add(this,a,b):"function"===typeof(null===
   (e=this._parameterDefinition)||void 0===e?void 0:e.update)&&this._parameterDefinition.update(a)};return b}();var module$src$api$apps$sd_controls$custom_components$StringInputCustomComponent={default:{}},__extends$$module$src$api$apps$sd_controls$custom_components$StringInputCustomComponent=this&&module$src$api$apps$sd_controls$custom_components$StringInputCustomComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return b(a,c)};return function(a,c){function d(){this.constructor=
   a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$custom_components$StringInputCustomComponent.default,"__esModule",{value:!0});var BaseCustomComponent_1$$module$src$api$apps$sd_controls$custom_components$StringInputCustomComponent=module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default;
   module$src$api$apps$sd_controls$custom_components$StringInputCustomComponent.default.StringInputCustomComponent=function(b){function a(a,d,e,g,h,f){void 0===f&&(f=!1);e=b.call(this,"string",a,d,e,g,h,f)||this;e._inputAttributes={type:"text"};e._inputClassList=["uk-input","uk-form-small"];e._delay=500;e._inputId=a+"-text";"number"===typeof d.delay&&(e._delay=Math.max(d.delay,e._delay));e.createElement();e.createInputEvents();return e}__extends$$module$src$api$apps$sd_controls$custom_components$StringInputCustomComponent(a,
   b);Object.defineProperty(a.prototype,"size",{get:function(){return 1},enumerable:!0,configurable:!0});a.prototype.createInput=function(){this._inputAttributes.name=this._inputId+"-text";this._inputComponent=this._domManager.createDomElement("input",this._inputId,this._inputContainer,this._inputClassList,this._inputAttributes);this._parameterDefinition.max&&(this._inputComponent.maxLength=this._parameterDefinition.max);this._parameterDefinition.value&&(this._inputComponent.value=this._parameterDefinition.value)};
   a.prototype.createInputEvents=function(){this._domManager.setDomEventListener(this._inputComponent,"input",this._delay,this.update.bind(this))};return a}(module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default.BaseCustomComponent);var module$src$api$apps$sd_controls$custom_components$BooleanInputCustomComponent={default:{}},__extends$$module$src$api$apps$sd_controls$custom_components$BooleanInputCustomComponent=this&&module$src$api$apps$sd_controls$custom_components$BooleanInputCustomComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return b(a,c)};return function(a,
   c){function d(){this.constructor=a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$custom_components$BooleanInputCustomComponent.default,"__esModule",{value:!0});var BaseCustomComponent_1$$module$src$api$apps$sd_controls$custom_components$BooleanInputCustomComponent=module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default;
   module$src$api$apps$sd_controls$custom_components$BooleanInputCustomComponent.default.BooleanInputCustomComponent=function(b){function a(a,d,e,g,h,f){void 0===f&&(f=!1);d=b.call(this,"checkbox",a,d,e,g,h,f)||this;d._inputId=a+"-checkbox";d._forName=d.id+"-checkbox";d.createElement();d.createInputEvents();return d}__extends$$module$src$api$apps$sd_controls$custom_components$BooleanInputCustomComponent(a,b);Object.defineProperty(a.prototype,"boolContainer",{get:function(){return this._boolContainer},
   enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"inputCheckboxContainer",{get:function(){return this._inputCheckboxContainer},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){return 1},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"value",{get:function(){return this._inputComponent.checked},set:function(a){this._inputComponent.value=a;this._inputComponent.checked="true"===this._inputComponent.value},enumerable:!0,configurable:!0});
   a.prototype.isCurrentValueSameAsInital=function(){return this.value.toString()===this._initalValue.toString()};a.prototype.createInput=function(){this._boolContainer=this._domManager.createDomElement("label",this.id+"-checkbox-label",this._inputContainer,["sdv-control-panel-boolean-input-checkbox-label"],{for:this._forName,"data-friendly-name":this._parameterDefinition.name});this._inputComponent=this._domManager.createDomElement("input",this._inputId,this._boolContainer,["shapediver-viewer-element",
   "sdv-control-panel-control","sdv-control-panel-boolean-input-checkbox"],{type:"checkbox",name:this._forName});this._inputCheckboxContainer=this._domManager.createDomElement("div",this.id+"-checkbox-helper",this._boolContainer,["sdv-control-panel-boolean-input-boxhelper"],{for:this._forName});this._parameterDefinition.value&&(this._inputComponent.value=this._parameterDefinition.value,this._inputComponent.checked="true"===this._inputComponent.value)};a.prototype.createInputEvents=function(){this._domManager.setDomEventListener(this._inputComponent,
   "change",10,this.update.bind(this))};a.prototype.update=function(a,d){b.prototype.update.call(this,d.srcElement.checked,d)};return a}(module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default.BaseCustomComponent);var module$src$api$apps$sd_controls$custom_components$Vector3CustomComponent={default:{}},__extends$$module$src$api$apps$sd_controls$custom_components$Vector3CustomComponent=this&&module$src$api$apps$sd_controls$custom_components$Vector3CustomComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return b(a,c)};return function(a,c){function d(){this.constructor=
   a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$custom_components$Vector3CustomComponent.default,"__esModule",{value:!0});var BaseCustomComponent_1$$module$src$api$apps$sd_controls$custom_components$Vector3CustomComponent=module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default;
   module$src$api$apps$sd_controls$custom_components$Vector3CustomComponent.default.Vector3CustomComponent=function(b){function a(a,d,e,g,h,f){void 0===f&&(f=!1);a=b.call(this,"vector3",a,d,e,g,h,f)||this;a._step=1;a._delay=500;a._inputContainerClasses=["uk-width-1-1","uk-padding-remove","uk-margin-remove"];a._parameterDefinition.step&&(a._step=a._parameterDefinition.step);a._value={x:0,y:0,z:0};a._parameterDefinition.value&&(d=a._parameterDefinition.value,a._value={x:d.x||0,y:d.y||0,z:d.z||0});"number"===
   typeof a.parameterDefinition.delay&&(a._delay=Math.max(a._delay,a.parameterDefinition.delay));a.createElement();a.createInputEvents();return a}__extends$$module$src$api$apps$sd_controls$custom_components$Vector3CustomComponent(a,b);Object.defineProperty(a.prototype,"inputComponent",{get:function(){return this._inputContainer},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){return 1},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"xInput",
   {get:function(){return this._xInput},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"yInput",{get:function(){return this._yInput},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"zInput",{get:function(){return this._zInput},enumerable:!0,configurable:!0});a.prototype.createInput=function(){this._inputContainer.setAttribute("uk-grid","");this._xContainer=this.createContainerElement("x");this._yContainer=this.createContainerElement("y");this._zContainer=this.createContainerElement("z");
   this._xLabel=this.createLabelElement("x",this._xContainer);this._yLabel=this.createLabelElement("y",this._yContainer);this._zLabel=this.createLabelElement("z",this._zContainer);this._xInput=this.createInputElement("x",this._xContainer);this._yInput=this.createInputElement("y",this._yContainer);this._zInput=this.createInputElement("z",this._zContainer)};a.prototype.createInputEvents=function(){this._domManager.setDomEventListener(this._xInput,"input",this._delay,this.update.bind(this));this._domManager.setDomEventListener(this._yInput,
   "input",this._delay,this.update.bind(this));this._domManager.setDomEventListener(this._zInput,"input",this._delay,this.update.bind(this));this._domManager.setDomEventListener(this._xInput,"focusout",10,this.update.bind(this));this._domManager.setDomEventListener(this._yInput,"focusout",10,this.update.bind(this));this._domManager.setDomEventListener(this._zInput,"focusout",10,this.update.bind(this));this._domManager.setDomEventListener(this._xInput,"keyup",10,this.updateKeyUp.bind(this));this._domManager.setDomEventListener(this._yInput,
   "keyup",10,this.updateKeyUp.bind(this));this._domManager.setDomEventListener(this._zInput,"keyup",10,this.updateKeyUp.bind(this))};a.prototype.update=function(a,d){var c=d.srcElement.getAttribute("data-component");this._value[c]=Number(Number(a).toFixed(this._step));b.prototype.update.call(this,this._value,d)};a.prototype.createContainerElement=function(a){return this._domManager.createDomElement("div",this.id+"-vector-"+a+"-container",this._inputContainer,["uk-width-3-3","uk-padding-remove-left",
   "vector3-container","uk-form-custom"])};a.prototype.createInputElement=function(a,b){var c={type:"number",name:this.id+"-number-"+a,"data-component":a};this._parameterDefinition.step&&(c.step=this._parameterDefinition.step);this._parameterDefinition.min&&(c.min=this._parameterDefinition.min);this._parameterDefinition.max&&(c.max=this._parameterDefinition.max);b=this._domManager.createDomElement("input",this.id+"-number-"+a,b,["uk-input","uk-form-small","sd-input-number","uk-width-2-3"],c);b.value=
   this._value[a];return b};a.prototype.createLabelElement=function(a,b){b=this._domManager.createDomElement("label",this.id+"-vector-"+a+"-label",b,["vector3-label"],{for:this.id+"-number-"+a});b.innerHTML=a.toUpperCase();return b};a.prototype.updateKeyUp=function(a,b){!b.which&&!b.keyCode||13!=b.which&&13!=b.keyCode||this.update(a,b)};return a}(module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default.BaseCustomComponent);var module$src$api$apps$sd_controls$custom_components$ButtonCustomComponent={default:{}},__extends$$module$src$api$apps$sd_controls$custom_components$ButtonCustomComponent=this&&module$src$api$apps$sd_controls$custom_components$ButtonCustomComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return b(a,c)};return function(a,c){function d(){this.constructor=
   a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$custom_components$ButtonCustomComponent.default,"__esModule",{value:!0});var BaseCustomComponent_1$$module$src$api$apps$sd_controls$custom_components$ButtonCustomComponent=module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default;
   module$src$api$apps$sd_controls$custom_components$ButtonCustomComponent.default.ButtonCustomComponent=function(b){function a(a,d,e,g,h,f){void 0===f&&(f=!1);d=b.call(this,"button",a,d,e,g,h,f)||this;d._inputId=a+"-text";d.createElement();d.createInputEvents();return d}__extends$$module$src$api$apps$sd_controls$custom_components$ButtonCustomComponent(a,b);Object.defineProperty(a.prototype,"size",{get:function(){return 1},enumerable:!0,configurable:!0});a.prototype.createInput=function(){this._row.removeChild(this._label);
   var a=this.id+"-button";this._inputComponent=this._domManager.createDomElement("button",a,this._inputContainer,"uk-button uk-button-default uk-button-small uk-width-expand text-transform-none uk-padding-remove sd-control-button".split(" "),{type:"button",name:a});this._inputComponent.innerHTML="<span>"+this._parameterDefinition.name+"</span>"};a.prototype.createInputEvents=function(){this._domManager.setDomEventListener(this._inputComponent,"click",10,this.update.bind(this))};a.prototype.update=function(a,
   d){b.prototype.update.call(this,!0,d)};return a}(module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default.BaseCustomComponent);var module$src$api$apps$sd_controls$custom_components$ChecklistCustomComponent={default:{}},__extends$$module$src$api$apps$sd_controls$custom_components$ChecklistCustomComponent=this&&module$src$api$apps$sd_controls$custom_components$ChecklistCustomComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return b(a,c)};return function(a,c){function d(){this.constructor=
   a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$custom_components$ChecklistCustomComponent.default,"__esModule",{value:!0});var BaseCustomComponent_1$$module$src$api$apps$sd_controls$custom_components$ChecklistCustomComponent=module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default;
   module$src$api$apps$sd_controls$custom_components$ChecklistCustomComponent.default.ChecklistCustomComponent=function(b){function a(a,d,e,g,h,f){void 0===f&&(f=!1);a=b.call(this,"checklist",a,d,e,g,h,f)||this;a._choices=[];a._inputComponents=[];a._currentValues=[];a._choices=a._parameterDefinition.choices;a._initalValue=a._parameterDefinition.value?a._parameterDefinition.value.map(function(a){return a}):[];a.createElement();a.createInputEvents();return a}__extends$$module$src$api$apps$sd_controls$custom_components$ChecklistCustomComponent(a,
   b);Object.defineProperty(a.prototype,"inputComponent",{get:function(){return this._form},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){return 2},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"value",{get:function(){return this._inputComponents.filter(function(a){return a.checked}).map(function(a){return a.value})},set:function(a){var b=this;this._currentValues=a.map(function(a){return a});this._inputComponents.forEach(function(a){return a.checked=
   b._currentValues.some(function(b){return b==a.value})})},enumerable:!0,configurable:!0});a.prototype.isCurrentValueSameAsInital=function(){var a=this.value;if(a.length!==this._initalValue.length)return!1;for(var b=0;b<a.length;b++)if(!this._initalValue.includes(a[b]))return!1;return!0};a.prototype.createInput=function(){this._form=this._domManager.createDomElement("form",this.id+"-form",this._inputContainer,["sdv-control-panel-control","sdv-control-panel-dropdown-input-form"]);for(var a=0;a<this._choices.length;a++){var b=
   this._choices[a],e=this._domManager.createDomElement("div",null,this._form);e=this._domManager.createDomElement("label",this.id+"-label-"+a,e,["sdv-control-panel-checklist-input-checkbox-label"]);e.innerHTML=b;var g=this.id+"-checkbox-"+a,h=this._domManager.createDomElement("input",g,e,[],{type:"checkbox",name:g});h.innerHTML=b;h.value=b;h.checked=this._initalValue.includes(b);h.checked&&this._currentValues.push(b);this._domManager.createDomElement("div",this.id+"-checkbox-helper",e,["sdv-control-panel-checklist-input-boxhelper"],
   {for:g});this._inputComponents.push(h)}};a.prototype.createInputEvents=function(){for(var a=0;a<this._inputComponents.length;a++)this._domManager.setDomEventListener(this._inputComponents[a],"change",10,this.update.bind(this))};a.prototype.update=function(a,d){this._currentValues.includes(a)?this._currentValues.splice(this._currentValues.indexOf(a),1):Array.isArray(a)||this._currentValues.push(a);b.prototype.update.call(this,this._currentValues,d)};return a}(module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default.BaseCustomComponent);var module$src$api$apps$sd_controls$custom_components$ColorCustomComponent={default:{}},__extends$$module$src$api$apps$sd_controls$custom_components$ColorCustomComponent=this&&module$src$api$apps$sd_controls$custom_components$ColorCustomComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return b(a,c)};return function(a,c){function d(){this.constructor=
   a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$custom_components$ColorCustomComponent.default,"__esModule",{value:!0});var BaseCustomComponent_1$$module$src$api$apps$sd_controls$custom_components$ColorCustomComponent=module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default;
   module$src$api$apps$sd_controls$custom_components$ColorCustomComponent.default.ColorCustomComponent=function(b){function a(a,d,e,g,h,f,k,l){void 0===l&&(l=!1);d=b.call(this,"color",a,d,e,g,h,l)||this;d._useSpectrum=f;d._tinyColorUtil=k;d._inputId=a+"-color";d._initalValue=k.toTinyColor(d._parameterDefinition.value);d.createElement();d.createInputEvents();return d}__extends$$module$src$api$apps$sd_controls$custom_components$ColorCustomComponent(a,b);Object.defineProperty(a.prototype,"colorPicker",
   {get:function(){return this._colorPicker},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){return 1},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"value",{get:function(){return this._inputComponent.value},set:function(a){var b=a;"object"!==typeof a&&(b=this._tinyColorUtil.toTinyColor(a));this._inputComponent.value=this._useSpectrum?b.toRgbString():b.toHexString();this._useSpectrum&&this._previousValue!==this._inputComponent.value&&(this._previousValue=
   this._inputComponent.value,a=document.createEvent("Event"),a.initEvent("change",!1,!0),this._inputComponent.dispatchEvent(a),$("#"+this._inputId).spectrum("set",this.value))},enumerable:!0,configurable:!0});a.prototype.setToInitalValueAndClearStack=function(){b.prototype.setToInitalValueAndClearStack.call(this);this._useSpectrum&&$("#"+this._inputId).spectrum("set",this.value)};a.prototype.createInput=function(){this._useSpectrum?this.createSpectrumControls():this.createNonSpectrumControls()};a.prototype.createInputEvents=
   function(){this._domManager.setDomEventListener(this._inputComponent,"change",10,this.update.bind(this))};a.prototype.isCurrentValueSameAsInital=function(){return this._useSpectrum?this._tinyColorUtil.toTinyColor(this.value).toRgbString()===this._tinyColorUtil.toTinyColor(this._initalValue).toRgbString():this.value===this._initalValue};a.prototype.createNonSpectrumControls=function(){this._inputComponent=this._domManager.createDomElement("input",this._inputId,this._inputContainer,["uk-input","uk-form-small",
   "uk-form-width-xsmall"],{name:this._inputId});this._inputComponent.setAttribute("type","color");this._inputComponent.value=this._initalValue.toHexString();this._colorPicker=this._inputComponent};a.prototype.createSpectrumControls=function(){var a=this;this._inputComponent=this._domManager.createDomElement("input",this._inputId,this._inputContainer,["uk-hidden"],{type:"text"});$("#"+this._inputId).spectrum({color:this._initalValue.toRgbString(),replacerClassName:"uk-padding-remove",showInput:!0,showInitial:!0,
   preferredFormat:"rgb",change:function(b){return a.value=b}});this._colorPicker=this.row.getElementsByClassName("sp-replacer")[0]};return a}(module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default.BaseCustomComponent);var module$src$api$apps$sd_controls$custom_components$DropdownCustomComponent={default:{}},__extends$$module$src$api$apps$sd_controls$custom_components$DropdownCustomComponent=this&&module$src$api$apps$sd_controls$custom_components$DropdownCustomComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return b(a,c)};return function(a,c){function d(){this.constructor=
   a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$custom_components$DropdownCustomComponent.default,"__esModule",{value:!0});var BaseCustomComponent_1$$module$src$api$apps$sd_controls$custom_components$DropdownCustomComponent=module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default;
   module$src$api$apps$sd_controls$custom_components$DropdownCustomComponent.default.DropdownCustomComponent=function(b){function a(a,d,e,g,h,f){void 0===f&&(f=!1);d=b.call(this,"dropdown",a,d,e,g,h,f)||this;d._choicesElements={};d._inputId=a+"-form";d._choices=d._parameterDefinition.choices;d.createElement();d.createInputEvents();return d}__extends$$module$src$api$apps$sd_controls$custom_components$DropdownCustomComponent(a,b);Object.defineProperty(a.prototype,"size",{get:function(){return 2},enumerable:!0,
   configurable:!0});a.prototype.updateOptions=function(a,b){this._choices=a;this.parameterDefinition.choices=a;this.inputComponent.innerHTML="";this.createOptions();this.inputComponent.value=b};a.prototype.createOptions=function(){for(var a in this._choices){var b=this.id+"-option-"+a;b=this._domManager.createDomElement("option",b,this._inputComponent,[],{name:b});b.innerHTML=this._choices[a];b.selected=this._choices[a]==this._parameterDefinition.value;this._choicesElements["cOption"+a]=b}};a.prototype.createInput=
   function(){this._inputComponent=this._domManager.createDomElement("select",this._inputId,this._inputContainer,["uk-select","uk-form-small","uk-width-expand"]);this.createOptions();this._inputComponent.value=this._parameterDefinition.value};a.prototype.createInputEvents=function(){this._domManager.setDomEventListener(this._inputComponent,"change",10,this.update.bind(this))};return a}(module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default.BaseCustomComponent);var module$src$api$apps$sd_controls$custom_components$FileCustomComponent={default:{}},__extends$$module$src$api$apps$sd_controls$custom_components$FileCustomComponent=this&&module$src$api$apps$sd_controls$custom_components$FileCustomComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return b(a,c)};return function(a,c){function d(){this.constructor=
   a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$custom_components$FileCustomComponent.default,"__esModule",{value:!0});var BaseCustomComponent_1$$module$src$api$apps$sd_controls$custom_components$FileCustomComponent=module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default,FileUtil_1$$module$src$api$apps$sd_controls$custom_components$FileCustomComponent=module$src$shared$util$FileUtil.default;
   module$src$api$apps$sd_controls$custom_components$FileCustomComponent.default.FileCustomComponent=function(b){function a(a,d,e,g,h,f,k){void 0===k&&(k=!1);a=b.call(this,"file",a,d,e,g,h,k)||this;a._fileHelper=f;a._inputId=a.id+"-button";a.createElement();a.createInputEvents();a.updateLabel(a.parameterDefinition.value);a._fileName=a.parameterDefinition.name;return a}__extends$$module$src$api$apps$sd_controls$custom_components$FileCustomComponent(a,b);Object.defineProperty(a.prototype,"fileInput",{get:function(){return this._fileInput},
   enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){return 1},enumerable:!0,configurable:!0});a.prototype.createInput=function(){var a;this._inputComponent=this._domManager.createDomElement("button",this._inputId,this._inputContainer,"uk-button uk-button-default uk-button-small uk-width-expand text-transform-none uk-padding-remove sd-control-button".split(" "),{type:"button",name:this._inputId});this._inputComponent.innerHTML="<span>"+(a=this._parameterDefinition.name,
   null!==a&&void 0!==a?a:"+")+"</span>";a=this._id+"-file";this._fileInput=this._domManager.createDomElement("input",a,this._inputContainer,[],{type:"file",name:a?a:"+"});this._fileInput.style.display="none";this._fileInput.multiple=!0;this._parameterDefinition.accept&&(a=this._parameterDefinition.accept,"string"===typeof a&&(a=[a]),this._fileInput.accept=a.join(","))};a.prototype.createInputEvents=function(){var a=this,b=!1;this._domManager.setDomEventListener(this._inputComponent,"keyup",null,function(a,
   c){"Space"==c.code&&(b=!0)});this._domManager.setDomEventListener(this._inputComponent,"click",10,function(c,d){!1===b&&a._fileInput.click();b=!1});this.bindChangeEvent();this.inputComponent.addEventListener("dragenter",this.dragHandler,!1);this.inputComponent.addEventListener("dragover",this.dragHandler,!1);this.inputComponent.addEventListener("drop",this.dropHandler,!1)};a.prototype.createLabel=function(){b.prototype.createLabel.call(this)};a.prototype.update=function(a,b){for(a=0;a<this.fileInput.files.length;a++)if(b=
   this.fileInput.files.item(a),!this.checkFileValidityAndStartLoading(b))return;try{var c=this._parameterDefinition.update(this._fileInput.files);c&&c instanceof Promise?c.then(this.updateLabel.bind(this)):this.updateLabel()}catch(g){this.log(g),this.updateLabel()}};a.prototype.bindChangeEvent=function(){this._domManager.setDomEventListener(this._fileInput,"change",10,this.update.bind(this))};a.prototype.checkFileValidityAndStartLoading=function(a){if(a instanceof File){a._type=0<a.type.length?a.type:
   module$src$shared$util$FileUtil.default.FileUtilInstance.guessMimeTypeFromFilename(a.name);if(!this.checkMimeType(a._type))return this.uploadError(),Array.isArray(this._parameterDefinition.accept)?this.log("Allowed file types: "+this._parameterDefinition.accept.join(", ")):this.log("Allowed file types: "+this._parameterDefinition.accept),!1;if(!this.checkSize(a.size))return this.uploadError(),this.log("Maximum file size: "+this._parameterDefinition.max+" bytes"),!1;this.removeUploadError();this.label.innerHTML=
   '<div uk-spinner="ratio: 0.5"></div>';this._fileName=a.name;return!0}return!1};a.prototype.checkMimeType=function(a){return this._parameterDefinition.allowedMimeTypes?Array.isArray(this._parameterDefinition.allowedMimeTypes)?this._parameterDefinition.allowedMimeTypes.some(function(b){return b==a}):this._parameterDefinition.allowedMimeTypes.includes(a):!0};a.prototype.checkSize=function(a){return 0<this._parameterDefinition.max?a<=this._parameterDefinition.max:!0};a.prototype.clear=function(){this._queue.use?
   this._queue.add(this,null):(this.parameterDefinition.update(""),this.value=null,0<this._fileInput.files.length?this._fileInput.value=null:this.bindChangeEvent(),this.updateLabel())};a.prototype.dragHandler=function(a){a.stopPropagation();a.preventDefault()};a.prototype.dropHandler=function(a){this.dragHandler(a)};a.prototype.log=function(a){console.warn(a)};a.prototype.removeUploadError=function(){this.label.innerHTML="";this.label.classList.remove("uk-text-danger")};a.prototype.updateLabel=function(a){var b=
   this,c=[];if(!a){for(var g=0;g<this.fileInput.files.length;g++)c.push(this.fileInput.files.item(g).name);this._fileName=c.join(", ")}a||this._fileName?(this.label.innerHTML=this._fileName?22<this._fileName.length?this._fileName.substr(0,20)+"... \u274c":this._fileName+"  \u274c":"Saved file  \u274c",this.label.onclick=function(){b.clear()}):(this.label.innerHTML="Select file\u2026",this.label.onclick=null)};a.prototype.uploadError=function(){this.label.innerHTML="upload failed";this.label.classList.add("uk-text-danger")};
   return a}(module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default.BaseCustomComponent);var module$src$api$apps$sd_controls$custom_components$ModalCustomComponent={default:{}},__extends$$module$src$api$apps$sd_controls$custom_components$ModalCustomComponent=this&&module$src$api$apps$sd_controls$custom_components$ModalCustomComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return b(a,c)};return function(a,c){function d(){this.constructor=
   a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$custom_components$ModalCustomComponent.default,"__esModule",{value:!0});var BaseCustomComponent_1$$module$src$api$apps$sd_controls$custom_components$ModalCustomComponent=module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default;
   module$src$api$apps$sd_controls$custom_components$ModalCustomComponent.default.ModalCustomComponent=function(b){function a(a,d,e,g,h,f){void 0===f&&(f=!1);a=b.call(this,"modal",a,d,e,g,h,f)||this;a._inputId="button_"+a.id;a._modalId="shapediver_modal_"+a.id;a.createElement();a.createInputEvents();return a}__extends$$module$src$api$apps$sd_controls$custom_components$ModalCustomComponent(a,b);Object.defineProperty(a.prototype,"size",{get:function(){return 1},enumerable:!0,configurable:!0});a.prototype.destory=
   function(){b.prototype.destroy.call(this);this._modalElem.remove()};Object.defineProperty(a.prototype,"content",{get:function(){return this._modalElem.innerHTML},set:function(a){this._parameterDefinition.modalContent=a;this._modalElem.innerHTML=a},enumerable:!0,configurable:!0});a.prototype.createInput=function(){this._inputComponent=this._domManager.createDomElement("button",this._inputId,this._inputContainer,"uk-button uk-button-default uk-button-small uk-width-expand text-transform-none uk-padding-remove sd-control-button".split(" "),
   {type:"button",name:this._inputId,"uk-toggle":"target: #"+this._modalId});this._inputComponent.innerHTML=this._parameterDefinition.name;this._modalElem=this._domManager.createDomElement("div",this._modalId,document.getElementsByTagName("body")[0],[],{"uk-modal":""});this._modalElem.innerHTML='<div class="uk-modal-dialog uk-modal-body">'+this._parameterDefinition.modalContent+"</div>"};a.prototype.createInputEvents=function(){};a.prototype.createLabel=function(){};a.prototype.update=function(a,b){};
   a.prototype.close=function(){UIkit.modal(document.getElementById(this._modalId)).hide()};a.prototype.onOpen=function(a){UIkit.util.on("#"+this._modalId,"show",function(){return a()})};return a}(module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default.BaseCustomComponent);var module$src$api$apps$sd_controls$custom_components$SliderCustomComponent={default:{}},__extends$$module$src$api$apps$sd_controls$custom_components$SliderCustomComponent=this&&module$src$api$apps$sd_controls$custom_components$SliderCustomComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return b(a,c)};return function(a,c){function d(){this.constructor=
   a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$custom_components$SliderCustomComponent.default,"__esModule",{value:!0});var BaseCustomComponent_1$$module$src$api$apps$sd_controls$custom_components$SliderCustomComponent=module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default;
   module$src$api$apps$sd_controls$custom_components$SliderCustomComponent.default.SliderCustomComponent=function(b){function a(a,d,e,g,h,f){void 0===f&&(f=!1);var c,l,m,n;d=b.call(this,"slider",a,d,e,g,h,f)||this;d._delay=[0,500];d._maxVal=100;d._minVal=0;d._step=0;d._decimalPlaces=null;d._value=0;d._inputId=a+"-number";d._inputRangeId=a+"-range";d._parameterDefinition.min&&(d._minVal=d._parameterDefinition.min);d._parameterDefinition.max&&(d._maxVal=d._parameterDefinition.max);d._parameterDefinition.value&&
   (d._value=d._parameterDefinition.value);if("number"===typeof d._parameterDefinition.step||"string"===typeof d._parameterDefinition.step)d._step=d._parameterDefinition.step;d._parameterDefinition.delay&&(Array.isArray(d._parameterDefinition.delay)?d._delay=[Math.max((c=d._parameterDefinition.delay[0],null!==c&&void 0!==c?c:0),d._delay[0]),Math.max((l=d._parameterDefinition.delay[1],null!==l&&void 0!==l?l:0),d._delay[1])]:"number"===typeof d._delay&&(d._delay=[Math.max((m=d._parameterDefinition.delay,
   null!==m&&void 0!==m?m:0),d._delay[0]),Math.max((n=d._parameterDefinition.delay,null!==n&&void 0!==n?n:0),d._delay[1])]));d.createElement();d.createInputEvents();return d}__extends$$module$src$api$apps$sd_controls$custom_components$SliderCustomComponent(a,b);Object.defineProperty(a.prototype,"decimalPlaces",{get:function(){return this._decimalPlaces},set:function(a){this._decimalPlaces=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"inputContainer",{get:function(){return this._inputContainer},
   enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"inputRange",{get:function(){return this._inputRange},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){return 2},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"value",{get:function(){return this._inputComponent.value},set:function(a){a=Number(a);this._minVal&&a<Number(this._minVal)&&(a=this._minVal);this._maxVal&&a>Number(this._maxVal)&&(a=this._maxVal);if(this._decimalPlaces||
   0==this._decimalPlaces){var b=Math.pow(10,this._decimalPlaces);a=Math.round(a*b)/b}this._inputComponent.value=a;this._inputRange.value=a},enumerable:!0,configurable:!0});a.prototype.createInput=function(){this.createRangeInput();this.createNumberInput()};a.prototype.createInputEvents=function(){var a=this,b,e,g=this._domManager.isEventSupported("input","input")?"input":"change",h=(b=this._delay[0],null!==b&&void 0!==b?b:0);b=(e=this._delay[1],null!==e&&void 0!==e?e:0);this._domManager.setDomEventListener(this._inputComponent,
   g,b,this.update.bind(this));this._domManager.setDomEventListener(this._inputComponent,"focusout",b,this.update.bind(this));this._domManager.setDomEventListener(this._inputComponent,"keyup",b,this.updateKeyUp.bind(this));this._domManager.setDomEventListener(this._inputRange,"input",null,function(){return a._inputComponent.value=a._inputRange.value});this._domManager.setDomEventListener(this._inputRange,"mouseup",h,this.update.bind(this));this._domManager.setDomEventListener(this._inputRange,"touchend",
   h,this.update.bind(this))};a.prototype.update=function(a,d){var c="focusout"===d.type&&(a==this._inputComponent.value||["mouseup","touchend"].includes(this._previousEventType));this._previousEventType=d.type;c||(this.value=a,b.prototype.update.call(this,this.value,d))};a.prototype.createNumberInput=function(){this._inputComponent=this._domManager.createDomElement("input",this._inputId,this._inputContainer,["uk-input","uk-width-1-3","uk-form-small","sd-input-number"],{min:this._minVal,max:this._maxVal,
   step:this._step,type:"number",name:this._inputId,value:this._value||"0"})};a.prototype.createRangeInput=function(){this._inputRange=this._domManager.createDomElement("input",this._inputRangeId,this._inputContainer,["uk-range","uk-width-2-3","uk-form-small","sd-input-range"],{type:"range",name:this._inputRangeId,min:this._minVal,max:this._maxVal,step:this._step,value:this._value||"0",tabIndex:"-1"});this._domManager.userAgentIsMobileOrTabletDevice&&this._inputRange.classList.add("sd-input-range-mobile");
   this._domManager.userAgentIsIPadOrIPhone?this._inputRange.classList.add("ios-padding-left"):this._inputRange.classList.add("uk-padding-remove-left")};a.prototype.updateKeyUp=function(a,b){!b.which&&!b.keyCode||13!=b.which&&13!=b.keyCode||this.update(a,b)};return a}(module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default.BaseCustomComponent);var module$src$api$apps$sd_controls$custom_components$GroupCustomComponent={default:{}},__extends$$module$src$api$apps$sd_controls$custom_components$GroupCustomComponent=this&&module$src$api$apps$sd_controls$custom_components$GroupCustomComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return b(a,c)};return function(a,c){function d(){this.constructor=
   a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$custom_components$GroupCustomComponent.default,"__esModule",{value:!0});var BaseCustomComponent_1$$module$src$api$apps$sd_controls$custom_components$GroupCustomComponent=module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default;
   module$src$api$apps$sd_controls$custom_components$GroupCustomComponent.default.GroupCustomComponent=function(b){function a(a,d,e,g,h,f,k){void 0===k&&(k=!1);a=b.call(this,"group",a,d,e,g,h,k)||this;a._controlsFactory=f;a._accordionType="custom-parameter";a._rowId=a.id+"-controlmenu-row";a.createElement();a.createInputEvents();return a}__extends$$module$src$api$apps$sd_controls$custom_components$GroupCustomComponent(a,b);Object.defineProperty(a.prototype,"size",{get:function(){return 4},enumerable:!0,
   configurable:!0});a.prototype.createInput=function(){var a=this;this._inputComponent=this._domManager.createDomElement("div",null,this._parametersEl,["uk-accordion-content","uk-margin-remove"],{"uk-grid":""});this._parameterDefinition.parameters.forEach(function(b){b=a._controlsFactory.createUserDefinedParameter(b,a._inputComponent,!1);a.children.push(b);b.label&&(b.label.classList.remove("uk-text-uppercase"),b.label.classList.add("uk-text-capitalize"))})};a.prototype.createInputEvents=function(){this._domManager.setDomEventListener(this._ulElem,
   "click",10,this.closeOthers.bind(this));this._domManager.setDomEventListener(this._ulElem,"click",10,this.update.bind(this))};a.prototype.createLabel=function(){this._label=this._domManager.createDomElement("a",this.id+"-a",this._parametersEl,"uk-accordion-title uk-width-expand uk-form-label uk-text-uppercase uk-text-small uk-padding-small sdv-control-panel-row-border".split(" "));this._label.innerHTML=this._parameterDefinition.name;this._parameterDefinition.title&&this._label.setAttribute("title",
   this._parameterDefinition.title)};a.prototype.createRow=function(){this._row=this._domManager.createDomElement("row",this._rowId,this._parent,["uk-margin-remove","uk-padding-remove","sd-max-width-1"],{"uk-grid":'margin: "";'});this._ulElem=this._domManager.createDomElement("ul",null,this._row,["uk-width-1-1"],{"uk-accordion":"multiple: false"});this._parametersEl=this._domManager.createDomElement("li",null,this._ulElem,["jq-accordion-control-li"],{"data-setting-type":this._accordionType})};a.prototype.update=
   function(a,b){};a.prototype.closeOthers=function(){var a=this;Array.from(document.getElementsByClassName("jq-accordion-control-li")).forEach(function(b){b.getAttribute("data-setting-type")!=a._accordionType||a._parametersEl.isSameNode(b)||b.classList.contains("uk-open")&&UIkit.accordion(b.parentNode).toggle(0)})};return a}(module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default.BaseCustomComponent);var module$src$api$apps$sd_controls$custom_components$StaticHTMLCustomComponent={default:{}},__extends$$module$src$api$apps$sd_controls$custom_components$StaticHTMLCustomComponent=this&&module$src$api$apps$sd_controls$custom_components$StaticHTMLCustomComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return b(a,c)};return function(a,c){function d(){this.constructor=
   a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$custom_components$StaticHTMLCustomComponent.default,"__esModule",{value:!0});var BaseCustomComponent_1$$module$src$api$apps$sd_controls$custom_components$StaticHTMLCustomComponent=module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default;
   module$src$api$apps$sd_controls$custom_components$StaticHTMLCustomComponent.default.StaticHTMLCustomComponent=function(b){function a(a,d,e,g,h,f){void 0===f&&(f=!1);a=b.call(this,"statichtml",a,d,e,g,h,f)||this;a.createElement();return a}__extends$$module$src$api$apps$sd_controls$custom_components$StaticHTMLCustomComponent(a,b);Object.defineProperty(a.prototype,"size",{get:function(){return 4},enumerable:!0,configurable:!0});a.prototype.createElement=function(){this.createRow();this.row.innerHTML=
   this._parameterDefinition.content;this.row.classList.remove("uk-padding-small","uk-margin-remove");this.row.classList.add("uk-padding-remove-left","uk-margin-remove-left","uk-margin-remove-top")};a.prototype.createInput=function(){};a.prototype.createInputEvents=function(){};a.prototype.update=function(a,b){};return a}(module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default.BaseCustomComponent);var module$src$api$apps$sd_controls$settings_components$BaseSettingComponent={default:{}};Object.defineProperty(module$src$api$apps$sd_controls$settings_components$BaseSettingComponent.default,"__esModule",{value:!0});
   module$src$api$apps$sd_controls$settings_components$BaseSettingComponent.default.BaseSettingComponent=function(){function b(a,c,d){var e=this;this._api=a;this._settingDefinition=c;this._component=d;!this._settingDefinition.update&&this._settingDefinition.setting&&(this._settingDefinition.update=function(a){return e._api.updateSettingAsync(e._settingDefinition.setting,a)});b._componentsRegistered.push(this);b._settingsUpdateEvent||(b._settingsUpdateEvent=a.addEventListener("settings.update",function(a){b._componentsRegistered.forEach(function(b){b.parameterDefinition.setting==
   a.settings.key&&(b.value="function"===typeof b.parameterDefinition.convertValue?b.parameterDefinition.convertValue(a.settings.valueNew):a.settings.valueNew)})}))}Object.defineProperty(b.prototype,"children",{get:function(){return this._component.children},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"groupId",{get:function(){return this._settingDefinition.groupId},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"hidden",{get:function(){return!1},enumerable:!0,
   configurable:!0});Object.defineProperty(b.prototype,"id",{get:function(){return this._settingDefinition.id},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"inputComponent",{get:function(){return this._component.inputComponent},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"component",{get:function(){return this._component},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"inputContainer",{get:function(){return this._component.inputContainer},
   enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"isChanged",{get:function(){return!1},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"label",{get:function(){return this._component.label},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"order",{get:function(){return this._component.order},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"parameterDefinition",{get:function(){return this._settingDefinition},enumerable:!0,configurable:!0});
   Object.defineProperty(b.prototype,"row",{get:function(){return this._component.row},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"size",{get:function(){return this._component.size},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"type",{get:function(){return this._component.type},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"value",{get:function(){return this._component.value},set:function(a){this._component.value=a},enumerable:!0,configurable:!0});
   Object.defineProperty(b.prototype,"valueStack",{get:function(){return null},enumerable:!0,configurable:!0});b.prototype.destroy=function(){this._component.destroy()};b.prototype.insertBefore=function(a){this._component.insertBefore(a)};b.prototype.isCurrentValueSameAsInital=function(){throw Error("Method not implemented.");};b.prototype.onDestroy=function(a){var b=this;this._component.onDestroy(function(){return a(b.id)})};b.prototype.queueCommitExecuted=function(a,b){throw Error("Method not implemented.");
   };b.prototype.setToInitalValueAndClearStack=function(){throw Error("Method not implemented.");};b._componentsRegistered=[];return b}();var module$src$api$apps$sd_controls$settings_components$StaticHTMLSettingComponent={default:{}},__extends$$module$src$api$apps$sd_controls$settings_components$StaticHTMLSettingComponent=this&&module$src$api$apps$sd_controls$settings_components$StaticHTMLSettingComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return b(a,c)};return function(a,
   c){function d(){this.constructor=a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$settings_components$StaticHTMLSettingComponent.default,"__esModule",{value:!0});var BaseSettingComponent_1$$module$src$api$apps$sd_controls$settings_components$StaticHTMLSettingComponent=module$src$api$apps$sd_controls$settings_components$BaseSettingComponent.default;
   module$src$api$apps$sd_controls$settings_components$StaticHTMLSettingComponent.default.StaticHTMLSettingComponent=function(b){function a(a,d,e,g){return b.call(this,a,d,g.createUserDefinedParameter(d,e,!1))||this}__extends$$module$src$api$apps$sd_controls$settings_components$StaticHTMLSettingComponent(a,b);return a}(module$src$api$apps$sd_controls$settings_components$BaseSettingComponent.default.BaseSettingComponent);var module$src$api$apps$sd_controls$parameters_components$BaseParameterComponent={default:{}},__awaiter$$module$src$api$apps$sd_controls$parameters_components$BaseParameterComponent=this&&module$src$api$apps$sd_controls$parameters_components$BaseParameterComponent.default.__awaiter||function(b,a,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,h){function g(a){try{l(d.next(a))}catch(n){h(n)}}function k(a){try{l(d["throw"](a))}catch(n){h(n)}}
   function l(a){a.done?c(a.value):e(a.value).then(g,k)}l((d=d.apply(b,a||[])).next())})},__generator$$module$src$api$apps$sd_controls$parameters_components$BaseParameterComponent=this&&module$src$api$apps$sd_controls$parameters_components$BaseParameterComponent.default.__generator||function(b,a){function c(a){return function(b){return d([a,b])}}function d(c){if(g)throw new TypeError("Generator is already executing.");for(;e;)try{if(g=1,h&&(f=c[0]&2?h["return"]:c[0]?h["throw"]||((f=h["return"])&&f.call(h),
   0):h.next)&&!(f=f.call(h,c[1])).done)return f;if(h=0,f)c=[c[0]&2,f.value];switch(c[0]){case 0:case 1:f=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++;h=c[1];c=[0];continue;case 7:c=e.ops.pop();e.trys.pop();continue;default:if(!(f=e.trys,f=0<f.length&&f[f.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!f||c[1]>f[0]&&c[1]<f[3]))e.label=c[1];else if(6===c[0]&&e.label<f[1])e.label=f[1],f=c;else if(f&&e.label<f[2])e.label=f[2],e.ops.push(c);else{f[2]&&e.ops.pop();e.trys.pop();
   continue}}c=a.call(b,e)}catch(m){c=[6,m],h=0}finally{g=f=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},g,h,f,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k};Object.defineProperty(module$src$api$apps$sd_controls$parameters_components$BaseParameterComponent.default,"__esModule",{value:!0});
   var _slugify$$module$src$api$apps$sd_controls$parameters_components$BaseParameterComponent=function(){function b(b,d){void 0===d&&(d=null);"string"!==typeof b&&(b+="");d="string"===typeof d?{replacement:d}:d||{};b=b.split("").reduce(function(b,c){return b+(a[c]||c).replace(d.remove||/[^\w\s$*_+~.()''!\-:@]/g,"")},"").replace(/^\s+|\s+$/g,"").replace(/[-\s]+/g,d.replacement||"-").replace("#{replacement}$","");return d.lower?b.toLowerCase():b}var a=JSON.parse('{"$":"dollar","&":"and","<":"less",">":"greater","|":"or","\u00a2":"cent","\u00a3":"pound","\u00a4":"currency","\u00a5":"yen","\u00a9":"(c)","\u00aa":"a","\u00ae":"(r)","\u00ba":"o","\u00c0":"A","\u00c1":"A","\u00c2":"A","\u00c3":"A","\u00c4":"A","\u00c5":"A","\u00c6":"AE","\u00c7":"C","\u00c8":"E","\u00c9":"E","\u00ca":"E","\u00cb":"E","\u00cc":"I","\u00cd":"I","\u00ce":"I","\u00cf":"I","\u00d0":"D","\u00d1":"N","\u00d2":"O","\u00d3":"O","\u00d4":"O","\u00d5":"O","\u00d6":"O","\u00d8":"O","\u00d9":"U","\u00da":"U","\u00db":"U","\u00dc":"U","\u00dd":"Y","\u00de":"TH","\u00df":"ss","\u00e0":"a","\u00e1":"a","\u00e2":"a","\u00e3":"a","\u00e4":"a","\u00e5":"a","\u00e6":"ae","\u00e7":"c","\u00e8":"e","\u00e9":"e","\u00ea":"e","\u00eb":"e","\u00ec":"i","\u00ed":"i","\u00ee":"i","\u00ef":"i","\u00f0":"d","\u00f1":"n","\u00f2":"o","\u00f3":"o","\u00f4":"o","\u00f5":"o","\u00f6":"o","\u00f8":"o","\u00f9":"u","\u00fa":"u","\u00fb":"u","\u00fc":"u","\u00fd":"y","\u00fe":"th","\u00ff":"y","\u0100":"A","\u0101":"a","\u0102":"A","\u0103":"a","\u0104":"A","\u0105":"a","\u0106":"C","\u0107":"c","\u010c":"C","\u010d":"c","\u010e":"D","\u010f":"d","\u0110":"DJ","\u0111":"dj","\u0112":"E","\u0113":"e","\u0116":"E","\u0117":"e","\u0118":"e","\u0119":"e","\u011a":"E","\u011b":"e","\u011e":"G","\u011f":"g","\u0122":"G","\u0123":"g","\u0128":"I","\u0129":"i","\u012a":"i","\u012b":"i","\u012e":"I","\u012f":"i","\u0130":"I","\u0131":"i","\u0136":"k","\u0137":"k","\u013b":"L","\u013c":"l","\u0141":"L","\u0142":"l","\u0143":"N","\u0144":"n","\u0145":"N","\u0146":"n","\u0147":"N","\u0148":"n","\u0150":"O","\u0151":"o","\u0152":"OE","\u0153":"oe","\u0158":"R","\u0159":"r","\u015a":"S","\u015b":"s","\u015e":"S","\u015f":"s","\u0160":"S","\u0161":"s","\u0162":"T","\u0163":"t","\u0164":"T","\u0165":"t","\u0168":"U","\u0169":"u","\u016a":"u","\u016b":"u","\u016e":"U","\u016f":"u","\u0170":"U","\u0171":"u","\u0172":"U","\u0173":"u","\u0179":"Z","\u017a":"z","\u017b":"Z","\u017c":"z","\u017d":"Z","\u017e":"z","\u0192":"f","\u01a0":"O","\u01a1":"o","\u01af":"U","\u01b0":"u","\u01c8":"LJ","\u01c9":"lj","\u01cb":"NJ","\u01cc":"nj","\u0218":"S","\u0219":"s","\u021a":"T","\u021b":"t","\u02da":"o","\u0386":"A","\u0388":"E","\u0389":"H","\u038a":"I","\u038c":"O","\u038e":"Y","\u038f":"W","\u0390":"i","\u0391":"A","\u0392":"B","\u0393":"G","\u0394":"D","\u0395":"E","\u0396":"Z","\u0397":"H","\u0398":"8","\u0399":"I","\u039a":"K","\u039b":"L","\u039c":"M","\u039d":"N","\u039e":"3","\u039f":"O","\u03a0":"P","\u03a1":"R","\u03a3":"S","\u03a4":"T","\u03a5":"Y","\u03a6":"F","\u03a7":"X","\u03a8":"PS","\u03a9":"W","\u03aa":"I","\u03ab":"Y","\u03ac":"a","\u03ad":"e","\u03ae":"h","\u03af":"i","\u03b0":"y","\u03b1":"a","\u03b2":"b","\u03b3":"g","\u03b4":"d","\u03b5":"e","\u03b6":"z","\u03b7":"h","\u03b8":"8","\u03b9":"i","\u03ba":"k","\u03bb":"l","\u03bc":"m","\u03bd":"n","\u03be":"3","\u03bf":"o","\u03c0":"p","\u03c1":"r","\u03c2":"s","\u03c3":"s","\u03c4":"t","\u03c5":"y","\u03c6":"f","\u03c7":"x","\u03c8":"ps","\u03c9":"w","\u03ca":"i","\u03cb":"y","\u03cc":"o","\u03cd":"y","\u03ce":"w","\u0401":"Yo","\u0402":"DJ","\u0404":"Ye","\u0406":"I","\u0407":"Yi","\u0408":"J","\u0409":"LJ","\u040a":"NJ","\u040b":"C","\u040f":"DZ","\u0410":"A","\u0411":"B","\u0412":"V","\u0413":"G","\u0414":"D","\u0415":"E","\u0416":"Zh","\u0417":"Z","\u0418":"I","\u0419":"J","\u041a":"K","\u041b":"L","\u041c":"M","\u041d":"N","\u041e":"O","\u041f":"P","\u0420":"R","\u0421":"S","\u0422":"T","\u0423":"U","\u0424":"F","\u0425":"H","\u0426":"C","\u0427":"Ch","\u0428":"Sh","\u0429":"Sh","\u042a":"U","\u042b":"Y","\u042c":"","\u042d":"E","\u042e":"Yu","\u042f":"Ya","\u0430":"a","\u0431":"b","\u0432":"v","\u0433":"g","\u0434":"d","\u0435":"e","\u0436":"zh","\u0437":"z","\u0438":"i","\u0439":"j","\u043a":"k","\u043b":"l","\u043c":"m","\u043d":"n","\u043e":"o","\u043f":"p","\u0440":"r","\u0441":"s","\u0442":"t","\u0443":"u","\u0444":"f","\u0445":"h","\u0446":"c","\u0447":"ch","\u0448":"sh","\u0449":"sh","\u044a":"u","\u044b":"y","\u044c":"","\u044d":"e","\u044e":"yu","\u044f":"ya","\u0451":"yo","\u0452":"dj","\u0454":"ye","\u0456":"i","\u0457":"yi","\u0458":"j","\u0459":"lj","\u045a":"nj","\u045b":"c","\u045f":"dz","\u0490":"G","\u0491":"g","\u0e3f":"baht","\u10d0":"a","\u10d1":"b","\u10d2":"g","\u10d3":"d","\u10d4":"e","\u10d5":"v","\u10d6":"z","\u10d7":"t","\u10d8":"i","\u10d9":"k","\u10da":"l","\u10db":"m","\u10dc":"n","\u10dd":"o","\u10de":"p","\u10df":"zh","\u10e0":"r","\u10e1":"s","\u10e2":"t","\u10e3":"u","\u10e4":"f","\u10e5":"k","\u10e6":"gh","\u10e7":"q","\u10e8":"sh","\u10e9":"ch","\u10ea":"ts","\u10eb":"dz","\u10ec":"ts","\u10ed":"ch","\u10ee":"kh","\u10ef":"j","\u10f0":"h","\u1e9e":"SS","\u1ea0":"A","\u1ea1":"a","\u1ea2":"A","\u1ea3":"a","\u1ea4":"A","\u1ea5":"a","\u1ea6":"A","\u1ea7":"a","\u1ea8":"A","\u1ea9":"a","\u1eaa":"A","\u1eab":"a","\u1eac":"A","\u1ead":"a","\u1eae":"A","\u1eaf":"a","\u1eb0":"A","\u1eb1":"a","\u1eb2":"A","\u1eb3":"a","\u1eb4":"A","\u1eb5":"a","\u1eb6":"A","\u1eb7":"a","\u1eb8":"E","\u1eb9":"e","\u1eba":"E","\u1ebb":"e","\u1ebc":"E","\u1ebd":"e","\u1ebe":"E","\u1ebf":"e","\u1ec0":"E","\u1ec1":"e","\u1ec2":"E","\u1ec3":"e","\u1ec4":"E","\u1ec5":"e","\u1ec6":"E","\u1ec7":"e","\u1ec8":"I","\u1ec9":"i","\u1eca":"I","\u1ecb":"i","\u1ecc":"O","\u1ecd":"o","\u1ece":"O","\u1ecf":"o","\u1ed0":"O","\u1ed1":"o","\u1ed2":"O","\u1ed3":"o","\u1ed4":"O","\u1ed5":"o","\u1ed6":"O","\u1ed7":"o","\u1ed8":"O","\u1ed9":"o","\u1eda":"O","\u1edb":"o","\u1edc":"O","\u1edd":"o","\u1ede":"O","\u1edf":"o","\u1ee0":"O","\u1ee1":"o","\u1ee2":"O","\u1ee3":"o","\u1ee4":"U","\u1ee5":"u","\u1ee6":"U","\u1ee7":"u","\u1ee8":"U","\u1ee9":"u","\u1eea":"U","\u1eeb":"u","\u1eec":"U","\u1eed":"u","\u1eee":"U","\u1eef":"u","\u1ef0":"U","\u1ef1":"u","\u1ef2":"Y","\u1ef3":"y","\u1ef4":"Y","\u1ef5":"y","\u1ef6":"Y","\u1ef7":"y","\u1ef8":"Y","\u1ef9":"y","\u2018":"\'","\u2019":"\'","\u201c":"\\"","\u201d":"\\"","\u2020":"+","\u2022":"*","\u2026":"...","\u20a0":"ecu","\u20a2":"cruzeiro","\u20a3":"french franc","\u20a4":"lira","\u20a5":"mill","\u20a6":"naira","\u20a7":"peseta","\u20a8":"rupee","\u20a9":"won","\u20aa":"new shequel","\u20ab":"dong","\u20ac":"euro","\u20ad":"kip","\u20ae":"tugrik","\u20af":"drachma","\u20b0":"penny","\u20b1":"peso","\u20b2":"guarani","\u20b3":"austral","\u20b4":"hryvnia","\u20b5":"cedi","\u20b9":"indian rupee","\u20bd":"russian ruble","\u2120":"sm","\u2122":"tm","\u2202":"d","\u2206":"delta","\u2211":"sum","\u221e":"infinity","\u2665":"love","\u5143":"yuan","\u5186":"yen","\ufdfc":"rial"}');
   b.extend=function(b){for(var c in b)a[c]=b[c]};return b}();
   module$src$api$apps$sd_controls$parameters_components$BaseParameterComponent.default.BaseParameterComponent=function(){function b(a,c,d,e,g,h){this._api=a;this._domManager=c;this._queue=d;this._component=e;this._parameter=g;this._editMode=h;this._editClass="sdv-edit-label";this._wrapClass="uk-text-truncate";this._slugId=this._api.getRuntimeId()+"_"+_slugify$$module$src$api$apps$sd_controls$parameters_components$BaseParameterComponent(e.id);this._component.hidden=this._component.hidden||!1;this._component.parameterDefinition.update=
   this.updateAsync.bind(this);b._instances.push(this);b._eventsBound||(this._api.parameters.addEventListener(this._api.parameters.EVENTTYPE.VALUE_UPDATE,function(a){return b._instances.forEach(function(b){return b.handleValueUpdateEvent(a)})}),this._api.parameters.addEventListener(this._api.parameters.EVENTTYPE.UPDATE,function(a){return b._instances.forEach(function(b){return b.handleParameterUpdateEvent(a)})}),this._api.exports.addEventListener(this._api.exports.EVENTTYPE.UPDATE,function(a){return b._instances.forEach(function(b){return b.handleExportsUpdateEvent(a)})}),
   b._eventsBound=!0);this.editMode(this._editMode)}Object.defineProperty(b.prototype,"children",{get:function(){return this._component.children},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"hidden",{get:function(){return this._component.hidden},set:function(a){this._component.hidden=a;this._editMode?this.inputComponent&&(a?this.inputComponent.classList.add("sdv-hidden"):this.inputComponent.classList.remove("sdv-hidden")):a&&this.destroy()},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
   "id",{get:function(){return this._component.id},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"inContentEditMode",{get:function(){return this._inContentEditMode},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"inputComponent",{get:function(){return this._component.inputComponent},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"inputContainer",{get:function(){return this._component.inputContainer},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
   "isChanged",{get:function(){return this._component.isChanged},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"isExport",{get:function(){return!0!==this._parameter.isParameter},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"isParameter",{get:function(){return this._parameter.isParameter},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"label",{get:function(){return this._component.label},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
   "name",{get:function(){return this._parameter.name},set:function(a){this._parameter.name=a;this._component.label.innerHTML=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"newName",{get:function(){return this._newName},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"order",{get:function(){return this._component.order},set:function(a){this._component.order=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"parameterDefinition",{get:function(){return this._component.parameterDefinition},
   enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"row",{get:function(){return this._component.row},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"size",{get:function(){return this._component.size},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"type",{get:function(){return this._component.type},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"value",{get:function(){return this._component.value},set:function(a){this._component.value=
   a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"valueStack",{get:function(){return this._component.valueStack},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"wasEdited",{get:function(){return this._wasEdited},enumerable:!0,configurable:!0});b.prototype.destroy=function(){this._component.destroy()};b.prototype.handleExportsUpdateEvent=function(a){var b=a.export[this.id];b||a.export.id!==this.id||(b=a.export);b&&(this.hidden=b.hidden)};b.prototype.handleParameterUpdateEvent=
   function(a){var b=a.parameter[this.id];b||a.parameter.id!==this.id||(b=a.parameter);b&&(this.hidden=b.hidden)};b.prototype.handleValueUpdateEvent=function(a){if(a.parameter)for(var b=Object.keys(a.parameter),d=0;d<b.length;d++)for(var e=b[d],g=Object.keys(a.parameter[e]),h=0;h<g.length;h++){var f=g[h];if(f===this.id){this.value=a.parameter[e][f];break}}};b.prototype.insertBefore=function(a){this._component.insertBefore(a)};b.prototype.isCurrentValueSameAsInital=function(){return this._component.isCurrentValueSameAsInital()};
   b.prototype.onDestroy=function(a){this._component.onDestroy(a)};b.prototype.queueCommitExecuted=function(a,b){this._component.queueCommitExecuted(a,b)};b.prototype.setEditable=function(a){var b=this;a?(this.label.classList.remove(this._wrapClass),this.label.classList.add(this._editClass),this.label.addEventListener("input",function(a){b._wasEdited=!0;b._newName=a.target.innerText}),this.label.contentEditable="true"):(this.label.classList.remove(this._editClass),this.label.classList.add(this._wrapClass),
   this.label.contentEditable="false");this._inContentEditMode=a};b.prototype.setToInitalValueAndClearStack=function(){return this._component.setToInitalValueAndClearStack()};b.prototype.updateAsync=function(a){return __awaiter$$module$src$api$apps$sd_controls$parameters_components$BaseParameterComponent(this,void 0,void 0,function(){var c;return __generator$$module$src$api$apps$sd_controls$parameters_components$BaseParameterComponent(this,function(d){switch(d.label){case 0:if(!this._parameter.isParameter)return[3,
   2];c=this._api.parameters.updateAsync({id:this._parameter.id,value:a});b.parametersPromises[this.id]=c;return[4,b.parametersPromises[this.id]];case 1:return d.sent(),delete b.parametersPromises[this.id],[2,c];case 2:return[2,this._api.exports.requestAsync({id:this._parameter.id})]}})})};b.prototype.editMode=function(a){var b=this;a&&(this.label.classList.add("sdv-edit-mode"),this._hideIcon=this._domManager.createDomElement("i",this._slugId+"-hide-icon",null,["uk-float-right","uk-margin-remove","uk-padding-remove-right",
   "sdv-control-brand-color"],{"uk-icon":"icon: ban; ratio: 0.6;"}),this._sortIcon=this._domManager.createDomElement("i",this._slugId+"-sort-icon",null,["sdv-control-brand-color","uk-padding-remove-left","uk-margin-small-right","jq-sdv-sort-bars","uk-width-auto"],{"uk-icon":"icon: move; ratio: 0.8;"}),this._hideIcon.onclick=function(){return b.hidden=!b.hidden},this._component.inputContainer.classList.remove("uk-width-1-1"),this._component.inputContainer.classList.add("uk-width-expand"),a=this._domManager.createDomElement("div",
   null,null,["uk-width-1-1"]),a.appendChild(this._hideIcon),"button"===this._component.type?this.row.insertBefore(a,this.row.childNodes[0]):this.row.insertBefore(a,this.label),this.row.insertBefore(this._sortIcon,this.inputContainer))};b._eventsBound=!1;b._instances=[];b.parametersPromises={};return b}();var module$src$api$apps$sd_controls$parameters_components$SliderParameterComponent={default:{}},__extends$$module$src$api$apps$sd_controls$parameters_components$SliderParameterComponent=this&&module$src$api$apps$sd_controls$parameters_components$SliderParameterComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return b(a,c)};return function(a,
   c){function d(){this.constructor=a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$parameters_components$SliderParameterComponent.default,"__esModule",{value:!0});
   var BaseParameterComponent_1$$module$src$api$apps$sd_controls$parameters_components$SliderParameterComponent=module$src$api$apps$sd_controls$parameters_components$BaseParameterComponent.default,SliderCustomComponent_1$$module$src$api$apps$sd_controls$parameters_components$SliderParameterComponent=module$src$api$apps$sd_controls$custom_components$SliderCustomComponent.default;
   function getStep$$module$src$api$apps$sd_controls$parameters_components$SliderParameterComponent(b){if("number"===typeof b.decimalplaces||"string"===typeof b.decimalplaces)switch(b.type){case "Even":case "Odd":return 2;case "Int":break;default:return Math.pow(.1,b.decimalplaces).toFixed(b.decimalplaces)}return 0}
   module$src$api$apps$sd_controls$parameters_components$SliderParameterComponent.default.SliderParameterComponent=function(b){function a(a,d,e,g,h,f){void 0===f&&(f=!1);a=b.call(this,a,d,e,new module$src$api$apps$sd_controls$custom_components$SliderCustomComponent.default.SliderCustomComponent(h.id,{name:h.name,type:h.elementType,min:h.min,max:h.max,title:h.note,value:h.defval,delay:[0,1E3],order:h.order,step:getStep$$module$src$api$apps$sd_controls$parameters_components$SliderParameterComponent(h)},
   g,d,e),h,f)||this;h.decimalplaces&&(a._component.decimalPlaces=Number(h.decimalplaces));a._component.parameterDefinition.update=a.updateAsync.bind(a);return a}__extends$$module$src$api$apps$sd_controls$parameters_components$SliderParameterComponent(a,b);Object.defineProperty(a.prototype,"hidden",{get:function(){return this._component.hidden},set:function(a){this._component.hidden=a;if(this._editMode){if(this.inputComponent&&(a?this.inputComponent.classList.add("sdv-hidden"):this.inputComponent.classList.remove("sdv-hidden")),
   this._component.inputRange){var b=this._component.inputRange;a?b.classList.add("sdv-hidden"):b.classList.remove("sdv-hidden")}}else a&&this.destroy()},enumerable:!0,configurable:!0});return a}(module$src$api$apps$sd_controls$parameters_components$BaseParameterComponent.default.BaseParameterComponent);var module$src$api$apps$sd_controls$parameters_components$FileParameterComponent={default:{}},__extends$$module$src$api$apps$sd_controls$parameters_components$FileParameterComponent=this&&module$src$api$apps$sd_controls$parameters_components$FileParameterComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return b(a,c)};return function(a,c){function d(){this.constructor=
   a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__awaiter$$module$src$api$apps$sd_controls$parameters_components$FileParameterComponent=this&&module$src$api$apps$sd_controls$parameters_components$FileParameterComponent.default.__awaiter||function(b,a,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,h){function g(a){try{l(d.next(a))}catch(n){h(n)}}function k(a){try{l(d["throw"](a))}catch(n){h(n)}}function l(a){a.done?
   c(a.value):e(a.value).then(g,k)}l((d=d.apply(b,a||[])).next())})},__generator$$module$src$api$apps$sd_controls$parameters_components$FileParameterComponent=this&&module$src$api$apps$sd_controls$parameters_components$FileParameterComponent.default.__generator||function(b,a){function c(a){return function(b){return d([a,b])}}function d(c){if(g)throw new TypeError("Generator is already executing.");for(;e;)try{if(g=1,h&&(f=c[0]&2?h["return"]:c[0]?h["throw"]||((f=h["return"])&&f.call(h),0):h.next)&&!(f=
   f.call(h,c[1])).done)return f;if(h=0,f)c=[c[0]&2,f.value];switch(c[0]){case 0:case 1:f=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++;h=c[1];c=[0];continue;case 7:c=e.ops.pop();e.trys.pop();continue;default:if(!(f=e.trys,f=0<f.length&&f[f.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!f||c[1]>f[0]&&c[1]<f[3]))e.label=c[1];else if(6===c[0]&&e.label<f[1])e.label=f[1],f=c;else if(f&&e.label<f[2])e.label=f[2],e.ops.push(c);else{f[2]&&e.ops.pop();e.trys.pop();continue}}c=
   a.call(b,e)}catch(m){c=[6,m],h=0}finally{g=f=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},g,h,f,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k};Object.defineProperty(module$src$api$apps$sd_controls$parameters_components$FileParameterComponent.default,"__esModule",{value:!0});
   var BaseParameterComponent_1$$module$src$api$apps$sd_controls$parameters_components$FileParameterComponent=module$src$api$apps$sd_controls$parameters_components$BaseParameterComponent.default,FileCustomComponent_1$$module$src$api$apps$sd_controls$parameters_components$FileParameterComponent=module$src$api$apps$sd_controls$custom_components$FileCustomComponent.default;
   module$src$api$apps$sd_controls$parameters_components$FileParameterComponent.default.FileParameterComponent=function(b){function a(a,d,e,g,h,f,k,l){void 0===k&&(k=!1);void 0===l&&(l=function(){});a=b.call(this,a,d,e,new module$src$api$apps$sd_controls$custom_components$FileCustomComponent.default.FileCustomComponent(h.id,{name:h.name,type:h.elementType,min:h.min,max:h.max,title:h.note,value:h.defval,order:h.order,allowedMimeTypes:h.format},g,d,e,f),h,k)||this;a._showMessage=l;a._sdClass="sd-control-button";
   a._component.parameterDefinition.update=a.updateAsync.bind(a);return a}__extends$$module$src$api$apps$sd_controls$parameters_components$FileParameterComponent(a,b);Object.defineProperty(a.prototype,"name",{get:function(){return this._parameter.name},set:function(a){this._parameter.name=a;this.inputComponent.firstElementChild.innerHTML=a},enumerable:!0,configurable:!0});a.prototype.setEditable=function(a){var b=this;a?(this.inputComponent.classList.remove(this._sdClass),this.inputComponent.addEventListener("input",
   function(a){b._wasEdited=!0;b._newName=a.target.innerText}),this.inputComponent.firstElementChild.contentEditable="true"):(this.inputComponent.classList.add(this._sdClass),this.inputComponent.firstElementChild.contentEditable="false");this._inContentEditMode=a};a.prototype.updateAsync=function(a){return __awaiter$$module$src$api$apps$sd_controls$parameters_components$FileParameterComponent(this,void 0,void 0,function(){var b,c;return __generator$$module$src$api$apps$sd_controls$parameters_components$FileParameterComponent(this,
   function(d){switch(d.label){case 0:b=""!=a?a.item(0):"",c=null,d.label=1;case 1:return d.trys.push([1,3,4,5]),[4,this._api.parameters.updateAsync({id:this._parameter.id,value:b})];case 2:return c=d.sent(),[3,5];case 3:return d.sent(),this.uploadError(),[3,5];case 4:return[2,Promise.resolve(c)];case 5:return[2]}})})};a.prototype.uploadError=function(){this.label.innerHTML="upload failed";this.label.classList.add("uk-text-danger")};return a}(module$src$api$apps$sd_controls$parameters_components$BaseParameterComponent.default.BaseParameterComponent);var module$src$api$apps$sd_controls$parameters_components$BooleanInputParameterComponent={default:{}},__extends$$module$src$api$apps$sd_controls$parameters_components$BooleanInputParameterComponent=this&&module$src$api$apps$sd_controls$parameters_components$BooleanInputParameterComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return b(a,c)};
   return function(a,c){function d(){this.constructor=a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$parameters_components$BooleanInputParameterComponent.default,"__esModule",{value:!0});
   var BaseParameterComponent_1$$module$src$api$apps$sd_controls$parameters_components$BooleanInputParameterComponent=module$src$api$apps$sd_controls$parameters_components$BaseParameterComponent.default,BooleanInputCustomComponent_1$$module$src$api$apps$sd_controls$parameters_components$BooleanInputParameterComponent=module$src$api$apps$sd_controls$custom_components$BooleanInputCustomComponent.default;
   module$src$api$apps$sd_controls$parameters_components$BooleanInputParameterComponent.default.BooleanInputParameterComponent=function(b){function a(a,d,e,g,h,f){void 0===f&&(f=!1);a=b.call(this,a,d,e,new module$src$api$apps$sd_controls$custom_components$BooleanInputCustomComponent.default.BooleanInputCustomComponent(h.id,{name:h.name,type:h.elementType,title:h.note,value:h.defval,order:h.order},g,d,e),h,f)||this;a._component.parameterDefinition.update=a.updateAsync.bind(a);return a}__extends$$module$src$api$apps$sd_controls$parameters_components$BooleanInputParameterComponent(a,
   b);Object.defineProperty(a.prototype,"children",{get:function(){return this._component.children},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hidden",{get:function(){return this._component.hidden},set:function(a){this._component.hidden=a;if(this._editMode){if(this.inputComponent){var b=this._component;a?b.boolContainer.classList.add("sdv-hidden"):b.boolContainer.classList.remove("sdv-hidden")}}else a&&this.destroy()},enumerable:!0,configurable:!0});return a}(module$src$api$apps$sd_controls$parameters_components$BaseParameterComponent.default.BaseParameterComponent);var module$src$api$apps$sd_controls$parameters_components$ButtonParameterComponent={default:{}},__extends$$module$src$api$apps$sd_controls$parameters_components$ButtonParameterComponent=this&&module$src$api$apps$sd_controls$parameters_components$ButtonParameterComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return b(a,c)};return function(a,
   c){function d(){this.constructor=a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__awaiter$$module$src$api$apps$sd_controls$parameters_components$ButtonParameterComponent=this&&module$src$api$apps$sd_controls$parameters_components$ButtonParameterComponent.default.__awaiter||function(b,a,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,h){function g(a){try{l(d.next(a))}catch(n){h(n)}}function k(a){try{l(d["throw"](a))}catch(n){h(n)}}
   function l(a){a.done?c(a.value):e(a.value).then(g,k)}l((d=d.apply(b,a||[])).next())})},__generator$$module$src$api$apps$sd_controls$parameters_components$ButtonParameterComponent=this&&module$src$api$apps$sd_controls$parameters_components$ButtonParameterComponent.default.__generator||function(b,a){function c(a){return function(b){return d([a,b])}}function d(c){if(g)throw new TypeError("Generator is already executing.");for(;e;)try{if(g=1,h&&(f=c[0]&2?h["return"]:c[0]?h["throw"]||((f=h["return"])&&
   f.call(h),0):h.next)&&!(f=f.call(h,c[1])).done)return f;if(h=0,f)c=[c[0]&2,f.value];switch(c[0]){case 0:case 1:f=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++;h=c[1];c=[0];continue;case 7:c=e.ops.pop();e.trys.pop();continue;default:if(!(f=e.trys,f=0<f.length&&f[f.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!f||c[1]>f[0]&&c[1]<f[3]))e.label=c[1];else if(6===c[0]&&e.label<f[1])e.label=f[1],f=c;else if(f&&e.label<f[2])e.label=f[2],e.ops.push(c);else{f[2]&&e.ops.pop();
   e.trys.pop();continue}}c=a.call(b,e)}catch(m){c=[6,m],h=0}finally{g=f=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},g,h,f,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k};Object.defineProperty(module$src$api$apps$sd_controls$parameters_components$ButtonParameterComponent.default,"__esModule",{value:!0});
   var BaseParameterComponent_1$$module$src$api$apps$sd_controls$parameters_components$ButtonParameterComponent=module$src$api$apps$sd_controls$parameters_components$BaseParameterComponent.default,ButtonCustomComponent_1$$module$src$api$apps$sd_controls$parameters_components$ButtonParameterComponent=module$src$api$apps$sd_controls$custom_components$ButtonCustomComponent.default;
   module$src$api$apps$sd_controls$parameters_components$ButtonParameterComponent.default.ButtonParameterComponent=function(b){function a(a,d,e,g,h,f){void 0===f&&(f=!1);var c=b.call(this,a,d,e,new module$src$api$apps$sd_controls$custom_components$ButtonCustomComponent.default.ButtonCustomComponent(h.id,{name:h.name,type:h.elementType,title:h.note,value:h.defval,order:h.order},g,d,h.isParameter?e:null),h,f)||this;c._sdClass="sd-control-button";c._component.parameterDefinition.update=function(a){return __awaiter$$module$src$api$apps$sd_controls$parameters_components$ButtonParameterComponent(c,
   void 0,void 0,function(){var b,c;return __generator$$module$src$api$apps$sd_controls$parameters_components$ButtonParameterComponent(this,function(d){switch(d.label){case 0:if(!h.isParameter)return[3,1];this.updateAsync(a);return[3,3];case 1:e.execute();b=[];for(c in module$src$api$apps$sd_controls$parameters_components$BaseParameterComponent.default.BaseParameterComponent.parametersPromises)b.push(module$src$api$apps$sd_controls$parameters_components$BaseParameterComponent.default.BaseParameterComponent.parametersPromises[c]);
   return[4,Promise.all(b)];case 2:d.sent(),this.updateAsync(a),d.label=3;case 3:return[2]}})})};return c}__extends$$module$src$api$apps$sd_controls$parameters_components$ButtonParameterComponent(a,b);Object.defineProperty(a.prototype,"name",{get:function(){return this._parameter.name},set:function(a){this._parameter.name=a;this.inputComponent.firstElementChild.innerHTML=a},enumerable:!0,configurable:!0});a.prototype.setEditable=function(a){var b=this;a?(this.inputComponent.classList.remove(this._sdClass),
   this.inputComponent.addEventListener("input",function(a){b._wasEdited=!0;b._newName=a.target.innerText}),this.inputComponent.firstElementChild.contentEditable="true",this._component.parameterDefinition.update=null):(this.inputComponent.classList.add(this._sdClass),this.inputComponent.firstElementChild.contentEditable="false",this._component.parameterDefinition.update=this.updateAsync.bind(this));this._inContentEditMode=a};return a}(module$src$api$apps$sd_controls$parameters_components$BaseParameterComponent.default.BaseParameterComponent);var module$src$api$apps$sd_controls$parameters_components$ColorParameterComponent={default:{}},__extends$$module$src$api$apps$sd_controls$parameters_components$ColorParameterComponent=this&&module$src$api$apps$sd_controls$parameters_components$ColorParameterComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return b(a,c)};return function(a,
   c){function d(){this.constructor=a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$parameters_components$ColorParameterComponent.default,"__esModule",{value:!0});
   var BaseParameterComponent_1$$module$src$api$apps$sd_controls$parameters_components$ColorParameterComponent=module$src$api$apps$sd_controls$parameters_components$BaseParameterComponent.default,ColorCustomComponent_1$$module$src$api$apps$sd_controls$parameters_components$ColorParameterComponent=module$src$api$apps$sd_controls$custom_components$ColorCustomComponent.default;
   module$src$api$apps$sd_controls$parameters_components$ColorParameterComponent.default.ColorParameterComponent=function(b){function a(a,d,e,g,h,f,k,l){void 0===k&&(k=!1);void 0===l&&(l=!1);a=b.call(this,a,d,e,new module$src$api$apps$sd_controls$custom_components$ColorCustomComponent.default.ColorCustomComponent(h.id,{name:h.name,type:h.elementType,title:h.note,value:h.defval,order:h.order},g,d,e,l,f,k),h,k)||this;a._component.parameterDefinition.update=a.updateAsync.bind(a);return a}__extends$$module$src$api$apps$sd_controls$parameters_components$ColorParameterComponent(a,
   b);Object.defineProperty(a.prototype,"hidden",{get:function(){return this._component.hidden},set:function(a){this._component.hidden=a;if(this._editMode){this.inputComponent&&(a?this.inputComponent.classList.add("sdv-hidden"):this.inputComponent.classList.remove("sdv-hidden"));var b=this._component.colorPicker;b&&(a?b.classList.add("sdv-hidden"):b.classList.remove("sdv-hidden"))}else a&&this.destroy()},enumerable:!0,configurable:!0});return a}(module$src$api$apps$sd_controls$parameters_components$BaseParameterComponent.default.BaseParameterComponent);var module$src$api$apps$sd_controls$parameters_components$StringInputParameterComponent={default:{}},__extends$$module$src$api$apps$sd_controls$parameters_components$StringInputParameterComponent=this&&module$src$api$apps$sd_controls$parameters_components$StringInputParameterComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return b(a,c)};
   return function(a,c){function d(){this.constructor=a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$parameters_components$StringInputParameterComponent.default,"__esModule",{value:!0});
   var BaseParameterComponent_1$$module$src$api$apps$sd_controls$parameters_components$StringInputParameterComponent=module$src$api$apps$sd_controls$parameters_components$BaseParameterComponent.default,StringInputCustomComponent_1$$module$src$api$apps$sd_controls$parameters_components$StringInputParameterComponent=module$src$api$apps$sd_controls$custom_components$StringInputCustomComponent.default;
   module$src$api$apps$sd_controls$parameters_components$StringInputParameterComponent.default.StringInputParameterComponent=function(b){function a(a,d,e,g,h,f){void 0===f&&(f=!1);a=b.call(this,a,d,e,new module$src$api$apps$sd_controls$custom_components$StringInputCustomComponent.default.StringInputCustomComponent(h.id,{name:h.name,type:h.elementType,title:h.note,value:h.defval,order:h.order,delay:1E3},g,d,e),h,f)||this;a._component.parameterDefinition.update=a.updateAsync.bind(a);return a}__extends$$module$src$api$apps$sd_controls$parameters_components$StringInputParameterComponent(a,
   b);return a}(module$src$api$apps$sd_controls$parameters_components$BaseParameterComponent.default.BaseParameterComponent);var module$src$api$apps$sd_controls$parameters_components$DropDownParameterComponent={default:{}},__extends$$module$src$api$apps$sd_controls$parameters_components$DropDownParameterComponent=this&&module$src$api$apps$sd_controls$parameters_components$DropDownParameterComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return b(a,c)};return function(a,
   c){function d(){this.constructor=a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__awaiter$$module$src$api$apps$sd_controls$parameters_components$DropDownParameterComponent=this&&module$src$api$apps$sd_controls$parameters_components$DropDownParameterComponent.default.__awaiter||function(b,a,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,h){function g(a){try{l(d.next(a))}catch(n){h(n)}}function k(a){try{l(d["throw"](a))}catch(n){h(n)}}
   function l(a){a.done?c(a.value):e(a.value).then(g,k)}l((d=d.apply(b,a||[])).next())})},__generator$$module$src$api$apps$sd_controls$parameters_components$DropDownParameterComponent=this&&module$src$api$apps$sd_controls$parameters_components$DropDownParameterComponent.default.__generator||function(b,a){function c(a){return function(b){return d([a,b])}}function d(c){if(g)throw new TypeError("Generator is already executing.");for(;e;)try{if(g=1,h&&(f=c[0]&2?h["return"]:c[0]?h["throw"]||((f=h["return"])&&
   f.call(h),0):h.next)&&!(f=f.call(h,c[1])).done)return f;if(h=0,f)c=[c[0]&2,f.value];switch(c[0]){case 0:case 1:f=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++;h=c[1];c=[0];continue;case 7:c=e.ops.pop();e.trys.pop();continue;default:if(!(f=e.trys,f=0<f.length&&f[f.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!f||c[1]>f[0]&&c[1]<f[3]))e.label=c[1];else if(6===c[0]&&e.label<f[1])e.label=f[1],f=c;else if(f&&e.label<f[2])e.label=f[2],e.ops.push(c);else{f[2]&&e.ops.pop();
   e.trys.pop();continue}}c=a.call(b,e)}catch(m){c=[6,m],h=0}finally{g=f=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},g,h,f,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k};Object.defineProperty(module$src$api$apps$sd_controls$parameters_components$DropDownParameterComponent.default,"__esModule",{value:!0});
   var BaseParameterComponent_1$$module$src$api$apps$sd_controls$parameters_components$DropDownParameterComponent=module$src$api$apps$sd_controls$parameters_components$BaseParameterComponent.default,DropdownCustomComponent_1$$module$src$api$apps$sd_controls$parameters_components$DropDownParameterComponent=module$src$api$apps$sd_controls$custom_components$DropdownCustomComponent.default;
   module$src$api$apps$sd_controls$parameters_components$DropDownParameterComponent.default.DropdownParameterComponent=function(b){function a(a,d,e,g,h,f){void 0===f&&(f=!1);a=b.call(this,a,d,e,new module$src$api$apps$sd_controls$custom_components$DropdownCustomComponent.default.DropdownCustomComponent(h.id,{name:h.name,type:h.elementType,title:h.note,value:h.choices[Number(h.defval)],choices:h.choices,order:h.order},g,d,e),h,f)||this;a._component.parameterDefinition.update=a.updateAsync.bind(a);return a}
   __extends$$module$src$api$apps$sd_controls$parameters_components$DropDownParameterComponent(a,b);a.prototype.updateAsync=function(a){return __awaiter$$module$src$api$apps$sd_controls$parameters_components$DropDownParameterComponent(this,void 0,void 0,function(){var b,c;return __generator$$module$src$api$apps$sd_controls$parameters_components$DropDownParameterComponent(this,function(d){switch(d.label){case 0:return b=this._parameter.choices.indexOf(a),this.value=a,[4,this._api.parameters.updateAsync({id:this._parameter.id,
   value:b})];case 1:return c=d.sent(),this.value=a,[2,Promise.resolve(c)]}})})};return a}(module$src$api$apps$sd_controls$parameters_components$BaseParameterComponent.default.BaseParameterComponent);var module$src$api$apps$sd_controls$parameters_components$ChecklistParameterComponent={default:{}},__extends$$module$src$api$apps$sd_controls$parameters_components$ChecklistParameterComponent=this&&module$src$api$apps$sd_controls$parameters_components$ChecklistParameterComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return b(a,c)};return function(a,
   c){function d(){this.constructor=a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$parameters_components$ChecklistParameterComponent.default,"__esModule",{value:!0});
   var BaseParameterComponent_1$$module$src$api$apps$sd_controls$parameters_components$ChecklistParameterComponent=module$src$api$apps$sd_controls$parameters_components$BaseParameterComponent.default,ChecklistCustomComponent_1$$module$src$api$apps$sd_controls$parameters_components$ChecklistParameterComponent=module$src$api$apps$sd_controls$custom_components$ChecklistCustomComponent.default;
   module$src$api$apps$sd_controls$parameters_components$ChecklistParameterComponent.default.ChecklistParameterComponent=function(b){function a(a,d,e,g,h,f){void 0===f&&(f=!1);a=b.call(this,a,d,e,new module$src$api$apps$sd_controls$custom_components$ChecklistCustomComponent.default.ChecklistCustomComponent(h.id,{name:h.name,type:h.elementType,title:h.note,value:h.defval?h.defval.split(",").map(function(a){return h.choices[a]}):[],choices:h.choices,order:h.order},g,d,e),h,f)||this;a._component.parameterDefinition.update=
   a.updateAsync.bind(a);return a}__extends$$module$src$api$apps$sd_controls$parameters_components$ChecklistParameterComponent(a,b);Object.defineProperty(a.prototype,"value",{get:function(){return this._component.value},set:function(a){var b=this;this._component.value=a.map(function(a){return b._parameter.choices[a]})},enumerable:!0,configurable:!0});a.prototype.update=function(a){var b=this;a=a.map(function(a){return b._parameter.choices.indexOf(a)});this._api.parameters.updateAsync({id:this._parameter.id,
   value:a})};return a}(module$src$api$apps$sd_controls$parameters_components$BaseParameterComponent.default.BaseParameterComponent);var module$src$api$apps$sd_controls$settings_components$DropdownSettingComponent={default:{}},__extends$$module$src$api$apps$sd_controls$settings_components$DropdownSettingComponent=this&&module$src$api$apps$sd_controls$settings_components$DropdownSettingComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return b(a,c)};return function(a,c){function d(){this.constructor=
   a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$settings_components$DropdownSettingComponent.default,"__esModule",{value:!0});var BaseSettingComponent_1$$module$src$api$apps$sd_controls$settings_components$DropdownSettingComponent=module$src$api$apps$sd_controls$settings_components$BaseSettingComponent.default;
   module$src$api$apps$sd_controls$settings_components$DropdownSettingComponent.default.DropdownSettingComponent=function(b){function a(a,d,e,g){e=b.call(this,a,d,g.createUserDefinedParameter(d,e,!1))||this;e.value=a.getSetting(d.setting);return e}__extends$$module$src$api$apps$sd_controls$settings_components$DropdownSettingComponent(a,b);return a}(module$src$api$apps$sd_controls$settings_components$BaseSettingComponent.default.BaseSettingComponent);var module$src$api$apps$sd_controls$settings_components$SliderSettingComponent={default:{}},__extends$$module$src$api$apps$sd_controls$settings_components$SliderSettingComponent=this&&module$src$api$apps$sd_controls$settings_components$SliderSettingComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return b(a,c)};return function(a,c){function d(){this.constructor=
   a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$settings_components$SliderSettingComponent.default,"__esModule",{value:!0});var BaseSettingComponent_1$$module$src$api$apps$sd_controls$settings_components$SliderSettingComponent=module$src$api$apps$sd_controls$settings_components$BaseSettingComponent.default;
   module$src$api$apps$sd_controls$settings_components$SliderSettingComponent.default.SliderSettingComponent=function(b){function a(a,d,e,g){var c=b.call(this,a,d,g.createUserDefinedParameter(d,e,!1))||this;c._settingDefinition.update=function(a){return c._api.updateSettingAsync(c._settingDefinition.setting,Number(a))};return c}__extends$$module$src$api$apps$sd_controls$settings_components$SliderSettingComponent(a,b);return a}(module$src$api$apps$sd_controls$settings_components$BaseSettingComponent.default.BaseSettingComponent);var module$src$api$apps$sd_controls$settings_components$CheckboxSettingComponent={default:{}},__extends$$module$src$api$apps$sd_controls$settings_components$CheckboxSettingComponent=this&&module$src$api$apps$sd_controls$settings_components$CheckboxSettingComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return b(a,c)};return function(a,c){function d(){this.constructor=
   a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$settings_components$CheckboxSettingComponent.default,"__esModule",{value:!0});var BaseSettingComponent_1$$module$src$api$apps$sd_controls$settings_components$CheckboxSettingComponent=module$src$api$apps$sd_controls$settings_components$BaseSettingComponent.default;
   module$src$api$apps$sd_controls$settings_components$CheckboxSettingComponent.default.CheckboxSettingComponent=function(b){function a(a,d,e,g){return b.call(this,a,d,g.createUserDefinedParameter(d,e,!1))||this}__extends$$module$src$api$apps$sd_controls$settings_components$CheckboxSettingComponent(a,b);return a}(module$src$api$apps$sd_controls$settings_components$BaseSettingComponent.default.BaseSettingComponent);var module$src$api$apps$sd_controls$settings_components$ColorSettingComponent={default:{}},__extends$$module$src$api$apps$sd_controls$settings_components$ColorSettingComponent=this&&module$src$api$apps$sd_controls$settings_components$ColorSettingComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return b(a,c)};return function(a,c){function d(){this.constructor=
   a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$settings_components$ColorSettingComponent.default,"__esModule",{value:!0});var BaseSettingComponent_1$$module$src$api$apps$sd_controls$settings_components$ColorSettingComponent=module$src$api$apps$sd_controls$settings_components$BaseSettingComponent.default;
   module$src$api$apps$sd_controls$settings_components$ColorSettingComponent.default.ColorSettingComponent=function(b){function a(a,d,e,g){return b.call(this,a,d,g.createUserDefinedParameter(d,e,!1))||this}__extends$$module$src$api$apps$sd_controls$settings_components$ColorSettingComponent(a,b);return a}(module$src$api$apps$sd_controls$settings_components$BaseSettingComponent.default.BaseSettingComponent);var module$src$api$apps$sd_controls$settings_components$lights$LoadLightSceneDropdownSettingComponent={default:{}},__extends$$module$src$api$apps$sd_controls$settings_components$lights$LoadLightSceneDropdownSettingComponent=this&&module$src$api$apps$sd_controls$settings_components$lights$LoadLightSceneDropdownSettingComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&
   (a[c]=b[c])};return b(a,c)};return function(a,c){function d(){this.constructor=a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$settings_components$lights$LoadLightSceneDropdownSettingComponent.default,"__esModule",{value:!0});var DropdownSettingComponent_1$$module$src$api$apps$sd_controls$settings_components$lights$LoadLightSceneDropdownSettingComponent=module$src$api$apps$sd_controls$settings_components$DropdownSettingComponent.default;
   module$src$api$apps$sd_controls$settings_components$lights$LoadLightSceneDropdownSettingComponent.default.LoadLightSceneDropdownSettingComponent=function(b){function a(a,d,e,g,h,f){var c=b.call(this,a,{id:"lights.lightScene",setting:"lights.lightScene",choices:a.scene.lights.getAllLightScenes().data,order:d.order,groupId:d.groupId,name:"Load Light Scene",title:"Load a saved light configuration.",type:"dropdown"},e,g)||this;c._factory=g;c._controlsEvents=h;c._sdControlSettings=f;c._createInitalLightsCalled=
   !1;c.parameterDefinition.update=function(a){return c.customUpdate(a)};c._controlsEvents.on("light.scene.created",function(){return c.onLightsSceneUpdated()});c._api.addEventListener(c._api.EVENTTYPE.SETTINGS_UPDATE,function(a){if("lights.lightScenes"===a.settings.key)c.onLightsSceneUpdated()});return c}__extends$$module$src$api$apps$sd_controls$settings_components$lights$LoadLightSceneDropdownSettingComponent(a,b);a.prototype.createLightElements=function(){if(!this._createInitalLightsCalled){this._createInitalLightsCalled=
   !0;this._controlsEvents.trigger("clear.lights");var a=this._api.scene.lights.getAllLightScenes().data;this.parameterDefinition.choices=a;var b=this._api.scene.lights.getLightScene().data.id;this._component.updateOptions(a,b);this.createLights(b)}};a.prototype.customUpdate=function(a){this._controlsEvents.trigger("clear.lights");this.createLights(a)};a.prototype.createLights=function(a){this.parameterDefinition.choices.includes(a)?(this._api.scene.lights.setLightSceneFromID(a).data,a=this._api.scene.lights.getLightScene(a).data.lights):
   a=this._api.scene.lights.getLightScene().data.lights;for(var b in a){var c=a[b],g=this._sdControlSettings.createLightSetting(c);this._sdControlSettings.settings[c.id]=g;this._factory.createShapeDiverSetting(g,this._factory.groups.getGroupByIndex(g.groupId));this._controlsEvents.trigger("add",this)}};a.prototype.onLightsSceneUpdated=function(){var a=this._api.scene.lights.getAllLightScenes().data,b=this._api.scene.lights.getLightScene().data.id;this._component.updateOptions(a,b)};return a}(module$src$api$apps$sd_controls$settings_components$DropdownSettingComponent.default.DropdownSettingComponent);var module$src$api$apps$sd_controls$settings_components$lights$LightDefinitionSettingComponent={default:{}},__extends$$module$src$api$apps$sd_controls$settings_components$lights$LightDefinitionSettingComponent=this&&module$src$api$apps$sd_controls$settings_components$lights$LightDefinitionSettingComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};
   return b(a,c)};return function(a,c){function d(){this.constructor=a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$settings_components$lights$LightDefinitionSettingComponent.default,"__esModule",{value:!0});var BaseCustomComponent_1$$module$src$api$apps$sd_controls$settings_components$lights$LightDefinitionSettingComponent=module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default;
   module$src$api$apps$sd_controls$settings_components$lights$LightDefinitionSettingComponent.default.LightDefinitionSettingComponent=function(b){function a(a,d,e,g,h,f,k){e=b.call(this,"group",d.id,d,e,g,h,!1)||this;e._api=a;e._controlsFactory=f;e._dragControls=k;e._accordionType="custom-parameter";e._isLightUpdateRegistered=!1;e._removeId=d.id+"-multiple-remove";e._rowId=e.id+"-controlmenu-row";e.createElement();e.component.label.innerHTML='<span id="'+e._removeId+'" uk-icon="icon: close; ratio: 0.8;"></span>'+
   e._parameterDefinition.name;e.createInputEvents();return e}__extends$$module$src$api$apps$sd_controls$settings_components$lights$LightDefinitionSettingComponent(a,b);Object.defineProperty(a.prototype,"component",{get:function(){return this},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"groupId",{get:function(){return this.parameterDefinition.groupId},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hidden",{get:function(){return!1},enumerable:!0,configurable:!0});
   Object.defineProperty(a.prototype,"id",{get:function(){return this._parameterDefinition.name},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"parameterDefinition",{get:function(){return this._parameterDefinition},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){return 4},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"type",{get:function(){return"light_definition"},enumerable:!0,configurable:!0});a.prototype.open=function(){this._parametersEl.classList.contains("uk-open")||
   UIkit.accordion(this._parametersEl.parentNode).toggle(1)};a.prototype.close=function(){this._parametersEl.classList.contains("uk-open")&&UIkit.accordion(this._parametersEl.parentNode).toggle(0)};a.prototype.createInput=function(){var a=this;this._inputComponent=this._domManager.createDomElement("div",null,this._parametersEl,["uk-accordion-content","uk-margin-remove"],{"uk-grid":""});this.parameterDefinition.parameters.forEach(function(b){b=a._controlsFactory.createShapeDiverSetting(b,a._inputComponent);
   a.children.push(b);b.label&&(b.label.classList.remove("uk-text-uppercase"),b.label.classList.add("uk-text-capitalize"))})};a.prototype.createInputEvents=function(){var a=this;this._domManager.setDomEventListener(this._ulElem,"click",null,this.onClick.bind(this));this._domManager.setDomEventListener(this._ulElem,"click",10,this.update.bind(this));this._domManager.setDomEventListener(document.getElementById(this._removeId),"click",null,function(){return a.remove()})};a.prototype.createLabel=function(){this._label=
   this._domManager.createDomElement("a",this.id+"-a",this._parametersEl,"uk-accordion-title uk-width-expand uk-form-label uk-text-uppercase uk-text-small uk-padding-small sdv-control-panel-row-border".split(" "));this._label.innerHTML=this._parameterDefinition.name;this._parameterDefinition.title&&this._label.setAttribute("title",this._parameterDefinition.title)};a.prototype.createRow=function(){this._row=this._domManager.createDomElement("row",this._rowId,this._parent,["uk-margin-remove","uk-padding-remove",
   "sd-max-width-1"],{"uk-grid":'margin: "";'});this._ulElem=this._domManager.createDomElement("ul",null,this._row,["uk-width-1-1"],{"uk-accordion":"multiple: false"});this._parametersEl=this._domManager.createDomElement("li",null,this._ulElem,["jq-accordion-control-li"],{"data-setting-type":this._accordionType})};a.prototype.update=function(a,b){};a.prototype.closeOthers=function(){var a=this;Array.from(document.getElementsByClassName("jq-accordion-control-li")).forEach(function(b){b.getAttribute("data-setting-type")!=
   a._accordionType||a._parametersEl.isSameNode(b)||b.classList.contains("uk-open")&&UIkit.accordion(b.parentNode).toggle(0)})};a.prototype.findChangedProperties=function(a){var b=this,c=[];Object.keys(a.properties).forEach(function(d){var e=a.properties[d];if("object"===typeof e)for(var g=Object.keys(e),k=0;k<g.length;k++){var l=g[k];if(b.parameterDefinition.lightDef.properties[d]&&e[l]!=b.parameterDefinition.lightDef.properties[d][l]){c.push(d);break}}else e!=b.parameterDefinition.lightDef.properties[d]&&
   c.push(d)});return c};a.prototype.onClick=function(){this.closeOthers();this._dragControls.makeLightDraggable(this.parameterDefinition.lightDef.id);this.registerLightUpdate();this.updateInputElements(this._api.scene.lights.getLight(this.parameterDefinition.lightDef.id).data)};a.prototype.registerLightUpdate=function(){var a=this;if(!this._isLightUpdateRegistered)this._dragControls.onLightUpdate(this.parameterDefinition.lightDef.id,function(b){a.updateInputElements(b);return b});this._isLightUpdateRegistered=
   !0};a.prototype.updateInputElements=function(a){var b=this;this.findChangedProperties(a).forEach(function(c){b.parameterDefinition.lightDef.properties[c]=a.properties[c];b.children.find(function(a){return a.id===c}).value=a.properties[c]})};a.prototype.remove=function(){this.destroy();this._api.scene.lights.removeLight(this.parameterDefinition.lightDef.id)};return a}(module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default.BaseCustomComponent);var module$src$api$apps$sd_controls$settings_components$GroupSettingComponent={default:{}},__extends$$module$src$api$apps$sd_controls$settings_components$GroupSettingComponent=this&&module$src$api$apps$sd_controls$settings_components$GroupSettingComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return b(a,c)};return function(a,c){function d(){this.constructor=
   a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$settings_components$GroupSettingComponent.default,"__esModule",{value:!0});var BaseSettingComponent_1$$module$src$api$apps$sd_controls$settings_components$GroupSettingComponent=module$src$api$apps$sd_controls$settings_components$BaseSettingComponent.default;
   module$src$api$apps$sd_controls$settings_components$GroupSettingComponent.default.GroupSettingComponent=function(b){function a(a,d,e,g){return b.call(this,a,d,g.createUserDefinedParameter(d,e,!1))||this}__extends$$module$src$api$apps$sd_controls$settings_components$GroupSettingComponent(a,b);return a}(module$src$api$apps$sd_controls$settings_components$BaseSettingComponent.default.BaseSettingComponent);var module$src$api$apps$sd_controls$settings_components$lights$BaseLightPropertySettingComponent={default:{}},__extends$$module$src$api$apps$sd_controls$settings_components$lights$BaseLightPropertySettingComponent=this&&module$src$api$apps$sd_controls$settings_components$lights$BaseLightPropertySettingComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=
   b[c])};return b(a,c)};return function(a,c){function d(){this.constructor=a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$settings_components$lights$BaseLightPropertySettingComponent.default,"__esModule",{value:!0});var BaseSettingComponent_1$$module$src$api$apps$sd_controls$settings_components$lights$BaseLightPropertySettingComponent=module$src$api$apps$sd_controls$settings_components$BaseSettingComponent.default;
   module$src$api$apps$sd_controls$settings_components$lights$BaseLightPropertySettingComponent.default.BaseLightPropertySettingComponent=function(b){function a(a,d,e,g){a=b.call(this,a,d,e)||this;a._dragControls=g;return a}__extends$$module$src$api$apps$sd_controls$settings_components$lights$BaseLightPropertySettingComponent(a,b);Object.defineProperty(a.prototype,"component",{get:function(){return this._component},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"lightId",{get:function(){return this._component.id},
   enumerable:!0,configurable:!0});a.prototype.getLightDef=function(){return this._api.scene.lights.getLight(this._settingDefinition.lightDef.id).data};return a}(module$src$api$apps$sd_controls$settings_components$BaseSettingComponent.default.BaseSettingComponent);var module$src$api$apps$sd_controls$settings_components$lights$SliderLightPropertySettingComponent={default:{}},__extends$$module$src$api$apps$sd_controls$settings_components$lights$SliderLightPropertySettingComponent=this&&module$src$api$apps$sd_controls$settings_components$lights$SliderLightPropertySettingComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&
   (a[c]=b[c])};return b(a,c)};return function(a,c){function d(){this.constructor=a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$settings_components$lights$SliderLightPropertySettingComponent.default,"__esModule",{value:!0});var BaseLightPropertySettingComponent_1$$module$src$api$apps$sd_controls$settings_components$lights$SliderLightPropertySettingComponent=module$src$api$apps$sd_controls$settings_components$lights$BaseLightPropertySettingComponent.default;
   module$src$api$apps$sd_controls$settings_components$lights$SliderLightPropertySettingComponent.default.SliderLightPropertySettingComponent=function(b){function a(a,d,e,g,h){var c=b.call(this,a,d,g.createShapeDiverSetting({id:d.id,name:d.name,type:"slider",min:d.min,max:d.max,value:d.value,order:d.order,groupId:d.groupId,lightDef:d.lightDef,step:d.step},e),h)||this;c.inputComponent.value=c.getLightDef().properties[d.name];c._component.parameterDefinition.update=function(a){var b=c.getLightDef();b.properties[c.id]=
   Number(a);c._api.scene.lights.updateLight(b)};return c}__extends$$module$src$api$apps$sd_controls$settings_components$lights$SliderLightPropertySettingComponent(a,b);return a}(module$src$api$apps$sd_controls$settings_components$lights$BaseLightPropertySettingComponent.default.BaseLightPropertySettingComponent);var module$src$api$apps$sd_controls$settings_components$lights$ColorLightPropertySettingComponent={default:{}},__extends$$module$src$api$apps$sd_controls$settings_components$lights$ColorLightPropertySettingComponent=this&&module$src$api$apps$sd_controls$settings_components$lights$ColorLightPropertySettingComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&
   (a[c]=b[c])};return b(a,c)};return function(a,c){function d(){this.constructor=a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$settings_components$lights$ColorLightPropertySettingComponent.default,"__esModule",{value:!0});var BaseLightPropertySettingComponent_1$$module$src$api$apps$sd_controls$settings_components$lights$ColorLightPropertySettingComponent=module$src$api$apps$sd_controls$settings_components$lights$BaseLightPropertySettingComponent.default;
   module$src$api$apps$sd_controls$settings_components$lights$ColorLightPropertySettingComponent.default.ColorLightPropertySettingComponent=function(b){function a(a,d,e,g,h){var c=b.call(this,a,d,g.createShapeDiverSetting({id:d.id,name:d.name,type:"color",value:d.value,order:d.order,groupId:d.groupId,lightDef:d.lightDef},e),h)||this;c._component.parameterDefinition.update=function(a){var b=c.getLightDef();b.properties[c.id]=a;c._api.scene.lights.updateLight(b)};return c}__extends$$module$src$api$apps$sd_controls$settings_components$lights$ColorLightPropertySettingComponent(a,
   b);return a}(module$src$api$apps$sd_controls$settings_components$lights$BaseLightPropertySettingComponent.default.BaseLightPropertySettingComponent);var module$src$api$apps$sd_controls$settings_components$lights$Vector3LightPropertySettingComponent={default:{}},__extends$$module$src$api$apps$sd_controls$settings_components$lights$Vector3LightPropertySettingComponent=this&&module$src$api$apps$sd_controls$settings_components$lights$Vector3LightPropertySettingComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&
   (a[c]=b[c])};return b(a,c)};return function(a,c){function d(){this.constructor=a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$settings_components$lights$Vector3LightPropertySettingComponent.default,"__esModule",{value:!0});var BaseLightPropertySettingComponent_1$$module$src$api$apps$sd_controls$settings_components$lights$Vector3LightPropertySettingComponent=module$src$api$apps$sd_controls$settings_components$lights$BaseLightPropertySettingComponent.default;
   module$src$api$apps$sd_controls$settings_components$lights$Vector3LightPropertySettingComponent.default.Vector3LightPropertySettingComponent=function(b){function a(a,d,e,g,h){var c=b.call(this,a,d,g.createShapeDiverSetting({id:d.id,name:d.name,type:"vector3",value:d.value,order:d.order,groupId:d.groupId,lightDef:d.lightDef},e),h)||this;c._component.parameterDefinition.update=function(a){var b=c.getLightDef();b.properties[c.id].x=a.x;b.properties[c.id].y=a.y;b.properties[c.id].z=a.z;c._api.scene.lights.updateLight(b);
   c._dragControls.updateLight(b)};c._dragControls.onLightUpdate(c.getLightDef().id,function(a){c.value=a.properties[c.id];return a});return c}__extends$$module$src$api$apps$sd_controls$settings_components$lights$Vector3LightPropertySettingComponent(a,b);Object.defineProperty(a.prototype,"value",{get:function(){var a=this.component.component;return{x:a.xInput.value,y:a.yInput.value,z:a.zInput.value}},set:function(a){var b=this.component.component;b.xInput.value=a.x.toString();b.yInput.value=a.y.toString();
   b.zInput.value=a.z.toString()},enumerable:!0,configurable:!0});return a}(module$src$api$apps$sd_controls$settings_components$lights$BaseLightPropertySettingComponent.default.BaseLightPropertySettingComponent);var module$src$api$apps$sd_controls$settings_components$Vector3SettingComponent={default:{}},__extends$$module$src$api$apps$sd_controls$settings_components$Vector3SettingComponent=this&&module$src$api$apps$sd_controls$settings_components$Vector3SettingComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return b(a,c)};return function(a,c){function d(){this.constructor=
   a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$settings_components$Vector3SettingComponent.default,"__esModule",{value:!0});var BaseSettingComponent_1$$module$src$api$apps$sd_controls$settings_components$Vector3SettingComponent=module$src$api$apps$sd_controls$settings_components$BaseSettingComponent.default;
   module$src$api$apps$sd_controls$settings_components$Vector3SettingComponent.default.Vector3SettingComponent=function(b){function a(a,d,e,g){return b.call(this,a,d,g.createUserDefinedParameter(d,e,!1))||this}__extends$$module$src$api$apps$sd_controls$settings_components$Vector3SettingComponent(a,b);return a}(module$src$api$apps$sd_controls$settings_components$BaseSettingComponent.default.BaseSettingComponent);var module$src$api$apps$sd_controls$settings_components$lights$CheckboxLightPropertySettingComponent={default:{}},__extends$$module$src$api$apps$sd_controls$settings_components$lights$CheckboxLightPropertySettingComponent=this&&module$src$api$apps$sd_controls$settings_components$lights$CheckboxLightPropertySettingComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&
   (a[c]=b[c])};return b(a,c)};return function(a,c){function d(){this.constructor=a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$settings_components$lights$CheckboxLightPropertySettingComponent.default,"__esModule",{value:!0});var BaseLightPropertySettingComponent_1$$module$src$api$apps$sd_controls$settings_components$lights$CheckboxLightPropertySettingComponent=module$src$api$apps$sd_controls$settings_components$lights$BaseLightPropertySettingComponent.default;
   module$src$api$apps$sd_controls$settings_components$lights$CheckboxLightPropertySettingComponent.default.CheckboxLightPropertySettingComponent=function(b){function a(a,d,e,g,h){var c=b.call(this,a,d,g.createShapeDiverSetting({id:d.id,name:d.name,type:"checkbox",value:d.value,order:d.order,groupId:d.groupId,lightDef:d.lightDef},e),h)||this;c._component.parameterDefinition.update=function(a){var b=c.getLightDef();b.properties[c.id]=a;c._api.scene.lights.updateLight(b)};return c}__extends$$module$src$api$apps$sd_controls$settings_components$lights$CheckboxLightPropertySettingComponent(a,
   b);return a}(module$src$api$apps$sd_controls$settings_components$lights$BaseLightPropertySettingComponent.default.BaseLightPropertySettingComponent);var module$src$api$apps$sd_controls$settings_components$ModalSettingComponent={default:{}},__extends$$module$src$api$apps$sd_controls$settings_components$ModalSettingComponent=this&&module$src$api$apps$sd_controls$settings_components$ModalSettingComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return b(a,c)};return function(a,c){function d(){this.constructor=
   a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$settings_components$ModalSettingComponent.default,"__esModule",{value:!0});var BaseSettingComponent_1$$module$src$api$apps$sd_controls$settings_components$ModalSettingComponent=module$src$api$apps$sd_controls$settings_components$BaseSettingComponent.default;
   module$src$api$apps$sd_controls$settings_components$ModalSettingComponent.default.ModalSettingComponent=function(b){function a(a,d,e,g){a=b.call(this,a,d,g.createUserDefinedParameter(d,e,!1))||this;a._componentFactory=g;return a}__extends$$module$src$api$apps$sd_controls$settings_components$ModalSettingComponent(a,b);return a}(module$src$api$apps$sd_controls$settings_components$BaseSettingComponent.default.BaseSettingComponent);var module$src$api$apps$sd_controls$settings$HTMLSettingsHelper={default:{}};Object.defineProperty(module$src$api$apps$sd_controls$settings$HTMLSettingsHelper.default,"__esModule",{value:!0});module$src$api$apps$sd_controls$settings$HTMLSettingsHelper.default.HTMLSettingsHelper=function(){function b(){}b.createAlert=function(a){return'<div class="uk-alert-danger" uk-alert>\n              <a class="uk-alert-close" uk-close></a>\n              <p>'+a+"</p>\n            </div>"};return b}();var module$src$api$apps$sd_controls$settings_components$lights$AddLightModalSettingComponent={default:{}},__extends$$module$src$api$apps$sd_controls$settings_components$lights$AddLightModalSettingComponent=this&&module$src$api$apps$sd_controls$settings_components$lights$AddLightModalSettingComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};
   return b(a,c)};return function(a,c){function d(){this.constructor=a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$settings_components$lights$AddLightModalSettingComponent.default,"__esModule",{value:!0});
   var ModalSettingComponent_1$$module$src$api$apps$sd_controls$settings_components$lights$AddLightModalSettingComponent=module$src$api$apps$sd_controls$settings_components$ModalSettingComponent.default,HTMLSettingsHelper_1$$module$src$api$apps$sd_controls$settings_components$lights$AddLightModalSettingComponent=module$src$api$apps$sd_controls$settings$HTMLSettingsHelper.default;
   module$src$api$apps$sd_controls$settings_components$lights$AddLightModalSettingComponent.default.AddLightModalSetting=function(b){function a(a,d,e,g,h,f,k){a=b.call(this,a,{type:"modal",id:d.id,order:d.order,name:"Add Light",title:"Add a new light source to the scene.",groupId:d.groupId},e,g)||this;a._parent=e;a._controlsSettings=h;a._events=f;a._shapeDiverDragControls=k;a._modalConfirmId="jq-add-light-modal-confirm";a._typeId="jq-add-light-type";a.component.content=a.getModalString();a.bindLightTypeChangeEvent();
   return a}__extends$$module$src$api$apps$sd_controls$settings_components$lights$AddLightModalSettingComponent(a,b);a.prototype.customUpdate=function(){var a=document.getElementById("jq-add-light-name").value,b=document.getElementById("jq-add-light-alert");a?(b.innerHTML="",b=document.getElementById("jq-add-light-type").value,a=this.resolveNameIfDuplicate(a),this._api.scene.lights.updateLight({id:a,type:this._api.scene.lights.LIGHTTYPE[b],properties:{}}),a=this._api.scene.lights.getLight(a).data,b=
   this._controlsSettings.createLightSetting(a),this._controlsSettings.settings[a.id]=b,b=this._componentFactory.createShapeDiverSetting(b,this._parent),this.component.close(),b.open(),this._shapeDiverDragControls.makeLightDraggableAndZoomAsync(a.id),window.setTimeout(this.setNameFieldAccordingToSelectedType.bind(this),2E3)):b.innerHTML=module$src$api$apps$sd_controls$settings$HTMLSettingsHelper.default.HTMLSettingsHelper.createAlert("Please specify a name for the new light")};a.prototype.bindLightTypeChangeEvent=
   function(){var a=this;this.component.onOpen(function(){return a.setNameFieldAccordingToSelectedType()});this.setNameFieldAccordingToSelectedType();document.getElementById(this._modalConfirmId).onclick=function(){return a.customUpdate()};document.getElementById(this._typeId).onchange=function(){return a.setNameFieldAccordingToSelectedType()}};a.prototype.getModalString=function(){return'\n        <div class="uk-modal-dialog uk-modal-body">\n\n        <h2 class="uk-modal-title">Add Light</h2>\n\n          <form class="uk-form-horizontal" onsubmit="return false"> \n            <div class="uk-margin">\n              <label class="uk-form-label" for="form-horizontal-select">Type:</label>\n              <div class="uk-form-controls">\n                  <select class="uk-select" id="'+
   this._typeId+'">\n                      '+Object.keys(this._api.scene.lights.LIGHTTYPE).map(function(a){return"<option>"+a+"</option>"}).join("")+'\n                  </select>\n              </div>\n            </div>\n            <div class="uk-margin">\n              <label class="uk-form-label" for="form-horizontal-text">Name:</label>\n              <div class="uk-form-controls">\n                  <input id="jq-add-light-name" class="uk-input" type="text" placeholder="type name ...">\n              </div>\n            </div>\n            <p class="uk-text-right">\n              <button class="uk-button uk-button-default uk-modal-close" type="button">Cancel</button>\n              <input id="jq-add-light-modal-confirm" class="uk-button uk-button-default sd-control-button" type="submit" value="save">\n              <div id="jq-add-light-alert">\n\n              </div>\n            </p>\n          </form>\n        </div>'};
   a.prototype.resolveNameIfDuplicate=function(a){if(this._api.scene.lights.getLightScene().data.lights[a]){for(var b=1;this._controlsSettings.settings[a+("_"+b)];)b++;a+="_"+b}return a};a.prototype.setNameFieldAccordingToSelectedType=function(){var a=document.getElementById("jq-add-light-type");document.getElementById("jq-add-light-name").value=this.resolveNameIfDuplicate(a.value)};return a}(module$src$api$apps$sd_controls$settings_components$ModalSettingComponent.default.ModalSettingComponent);var module$src$api$apps$sd_controls$settings_components$lights$SaveLightSceneModalSettingComponent={default:{}},__extends$$module$src$api$apps$sd_controls$settings_components$lights$SaveLightSceneModalSettingComponent=this&&module$src$api$apps$sd_controls$settings_components$lights$SaveLightSceneModalSettingComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&
   (a[c]=b[c])};return b(a,c)};return function(a,c){function d(){this.constructor=a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$settings_components$lights$SaveLightSceneModalSettingComponent.default,"__esModule",{value:!0});
   var ModalSettingComponent_1$$module$src$api$apps$sd_controls$settings_components$lights$SaveLightSceneModalSettingComponent=module$src$api$apps$sd_controls$settings_components$ModalSettingComponent.default,HTMLSettingsHelper_1$$module$src$api$apps$sd_controls$settings_components$lights$SaveLightSceneModalSettingComponent=module$src$api$apps$sd_controls$settings$HTMLSettingsHelper.default;
   module$src$api$apps$sd_controls$settings_components$lights$SaveLightSceneModalSettingComponent.default.SaveLightSceneModalSettingComponent=function(b){function a(a,d,e,g,h,f,k){var c=b.call(this,a,{type:"modal",setting:"scene.add.light",id:d.id,order:d.order,name:"Save Light Scene",title:"Save the current configuration of light sources. Apply settings afterwards to store the configuration in the model.",groupId:d.groupId},e,g)||this;c._parent=e;c._controlsSettings=h;c._events=f;c._shapeDiverDragControls=
   k;c._saveId="jq-add-lights-scene-modal-save";c._confirmId="jq-add-lights-scene-modal-confirm";c._cancelId="jq-add-lights-scene-modal-overwrite-cancel";c._overwriteContent='<label>The scene already exists. Do you want to overwrite it?</label>\n                          <p class="uk-text-right">\n                            <button id="'+c._confirmId+'" data-overwrite="true" class="uk-button uk-button-default sd-control-button" type="button">Yes</button>\n                            <button id="'+c._cancelId+
   '" class="uk-button uk-button-default" type="button">No</button>\n                          </p>';c.component.content=c.createModalContent(c.getNameContent());c.component.onOpen(function(){return c.onModalOpen()});c.bindEvents();return c}__extends$$module$src$api$apps$sd_controls$settings_components$lights$SaveLightSceneModalSettingComponent(a,b);a.prototype.bindEvents=function(){var a=this,b=document.getElementById(this._saveId);b&&(b.onclick=function(){return a.customUpdate()});if(b=document.getElementById(this._confirmId))b.onclick=
   function(){return a.customUpdate()}};a.prototype.bindExistingSceneDropdownChanged=function(){var a=document.getElementById("jq-add-lights-scene-existing");null!==a&&(a.onchange=function(){return document.getElementById("jq-add-lights-scene-name").value=a.value})};a.prototype.createModalContent=function(a){return'<div class="uk-modal-dialog uk-modal-body">\n            <h2 class="uk-modal-title">Save Light Scene</h2>\n\n              <form id="jq-add-lights-scenes-content" class="uk-form-horizontal">\n                '+
   a+'\n              </form>\n              <div id="jq-add-lights-scenes-alert">\n\n              </div>\n            </div>'};a.prototype.customUpdate=function(){var a=this,b,e=null===(b=document.getElementById(this._confirmId))||void 0===b?void 0:b.getAttribute("data-overwrite");b=this._api.scene.lights.getAllLightScenes().data;var g=document.getElementById("jq-add-lights-scene-name");g&&(this._name=g.value);if(!e)if(g=document.getElementById("jq-add-lights-scenes-alert"),this._name){if(this.isDefaultOrLegacyScene(this._name)){g&&
   (g.innerHTML=module$src$api$apps$sd_controls$settings$HTMLSettingsHelper.default.HTMLSettingsHelper.createAlert('Light scene "'+this._name+'" cannot be overriden or saved. Please use another name for light scene'));this.bindEvents();return}g&&(g.innerHTML="")}else{g&&(g.innerHTML=module$src$api$apps$sd_controls$settings$HTMLSettingsHelper.default.HTMLSettingsHelper.createAlert("Please specify a name for the light scene"));this.bindEvents();return}e||!b.some(function(b){return b==a._name})?(this._api.scene.lights.saveLightScene(this._name),
   this._component.close(),document.getElementById("jq-add-lights-scenes-content").innerHTML=this.getNameContent(),this._events.trigger("light.scene.created")):(document.getElementById("jq-add-lights-scenes-content").innerHTML=this._overwriteContent,document.getElementById(this._cancelId).onclick=function(){document.getElementById("jq-add-lights-scenes-content").innerHTML=a.getNameContent()});this.bindEvents()};a.prototype.getNameContent=function(){var a=this,b=this._api.scene.lights.getAllLightScenes().data.filter(function(b){return!a.isDefaultOrLegacyScene(b)}),
   e=this._api.scene.lights.getLightScene().data,g="";0<b.length&&(g='<div class="uk-margin">\n                              <label class="uk-form-label" for="form-horizontal-select">Saved Scenes:</label>\n                              <div class="uk-form-controls">\n                                  <select class="uk-select" id="jq-add-lights-scene-existing">\n                                      '+b.map(function(c){return"<option "+(a.isDefaultOrLegacyScene(c)?"disabled":"")+" "+(b.some(function(a){return a===
   e.id})?"selected":"")+">"+c+"</option>"}).join("")+"\n                                  </select>\n                              </div>\n                            </div>");return g+'\n            <div class="uk-margin">\n              <label class="uk-form-label" for="form-horizontal-text">Save Current Scene As:</label>\n              <div class="uk-form-controls">\n                  <input id="jq-add-lights-scene-name" class="uk-input" type="text" placeholder="type name ...">\n              </div>\n            </div>\n            <p class="uk-text-right">\n              <button class="uk-button uk-button-default uk-modal-close" type="button">Cancel</button>\n              <button id="'+
   this._saveId+'" class="uk-button uk-button-default sd-control-button" type="button">Save</button>\n            </p>'};a.prototype.isDefaultOrLegacyScene=function(a){return"default"===a||"legacy"===a};a.prototype.moveNameIndex=function(a){var b=a.lastIndexOf("_");if(-1<b){var c=a.substr(b+1);if(0==isNaN(c))return c=Number(c),c++,a=a.replace(a.substr(b),""),a+"_"+c}return a+"_1"};a.prototype.onModalOpen=function(){var a=this._api.scene.lights.getLightScene().data,b=this.resolveNameIfDuplicate("scene");
   this._api.scene.lights.getAllLightScenes().data.some(function(b){return b===a.id})&&(b=this.resolveNameIfDuplicate(a.id));var e=document.getElementById("jq-add-lights-scene-name");null!==e&&(e.value=b,b=document.getElementById("jq-add-lights-scene-existing"),null===b||this.isDefaultOrLegacyScene(a.id)||(b.value=a.id));this.bindExistingSceneDropdownChanged();this.bindEvents()};a.prototype.resolveNameIfDuplicate=function(a){var b=this._api.scene.lights.getAllLightScenes().data;if(b.some(function(b){return b==
   a}))for(;b.some(function(b){return b==a});)a=this.moveNameIndex(a);return a};return a}(module$src$api$apps$sd_controls$settings_components$ModalSettingComponent.default.ModalSettingComponent);var module$src$api$apps$sd_controls$settings_components$camera$CameraDropdownSettingComponent={default:{}},__extends$$module$src$api$apps$sd_controls$settings_components$camera$CameraDropdownSettingComponent=this&&module$src$api$apps$sd_controls$settings_components$camera$CameraDropdownSettingComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};
   return b(a,c)};return function(a,c){function d(){this.constructor=a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$settings_components$camera$CameraDropdownSettingComponent.default,"__esModule",{value:!0});
   var DropdownSettingComponent_1$$module$src$api$apps$sd_controls$settings_components$camera$CameraDropdownSettingComponent=module$src$api$apps$sd_controls$settings_components$DropdownSettingComponent.default,SDControlsSettings_1$$module$src$api$apps$sd_controls$settings_components$camera$CameraDropdownSettingComponent=module$src$api$apps$sd_controls$settings$SDControlsSettings.default;
   module$src$api$apps$sd_controls$settings_components$camera$CameraDropdownSettingComponent.default.CameraDropdownSettingComponent=function(b){function a(c,d,e,g,h){var f=b.call(this,c,{value:a._choices[c.getSetting("camera.cameraTypes.active")],choices:a._choices,type:"dropdown",title:d.title,name:d.name,setting:"camera.cameraTypes.active",order:d.order,id:d.id,groupId:d.groupId},e,g)||this;f._parent=e;f._componentFactory=g;f._controlsEvents=h;f._perspectiveSettings="camera.cameraTypes.perspective.fov camera.controls.orbit.autoRotationSpeed camera.controls.orbit.damping camera.controls.orbit.enableKeyPan camera.controls.orbit.enablePan camera.controls.orbit.enableRotation camera.controls.orbit.enableZoom camera.controls.orbit.keyPanSpeed camera.controls.orbit.rotationSpeed camera.controls.orbit.zoomSpeed camera.controls.orbit.panSpeed".split(" ");
   f._ortographicSettings="camera.controls.orthographic.damping camera.controls.orthographic.enableKeyPan camera.controls.orthographic.enablePan camera.controls.orthographic.enableZoom camera.controls.orthographic.zoomSpeed camera.controls.orthographic.zoomSpeed camera.controls.orthographic.panSpeed".split(" ");f._settingDefinition.update=function(b){b=a._choices.indexOf(b);f._currentSelection="PERSPECTIVE"===a._choices[b]?"perspective":"ortographic";f._api.updateSettingAsync("camera.cameraTypes.active",
   b);f.createSettings();f._previousSelection=f._currentSelection};f._currentSelection="PERSPECTIVE"===f._settingDefinition.value?"perspective":"ortographic";f.createSettings();f._previousSelection=f._currentSelection;return f}__extends$$module$src$api$apps$sd_controls$settings_components$camera$CameraDropdownSettingComponent(a,b);Object.defineProperty(a.prototype,"value",{get:function(){return this._component.value},set:function(b){"number"===typeof b&&(b=a._choices[b]);this._component.value=b},enumerable:!0,
   configurable:!0});a.prototype.createSettings=function(){if(this._previousSelection!==this._currentSelection){var a="perspective"===this._currentSelection;this.destroySettings(a?this._ortographicSettings:this._perspectiveSettings);a=a?this.createPerspectiveSettings():this.createOrtographicSettings();for(var b in a)this._controlsEvents.trigger("create_setting",{key:b,definition:a[b]})}};a.prototype.createPerspectiveSettings=function(){var a=this,b=this._api.getSettingDefinitions();return{"camera.cameraTypes.perspective.fov":{id:"camera.cameraTypes.perspective.fov",
   setting:"camera.cameraTypes.perspective.fov",type:"slider",name:"Field of View",title:b["scene.camera.cameraTypes.perspective.fov"].description,value:this._api.getSetting("scene.camera.cameraTypes.perspective.fov"),groupId:4,order:2,min:10,max:90,step:1},"camera.controls.orbit.enableZoom":{value:!this._api.getSetting("camera.controls.orbit.enableZoom"),setting:"camera.controls.orbit.enableZoom",id:"camera.controls.orbit.enableZoom",type:"checkbox",name:"Disable Zoom",title:b["scene.camera.controls.orbit.enableZoom"].description,
   order:3,groupId:4,update:function(b){return a._api.updateSettingAsync("camera.controls.orbit.enableZoom",!b)},convertValue:function(a){return!a}},"camera.controls.orbit.zoomSpeed":{value:this._api.getSetting("camera.controls.orbit.zoomSpeed"),id:"camera.controls.orbit.zoomSpeed",order:4,groupId:4,setting:"camera.controls.orbit.zoomSpeed",name:"Zoom Speed",title:b["scene.camera.controls.orbit.zoomSpeed"].description,type:"slider",min:0,max:1+module$src$api$apps$sd_controls$settings$SDControlsSettings.default.SDControlsSettings.EPS,
   step:.01},"camera.controls.orbit.enablePan":{value:this._api.getSetting("camera.controls.orbit.enablePan"),id:"camera.controls.orbit.enablePan",order:5,groupId:4,setting:"camera.controls.orbit.enablePan",name:"Disable Pan",title:b["scene.camera.controls.orbit.enablePan"].description,type:"checkbox",update:function(b){return a._api.updateSettingAsync("camera.controls.orbit.enablePan",!b)},convertValue:function(a){return!a}},"camera.controls.orbit.panSpeed":{value:this._api.getSetting("camera.controls.orbit.panSpeed"),
   id:"camera.controls.orbit.panSpeed",order:6,groupId:4,setting:"camera.controls.orbit.panSpeed",name:"Pan Speed",title:b["scene.camera.controls.orbit.panSpeed"].description,type:"slider",min:0,max:1+module$src$api$apps$sd_controls$settings$SDControlsSettings.default.SDControlsSettings.EPS,step:.01},"camera.controls.orbit.enableKeyPan":{value:this._api.getSetting("camera.controls.orbit.enableKeyPan"),id:"camera.controls.orbit.enableKeyPan",order:7,groupId:4,setting:"camera.controls.orbit.enableKeyPan",
   name:"Disable Key pan",title:b["scene.camera.controls.orbit.enableKeyPan"].description,type:"checkbox",update:function(b){return a._api.updateSettingAsync("camera.controls.orbit.enableKeyPan",!b)},convertValue:function(a){return!a}},"camera.controls.orbit.keyPanSpeed":{value:this._api.getSetting("camera.controls.orbit.keyPanSpeed"),id:"camera.controls.orbit.keyPanSpeed",order:8,groupId:4,setting:"camera.controls.orbit.keyPanSpeed",name:"Key pan speed",title:b["scene.camera.controls.orbit.keyPanSpeed"].description,
   type:"slider",min:0,max:1,step:.01},"camera.controls.orbit.autoRotationSpeed":{value:this._api.getSetting("camera.controls.orbit.autoRotationSpeed"),id:"camera.controls.orbit.autoRotationSpeed",order:9,groupId:4,setting:"camera.controls.orbit.autoRotationSpeed",title:b["scene.camera.controls.orbit.autoRotationSpeed"].description,name:"Auto Rotation",type:"slider",min:-10,max:10+module$src$api$apps$sd_controls$settings$SDControlsSettings.default.SDControlsSettings.EPS,step:.01},"camera.controls.orbit.damping":{value:this._api.getSetting("camera.controls.orbit.damping"),
   id:"camera.controls.orbit.damping",order:10,groupId:4,setting:"camera.controls.orbit.damping",name:"Damping Factor",title:b["scene.camera.controls.orbit.damping"].description,type:"slider",min:0,max:1,step:.01},"camera.controls.orbit.enableRotation":{setting:"camera.controls.orbit.enableRotation",value:!this._api.getSetting("camera.controls.orbit.enableRotation"),type:"checkbox",name:"Disable Rotation",title:b["scene.camera.controls.orbit.enableRotation"].description,order:9,groupId:4,id:"camera.controls.orbit.enableRotation",
   update:function(b){return a._api.updateSettingAsync("camera.controls.orbit.enableRotation",!b)},convertValue:function(a){return!a}},"camera.controls.orbit.rotationSpeed":{value:this._api.getSetting("camera.controls.orbit.rotationSpeed"),id:"camera.controls.orbit.rotationSpeed",order:6,groupId:4,setting:"camera.controls.orbit.rotationSpeed",name:"Rotation Speed",title:b["scene.camera.controls.orbit.rotationSpeed"].description,type:"slider",min:0,max:1+module$src$api$apps$sd_controls$settings$SDControlsSettings.default.SDControlsSettings.EPS,
   step:.01}}};a.prototype.createOrtographicSettings=function(){var a=this,b=this._api.getSettingDefinitions();return{"camera.controls.orthographic.enableZoom":{value:!this._api.getSetting("camera.controls.orthographic.enableZoom"),setting:"camera.controls.orthographic.enableZoom",id:"camera.controls.orthographic.enableZoom",type:"checkbox",name:"Disable Zoom",title:b["scene.camera.controls.orthographic.enableZoom"].description,order:2,groupId:4,update:function(b){return a._api.updateSettingAsync("camera.controls.orthographic.enableZoom",
   !b)},convertValue:function(a){return!a}},"camera.controls.orthographic.zoomSpeed":{value:this._api.getSetting("camera.controls.orthographic.zoomSpeed"),id:"camera.controls.orthographic.zoomSpeed",order:3,groupId:4,setting:"camera.controls.orthographic.zoomSpeed",name:"Zoom Speed",title:b["scene.camera.controls.orthographic.zoomSpeed"].description,type:"slider",min:0,max:1+module$src$api$apps$sd_controls$settings$SDControlsSettings.default.SDControlsSettings.EPS,step:.01},"camera.controls.orthographic.enablePan":{value:!this._api.getSetting("camera.controls.orthographic.enablePan"),
   id:"camera.controls.orthographic.enablePan",order:4,groupId:4,setting:"camera.controls.orthographic.enablePan",name:"Disable Pan",title:b["scene.camera.controls.orthographic.enablePan"].description,type:"checkbox",update:function(b){return a._api.updateSettingAsync("camera.controls.orthographic.enablePan",!b)},convertValue:function(a){return!a}},"camera.controls.orthographic.panSpeed":{value:this._api.getSetting("camera.controls.orthographic.panSpeed"),id:"camera.controls.orthographic.panSpeed",order:5,
   groupId:4,setting:"camera.controls.orthographic.panSpeed",name:"Pan Speed",title:b["scene.camera.controls.orthographic.panSpeed"].description,type:"slider",min:0,max:1+module$src$api$apps$sd_controls$settings$SDControlsSettings.default.SDControlsSettings.EPS,step:.01},"camera.controls.orthographic.enableKeyPan":{value:!this._api.getSetting("camera.controls.orthographic.enableKeyPan"),id:"camera.controls.orthographic.enableKeyPan",order:6,groupId:4,setting:"camera.controls.orthographic.enableKeyPan",
   name:"Disable Key pan",title:b["scene.camera.controls.orthographic.enableKeyPan"].description,type:"checkbox",update:function(b){return a._api.updateSettingAsync("camera.controls.orthographic.enableKeyPan",!b)},convertValue:function(a){return!a}},"camera.controls.orthographic.keyPanSpeed":{value:this._api.getSetting("camera.controls.orthographic.keyPanSpeed"),id:"camera.controls.orthographic.keyPanSpeed",order:7,groupId:4,setting:"camera.controls.orthographic.keyPanSpeed",name:"Key pan speed",title:b["scene.camera.controls.orthographic.keyPanSpeed"].description,
   type:"slider",min:0,max:1,step:.01},"camera.controls.orthographic.damping":{value:this._api.getSetting("camera.controls.orthographic.damping"),id:"camera.controls.orthographic.damping",order:8,groupId:4,setting:"camera.controls.orthographic.damping",name:"Damping Factor",title:b["scene.camera.controls.orthographic.damping"].description,type:"slider",min:0,max:1.0000001,step:.01}}};a.prototype.destroySettings=function(a){var b=this;a.forEach(function(a){return b._controlsEvents.trigger("remove_setting",
   a)})};a._choices="PERSPECTIVE TOP BOTTOM RIGHT LEFT BACK FRONT".split(" ");return a}(module$src$api$apps$sd_controls$settings_components$DropdownSettingComponent.default.DropdownSettingComponent);var module$src$api$apps$sd_controls$settings_components$StringInputSettingComponent={default:{}},__extends$$module$src$api$apps$sd_controls$settings_components$StringInputSettingComponent=this&&module$src$api$apps$sd_controls$settings_components$StringInputSettingComponent.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return b(a,c)};return function(a,
   c){function d(){this.constructor=a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$settings_components$StringInputSettingComponent.default,"__esModule",{value:!0});var BaseSettingComponent_1$$module$src$api$apps$sd_controls$settings_components$StringInputSettingComponent=module$src$api$apps$sd_controls$settings_components$BaseSettingComponent.default;
   module$src$api$apps$sd_controls$settings_components$StringInputSettingComponent.default.StringInputSettingComponent=function(b){function a(a,d,e,g){return b.call(this,a,d,g.createUserDefinedParameter(d,e,!1))||this}__extends$$module$src$api$apps$sd_controls$settings_components$StringInputSettingComponent(a,b);return a}(module$src$api$apps$sd_controls$settings_components$BaseSettingComponent.default.BaseSettingComponent);var module$src$api$apps$sd_controls$managers$SDControlsComponentFactory={default:{}};Object.defineProperty(module$src$api$apps$sd_controls$managers$SDControlsComponentFactory.default,"__esModule",{value:!0});
   var StringInputCustomComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$custom_components$StringInputCustomComponent.default,BooleanInputCustomComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$custom_components$BooleanInputCustomComponent.default,Vector3CustomComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$custom_components$Vector3CustomComponent.default,
   ButtonCustomComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$custom_components$ButtonCustomComponent.default,ChecklistCustomComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$custom_components$ChecklistCustomComponent.default,ColorCustomComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$custom_components$ColorCustomComponent.default,
   DropdownCustomComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$custom_components$DropdownCustomComponent.default,FileCustomComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$custom_components$FileCustomComponent.default,ModalCustomComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$custom_components$ModalCustomComponent.default,
   SliderCustomComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$custom_components$SliderCustomComponent.default,GroupCustomComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$custom_components$GroupCustomComponent.default,StaticHTMLCustomComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$custom_components$StaticHTMLCustomComponent.default,
   StaticHTMLSettingComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$settings_components$StaticHTMLSettingComponent.default,SliderParameterComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$parameters_components$SliderParameterComponent.default,FileParameterComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$parameters_components$FileParameterComponent.default,
   BooleanInputParameterComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$parameters_components$BooleanInputParameterComponent.default,ButtonParameterComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$parameters_components$ButtonParameterComponent.default,ColorParameterComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$parameters_components$ColorParameterComponent.default,
   StringInputParameterComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$parameters_components$StringInputParameterComponent.default,DropDownParameterComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$parameters_components$DropDownParameterComponent.default,ChecklistParameterComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$parameters_components$ChecklistParameterComponent.default,
   DropdownSettingComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$settings_components$DropdownSettingComponent.default,SliderSettingComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$settings_components$SliderSettingComponent.default,CheckboxSettingComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$settings_components$CheckboxSettingComponent.default,
   ColorSettingComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$settings_components$ColorSettingComponent.default,LoadLightSceneDropdownSettingComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$settings_components$lights$LoadLightSceneDropdownSettingComponent.default,LightDefinitionSettingComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$settings_components$lights$LightDefinitionSettingComponent.default,
   GroupSettingComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$settings_components$GroupSettingComponent.default,SliderLightPropertySettingComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$settings_components$lights$SliderLightPropertySettingComponent.default,ColorLightPropertySettingComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$settings_components$lights$ColorLightPropertySettingComponent.default,
   Vector3LightPropertySettingComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$settings_components$lights$Vector3LightPropertySettingComponent.default,Vector3SettingComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$settings_components$Vector3SettingComponent.default,CheckboxLightPropertySettingComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$settings_components$lights$CheckboxLightPropertySettingComponent.default,
   AddLightModalSettingComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$settings_components$lights$AddLightModalSettingComponent.default,SaveLightSceneModalSettingComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$settings_components$lights$SaveLightSceneModalSettingComponent.default,CameraDropdownSettingComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=
   module$src$api$apps$sd_controls$settings_components$camera$CameraDropdownSettingComponent.default,StringInputSettingComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$settings_components$StringInputSettingComponent.default;
   module$src$api$apps$sd_controls$managers$SDControlsComponentFactory.default.SDControlsComponentFactory=function(){function b(a,b,d,e,g,h,f,k,l){this._api=a;this._queue=b;this._domManager=d;this._tinyColorUtil=e;this._controlEvents=g;this._fileHelper=h;this._sdSettings=f;this._groups=k;this._dragControls=l;this._settingDestoryEvents=[];this._settingCreatedEvents=[]}Object.defineProperty(b.prototype,"groups",{get:function(){return this._groups},enumerable:!0,configurable:!0});b.prototype.createShapeDiverParameter=
   function(a,b,d){if(!d&&a.hidden)return null;var c=null;switch(this.resolveParameterType(a)){case "button":c=new module$src$api$apps$sd_controls$parameters_components$ButtonParameterComponent.default.ButtonParameterComponent(this._api,this._domManager,this._queue,b,a,d);break;case "checkbox":c=new module$src$api$apps$sd_controls$parameters_components$BooleanInputParameterComponent.default.BooleanInputParameterComponent(this._api,this._domManager,this._queue,b,a,d);break;case "checklist":c=new module$src$api$apps$sd_controls$parameters_components$ChecklistParameterComponent.default.ChecklistParameterComponent(this._api,
   this._domManager,this._queue,b,a,d);break;case "color":c=new module$src$api$apps$sd_controls$parameters_components$ColorParameterComponent.default.ColorParameterComponent(this._api,this._domManager,this._queue,b,a,this._tinyColorUtil,d,this._domManager.useSpectrum);break;case "dropdown":c=new module$src$api$apps$sd_controls$parameters_components$DropDownParameterComponent.default.DropdownParameterComponent(this._api,this._domManager,this._queue,b,a,d);break;case "string":c=new module$src$api$apps$sd_controls$parameters_components$StringInputParameterComponent.default.StringInputParameterComponent(this._api,
   this._domManager,this._queue,b,a,d);break;case "file":c=new module$src$api$apps$sd_controls$parameters_components$FileParameterComponent.default.FileParameterComponent(this._api,this._domManager,this._queue,b,a,this._fileHelper,d);break;case "slider":c=new module$src$api$apps$sd_controls$parameters_components$SliderParameterComponent.default.SliderParameterComponent(this._api,this._domManager,this._queue,b,a,d)}if(null===c)throw Error("Cannot create parameter component of type "+a.elementType);a.hidden&&
   (c.hidden=!0);return c};b.prototype.createShapeDiverSetting=function(a,b){var c=null;switch(a.type){case "camera":c=new module$src$api$apps$sd_controls$settings_components$camera$CameraDropdownSettingComponent.default.CameraDropdownSettingComponent(this._api,a,b,this,this._controlEvents);break;case "checkbox":c=new module$src$api$apps$sd_controls$settings_components$CheckboxSettingComponent.default.CheckboxSettingComponent(this._api,a,b,this);break;case "color":c=new module$src$api$apps$sd_controls$settings_components$ColorSettingComponent.default.ColorSettingComponent(this._api,
   a,b,this);break;case "dropdown":c=new module$src$api$apps$sd_controls$settings_components$DropdownSettingComponent.default.DropdownSettingComponent(this._api,a,b,this);break;case "group":c=new module$src$api$apps$sd_controls$settings_components$GroupSettingComponent.default.GroupSettingComponent(this._api,a,b,this);break;case "slider":c=new module$src$api$apps$sd_controls$settings_components$SliderSettingComponent.default.SliderSettingComponent(this._api,a,b,this);break;case "string":c=new module$src$api$apps$sd_controls$settings_components$StringInputSettingComponent.default.StringInputSettingComponent(this._api,
   a,b,this);break;case "statichtml":c=new module$src$api$apps$sd_controls$settings_components$StaticHTMLSettingComponent.default.StaticHTMLSettingComponent(this._api,a,b,this);break;case "vector3":c=new module$src$api$apps$sd_controls$settings_components$Vector3SettingComponent.default.Vector3SettingComponent(this._api,a,b,this);break;case "light_slider":c=new module$src$api$apps$sd_controls$settings_components$lights$SliderLightPropertySettingComponent.default.SliderLightPropertySettingComponent(this._api,
   a,b,this,this._dragControls);break;case "light_color":c=new module$src$api$apps$sd_controls$settings_components$lights$ColorLightPropertySettingComponent.default.ColorLightPropertySettingComponent(this._api,a,b,this,this._dragControls);break;case "light_checkbox":c=new module$src$api$apps$sd_controls$settings_components$lights$CheckboxLightPropertySettingComponent.default.CheckboxLightPropertySettingComponent(this._api,a,b,this,this._dragControls);break;case "light_vector":c=new module$src$api$apps$sd_controls$settings_components$lights$Vector3LightPropertySettingComponent.default.Vector3LightPropertySettingComponent(this._api,
   a,b,this,this._dragControls);break;case "light_definition":c=new module$src$api$apps$sd_controls$settings_components$lights$LightDefinitionSettingComponent.default.LightDefinitionSettingComponent(this._api,a,b,this._domManager,this._queue,this,this._dragControls);break;case "load_light_scene":c=new module$src$api$apps$sd_controls$settings_components$lights$LoadLightSceneDropdownSettingComponent.default.LoadLightSceneDropdownSettingComponent(this._api,a,b,this,this._controlEvents,this._sdSettings);
   break;case "add_light_modal":c=new module$src$api$apps$sd_controls$settings_components$lights$AddLightModalSettingComponent.default.AddLightModalSetting(this._api,a,b,this,this._sdSettings,this._controlEvents,this._dragControls);break;case "save_light_scene_modal":c=new module$src$api$apps$sd_controls$settings_components$lights$SaveLightSceneModalSettingComponent.default.SaveLightSceneModalSettingComponent(this._api,a,b,this,this._sdSettings,this._controlEvents,this._dragControls)}if(null==c)throw Error("Cannot create setting component of type "+
   a.type);this._settingCreatedEvents.forEach(function(b){return b(c,a)});return c};b.prototype.createUserDefinedParameter=function(a,b,d){var c=a.type,g=this.generateUUID();if(b=this.createCustomInputComponent(g,c,a,b,d))return b;throw Error("Cannot create input component of type  "+a.type);};b.prototype.onSettingCreated=function(a){this._settingCreatedEvents.push(a)};b.prototype.createCustomInputComponent=function(a,b,d,e,g){switch(b){case "string":return new module$src$api$apps$sd_controls$custom_components$StringInputCustomComponent.default.StringInputCustomComponent(a,
   d,e,this._domManager,this._queue,g);case "checkbox":return new module$src$api$apps$sd_controls$custom_components$BooleanInputCustomComponent.default.BooleanInputCustomComponent(a,d,e,this._domManager,this._queue,g);case "vector3":return new module$src$api$apps$sd_controls$custom_components$Vector3CustomComponent.default.Vector3CustomComponent(a,d,e,this._domManager,this._queue,g);case "button":return new module$src$api$apps$sd_controls$custom_components$ButtonCustomComponent.default.ButtonCustomComponent(a,
   d,e,this._domManager,this._queue,g);case "checklist":return new module$src$api$apps$sd_controls$custom_components$ChecklistCustomComponent.default.ChecklistCustomComponent(a,d,e,this._domManager,this._queue,g);case "group":return new module$src$api$apps$sd_controls$custom_components$GroupCustomComponent.default.GroupCustomComponent(a,d,e,this._domManager,this._queue,this,g);case "color":return new module$src$api$apps$sd_controls$custom_components$ColorCustomComponent.default.ColorCustomComponent(a,
   d,e,this._domManager,this._queue,this._domManager.useSpectrum,this._tinyColorUtil);case "dropdown":return new module$src$api$apps$sd_controls$custom_components$DropdownCustomComponent.default.DropdownCustomComponent(a,d,e,this._domManager,this._queue,g);case "file":return new module$src$api$apps$sd_controls$custom_components$FileCustomComponent.default.FileCustomComponent(a,d,e,this._domManager,this._queue,this._fileHelper,g);case "modal":return new module$src$api$apps$sd_controls$custom_components$ModalCustomComponent.default.ModalCustomComponent(a,
   d,e,this._domManager,this._queue,g);case "slider":return new module$src$api$apps$sd_controls$custom_components$SliderCustomComponent.default.SliderCustomComponent(a,d,e,this._domManager,this._queue,g);case "statichtml":return new module$src$api$apps$sd_controls$custom_components$StaticHTMLCustomComponent.default.StaticHTMLCustomComponent(a,d,e,this._domManager,this._queue,g)}};b.prototype.generateUUID=function(){var a=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,
   function(b){var c=(a+16*Math.random())%16|0;a=Math.floor(a/16);return("x"===b?c:c&3|8).toString(16)})};b.prototype.resolveParameterType=function(a){if(a.elementType)return a.elementType;if(!a.isParameter)return"button";if(a.visualization)switch(a.visualization.toLowerCase()){case "dropdown":case "cycle":return"dropdown";case "checklist":return"checklist";case "dial":case "slider":return"slider";default:return a.visualization.toLowerCase()}else if(a.type)switch(a.type.toLowerCase()){case "bool":return"checkbox";
   case "stringlist":return"dropdown";case "download":case "email":return"button";case "int":return"slider";default:return a.type.toLowerCase()}};return b}();var module$src$api$apps$sd_controls$managers$SDControlsSortManager={default:{}};Object.defineProperty(module$src$api$apps$sd_controls$managers$SDControlsSortManager.default,"__esModule",{value:!0});
   var SDControlsSortManager$$module$src$api$apps$sd_controls$managers$SDControlsSortManager=function(){function b(){}b.prototype.sort=function(a,b){void 0===b&&(b=!0);if(0<a.length){a.sort(function(a,b){if(a.isExport||b.isExport){if(a.isExport)return 1;if(b.isExport)return-1}return a.order-b.order});var c=a.length-1,e=a[c];if(0===c)e.children&&0<e.children.length&&this.sort(e.children);else for(;0<c;){e.children&&0<e.children.length&&this.sort(e.children);var g=a[--c];!0===b&&g.insertBefore(e);e=g}}return a};
   return b}();module$src$api$apps$sd_controls$managers$SDControlsSortManager.default.SDControlsSortManagerInstance=new SDControlsSortManager$$module$src$api$apps$sd_controls$managers$SDControlsSortManager;var module$src$api$apps$sd_controls$managers$SDControlsSettingsHandler={default:{}};Object.defineProperty(module$src$api$apps$sd_controls$managers$SDControlsSettingsHandler.default,"__esModule",{value:!0});module$src$api$apps$sd_controls$managers$SDControlsSettingsHandler.default.SDControlsSettingsHandler=function(){function b(a){this._api=a;this._settingUpdateEvents=[];a.addEventListener("settings.update",function(a){})}b.prototype.onSettingUpdate=function(a){this._settingUpdateEvents.push(a)};return b}();var module$src$api$apps$SDControls={default:{}};module$src$api$apps$SDControls.default.default=function(b,a,c,d){var e=new ShapeDiverControls$$module$src$api$apps$SDControls(b,a,c,d);return{parameterTypes:e.parameterTypes,createParameter:function(a){return e.createParameter(a)},removeParameter:function(a){return e.removeParameter(a)},save:function(){return e.save()},destroy:function(){return e.destroy()}}};
   var __awaiter$$module$src$api$apps$SDControls=this&&module$src$api$apps$SDControls.default.__awaiter||function(b,a,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,h){function g(a){try{l(d.next(a))}catch(n){h(n)}}function k(a){try{l(d["throw"](a))}catch(n){h(n)}}function l(a){a.done?c(a.value):e(a.value).then(g,k)}l((d=d.apply(b,a||[])).next())})},__generator$$module$src$api$apps$SDControls=this&&module$src$api$apps$SDControls.default.__generator||
   function(b,a){function c(a){return function(b){return d([a,b])}}function d(c){if(g)throw new TypeError("Generator is already executing.");for(;e;)try{if(g=1,h&&(f=c[0]&2?h["return"]:c[0]?h["throw"]||((f=h["return"])&&f.call(h),0):h.next)&&!(f=f.call(h,c[1])).done)return f;if(h=0,f)c=[c[0]&2,f.value];switch(c[0]){case 0:case 1:f=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++;h=c[1];c=[0];continue;case 7:c=e.ops.pop();e.trys.pop();continue;default:if(!(f=e.trys,f=0<f.length&&
   f[f.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!f||c[1]>f[0]&&c[1]<f[3]))e.label=c[1];else if(6===c[0]&&e.label<f[1])e.label=f[1],f=c;else if(f&&e.label<f[2])e.label=f[2],e.ops.push(c);else{f[2]&&e.ops.pop();e.trys.pop();continue}}c=a.call(b,e)}catch(m){c=[6,m],h=0}finally{g=f=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},g,h,f,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===
   typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k};Object.defineProperty(module$src$api$apps$SDControls.default,"__esModule",{value:!0});
   var GroupSettings_1$$module$src$api$apps$SDControls=module$src$api$apps$sd_controls$settings$GroupSettings.default,app_1$$module$src$api$apps$SDControls=module$src$modules$shapediver_lights_drag_controls$app.default,SDControlsManager_1$$module$src$api$apps$SDControls=module$src$api$apps$sd_controls$SDControlsManager.default,SDControlsDomManager_1$$module$src$api$apps$SDControls=module$src$api$apps$sd_controls$managers$SDControlsDomManager.default,SDControlsDependenciesResolver_1$$module$src$api$apps$SDControls=
   module$src$api$apps$sd_controls$managers$SDControlsDependenciesResolver.default,SDFileHelper_1$$module$src$api$apps$SDControls=module$src$modules$shapediver_file_helper$SDFileHelper.default,GenericEvent_1$$module$src$api$apps$SDControls=module$src$modules$shapediver_generic_event$GenericEvent.default,SDControlComponentContracts_1$$module$src$api$apps$SDControls=module$src$api$apps$sd_controls$managers$SDControlComponentContracts.default,enums_1$$module$src$api$apps$SDControls=module$src$api$apps$sd_controls$enums$enums.default,
   SDControlsParameterHandler_1$$module$src$api$apps$SDControls=module$src$api$apps$sd_controls$managers$SDControlsParameterHandler.default,TinyColorUtil_1$$module$src$api$apps$SDControls=module$src$shared$util$TinyColorUtil.default,SDParameterCommitQueue_1$$module$src$api$apps$SDControls=module$src$api$apps$sd_controls$commit_queues$SDParameterCommitQueue.default,SDControlsEditManager_1$$module$src$api$apps$SDControls=module$src$api$apps$sd_controls$managers$SDControlsEditManager.default,SDControlsParametersLinker_1$$module$src$api$apps$SDControls=
   module$src$api$apps$sd_controls$managers$SDControlsParametersLinker.default,SDControlsSettings_1$$module$src$api$apps$SDControls=module$src$api$apps$sd_controls$settings$SDControlsSettings.default,SDControlsResizeManager_1$$module$src$api$apps$SDControls=module$src$api$apps$sd_controls$managers$SDControlsResizeManager.default,SDControlsComponentFactory_1$$module$src$api$apps$SDControls=module$src$api$apps$sd_controls$managers$SDControlsComponentFactory.default,SDControlsSortManager_1$$module$src$api$apps$SDControls=
   module$src$api$apps$sd_controls$managers$SDControlsSortManager.default,SDControlsSettingsHandler_1$$module$src$api$apps$SDControls=module$src$api$apps$sd_controls$managers$SDControlsSettingsHandler.default,ShapeDiverControls$$module$src$api$apps$SDControls=function(){function b(a,b,d,e){var c;this._api=a;this._parentContainer=b;this._options=d;this._events=e;this._initializeDone=null;this._editMode=!(!this._options||!0!==this._options.editMode&&"true"!==this._options.editMode);this._domManager=new module$src$api$apps$sd_controls$managers$SDControlsDomManager.default.SDControlsDomManager;
   this._sdControlsDomManager=new module$src$api$apps$sd_controls$managers$SDControlsDomManager.default.SDControlsDomManager;this._sdFileHelper=new module$src$modules$shapediver_file_helper$SDFileHelper.default.SDFileHelper;this._sdControlsDomManager=new module$src$api$apps$sd_controls$managers$SDControlsDomManager.default.SDControlsDomManager;this._sdDepenenciesResolver=new module$src$api$apps$sd_controls$managers$SDControlsDependenciesResolver.default.SDControlsDependenciesResolver(this._sdControlsDomManager.useSpectrum);
   this._sortManager=module$src$api$apps$sd_controls$managers$SDControlsSortManager.default.SDControlsSortManagerInstance;this._sdControlsContract=module$src$api$apps$sd_controls$managers$SDControlComponentContracts.default.SDControlComponentsContractsInstance;this._sdParametersLinker=new module$src$api$apps$sd_controls$managers$SDControlsParametersLinker.default.SDControlsParameterLinker(this._api);this._resizeManager=new module$src$api$apps$sd_controls$managers$SDControlsResizeManager.default.SDControlsResizeManager(this._sdControlsDomManager.userAgentIsMobileDevice);
   this.initializeAsync();null===(c=this._events)||void 0===c?void 0:c.onElementCreated()}Object.defineProperty(b.prototype,"parameterTypes",{get:function(){return module$src$api$apps$sd_controls$enums$enums.default.DefaultControlParameterType},enumerable:!0,configurable:!0});b.prototype.createParameter=function(a){return __awaiter$$module$src$api$apps$SDControls(this,void 0,void 0,function(){return __generator$$module$src$api$apps$SDControls(this,function(b){switch(b.label){case 0:return[4,this._initializeDone];
   case 1:return b.sent(),[2,this._controlsManager.createUserDefinedParameterAsync(a)]}})})};b.prototype.destroy=function(){this._controlsManager.destroyParameters()};b.prototype.removeParameter=function(a){return this._controlsManager.removeUserDefinedParameter(a)};b.prototype.resort=function(){this._controlsManager.resort()};b.prototype.save=function(){this._controlsManager.saveParameters()};b.prototype.createContainer=function(){var a=this._domManager.createDomElement("div","sd-elements-container-"+
   (this._options.settings?"settings":"parameters"),null,["sdv-control-panel-row-container","uk-child-width-1-1","uk-margin-remove"],{"uk-grid":"","uk-height-match":""});this._parentContainer.appendChild(a);return a};b.prototype.initalizeParametersAsync=function(){return __awaiter$$module$src$api$apps$SDControls(this,void 0,void 0,function(){var a,b;return __generator$$module$src$api$apps$SDControls(this,function(c){this._sdParametersHandler=new module$src$api$apps$sd_controls$managers$SDControlsParameterHandler.default.SDControlsParameterHandler(this._api,
   this._sdDepenenciesResolver);a=this._domManager.createDomElement("button",this._api.getRuntimeId()+"_sd-control-panel-main-accordion-settings",this._parentContainer,["sd-control-panel-accordion"]);b=this._domManager.createDomElement("div",this._api.getRuntimeId()+"_settings-text",a,["shapediver-viewer-element","sd-control-panel-accordion-text"]);b.innerHTML="MODEL PARAMETERS";this._container=this.createContainer();this._controlsEvents=new module$src$modules$shapediver_generic_event$GenericEvent.default.GenericEvent(["parameter_registered"]);
   this._sdCommitQueue=new module$src$api$apps$sd_controls$commit_queues$SDParameterCommitQueue.default.SDParametersCommitQueue(this._api,this._container.parentElement,this._options.commitParameter);this._sdControlsEditManager=new module$src$api$apps$sd_controls$managers$SDControlsEditManager.default.SDControlsEditManager(!!this._options.editMode,module$src$api$apps$sd_controls$managers$SDControlsSortManager.default.SDControlsSortManagerInstance);return[2,Promise.resolve(b)]})})};b.prototype.initializeAsync=
   function(){return __awaiter$$module$src$api$apps$SDControls(this,void 0,void 0,function(){var a=this;return __generator$$module$src$api$apps$SDControls(this,function(b){null===this._initializeDone&&(this._initializeDone=new Promise(function(b){return __awaiter$$module$src$api$apps$SDControls(a,void 0,void 0,function(){return __generator$$module$src$api$apps$SDControls(this,function(a){switch(a.label){case 0:return this._options.settings?[4,this.initializeSettingAsync()]:[3,2];case 1:return a.sent(),
   [3,4];case 2:return[4,this.initalizeParametersAsync()];case 3:a.sent(),a.label=4;case 4:return this._inputComponentsFactory=new module$src$api$apps$sd_controls$managers$SDControlsComponentFactory.default.SDControlsComponentFactory(this._api,this._sdCommitQueue,this._domManager,module$src$shared$util$TinyColorUtil.default.TinyColorUtilInstance,this._controlsEvents,this._sdFileHelper,this._sdSettings,this._settingsGroups,this._dragControls),this._controlsManager=new module$src$api$apps$sd_controls$SDControlsManager.default.SDControlsManager(this._api,
   this._sdParametersHandler,this._sdSettingsHandler,this._sdControlsEditManager,this._sdDepenenciesResolver,this._controlsEvents,this._sdSettings,this._settingsGroups,this._container,this._sortManager,this._sdControlsContract,this._sdParametersLinker,this._inputComponentsFactory,this._resizeManager,this._dragControls,this._editMode),b(),[2]}})})}));return[2,this._initializeDone]})})};b.prototype.initializeSettingAsync=function(){return __awaiter$$module$src$api$apps$SDControls(this,void 0,void 0,function(){var a,
   b;return __generator$$module$src$api$apps$SDControls(this,function(c){switch(c.label){case 0:return this._controlsEvents=new module$src$modules$shapediver_generic_event$GenericEvent.default.GenericEvent("add clear.lights removed dropdown.customUpdate remove_setting create_setting".split(" ")),this._sdSettings=new module$src$api$apps$sd_controls$settings$SDControlsSettings.default.SDControlsSettings(this._api,this._editMode),this._dragControls=new module$src$modules$shapediver_lights_drag_controls$app.default.ShapeDiverDragControls(this._api,
   THREE),this._sdSettingsHandler=new module$src$api$apps$sd_controls$managers$SDControlsSettingsHandler.default.SDControlsSettingsHandler(this._api),[4,this._sdDepenenciesResolver.resolveDependenciesAsync()];case 1:return c.sent(),a=this._domManager.createDomElement("button",this._api.getRuntimeId()+"_sd-control-panel-main-accordion-settings",this._parentContainer,["sd-control-panel-accordion"]),b=this._domManager.createDomElement("div",this._api.getRuntimeId()+"_settings-text",a,["shapediver-viewer-element",
   "sd-control-panel-accordion-text"]),b.innerHTML="VIEWER SETTINGS",this._container=this.createContainer(),this._settingsGroups=new module$src$api$apps$sd_controls$settings$GroupSettings.default.GroupSettings(this._container,this._domManager),[2,Promise.resolve()]}})})};return b}();var module$src$api$apps$DomElementManager={default:function(b){var a={},c={};b.scene.addEventListener(b.scene.EVENTTYPE.ANCHOR_ADD,function(a){if(a.anchors)for(var b=0,c=a.anchors.length;b<c;b++)d(a.anchors[b])});b.scene.addEventListener(b.scene.EVENTTYPE.ANCHOR_REMOVE,function(a){if(a.anchors)for(var b=0,c=a.anchors.length;b<c;b++)e(a.anchors[b])});var d=function(d){if(!d.format||!c[d.format])return null;var e=document.getElementById(d.viewport+"-shapediver-domElements");e||(e=document.createElement("div"),
   e.id=d.viewport+"-shapediver-domElements",e.classList.add("shapediver-domElements"),b.viewports.get(d.viewport).getContainer().appendChild(e));var g=c[d.format];e=g.add(e,d);a[d.scenePath]=e;d.updateFunction(g.update);return e};var e=function(b){if(!a[b.scenePath]||!b.format||!c[b.format])return null;c[b.format].remove(b)};var g=function(a,c){var d=c.data,e=(0,module$src$shared$util$toTinyColor.default)(d.color,"black");var g=document.createElement("div");g.type="text/css";g.style.display="none";
   g.classList.add("shapediver-domElement");a.appendChild(g);a=document.createElement("span");a.style.color=e.toHexString();a.style.opacity=e.getAlpha();a.innerHTML=d.text;a.classList.add("shapediver-domElement-span");g.appendChild(a);if(d.textAlign)var f=d.textAlign;a.style.textAlign="right"===f||"center"===f?f:"left";return{domElement:g,api:b.viewports.get(c.viewport)}};var h=function(b){var c=a[b.scenePath].domElement,d=b.data;if(b.hidden&&!1!==d.hidden)c.style.display="none";else{c.style.display=
   "";if(d.positioning){var e=d.positioning.horizontal;var g=d.positioning.vertical}d="right"===e?b.containerX-c.offsetWidth:"left"===e?b.containerX:b.containerX-c.offsetWidth/2;b="bottom"===g?b.containerY-c.offsetHeight:"top"===g?b.containerY:b.containerY-c.offsetHeight/2;c.style.left=d+"px";c.style.top=b+"px"}};var f=function(b){var c=a[b.scenePath].domElement;c.style.display="none";document.getElementById(a[b.scenePath].api.getViewportRuntimeId()+"-shapediver-domElements").removeChild(c)};c={tag2d:{add:g,
   remove:f,update:h},text:{add:g,remove:f,update:h},image:{add:function(a,c){var d=c.data;var e=document.createElement("div");e.type="text/css";e.style.display="none";e.classList.add("shapediver-domElement");a.appendChild(e);a=document.createElement("img");e.appendChild(a);a.src=d.src;d.height&&(a.height=d.height);d.width&&(a.width=d.width);d.alt&&(a.alt=d.alt);return{domElement:e,api:b.viewports.get(c.viewport)}},remove:function(b){var c=a[b.scenePath].domElement;c.style.display="none";document.getElementById(a[b.scenePath].api.getViewportRuntimeId()+
   "-shapediver-domElements").removeChild(c)},update:function(b){var c=a[b.scenePath].domElement,d=b.data;if(b.hidden&&!1!==d.hidden)c.style.display="none";else{c.style.display="";if(d.positioning){var e=d.positioning.horizontal;var g=d.positioning.vertical}d="right"===e?b.containerX-c.offsetWidth:"left"===e?b.containerX:b.containerX-c.offsetWidth/2;b="bottom"===g?b.containerY-c.offsetHeight:"top"===g?b.containerY:b.containerY-c.offsetHeight/2;c.style.left=d+"px";c.style.top=b+"px"}}}}}};var module$src$api$apps$UIkitViewportOverlays={},GLOBAL_UTILS$$module$src$api$apps$UIkitViewportOverlays=module$src$shared$util$GlobalUtils.default;
   module$src$api$apps$UIkitViewportOverlays.default=function(b,a){if(!window.UIkit)return null;a=a||{};a.domElementIdPrefix=a.domElementIdPrefix||"sdv-container";a.hasOwnProperty("containerViewport")||(a.containerViewport=document.getElementById(a.domElementIdPrefix+"-viewport"));if(!a.containerViewport)return null;a.hasOwnProperty("containerControls")||(a.containerControls=document.getElementById(a.domElementIdPrefix+"-controls"));a.hasOwnProperty("containerSettings")||(a.containerSettings=document.getElementById(a.domElementIdPrefix+
   "-settings"));a.resizeHandler=a.resizeHandler||function(){};var c={},d=a.containerViewport,e=a.containerControls,g=a.containerSettings,h=[];"brandedMode createButtons showControlsButton showSettingsButton showZoomButton showFullscreenButton showInitialSpinner showBusySpinner".split(" ").forEach(function(b){"boolean"!==typeof a[b]&&(a[b]=module$src$shared$util$GlobalUtils.default.getBooleanNodeAttribute(a.container,b.toLowerCase(),!0))});var f=document.createElement("ul");f.classList.add("uk-iconnav");
   f.classList.add("shapediver-iconnav");var k=document.createElement("div");k.appendChild(f);d.appendChild(k);if(a.createButtons){var l=function(a,b,c){var d=document.createElement("li"),e=document.createElement("a");e.href="#";e.setAttribute("uk-icon","icon: "+a);"function"===typeof c&&(e.onclick=c);b||(d.style.display="none");d.appendChild(e);f.appendChild(d);return{li:d,a:e,onclick:c}};g&&(c.settings=l("pencil",a.showSettingsButton,function(c){"function"===typeof c.preventDefault&&c.preventDefault();
   var d="none"===g.style.display?"":"none";g.style.display="boolean"===typeof c?c?"":"none":d;b&&b.scene&&"function"===typeof b.scene.render&&b.scene.render();a.resizeHandler()}),a.showSettingsInitial&&(g.style.display="",a.resizeHandler()));e&&(c.controls=l("settings",a.showControlsButton,function(c){"function"===typeof c.preventDefault&&c.preventDefault();var d="none"===e.style.display?"":"none";e.style.display="boolean"===typeof c?c?"":"none":d;b&&b.scene&&"function"===typeof b.scene.render&&b.scene.render();
   a.resizeHandler()}),a.showControlsInitial&&(e.style.display="",a.resizeHandler()));if(b&&b.scene&&b.scene.camera&&"function"===typeof b.scene.camera.resetAsync){var m=0;c.zoom=l("camera",a.showZoomButton,function(c){"function"===typeof c.preventDefault&&c.preventDefault();a.zoomButtonResetsCamera?b.scene.camera.resetAsync({coordinates:"spherical"}):0!==m?(b.scene.camera.resetAsync({coordinates:"spherical"}),clearTimeout(m),m=0):(b.scene.camera.zoomAsync(),m=setTimeout(function(){m=0},500))});0===
   b.getSetting("scene.camera.cameraMovementDuration")&&b.updateSettingAsync("scene.camera.cameraMovementDuration",1E3)}if(b&&"function"===typeof b.getSetting&&"function"===typeof b.updateSettingAsync){c.fullscreen=l("expand",a.showFullscreenButton,function(a){"function"===typeof a.preventDefault&&a.preventDefault();a=b.getSetting("scene.fullscreen");b.updateSettingAsync("scene.fullscreen",!a)});var n=function(){document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement||
   document.mozFullScreenElement?c.fullscreen.a.setAttribute("uk-icon","icon: shrink"):c.fullscreen.a.setAttribute("uk-icon","icon: expand")};document.addEventListener("webkitfullscreenchange",n);document.addEventListener("mozfullscreenchange",n);document.addEventListener("fullscreenchange",n)}}var q=function(a){a.style.position="absolute";a.style.top="50%";a.style.left="50%";a.style.transform="translateX(-50%) translateY(-50%)";a.style["-webkit-transform"]=a.style.transform};if(b&&b.scene&&a.showInitialSpinner){if(a.brandedMode){var p=
   document.createElement("img");p.style.maxWidth="66%";p.style.maxHeight="66%";p.style.backgroundColor="none";p.src="https://viewer.shapediver.com/v2/img/logo_color.png"}else p=document.createElement("div"),p.setAttribute("uk-spinner","ratio: 2");q(p);d.parentNode.appendChild(p);var u=function(){p&&(d.parentNode.removeChild(p),p=null);t&&(b.scene.removeEventListener(t.data),t=null)};var t=b.scene.addEventListener(b.scene.EVENTTYPE.VISIBILITY_ON,u)}if(b&&b.state&&a.showBusySpinner){var r=function(a){a.classList.add("shapediver-spinner-busy");
   a.setAttribute("uk-spinner","ratio: 1")},v;var w=document.createElement("div");r(w);k.appendChild(w);l=b.state.addEventListener(b.state.EVENTTYPE.BUSY,function(){w.style.display=""});l.data&&h.push(l.data);l=b.state.addEventListener(b.state.EVENTTYPE.IDLE,function(){w.style.display="none"});l.data&&h.push(l.data);var y=function(a,b){v?w.removeChild(v):(w.removeAttribute("uk-spinner"),w.classList.remove("uk-spinner","uk-icon"));a?(v=document.createElement("img"),v.src=a,b&&(b=Array.isArray(b)||[b],
   b.forEach(function(a){w.classList.add(a)})),q(w),w.appendChild(v)):r(w)};var x=function(){}}var A=function(a,b){window.UIkit.notification({message:b,status:a||"primary",pos:"top-center"})};l=b.state.addEventListener(b.state.EVENTTYPE.MESSAGE,function(a){if(b.getSetting("showMessages")&&a.message){var c,d=a.messageLevel;"number"===typeof d&&(d&=7,d===window.SDVApp.constants.loggingLevels.WARN?c="warning":d>window.SDVApp.constants.loggingLevels.WARN?c="danger":d<window.SDVApp.constants.loggingLevels.WARN&&
   (c="primary"));A(c,a.message)}});l.data&&h.push(l.data);l=function(a){"function"===typeof u&&u();b.updateSettingAsync("scene.show",!1);var c=document.createElement("div");q(c);c.classList.add("uk-text-middle");c.classList.add("uk-text-break");c.classList.add("uk-text-center");d.parentNode.appendChild(c);var e='<h1 class="uk-text-lead">We are sorry</h1>';a.messageScope&&(e+=a.messageScope);c.innerHTML=e};var z=b.state.get().data.failedStatusMessages;0<z.length?l(z[0]):(l=b.state.addEventListener(b.state.EVENTTYPE.FAILED,
   l),l.data&&h.push(l.data));return{destroy:function(){k&&(d.removeChild(k),k=null);"function"===typeof u&&u();n&&(document.removeEventListener("webkitfullscreenchange",n),document.removeEventListener("mozfullscreenchange",n),document.removeEventListener("fullscreenchange",n));h.forEach(function(a){return b.removeEventListener(a)});k=null},toggleVisibility:function(a,b){c[a]&&(c[a].li.style.display=b?"":"none")},buttonOnClick:function(a,b){if(c[a])c[a].onclick(b)},setBusyGraphic:y,setBusyGraphicPosition:x,
   showMessage:A}};var module$src$api$apps$UIkitExportModal={default:function(b,a){if(!b)return null;a=a||{};a.domElementIdPrefix||(a.domElementIdPrefix="sdv-container-modal-export");a.parentElement||(a.parentElement=document.getElementById("sdv-container")?document.getElementById("sdv-container"):document.body);a.UIkitOpts||(a.UIkitOpts={escClose:!0,bgClose:!1,container:document.getElementById("sdv-container")?"#sdv-container":!1});var c=(""+a.downloadExportButtonName||"download").toLowerCase(),d=c.substring(0,1).toUpperCase()+
   c.substring(1);if(!window.UIkit)return null;var e,g,h,f,k,l=0,m,n=[],q,p=!1,u=a.parentElement,t=a.domElementIdPrefix,r=[];(function(a){e=document.createElement("div");e.id=a;var b=document.createElement("div");b.classList.add("uk-modal-dialog");b.classList.add("uk-modal-body");e.appendChild(b);g=document.createElement("h2");g.id=a+"-title";g.classList.add("uk-modal-title");b.appendChild(g);h=document.createElement("p");h.id=a+"-prompt";b.appendChild(h);var c=document.createElement("p");c.classList.add("uk-text-right");
   b.appendChild(c);f=document.createElement("h2");f.id=a+"-button-cancel";f.type="button";f.classList.add("uk-button");f.classList.add("uk-button-default");f.classList.add("uk-modal-close");c.appendChild(f);k=document.createElement("h2");k.id=a+"-button-ok";k.type="button";k.classList.add("uk-button");k.classList.add("uk-button-primary");c.appendChild(k);u.appendChild(e);return e})(t);var v=window.UIkit.modal("#"+t,a.UIkitOpts);var w=function(a){if(!a.export)return!1;var b=a.export;if(!a.token||!a.token.id||
   n.includes(a.token.id)||a.token.attributes&&a.token.attributes.silent||p&&m!==a.token.id)return!1;m=a.token.id;g.innerHTML=b.name?'Export "'+b.name+'"':"Export";if(b.content||b.result)"download"===b.type?(h.innerHTML=b.filename&&0<b.content.length&&b.content[0].href?'File "'+b.filename+'" is available for '+c+".":b.msg?b.msg:"File is available for "+c+".",b.content&&0<b.content.length&&(a=b.content[0],a.size&&(h.innerHTML+="<br/>Download size: "+a.size+" bytes"),a.format&&(h.innerHTML+="<br/>File format: "+
   a.format))):h.innerHTML="email"===b.type?b.result.err?b.result.err:b.result.msg?b.result.msg:"Export has been finished.":"shapeways"===b.type?b.result.err?b.result.err:b.result.msg?b.result.msg:"Export to ShapeWays has been finished.":"Export has been finished.";else{a="Processing, please wait...";b.msg&&(a=b.msg);for(var e=1;e<=l;e++)a+=".";h.innerHTML=a;l=(l+1)%4}b.content||b.result?(f.innerHTML="Cancel","download"===b.type?0<b.content.length&&b.content[0].href&&(k.innerHTML=d,q=b.content[0].href):
   "shapeways"===b.type?b.result.err?k.innerHTML="Ok":b.result.href&&(k.innerHTML="Go to ShapeWays",q=b.result.href):k.innerHTML="Ok",k.hidden=!(k.innerHTML&&0<k.innerHTML.length)):(f.innerHTML="Cancel",q="",k.innerHTML="",k.hidden=!0);return!0};a=b.exports.addEventListener(b.exports.EVENTTYPE.STATUS,function(a){w(a)&&(v.show(),p=!0)});a.data&&r.push(a.data);a=b.exports.addEventListener(b.exports.EVENTTYPE.AVAILABLE,function(a){w(a)&&(v.show(),p=!0)});a.data&&r.push(a.data);f.onclick=function(){m&&n.push(m);
   m=null;v.hide();p=!1};k.onclick=function(){m&&n.push(m);m=null;q&&(window.open(q,"_blank"),q="");v.hide();p=!1};return{destroy:function(){k.onclick=null;f.onclick=null;u.removeChild(e);r.forEach(function(a){return b.export.removeEventListener(a)})}}}};var module$src$modules$shapediver_state_dashboard$StatePromise={default:{}},__awaiter$$module$src$modules$shapediver_state_dashboard$StatePromise=this&&module$src$modules$shapediver_state_dashboard$StatePromise.default.__awaiter||function(b,a,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,h){function g(a){try{l(d.next(a))}catch(n){h(n)}}function k(a){try{l(d["throw"](a))}catch(n){h(n)}}function l(a){a.done?c(a.value):e(a.value).then(g,k)}
   l((d=d.apply(b,a||[])).next())})},__generator$$module$src$modules$shapediver_state_dashboard$StatePromise=this&&module$src$modules$shapediver_state_dashboard$StatePromise.default.__generator||function(b,a){function c(a){return function(b){return d([a,b])}}function d(c){if(g)throw new TypeError("Generator is already executing.");for(;e;)try{if(g=1,h&&(f=c[0]&2?h["return"]:c[0]?h["throw"]||((f=h["return"])&&f.call(h),0):h.next)&&!(f=f.call(h,c[1])).done)return f;if(h=0,f)c=[c[0]&2,f.value];switch(c[0]){case 0:case 1:f=
   c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++;h=c[1];c=[0];continue;case 7:c=e.ops.pop();e.trys.pop();continue;default:if(!(f=e.trys,f=0<f.length&&f[f.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!f||c[1]>f[0]&&c[1]<f[3]))e.label=c[1];else if(6===c[0]&&e.label<f[1])e.label=f[1],f=c;else if(f&&e.label<f[2])e.label=f[2],e.ops.push(c);else{f[2]&&e.ops.pop();e.trys.pop();continue}}c=a.call(b,e)}catch(m){c=[6,m],h=0}finally{g=f=0}if(c[0]&5)throw c[1];return{value:c[0]?
   c[1]:void 0,done:!0}}var e={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},g,h,f,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k};Object.defineProperty(module$src$modules$shapediver_state_dashboard$StatePromise.default,"__esModule",{value:!0});
   module$src$modules$shapediver_state_dashboard$StatePromise.default.State=function(){function b(){var a=this;this._resolved=!1;this._promise=new Promise(function(b,d){a._resolve=b;a._reject=d});this._promise.then(function(b){a._resolved=!0;return b})}Object.defineProperty(b.prototype,"resolved",{get:function(){return this._resolved},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"resolve",{get:function(){return this._resolve},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
   "reject",{get:function(){return this._reject},enumerable:!0,configurable:!0});b.prototype.then=function(a){return __awaiter$$module$src$modules$shapediver_state_dashboard$StatePromise(this,void 0,void 0,function(){return __generator$$module$src$modules$shapediver_state_dashboard$StatePromise(this,function(b){return[2,this._promise.then(a)]})})};return b}();var module$src$modules$shapediver_state_dashboard$StateDashboard={default:{}};Object.defineProperty(module$src$modules$shapediver_state_dashboard$StateDashboard.default,"__esModule",{value:!0});
   var StatePromise_1$$module$src$modules$shapediver_state_dashboard$StateDashboard=module$src$modules$shapediver_state_dashboard$StatePromise.default,StateDashboard$$module$src$modules$shapediver_state_dashboard$StateDashboard=function(){function b(){this._firstTimeVisible=new module$src$modules$shapediver_state_dashboard$StatePromise.default.State;this._settingsLoaded=new module$src$modules$shapediver_state_dashboard$StatePromise.default.State;this._customStates={}}Object.defineProperty(b.prototype,
   "firstTimeVisible",{get:function(){return this._firstTimeVisible},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"settingsLoaded",{get:function(){return this._settingsLoaded},enumerable:!0,configurable:!0});b.prototype.getCustomState=function(a){return this._customStates[a]};b.prototype.createCustomState=function(a){this._customStates[a]=new module$src$modules$shapediver_state_dashboard$StatePromise.default.State;return this._customStates[a]};return b}();
   module$src$modules$shapediver_state_dashboard$StateDashboard.default.StateDashboardLibrary=function(){function b(){}b.getInstance=function(a){b.instances[a]||(b.instances[a]=new StateDashboard$$module$src$modules$shapediver_state_dashboard$StateDashboard);return b.instances[a]};b.instances={};return b}();var module$src$shared$pubsub$PubSub={default:function(b){function a(a){for(var b in a)if(a.hasOwnProperty(b))return!0;return!1}function c(a){return function(){throw a;}}function d(a,b,d){try{a(b,d)}catch(u){setTimeout(c(u),0)}}function e(a,b,c){a(b,c)}function g(a,b,c,g){var f=k[b];g=g?e:d;var h;if(k.hasOwnProperty(b))for(h in f)f.hasOwnProperty(h)&&g(f[h],a,c)}function h(a,b,c){return function(){var d=String(a),e=d.lastIndexOf(".");for(g(a,a,b,c);-1!==e;)d=d.substr(0,e),e=d.lastIndexOf("."),g(a,
   d,b,c)}}function f(b,c,d,e){c=h(b,c,e);b=String(b);e=!(!k.hasOwnProperty(b)||!a(k[b]));for(var g=b.lastIndexOf(".");!e&&-1!==g;)b=b.substr(0,g),g=b.lastIndexOf("."),e=!(!k.hasOwnProperty(b)||!a(k[b]));if(!e)return!1;!0===d?c():setTimeout(c,0);return!0}var k={},l=-1,m=this;b=b||{};"boolean"!==typeof b.immediateExceptions&&(b.immediateExceptions=!1);m.publish=function(a,c){return f(a,c,!1,b.immediateExceptions)};m.publishSync=function(a,c){return f(a,c,!0,b.immediateExceptions)};m.subscribe=function(a,
   b){if("function"!==typeof b)return!1;k.hasOwnProperty(a)||(k[a]={});var c="uid_"+String(++l);k[a][c]=b;return c};m.subscribeOnce=function(a,b){var c=m.subscribe(a,function(){m.unsubscribe(c);b.apply(this,arguments)});return m};m.clearAllSubscriptions=function(){k={}};m.clearSubscriptions=function(a){for(var b in k)k.hasOwnProperty(b)&&0===b.indexOf(a)&&delete k[b]};m.unsubscribe=function(a){var b;if((b="string"===typeof a)&&!(b=k.hasOwnProperty(a)))a:{for(var c in k)if(k.hasOwnProperty(c)&&0===c.indexOf(a)){b=
   !0;break a}b=!1}var d=b;c=!d&&"string"===typeof a;b="function"===typeof a;var e=!1,g,f;if(d)m.clearSubscriptions(a);else{for(g in k)if(k.hasOwnProperty(g)){d=k[g];if(c&&d[a]){delete d[a];e=a;break}if(b)for(f in d)d.hasOwnProperty(f)&&d[f]===a&&(delete d[f],e=!0)}return e}}}};var module$src$app$partials$ViewerAppLoggingPartial={},VIEWERAPPCONSTANTS$$module$src$app$partials$ViewerAppLoggingPartial=module$src$app$ViewerAppConstants.default,PUBSUB$$module$src$app$partials$ViewerAppLoggingPartial=module$src$shared$pubsub$PubSub.default;
   module$src$app$partials$ViewerAppLoggingPartial.default=function(){var b=this,a=new module$src$shared$pubsub$PubSub.default;this.subscribeToLogStream=function(b,c,d){if(!Array.isArray(b)){for(var e=[],g=0;g<=b;g++)e.push(g);b=e}Array.isArray(c)||(c=[c]);var h=[];b.forEach(function(b){c.forEach(function(c){var e=b.toString();0<c.length&&(e+="."+c);h.push(a.subscribe(e,d))})});return h};this.unsubscribeFromLogStream=function(b){b.forEach(function(b){a.unsubscribe(b)})};var c=function(a,c){var d=Number(a.slice(0,
   1));a=a.slice(2);b.logToConsole.apply(b,[d,a].concat($jscomp.arrayFromIterable(c)))},d=this.subscribeToLogStream(b.getSetting("loggingLevel"),"",c);this.log=function(){var b=1===arguments.length?[arguments[0]]:Array.apply(null,arguments),c=b[0],d=b[1];b=b.slice(2);c=c.toString();"string"===typeof d&&0<d.length&&(c+="."+d);a.publish(c,[].concat($jscomp.arrayFromIterable(b)))};this.registerHook("loggingLevel",function(a){b.unsubscribeFromLogStream(d);d=b.subscribeToLogStream(a,"",c);b.log(module$src$app$ViewerAppConstants.default.loggingLevels.DEBUG,
   "ViewerApp.loggingLevelUpdateHook","loggingLevel set from "+b.getLoggingLevelName(b.getSetting("loggingLevel"))+" to "+b.getLoggingLevelName(a));return!0})};var module$src$app$partials$ViewerAppMessagingPartial={},GLOBALUTILS$$module$src$app$partials$ViewerAppMessagingPartial=module$src$shared$util$GlobalUtils.default,MESSAGINGCONSTANTS$$module$src$app$partials$ViewerAppMessagingPartial=module$src$shared$constants$MessagingConstants.default,PUBSUB$$module$src$app$partials$ViewerAppMessagingPartial=module$src$shared$pubsub$PubSub.default;
   module$src$app$partials$ViewerAppMessagingPartial.default=function(){var b=this,a=new module$src$shared$pubsub$PubSub.default;this.message=function(c,e){c=c===module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS&&e.token&&e.token.id?c+"."+e.token.id:c;b.messageToPubSub(c,e,a,{});b.messageToLog(c,e)};this.subscribeToMessageStream=function(b,c){Array.isArray(b)||(b=[b]);var d=[];b.forEach(function(b){d.push(a.subscribe(b,c))});return d};this.unsubscribeFromMessageStream=function(b){Array.isArray(b)||
   (b=[b]);var c=!0;b.forEach(function(b){a.unsubscribe(b)||(c=!1)});return c};this.setupDispatching=function(a){var c=[];Object.keys(a).forEach(function(d){var e=a[d].partListeners;d=b.subscribeToMessageStream(d,function(a,c){Array.isArray(c.parts)||(c.parts=[],b.warn("ViewerAppMessagingPartial.setupDispatching","Message without data parts: "+JSON.stringify(c,null,0)));c.parts.forEach(function(d){e.forEach(function(e){if(d.type===e.type){var g=e.cb;"string"===typeof g&&0<g.length&&(g=module$src$shared$util$GlobalUtils.default.getAt(b,
   g.split(".")));if("function"===typeof g){var f=[];f=Array.isArray(e.params)?e.params.map(function(b){if("type"===b)return d.type;if("data"===b)return d.data;if("token"===b)return c.token;if("origin"===b)return c.origin;if("topic"===b)return a;if("plugin"===b)return c.origin.plugin}):[c.token,d.data,d.type,c.origin];g=Promise.resolve(g.apply(b,f));g.then(function(a){!1===a&&b.debug("ViewerAppMessagingPartial.setupDispatching","Message callback returned false",e,f)});g.catch(function(a){b.error("ViewerAppMessagingPartial.setupDispatching",
   "Error in message callback: "+a.message,a,e,f)})}}})})});c=c.concat(d)});return c};var c=[];this.subscribeToMessageStream(module$src$shared$constants$MessagingConstants.default.messageTopics.STATUS_FAILED,function(a,b){(a=b.getUniquePartByType(module$src$shared$constants$MessagingConstants.default.messageDataTypes.STATUS_MESSAGE))&&a.data&&c.push(a.data)});this.getFailedStatusMessages=function(){return c}};var module$src$app$partials$ViewerAppPluginManager={},pluginConstants$$module$src$app$partials$ViewerAppPluginManager=module$src$plugins$PluginConstants.default,MessagePrototype$$module$src$app$partials$ViewerAppPluginManager=module$src$shared$messages$MessagePrototype.default;
   module$src$app$partials$ViewerAppPluginManager.default=function(){var b=this,a={},c=[],d=[];a.getStatusDescription=function(){var a=[];c.forEach(function(b){a.push(b.getStatusDescription())});return a};a.registerPlugin=function(e){if(e.getStatus()!==module$src$plugins$PluginConstants.default.pluginStatuses.READY)b.error("ViewerAppPluginManager.registerPlugin","Unexpected plugin status before loading: "+e.getStatus());else{var g=e.getRuntimeId();if(void 0!==a.getPluginByRuntimeId(g))b.error("ViewerAppPluginManager.registerPlugin",
   "Plugin with runtime id "+g+" already loaded");else{e.log=function(){var a=1===arguments.length?[arguments[0]]:Array.apply(null,arguments),c=a[0],d=a[1];a=a.slice(2);d=e.getShortName()+"."+g+"."+d;b.log.apply(b,[c,d].concat($jscomp.arrayFromIterable(a)))};e.message=function(a,c){if(void 0===c.origin||"object"!==typeof c.origin)c.origin={};c.origin.plugin=g;void 0!==c.token&&"object"===typeof c.token&&void 0===c.token.creator&&(c.token.creator={plugin:g});b.message(a,c)};e.app={api:b.api};e.app.getContainer=
   b.getContainer;var f=e.getCapabilities();f.includes(module$src$plugins$PluginConstants.default.pluginCapabilities.INTERACTIVE)&&(e.app.sceneGeometryManager=b.sceneGeometryManager,e.app.viewportManager=b.viewportManager);f.includes(module$src$plugins$PluginConstants.default.pluginCapabilities.DRAGANDDROP)&&(e.app.sceneGeometryManager=b.sceneGeometryManager,e.app.viewportManager=b.viewportManager);var h=[];if(f.includes(module$src$plugins$PluginConstants.default.pluginCapabilities.MESSAGECALLBACKS)&&
   b.subscribeToMessageStream){f=e.getMessageCallbacks();for(var n in f){var q=b.subscribeToMessageStream(n,f[n]);h=h.concat(q)}}if(e.load({loggingLevel:b.getSetting("loggingLevel")}))if(e.getStatus()!==module$src$plugins$PluginConstants.default.pluginStatuses.LOADED&&e.getStatus()!==module$src$plugins$PluginConstants.default.pluginStatuses.ACTIVE)b.error("ViewerAppPluginManager.registerPlugin","Unexpected plugin status after loading: "+e.getStatus());else return b.message(module$src$plugins$PluginConstants.default.messageTopics.PLUGIN_REGISTERED,
   new module$src$shared$messages$MessagePrototype.default(module$src$plugins$PluginConstants.default.messageDataTypes.PLUGIN_RUNTIME_ID,g)),b.info("ViewerAppPluginManager.registerPlugin",'Registered plugin "'+e.getName()+'" with capabilities '+JSON.stringify(e.getCapabilities())+" and runtime id "+e.getRuntimeId()),c.push(e),d.push(h),g;else b.error("ViewerAppPluginManager.registerPlugin",'Failed to load plugin "'+e.getName()+'" with runtime id '+g)}}};a.deregisterPlugin=function(a){var e=c.findIndex(function(b){return b.getRuntimeId()===
   a});if(-1===e)return b.error("ViewerAppPluginManager.deregisterPlugin","Plugin with runtimeId "+a+" not found"),!1;b.unsubscribeFromMessageStream&&b.unsubscribeFromMessageStream(d[e]);var g=c.splice(e,1)[0];d.splice(e,1);b.info("ViewerAppPluginManager.deregisterPlugin",'Deregistered plugin "'+g.getName()+'" with capabilities '+JSON.stringify(g.getCapabilities())+" and runtime id "+g.getRuntimeId());return!0};a.getRuntimeIds=function(){for(var a=c.length,b=Array(c.length),d=0;d<a;d++)b[d]=c[d].getRuntimeId();
   return b};a.getPluginByRuntimeId=function(a){return c.find(function(b){return b.getRuntimeId()===a})};a.getPluginByName=function(a){return c.find(function(b){return b.getName()===a})};a.getPluginByShortName=function(a){return c.find(function(b){return b.getShortName()===a})};a.getPluginByCapabilities=function(a){a||(a=[]);Array.isArray(a)||(a=[a]);return c.find(function(b){var c=b.getCapabilities();return a.every(function(a){return c.includes(a)})})};var e=999,g=Promise.resolve(),h=function(a,d){var f=
   a.indexOf("."),m=Number(a.slice(0,f))&module$src$plugins$PluginConstants.default.loggingLevels.LVLBITS,k=a.slice(f+1),q=c.find(function(a){return a.getCapabilities().includes(module$src$plugins$PluginConstants.default.pluginCapabilities.LOGGING)});q?g=g.finally(function(){b.debug("ViewerAppPluginManager._logToServer","Logging to server",{loggingLevel:m,scope:k,data:d});Array.isArray(d)||(d=[d]);q.logToServer.apply(q,[m,k].concat($jscomp.arrayFromIterable(d))).catch(function(a){b.warn("ViewerAppPluginManager._logToServer",
   a)});e=999}).finally(function(){return new Promise(function(a){setTimeout(a,9999)})}):(b.debug("ViewerAppPluginManager._logToServer","Delaying logging to server by "+e+"msec",{loggingLevel:m,scope:k,data:d}),setTimeout(h,e,a,d),e*=2)};"function"===typeof b.subscribeToLogStream&&b.subscribeToLogStream([module$src$plugins$PluginConstants.default.loggingLevels.ERROR_S,module$src$plugins$PluginConstants.default.loggingLevels.WARN_S,module$src$plugins$PluginConstants.default.loggingLevels.INFO_S,module$src$plugins$PluginConstants.default.loggingLevels.DEBUG_S],
   "",h);return a};var module$src$shared$exceptions$MissingImplementationException={default:function(){}};module$src$shared$exceptions$MissingImplementationException.default.prototype.toString=function(){return"Missing implementation"};var module$src$shared$interfaces$ParameterInterface={},MissingImplementationException$$module$src$shared$interfaces$ParameterInterface=module$src$shared$exceptions$MissingImplementationException.default;
   module$src$shared$interfaces$ParameterInterface.default=function(){this.setValue=function(){throw new module$src$shared$exceptions$MissingImplementationException.default;};this.parseValue=function(){throw new module$src$shared$exceptions$MissingImplementationException.default;};this.getValue=function(){throw new module$src$shared$exceptions$MissingImplementationException.default;};this.getValueString=function(){throw new module$src$shared$exceptions$MissingImplementationException.default;};this.checkValue=
   function(){throw new module$src$shared$exceptions$MissingImplementationException.default;};this.isValid=function(){throw new module$src$shared$exceptions$MissingImplementationException.default;};this.getDefinition=function(){throw new module$src$shared$exceptions$MissingImplementationException.default;}};var module$src$shared$types$ShapeDiverParameters={default:{}},GlobalUtils$$module$src$shared$types$ShapeDiverParameters=module$src$shared$util$GlobalUtils.default,toTinyColor$$module$src$shared$types$ShapeDiverParameters=module$src$shared$util$toTinyColor.default,uuidv4Regex$$module$src$shared$types$ShapeDiverParameters=/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,defaultSettings$$module$src$shared$types$ShapeDiverParameters={strictMode:!0},CommonParameter$$module$src$shared$types$ShapeDiverParameters=
   function(b){var a=this;module$src$shared$mixins$GlobalMixin.default.call(this);module$src$shared$interfaces$ParameterInterface.default.call(this);var c=function(a,b){return Array.isArray(a)&&"array"===b||typeof a===b?!0:!1};void 0===b||"object"!==typeof b?b=defaultSettings$$module$src$shared$types$ShapeDiverParameters:(b=module$src$shared$util$GlobalUtils.default.deepCopy(b),module$src$shared$util$GlobalUtils.default.defaults(b,defaultSettings$$module$src$shared$types$ShapeDiverParameters));void 0===
   b.isValid&&(b.isValid=!0);if(void 0===b.name||"string"!==typeof b.name||0===b.name.length)b.name="Generic parameter";if(void 0===b.valuetype||"string"!==typeof b.valuetype||0===b.valuetype.length)void 0!==b.defval?Array.isArray(b.defval)?b.valuetype="array":b.valuetype=typeof b.defval:(b.valuetype="number",b.isValid=!1);void 0!==b.defval&&c(b.defval,b.valuetype)||(b.defval=0,b.isValid=!1);void 0===b.value?b.value=b.defval:c(b.value,b.valuetype)||(b.isValid=!1);module$src$shared$mixins$SettingsMixin.default.call(this,
   b);this.registerHook("valuetype",function(){return!1});this.registerHook("defval",function(b){return a.checkValue(b)});this.registerHook("value",function(b){return a.checkValue(b)});this.registerHook("isValid",function(){return!1});module$src$shared$mixins$LoggingMixin.default.call(this);this.isValid=function(){return a.getSetting("isValid")};this.checkValue=function(b){return c(b,a.getSettingShallow("valuetype"))};this.setValue=function(b){return a.updateSetting("value",b)};this.getValue=function(){return a.getSetting("value")};
   this.getValueString=function(){return a.getValue().toString()};this.parseValue=function(b){if("string"!==typeof b)return!1;var c=a.getSettingShallow("valuetype");if("string"===c)return a.setValue(b);if("number"===c)return a.setValue(parseFloat(b));if("boolean"===c)return"false"===b.toLowerCase()?a.setValue(!1):a.setValue(!!b);if("object"===c||"array"===c)try{return a.setValue(JSON.Parse(b))}catch(g){return a.debug("CommonParameter.parseValue",g),!1}else return!1};this.isValueDifferent=function(b){var c=
   a.getSettingShallow("valuetype"),d=a.getSettingShallow("value");return"array"===c||"object"===c?(c=JSON.stringify(d,null,0),b=JSON.stringify(b,null,0),c!==b):d!==b};a.toString=function(){var b='Parameter "'+a.getSetting("name")+'"';return b+="\n\tsettings: "+JSON.stringify(a.getSettings(),null,0)};this.acceptsBlobs=function(){return!1};this.checkBlob=function(b){if(!(a.acceptsBlobs()&&b instanceof Blob)||b.size>a.getSettingShallow("max"))return!1;b._type=0<b.type.length?b.type:module$src$shared$util$GlobalUtils.default.guessMimeTypeFromFilename(b.name);
   return a.getSettingShallow("format").includes(b._type)?!0:!1};return this};module$src$shared$types$ShapeDiverParameters.default.CommonParameter=CommonParameter$$module$src$shared$types$ShapeDiverParameters;
   var FloatParameter$$module$src$shared$types$ShapeDiverParameters=function(b){var a=this;void 0===b||"object"!==typeof b?b=defaultSettings$$module$src$shared$types$ShapeDiverParameters:(b=module$src$shared$util$GlobalUtils.default.deepCopy(b),module$src$shared$util$GlobalUtils.default.defaults(b,defaultSettings$$module$src$shared$types$ShapeDiverParameters));void 0===b.isValid&&(b.isValid=!0);"boolean"!==typeof b.strictMode||b.strictMode||(["decimalplaces"].forEach(function(a){"string"===typeof b[a]&&
   (b[a]=parseInt(b[a]))}),["min","max","defval","value"].forEach(function(a){"string"===typeof b[a]&&(b[a]=parseFloat(b[a]))}));if(void 0===b.name||"string"!==typeof b.name||0===b.name.length)b.name="Float parameter";b.valuetype="number";if(void 0===b.decimalplaces||"number"!==typeof b.decimalplaces||0>b.decimalplaces)b.decimalplaces=20;if(void 0===b.min||"number"!==typeof b.min)b.min=-Number.MAX_VALUE;if(void 0===b.max||"number"!==typeof b.max)b.max=Number.MAX_VALUE;b.min>b.max&&(b.min=b.max,b.isValid=
   !1);if(void 0===b.defval||"number"!==typeof b.defval||b.defval<b.min||b.defval>b.max)b.defval=b.min,b.isValid=!1;if(void 0===b.value||"number"!==typeof b.value||b.value<b.min||b.value>b.max)b.value=b.defval;CommonParameter$$module$src$shared$types$ShapeDiverParameters.call(this,b);this.registerHook("decimalplaces",function(){return!1});this.registerHook("min",function(b){return a.getSettingShallow("value")>=b?!0:!1});this.registerHook("max",function(b){return a.getSettingShallow("value")<=b?!0:!1});
   var c=this.setValue;this.setValue=function(b){"string"!==typeof b||a.getSettingShallow("strictMode")||(b=parseFloat(b));if("number"!==typeof b)return!1;var d=b,e=a.getSettingShallow("decimalplaces");e<Number.MAX_SAFE_INTEGER&&(d=parseFloat(b.toFixed(e)));return c(d)};this.getValueString=function(){var b=a.getSettingShallow("decimalplaces");return b<Number.MAX_SAFE_INTEGER?a.getValue().toFixed(b):a.getValue()};var d=this.checkValue;this.checkValue=function(b){"string"!==typeof b||a.getSettingShallow("strictMode")||
   (b=parseFloat(b));return d(b)?b>=a.getSettingShallow("min")&&b<=a.getSettingShallow("max"):!1};this.getDefinition=function(){return a.getSettings("id name plugin note type decimalplaces defval group max min visualization _name order hidden".split(" "))};return this};module$src$shared$types$ShapeDiverParameters.default.FloatParameter=FloatParameter$$module$src$shared$types$ShapeDiverParameters;
   var IntegerParameter$$module$src$shared$types$ShapeDiverParameters=function(b){void 0===b||"object"!==typeof b?b=defaultSettings$$module$src$shared$types$ShapeDiverParameters:(b=module$src$shared$util$GlobalUtils.default.deepCopy(b),module$src$shared$util$GlobalUtils.default.defaults(b,defaultSettings$$module$src$shared$types$ShapeDiverParameters));void 0===b.isValid&&(b.isValid=!0);"boolean"!==typeof b.strictMode||b.strictMode||["decimalplaces","min","max","defval","value"].forEach(function(a){"string"===
   typeof b[a]&&(b[a]=parseInt(b[a]))});if(void 0===b.name||"string"!==typeof b.name||0===b.name.length)b.name="Integer parameter";void 0===b.decimalplaces&&(b.decimalplaces=0);if("number"!==typeof b.decimalplaces||0!==b.decimalplaces)b.decimalplaces=0,b.isValid=!1;if(void 0===b.min||"number"!==typeof b.min)b.min=Number.MIN_SAFE_INTEGER;if(void 0===b.max||"number"!==typeof b.max)b.max=Number.MAX_SAFE_INTEGER;b.min>b.max&&(b.min=b.max,b.isValid=!1);if(void 0===b.defval||"number"!==typeof b.defval||b.defval<
   b.min||b.defval>b.max||Math.round(b.defval)!==b.defval)b.defval=b.min,b.isValid=!1;if(void 0===b.value||"number"!==typeof b.value||b.value<b.min||b.value>b.max||Math.round(b.value)!==b.value)b.value=b.defval;FloatParameter$$module$src$shared$types$ShapeDiverParameters.call(this,b);return this};module$src$shared$types$ShapeDiverParameters.default.IntegerParameter=IntegerParameter$$module$src$shared$types$ShapeDiverParameters;
   var EvenIntegerParameter$$module$src$shared$types$ShapeDiverParameters=function(b){void 0===b||"object"!==typeof b?b=defaultSettings$$module$src$shared$types$ShapeDiverParameters:(b=module$src$shared$util$GlobalUtils.default.deepCopy(b),module$src$shared$util$GlobalUtils.default.defaults(b,defaultSettings$$module$src$shared$types$ShapeDiverParameters));void 0===b.isValid&&(b.isValid=!0);"boolean"!==typeof b.strictMode||b.strictMode||["decimalplaces","min","max","defval","value"].forEach(function(a){"string"===
   typeof b[a]&&(b[a]=parseInt(b[a]))});if(void 0===b.name||"string"!==typeof b.name||0===b.name.length)b.name="Even integer parameter";if(void 0===b.min||"number"!==typeof b.min)b.min=Number.MIN_SAFE_INTEGER;if(void 0===b.max||"number"!==typeof b.max)b.max=Number.MAX_SAFE_INTEGER;b.min>b.max&&(b.min=b.max,b.isValid=!1);if(void 0===b.defval||"number"!==typeof b.defval||b.defval<b.min||b.defval>b.max||0!==b.defval%2)b.defval=b.min,b.isValid=!1;if(void 0===b.value||"number"!==typeof b.value||b.value<b.min||
   b.value>b.max||0!==b.value%2)b.value=b.defval;IntegerParameter$$module$src$shared$types$ShapeDiverParameters.call(this,b);var a=this.checkValue;this.checkValue=function(b){return a(b)?0===b%2:!1};return this};module$src$shared$types$ShapeDiverParameters.default.EvenIntegerParameter=EvenIntegerParameter$$module$src$shared$types$ShapeDiverParameters;
   var OddIntegerParameter$$module$src$shared$types$ShapeDiverParameters=function(b){void 0===b||"object"!==typeof b?b=defaultSettings$$module$src$shared$types$ShapeDiverParameters:(b=module$src$shared$util$GlobalUtils.default.deepCopy(b),module$src$shared$util$GlobalUtils.default.defaults(b,defaultSettings$$module$src$shared$types$ShapeDiverParameters));void 0===b.isValid&&(b.isValid=!0);"boolean"!==typeof b.strictMode||b.strictMode||["decimalplaces","min","max","defval","value"].forEach(function(a){"string"===
   typeof b[a]&&(b[a]=parseInt(b[a]))});if(void 0===b.name||"string"!==typeof b.name||0===b.name.length)b.name="Even integer parameter";if(void 0===b.min||"number"!==typeof b.min)b.min=Number.MIN_SAFE_INTEGER;if(void 0===b.max||"number"!==typeof b.max)b.max=Number.MAX_SAFE_INTEGER;b.min>b.max&&(b.min=b.max,b.isValid=!1);if(void 0===b.defval||"number"!==typeof b.defval||b.defval<b.min||b.defval>b.max||1!==Math.abs(b.defval%2))b.defval=b.min,b.isValid=!1;if(void 0===b.value||"number"!==typeof b.value||
   b.value<b.min||b.value>b.max||1!==Math.abs(b.value%2))b.value=b.defval;IntegerParameter$$module$src$shared$types$ShapeDiverParameters.call(this,b);var a=this.checkValue;this.checkValue=function(b){return a(b)?1===Math.abs(b%2):!1};return this};module$src$shared$types$ShapeDiverParameters.default.OddIntegerParameter=OddIntegerParameter$$module$src$shared$types$ShapeDiverParameters;
   var ValueListParameter$$module$src$shared$types$ShapeDiverParameters=function(b){var a=this;void 0===b||"object"!==typeof b?b=defaultSettings$$module$src$shared$types$ShapeDiverParameters:(b=module$src$shared$util$GlobalUtils.default.deepCopy(b),module$src$shared$util$GlobalUtils.default.defaults(b,defaultSettings$$module$src$shared$types$ShapeDiverParameters));void 0===b.isValid&&(b.isValid=!0);"boolean"!==typeof b.strictMode||b.strictMode||["defval"].forEach(function(a){"string"===typeof b[a]&&
   (b[a]=parseInt(b[a]))});if(void 0===b.name||"string"!==typeof b.name||0===b.name.length)b.name="Value list parameter";void 0!==b.choices&&Array.isArray(b.choices)||(b.choices=[],b.isValid=!1);b.min=0;b.max=b.choices.length-1;if(void 0===b.defval||"number"!==typeof b.defval||b.defval<b.min||b.defval>b.max)b.defval=b.min,b.isValid=!1;IntegerParameter$$module$src$shared$types$ShapeDiverParameters.call(this,b);this.registerHook("min",function(){return!1});this.registerHook("max",function(){return!1});
   this.registerHook("choices",function(){return!1});this.getChoices=function(){return a.getSetting("choices")};this.getSelectedChoice=function(){return a.getSetting("choices")[a.getSettingShallow("value")]};this.getDefinition=function(){return a.getSettings("id name plugin note type choices defval group visualization _name order hidden".split(" "))};return this};module$src$shared$types$ShapeDiverParameters.default.ValueListParameter=ValueListParameter$$module$src$shared$types$ShapeDiverParameters;
   var MultipleChoiceParameter$$module$src$shared$types$ShapeDiverParameters=function(b){var a=this,c=function(b,c,d){void 0===d&&(d=!0);if("string"===typeof b&&!d)if(!b.startsWith("[")&&b.includes(","))try{b=JSON.parse("["+b+"]")}catch(l){a.debug("MultipleChoiceParameter._checkValue",l);return}else if(b=parseInt(b),isNaN(b))return;if("number"===typeof b){if(0<=b&&b<=c)return[b]}else if(Array.isArray(b)){var e=[];if(b.every(function(a,g){if("string"===typeof a&&!d){a=parseInt(a);if(!isNaN(a))return!1;
   b[g]=a}return"number"===typeof a&&0<=a&&a<=c&&-1===e.indexOf(a)?(e.push(a),!0):!1}))return e}};void 0===b||"object"!==typeof b?b=defaultSettings$$module$src$shared$types$ShapeDiverParameters:(b=module$src$shared$util$GlobalUtils.default.deepCopy(b),module$src$shared$util$GlobalUtils.default.defaults(b,defaultSettings$$module$src$shared$types$ShapeDiverParameters));void 0===b.isValid&&(b.isValid=!0);var d=!0;"boolean"!==typeof b.strictMode||b.strictMode||(d=!1);if(void 0===b.name||"string"!==typeof b.name||
   0===b.name.length)b.name="Multiple value list parameter";void 0!==b.choices&&Array.isArray(b.choices)||(b.choices=[],b.isValid=!1);b.min=0;b.max=b.choices.length-1;"string"===typeof b.defval&&!d||void 0!==b.defval&&("number"===typeof b.defval||Array.isArray(b.defval))?(b.defval=c(b.defval,b.max,d),void 0===b.defval&&(b.defval=[],b.isValid=!1)):(b.defval=[],b.isValid=!1);void 0===b.value&&(b.value=b.defval);"number"===typeof b.value||Array.isArray(b.value)?(b.value=c(b.value,b.max,d),void 0===b.value&&
   (b.value=b.defval,b.isValid=!1)):(b.value=b.defval,b.isValid=!1);CommonParameter$$module$src$shared$types$ShapeDiverParameters.call(this,b);this.registerHook("min",function(){return!1});this.registerHook("max",function(){return!1});this.registerHook("choices",function(){return!1});this.getChoices=function(){return a.getSetting("choices")};this.getSelectedChoices=function(){var b=a.getSetting("choices"),c=[];a.getSettingShallow("value").forEach(function(a){c.push(b[a])});return c};this.checkValue=
   function(b){return void 0!==c(b,a.getSettingShallow("max"),a.getSettingShallow("strictMode"))};this.getValueString=function(){var b=JSON.stringify(a.getValue(),null,0);b=b.replace("[","");return b=b.replace("]","")};var e=this.setValue;this.setValue=function(b){b=c(b,a.getSettingShallow("max"),a.getSettingShallow("strictMode"));return void 0===b?!1:e(b)};this.parseValue=function(b){b=c(b,a.getSettingShallow("max"),!1);return a.setValue(b)};this.getDefinition=function(){return a.getSettings("id name plugin note type choices defval group visualization _name order hidden".split(" "))};
   return this};module$src$shared$types$ShapeDiverParameters.default.MultipleChoiceParameter=MultipleChoiceParameter$$module$src$shared$types$ShapeDiverParameters;
   var StringParameter$$module$src$shared$types$ShapeDiverParameters=function(b){var a=this;void 0===b||"object"!==typeof b?b=defaultSettings$$module$src$shared$types$ShapeDiverParameters:(b=module$src$shared$util$GlobalUtils.default.deepCopy(b),module$src$shared$util$GlobalUtils.default.defaults(b,defaultSettings$$module$src$shared$types$ShapeDiverParameters));b.valuetype="string";void 0===b.isValid&&(b.isValid=!0);"boolean"!==typeof b.strictMode||b.strictMode||["max"].forEach(function(a){"string"===
   typeof b[a]&&(b[a]=parseInt(b[a]))});if(void 0===b.name||"string"!==typeof b.name||0===b.name.length)b.name="String parameter";if(void 0===b.max||"number"!==typeof b.max)b.max=Number.MAX_SAFE_INTEGER,b.isValid=!1;if(void 0===b.defval||"string"!==typeof b.defval)b.defval="",b.isValid=!1;b.defval.length>b.max&&(b.defval=b.defval.slice(0,b.max),b.isValid=!1);void 0!==b.value&&"string"!==typeof b.value&&(b.value=b.defval,b.isValid=!1);void 0!==b.value&&b.value.length>b.max&&(b.value=b.value.slice(0,b.max),
   b.isValid=!1);CommonParameter$$module$src$shared$types$ShapeDiverParameters.call(this,b);var c=this.checkValue;this.checkValue=function(b){return c(b)?b.length<=a.getSettingShallow("max"):!1};this.getDefinition=function(){return a.getSettings("id name plugin note type defval group max _name order hidden".split(" "))};return this};module$src$shared$types$ShapeDiverParameters.default.StringParameter=StringParameter$$module$src$shared$types$ShapeDiverParameters;
   var BooleanParameter$$module$src$shared$types$ShapeDiverParameters=function(b){var a=this;void 0===b||"object"!==typeof b?b=defaultSettings$$module$src$shared$types$ShapeDiverParameters:(b=module$src$shared$util$GlobalUtils.default.deepCopy(b),module$src$shared$util$GlobalUtils.default.defaults(b,defaultSettings$$module$src$shared$types$ShapeDiverParameters));b.valuetype="boolean";void 0===b.isValid&&(b.isValid=!0);"boolean"!==typeof b.strictMode||b.strictMode||"string"!==typeof b.defval||("false"===
   b.defval.toLowerCase()?b.defval=!1:"true"===b.defval.toLowerCase()?b.defval=!0:0>=parseInt(b.defval)?b.defval=!1:0<parseInt(b.defval)&&(b.defval=!0));if(void 0===b.name||"string"!==typeof b.name||0===b.name.length)b.name="Boolean parameter";if(void 0===b.defval||"boolean"!==typeof b.defval)b.defval=!1,b.isValid=!1;CommonParameter$$module$src$shared$types$ShapeDiverParameters.call(this,b);var c=this.checkValue;this.checkValue=function(b){if("string"===typeof b&&!a.getSettingShallow("strictMode"))if("true"===
   b.toLowerCase())b=!0;else if("false"===b.toLowerCase())b=!1;else return!1;return c(b)};var d=this.setValue;this.setValue=function(b){if("string"===typeof b&&!a.getSettingShallow("strictMode"))if("true"===b.toLowerCase())b=!0;else if("false"===b.toLowerCase())b=!1;else return!1;return d(b)};this.getDefinition=function(){return a.getSettings("id name plugin note type defval group _name order hidden".split(" "))};return this};module$src$shared$types$ShapeDiverParameters.default.BooleanParameter=BooleanParameter$$module$src$shared$types$ShapeDiverParameters;
   var ColorParameter$$module$src$shared$types$ShapeDiverParameters=function(b){var a=this,c=function(a){return a.toString("hex8").replace("#","0x")};void 0===b||"object"!==typeof b?b=defaultSettings$$module$src$shared$types$ShapeDiverParameters:(b=module$src$shared$util$GlobalUtils.default.deepCopy(b),module$src$shared$util$GlobalUtils.default.defaults(b,defaultSettings$$module$src$shared$types$ShapeDiverParameters));b.max=Number.MAX_SAFE_INTEGER;void 0===b.isValid&&(b.isValid=!0);if(void 0===b.name||
   "string"!==typeof b.name||0===b.name.length)b.name="Color parameter";void 0===b.defval&&(b.defval="white");var d=(0,module$src$shared$util$toTinyColor.default)(b.defval);null===d?(b.defval=(0,module$src$shared$util$toTinyColor.default)("white"),b.isValid=!1):b.defval=d;b.defval=c(b.defval);void 0===b.value?b.value=b.defval:(d=(0,module$src$shared$util$toTinyColor.default)(b.defval),null===d?(b.value=(0,module$src$shared$util$toTinyColor.default)("white"),b.isValid=!1):b.value=d);b.value=c(b.value);
   StringParameter$$module$src$shared$types$ShapeDiverParameters.call(this,b);var e=this.setValue;this.setValue=function(a){a=(0,module$src$shared$util$toTinyColor.default)(a);return null===a?!1:e(c(a))};this.getValue=function(){return c((0,module$src$shared$util$toTinyColor.default)(a.getSettingShallow("value")))};this.getValueTinyColor=function(){return(0,module$src$shared$util$toTinyColor.default)(a.getSettingShallow("value"))};this.getValueString=function(){return a.getValue()};this.parseValue=function(b){return a.setValue(b)};
   this.getDefinition=function(){return a.getSettings("id name plugin note type defval group _name order hidden".split(" "))};return this};module$src$shared$types$ShapeDiverParameters.default.ColorParameter=ColorParameter$$module$src$shared$types$ShapeDiverParameters;
   var FileParameter$$module$src$shared$types$ShapeDiverParameters=function(b){var a=this;void 0===b||"object"!==typeof b?b=defaultSettings$$module$src$shared$types$ShapeDiverParameters:(b=module$src$shared$util$GlobalUtils.default.deepCopy(b),module$src$shared$util$GlobalUtils.default.defaults(b,defaultSettings$$module$src$shared$types$ShapeDiverParameters));void 0===b.isValid&&(b.isValid=!0);if(void 0===b.name||"string"!==typeof b.name||0===b.name.length)b.name="File parameter";"boolean"!==typeof b.strictMode||
   b.strictMode||["max"].forEach(function(a){"string"===typeof b[a]&&(b[a]=parseInt(b[a]))});void 0===b.defval&&(b.defval="");"string"!==typeof b.defval&&(b.defval="",b.isValid=!1);void 0===b.value&&(b.value=b.defval);"string"!==typeof b.value&&(b.value="",b.isValid=!1);if(void 0===b.max||"number"!==typeof b.max)b.max=0,b.isValid=!1;module$src$shared$util$GlobalUtils.default.isArrayOfType(b.format,"string")||(b.format=[],b.isValid=!1);StringParameter$$module$src$shared$types$ShapeDiverParameters.call(this,
   b);var c=function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")?""===a||uuidv4Regex$$module$src$shared$types$ShapeDiverParameters.test(a)||a.startsWith("http://")||a.startsWith("https://")?!0:!1:!1};this.checkValue=function(a){return c(a)};var d=this.setValue;this.setValue=function(a){return c(a)?d(a):!1};this.acceptsBlobs=function(){return!0};this.getDefinition=function(){return a.getSettings("id name plugin note type defval group _name order hidden max format".split(" "))};
   return this};module$src$shared$types$ShapeDiverParameters.default.FileParameter=FileParameter$$module$src$shared$types$ShapeDiverParameters;
   var ParameterFactory$$module$src$shared$types$ShapeDiverParameters=function(b){var a=this;module$src$shared$mixins$GlobalMixin.default.call(this);module$src$shared$mixins$SettingsMixin.default.call(this,b);module$src$shared$mixins$LoggingMixin.default.call(this);var c=module$src$shared$util$GlobalUtils.default.deepCopy(b),d={"float":FloatParameter$$module$src$shared$types$ShapeDiverParameters,"int":IntegerParameter$$module$src$shared$types$ShapeDiverParameters,even:EvenIntegerParameter$$module$src$shared$types$ShapeDiverParameters,
   odd:OddIntegerParameter$$module$src$shared$types$ShapeDiverParameters,string:StringParameter$$module$src$shared$types$ShapeDiverParameters,color:ColorParameter$$module$src$shared$types$ShapeDiverParameters,"stringlist:sequence":ValueListParameter$$module$src$shared$types$ShapeDiverParameters,"stringlist:cycle":ValueListParameter$$module$src$shared$types$ShapeDiverParameters,"stringlist:dropdown":ValueListParameter$$module$src$shared$types$ShapeDiverParameters,"stringlist:checklist":MultipleChoiceParameter$$module$src$shared$types$ShapeDiverParameters,
   bool:BooleanParameter$$module$src$shared$types$ShapeDiverParameters,file:FileParameter$$module$src$shared$types$ShapeDiverParameters};this.produce=function(b){b=module$src$shared$util$GlobalUtils.default.deepCopy(b);if(void 0===b.type||"string"!==typeof b.type)a.debug("ShapeDiverParameters~factory","type not defined");else{var e=d[(b.type+":"+b.visualization).toLowerCase()];if(void 0===e&&(e=d[b.type.toLowerCase()],void 0===e)){a.debug("ShapeDiverParameters~factory","type not known: "+b.type.toLowerCase());
   return}try{b.hasOwnProperty("hidden")||(b.hidden=!1);module$src$shared$util$GlobalUtils.default.inject(c,b);var h=new e(b);if(h.isValid())return h;a.debug("ShapeDiverParameters~factory","created parameter not valid for "+a.jsify(b)+": "+a.jsify(h.getSettings())+", try to set strictMode to false")}catch(f){a.debug("ShapeDiverParameters~factory","exception creating parameter",b,f)}}};return this};module$src$shared$types$ShapeDiverParameters.default.ParameterFactory=ParameterFactory$$module$src$shared$types$ShapeDiverParameters;var module$src$app$partials$ViewerAppParameterManager={},GlobalUtils$$module$src$app$partials$ViewerAppParameterManager=module$src$shared$util$GlobalUtils.default,pluginConstants$$module$src$app$partials$ViewerAppParameterManager=module$src$shared$constants$PluginConstantsGlobal.default,messagingConstants$$module$src$app$partials$ViewerAppParameterManager=module$src$shared$constants$MessagingConstants.default,MessagePrototype$$module$src$app$partials$ViewerAppParameterManager=module$src$shared$messages$MessagePrototype.default;
   module$src$app$partials$ViewerAppParameterManager.default=function(b){var a=this,c={},d=[],e=new module$src$shared$types$ShapeDiverParameters.default.ParameterFactory({strictMode:!1});if(b&&b.hasOwnProperty("pluginManager")&&b.pluginManager.hasOwnProperty("getPluginByRuntimeId"))var g=b.pluginManager;var h=[],f=[],k=function(a){if(h.length!==f.length){for(var b=[],d=[],e=f.length,g=Math.max(0,e-50),l=g;l<e;l++)b.push(h[f[l]]),d.push(l-g);f=d;h=b}a||(a=c.getParameterState());h.push(a);f.push(h.length-
   1)};c.canGoBackInHistory=function(){return 0>=h.length||0>=f[f.length-1]?!1:!0};c.canGoForwardInHistory=function(){return 0>=h.length||f[f.length-1]>=h.length-1?!1:!0};c.goBackInHistory=function(a){if(!c.canGoBackInHistory())return!1;var b=f[f.length-1]-1;f.push(b);c.setMultipleParameterValues(h[b],a,!1,!0);return!0};c.goForwardInHistory=function(a){if(!c.canGoForwardInHistory())return!1;var b=f[f.length-1]+1;f.push(b);c.setMultipleParameterValues(h[b],a,!1,!0);return!0};c.registerMultipleParameters=
   function(a,b){var d=[];Object.keys(a).forEach(function(e){var g=module$src$shared$util$GlobalUtils.default.deepCopy(a[e]);g.id=e;"time"!==g.type.toLowerCase()&&(e=c.registerParameter(g,b),void 0!==e&&d.push(e))});return d};c.registerParameter=function(b,g){if(void 0===g||"string"!==typeof g)a.debug("ViewerAppParameterManager.registerParameter","No plugin specified");else if(b&&"object"===typeof b){b.plugin=g;if(void 0===b.id||"string"!==typeof b.id)b.id=module$src$shared$util$GlobalUtils.default.createRandomId(),
   a.debug("ViewerAppParameterManager.registerParameter","No id was specified, using "+b.id);if(void 0!==c.getUniqueParameterBySettings({id:b.id,plugin:g}))a.debug("ViewerAppParameterManager.registerParameter","Parameter with id "+b.id+" and plugin "+g+" already exists");else if(g=e.produce(b),void 0===g)a.debug("ViewerAppParameterManager.registerParameter","Parameter factory failed for definition",b);else return d.push(g),g={},g[b.id]=b,a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PARAMETER_REGISTERED,
   new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PARAMETER_DEFINITION,g)),b.id}else a.debug("ViewerAppParameterManager.registerParameter","Definition of parameter missing")};c.updateParameter=function(b){if(!b||"object"!==typeof b)return a.debug("ViewerAppParameterManager.updateParameter","Definition of parameter missing"),!1;var c=n(b);if(void 0===c)return a.debug("ViewerAppParameterManager.updateParameter","Parameter not found",
   b),!1;c=d[c];var e=c.getSetting("name");"string"===typeof b.name&&0<b.name.length&&b.name!==e&&(c.getSetting("_name")||c.updateSetting("_name",e),c.updateSetting("name",b.name));"number"===typeof b.order&&c.updateSetting("order",b.order);"boolean"===typeof b.hidden&&c.updateSetting("hidden",b.hidden);c.getDefinition();a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PARAMETER_UPDATE,new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PARAMETER_DEFINITION,
   c.getDefinition()));return!0};c.updateMultipleParameters=function(a){Array.isArray(a)||(a=[a]);return a.every(function(a){return c.updateParameter(a)})};c.registerConfig=function(b){var d={};if(b.controlNames&&"object"===typeof b.controlNames){var e=b.controlNames;Object.keys(e).forEach(function(a){var g=c.getUniqueParameterBySettings({id:a,plugin:b.plugin});g&&(g.getSetting("_name")||g.updateSetting("_name",g.getSetting("name")),g.updateSetting("name",e[a]),d[g.getSettingShallow("id")]=g)})}if(b.controlOrder&&
   Array.isArray(b.controlOrder))for(var g=b.controlOrder,f=0;f<g.length;f++){var h=c.getUniqueParameterBySettings({id:g[f],plugin:b.plugin});h&&(h.updateSetting("order",f),d[h.getSettingShallow("id")]=h)}if(b.parametersHidden&&Array.isArray(b.parametersHidden))for(g=b.parametersHidden,f=0;f<g.length;f++)if(h=c.getUniqueParameterBySettings({id:g[f],plugin:b.plugin}))h.updateSetting("hidden",!0),d[h.getSettingShallow("id")]=h;Object.keys(d).forEach(function(b){b=d[b].getDefinition();var c={};c[b.id]=
   b;a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PARAMETER_UPDATE,new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PARAMETER_DEFINITION,c))});return!0};c.getConfig=function(a){a=c.getParameterDefinitionsAndValues({plugin:a});if(Array.isArray(a)){if(0===a.length)return{};var b={};a.forEach(function(a){module$src$shared$util$GlobalUtils.default.typeCheck(a.name,"string")&&module$src$shared$util$GlobalUtils.default.typeCheck(a._name,
   "string")&&(b.controlNames=b.controlNames||[],b.controlNames.push({id:a.id,name:a.name}));module$src$shared$util$GlobalUtils.default.typeCheck(a.hidden,"boolean")&&a.hidden&&(b.parametersHidden=b.parametersHidden||[],b.parametersHidden.push(a.id));module$src$shared$util$GlobalUtils.default.typeCheck(a.order,"number")&&(b.controlOrder=b.controlOrder||[],b.controlOrder.push({id:a.id,order:a.order}))});return b}};c.deregisterParameter=function(b,c){var e={};e.id=b;void 0!==c&&(e.plugin=c);e=m(e);if(void 0===
   e)return a.error("ViewerAppParameterManager.deregisterParameter","Parameter with id "+b+" and plugin "+c+" not found"),!1;c=d.splice(e,1)[0];a.info("ViewerAppParameterManager.deregisterParameter",'Deregistered parameter "'+c.getSetting("name")+'" with id '+b);return!0};c.getParameterById=function(a,b){var d={};d.id=a;void 0!==b&&(d.plugin=b);return c.getUniqueParameterBySettings(d)};c.getParameterByName=function(a,b){var d={};d.name=a;void 0!==b&&(d.plugin=b);return c.getUniqueParameterBySettings(d)};
   c.getParameterByIdOrName=function(a,b){var d={};d.id=a;void 0!==b&&(d.plugin=b);b=c.getUniqueParameterBySettings(d);if(void 0!==b)return b;delete d.id;d.name=a;return c.getUniqueParameterBySettings(d)};c.getParametersBySettings=function(a){return d.filter(function(b){return Object.keys(a).every(function(c){return b.hasSetting(c)&&b.getSettingShallow(c)===a[c]?!0:!1})})};c.idsUnique=function(){var a=[];return d.every(function(b){b=b.getSetting("id");if(a.includes(b))return!1;a.push(b);return!0})};
   c.namesUnique=function(){var a=[];return d.every(function(b){b=b.getSetting("name");if(a.includes(b))return!1;a.push(b);return!0})};var l=function(a){var b=[];d.forEach(function(c,d){Object.keys(a).every(function(b){return c.hasSetting(b)&&c.getSettingShallow(b)===a[b]?!0:!1})&&b.push(d)});return b},m=function(a){a=l(a);if(1===a.length)return a[0]};c.getUniqueParameterBySettings=function(a){a=c.getParametersBySettings(a);if(1===a.length)return a[0]};c.getParameterDefinitions=function(b){var e={};
   (void 0!==b&&"object"===typeof b?c.getParametersBySettings(b):d).forEach(function(b,d){var g=b.getDefinition();g&&"object"===typeof g?(d=b.getSetting("id"),1<c.getParametersBySettings({id:d}).length&&(d=d+"__"+b.getSetting("plugin")),e[d]=g):a.debug("ViewerAppParameterManager.getParameterDefinitions","Could not get definition of parameter "+d)});return e};c.getParameterDefinitionsAndValues=function(b){b=void 0!==b&&"object"===typeof b?c.getParametersBySettings(b):d;var e=[];b.forEach(function(b,c){var d=
   b.getDefinition();d&&"object"===typeof d?(d.value=b.getValue(),e.push(d)):a.debug("ViewerAppParameterManager.getParameterDefinitionsAndValues","Could not get definition of parameter "+c)});e.sort(function(a,b){var c=a.plugin;var d=b.plugin;"number"===typeof a.order&&"number"===typeof b.order?(c+=Math.floor(1E3*a.order).toString().padStart(8,"0"),d+=Math.floor(1E3*b.order).toString().padStart(8,"0")):(c+=a.name,d+=b.name);return c<d?-1:c>d?1:0});return e};var n=function(a){if(a&&"object"===typeof a){var b=
   {};void 0!==a.plugin&&"string"===typeof a.plugin&&(b.plugin=a.plugin);if(void 0!==a.id&&"string"===typeof a.id){b.id=a.id;var c=m(b);if(void 0!==c)return c;delete b.id}if(void 0!==a.idOrName&&"string"===typeof a.idOrName){b.id=a.idOrName;c=m(b);if(void 0!==c)return c;delete b.id;b.name=a.idOrName;c=m(b);if(void 0!==c)return c;delete b.name}if(void 0!==a._name&&"string"===typeof a._name&&(b._name=a._name,c=m(b),void 0!==c)||void 0!==a.name&&"string"===typeof a.name&&(b.name=a.name,c=m(b),void 0!==
   c))return c}};c.updateRequiresPriorUpload=function(a){Array.isArray(a)||(a=[a]);for(var b=!1,c=0,e=a.length;c<e;c++){var g=a[c];if(g.value instanceof Blob){g=n(g);if(void 0===g)return;d[g].acceptsBlobs()&&(b=!0)}}return b};c.priorUpload=function(b){var c={params:[],plugins:{}},e=function(a,b,d){c.err||(c.err=[]);c.err.push({code:a,msg:b,data:d})};if(!Array.isArray(b))return e(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.ERROR,"Not an array"),Promise.resolve(c);if(void 0===
   g)return e(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND,"Plugin functionality not found"),a.debug("ViewerAppParameterManager.priorUpload","Plugin functionality not found"),Promise.resolve(c);for(var f={},h=0,l=b.length;h<l;h++){var m=b[h];if(m.value instanceof Blob){var k=n(m);if(void 0===k)return e(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PARAM_NOT_FOUND,"Could not find parameter",m),a.debug("ViewerAppParameterManager.priorUpload",
   "Could not find parameter",m),Promise.resolve(c);k=d[k];m.id=k.getSetting("id");m.plugin=k.getSetting("plugin");if(!k.checkBlob(m.value))return e(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.VALUE_REJECT,"Blob size or type rejected",m),c.params.push({id:m.id,plugin:m.plugin,result:module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.VALUE_REJECT}),a.debug("ViewerAppParameterManager.priorUpload","Blob size or type rejected"),Promise.resolve(c);
   f.hasOwnProperty(m.plugin)||(f[m.plugin]={request:{},data:{}});f[m.plugin].request[m.id]={format:m.value._type,size:m.value.size};f[m.plugin].data[m.id]=m.value;c.params.push({id:m.id,plugin:m.plugin,result:module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.VALUE_OK})}}h=[];var q=[],A;for(A in f){l=g.getPluginByRuntimeId(A);if(!l)return e(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND,"Plugin not found",A),a.debug("ViewerAppParameterManager.priorUpload",
   "Plugin "+A+" not found"),c.plugins[A]=module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND,Promise.resolve(c);h.push(l.fileUpload(f[A]));q.push(A)}return Promise.all(h).then(function(a){for(var d={},e=0,g=a.length;e<g;d={plugin$133:d.plugin$133},e++){d.plugin$133=q[e];var f=a[e],h={},l;for(l in f){h.id=l;var m=b.find(function(a,b){return function(c){return c.plugin===a.plugin$133&&c.id===b.id}}(d,h));if(!m)throw Error("ViewerAppParameterManager.priorUpload: internal error, parameter not found");
   m.value=f[h.id];h={id:h.id}}}return c},function(a){e(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.UPLOAD_FAILED,"Upload failed",a);return c})};c.setParameterValue=function(a,b){return c.setMultipleParameterValues([a],b)};c.setMultipleParameterValues=function(b,e,h,l){void 0===h&&(h=!1);var m=c.getParameterState(),u={params:[],plugins:{}};e=module$src$shared$constants$MessagingConstants.default.makeMessageToken(e);u.token=e;var t=function(a,b,c){u.err||(u.err=[]);u.err.push({code:a,
   msg:b,data:c})},q=function(a,b,c){u.warn||(u.warn=[]);u.warn.push({code:a,msg:b,data:c})},p=[];b.forEach(function(b){var c=n(b);void 0===c?(t(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PARAM_NOT_FOUND,"Could not find parameter",b),a.debug("ViewerAppParameterManager.setMultipleParameterValues","Could not find parameter",b)):(b.idx=c,c=d[c],b.id=c.getSetting("id"),b.plugin=c.getSetting("plugin"),p.includes(b.plugin)||p.push(b.plugin),void 0===b.value?(t(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.NO_VALUE,
   "Parameter value not set",b.value),u.params.push({id:b.id,plugin:b.plugin,result:module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.NO_VALUE}),a.debug("ViewerAppParameterManager.setMultipleParameterValues","Parameter value not set",b,c)):c.checkValue(b.value)||(t(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.VALUE_REJECT,"Parameter value rejected",b.value),u.params.push({id:b.id,plugin:b.plugin,result:module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.VALUE_REJECT}),
   a.debug("ViewerAppParameterManager.setMultipleParameterValues","Parameter value rejected",b,c)))});if(u.err||u.warn)return u;var A=!0,z=[];b.forEach(function(b){var c=d[b.idx];c.isValueDifferent(b.value)?(z.includes(b.plugin)||z.push(b.plugin),A=!1,c.setValue(b.value)?u.params.push({id:b.id,plugin:b.plugin,result:module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.VALUE_OK}):(t(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.VALUE_REJECT,"Parameter value rejected",
   b.value),u.params.push({id:b.id,plugin:b.plugin,result:module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.VALUE_REJECT}),a.debug("ViewerAppParameterManager.setMultipleParameterValues","Parameter value rejected",b,c))):u.params.push({id:b.id,plugin:b.plugin,result:module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.VALUE_EXISTS})});if(u.err)return h=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR,
   u.err,e),a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,h),u;h&&(z=p);var B=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_STATUS,{busy:!1,progress:0},e);a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,B);if(A&&!h)return h=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS,
   "All parameter values up to date",e),a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,h),u;0===f.length&&k(m);l||A||k();h=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_STATUS,{busy:!0,progress:0},e);a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,h);var J={};if(1<z.length){h=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_FORK,
   [],e);l=(z.length+"").length;for(m=0;m<z.length;m++)B=module$src$shared$util$GlobalUtils.default.deepCopy(e),B.id=e.id+"."+(Array(l).join("0")+m).slice(-l),J[z[m]]=B,h.parts[0].data.push(B.id);a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,h)}else z.forEach(function(a){J[a]=module$src$shared$util$GlobalUtils.default.deepCopy(e)});var F={};z.forEach(function(c){var e=b.filter(function(a){return a.plugin===c});F[c]={};var f=F[c];e.forEach(function(a){f[a.id]=
   d[a.idx].getValue()});var h;if(void 0===g)q(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND,"Plugin functionality not found",c),a.warn("ViewerAppParameterManager.setMultipleParameterValues","Plugin functionality not found"),u.plugins[c]=module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND;else if(h=g.getPluginByRuntimeId(c)){var l={};h.getCapabilities().includes(module$src$shared$constants$PluginConstantsGlobal.default.pluginCapabilities.PARTIAL_UPDATES)?
   (e.forEach(function(a){l[a.id]=d[a.idx].getValueString()}),e=h.setMultipleParameterValues(l,J[c]),u.plugins[c]=e):(e.forEach(function(a){l[a.id]=d[a.idx].getValueString()}),d.forEach(function(a){var b=a.getSetting("id");c!==a.getSetting("plugin")||l.hasOwnProperty(b)||(l[b]=a.getValueString())}),e=h.setAllParameterValues(l,J[c]),u.plugins[c]=e)}else t(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND,"Plugin not found",c),a.debug("ViewerAppParameterManager.setMultipleParameterValues",
   "Plugin "+c+" not found"),u.plugins[c]=module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND});h=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PARAMETER_UPDATE,F,e);a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PARAMETER_VALUE_UPDATE,h);if(u.err||u.warn)h=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR,
   u.err,e),a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,h);return u};c.getParameterValuesForPlugin=function(a,b){var d={};c.getParametersBySettings({plugin:a}).forEach(function(a){b?d[a.getSetting("id")]=a.getValueString():d[a.getSetting("id")]=a.getSetting("value")});return d};c.refreshPluginInitial=function(a,b){var d={plugins:{}};b=module$src$shared$constants$MessagingConstants.default.makeMessageToken(b);d.token=b;var e=function(a,b,c){d.err||(d.err=[]);
   d.err.push({code:a,msg:b,data:c})};if(void 0===g)return e(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND,"Plugin functionality not found",a),d.plugins[a]=module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND,d;var f=g.getPluginByRuntimeId(a);return f?f.hasSetting("deferGeometryLoading")&&f.getSettingShallow("deferGeometryLoading")?(d.plugins[a]=module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.ABORT,
   d):c.refreshPlugin(a,b):(e(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND,"Plugin not found",a),d.plugins[a]=module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND,d)};c.refreshPlugin=function(b,d){var e={plugins:{}};d=module$src$shared$constants$MessagingConstants.default.makeMessageToken(d);e.token=d;var f=function(a,b,c){e.err||(e.err=[]);e.err.push({code:a,msg:b,data:c})},h=[];c.getParametersBySettings({plugin:b}).forEach(function(a){h.push({id:a.getSetting("id"),
   value:a.getSetting("value"),plugin:b})});if(0>=h.length&&g){var l=g.getPluginByRuntimeId(b);if(!l)return f(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND,"Plugin not found",b),e.plugins[b]=module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND,e;f=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_STATUS,{busy:!0,progress:0},d);
   a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,f);e.plugins[b]=l.setAllParameterValues({},d);return e}return c.setMultipleParameterValues(h,d,!0)};c.getParameterValuesCompat=function(){var a={};d.forEach(function(b){a[b.getSettingShallow("id")]=b.getSetting("value")});return a};c.getParameterState=function(){var a=[];d.forEach(function(b){a.push({id:b.getSettingShallow("id"),plugin:b.getSettingShallow("plugin"),value:b.getSettingShallow("value")})});return a};
   return c};var module$src$app$partials$ViewerAppExportManager={},GlobalUtils$$module$src$app$partials$ViewerAppExportManager=module$src$shared$util$GlobalUtils.default,pluginConstants$$module$src$app$partials$ViewerAppExportManager=module$src$shared$constants$PluginConstantsGlobal.default,messagingConstants$$module$src$app$partials$ViewerAppExportManager=module$src$shared$constants$MessagingConstants.default,MessagePrototype$$module$src$app$partials$ViewerAppExportManager=module$src$shared$messages$MessagePrototype.default;
   module$src$app$partials$ViewerAppExportManager.default=function(b){var a=this,c=b.pluginManager,d=b.parameterManager,e={},g=[];e.registerMultipleExports=function(a,b){Object.keys(a).forEach(function(c){var d=module$src$shared$util$GlobalUtils.default.deepCopy(a[c]);d.id=c;e.registerExport(d,b)});return[]};e.registerExport=function(b,c){if(void 0!==c&&module$src$shared$util$GlobalUtils.default.typeCheck(c,"string"))if(void 0===b||"object"!==typeof b)a.debug("ViewerAppExportManager.registerExport",
   "Definition of export missing");else if(b.plugin=c,void 0!==b.id&&module$src$shared$util$GlobalUtils.default.typeCheck(b.id,"string")||(b.id=module$src$shared$util$GlobalUtils.default.createRandomId(),a.debug("ViewerAppExportManager.registerExport","No id was specified, using "+b.id)),void 0!==e.getUniqueExportByProperties({id:b.id,plugin:c}))a.debug("ViewerAppExportManager.registerExport","Export with id "+b.id+" and plugin "+c+" already exists");else return b.hasOwnProperty("hidden")||(b.hidden=
   !1),void 0===b.name&&a.warn("ViewerAppExportManager.registerExport","Export without name:",b),g.push(b),c={},c[b.id]=module$src$shared$util$GlobalUtils.default.deepCopy(b),a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.EXPORT_REGISTERED,new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_DEFINITION,c)),b.id;else a.debug("ViewerAppExportManager.registerExport","No plugin specified")};
   e.registerConfig=function(b){var c={};if(b.controlNames&&"object"===typeof b.controlNames){var d=b.controlNames;Object.keys(d).forEach(function(a){var g=e.getUniqueExportByProperties({id:a,plugin:b.plugin});g&&(void 0===g._name&&(g._name=module$src$shared$util$GlobalUtils.default.deepCopy(g.name)),g.name=module$src$shared$util$GlobalUtils.default.deepCopy(d[a]),c[g.id]=g)})}if(b.controlOrder&&Array.isArray(b.controlOrder))for(var g=b.controlOrder,f=0;f<g.length;f++){var h=e.getUniqueExportByProperties({id:g[f],
   plugin:b.plugin});h&&(h.order=f,c[h.id]=h)}if(b.parametersHidden&&Array.isArray(b.parametersHidden))for(g=b.parametersHidden,f=0;f<g.length;f++)if(h=e.getUniqueExportByProperties({id:g[f],plugin:b.plugin}))h.hidden=!0,c[h.id]=h;Object.keys(c).forEach(function(b){b=module$src$shared$util$GlobalUtils.default.deepCopy(c[b]);var d={};d[b.id]=b;a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.EXPORT_UPDATE,new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_DEFINITION,
   d))});return!0};e.getConfig=function(a){var b=e.getExportDefinitions();if(Array.isArray(b)){b=b.filter(function(b){return void 0===b.plugin||b.plugin===a});if(0===b.length)return{};var c={};b.forEach(function(a){module$src$shared$util$GlobalUtils.default.typeCheck(a.name,"string")&&module$src$shared$util$GlobalUtils.default.typeCheck(a._name,"string")&&(c.controlNames=c.controlNames||[],c.controlNames.push({id:a.id,name:a.name}));module$src$shared$util$GlobalUtils.default.typeCheck(a.hidden,"boolean")&&
   a.hidden&&(c.parametersHidden=c.parametersHidden||[],c.parametersHidden.push(a.id));module$src$shared$util$GlobalUtils.default.typeCheck(a.order,"number")&&(c.controlOrder=c.controlOrder||[],c.controlOrder.push({id:a.id,order:a.order}))});return c}};e.updateExport=function(b){if(!b||"object"!==typeof b)return a.debug("ViewerAppExportManager.updateExport","Definition of export missing"),!1;var c=k(b);if(void 0===c)return a.debug("ViewerAppExportManager.updateExport","Export not found",b),!1;c=g[c];
   "string"===typeof b.name&&0<b.name.length&&b.name!==c.name&&(void 0===c._name&&(c._name=module$src$shared$util$GlobalUtils.default.deepCopy(c.name)),c.name=module$src$shared$util$GlobalUtils.default.deepCopy(b.name));"number"===typeof b.order&&(c.order=b.order);"boolean"===typeof b.hidden&&(c.hidden=b.hidden);b=module$src$shared$util$GlobalUtils.default.deepCopy(c);c={};c[b.id]=b;a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.EXPORT_UPDATE,new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_DEFINITION,
   c));return!0};e.updateMultipleExports=function(a){Array.isArray(a)||(a=[a]);return a.every(function(a){return e.updateExport(a)})};e.deregisterExport=function(b,c){var d={};d.id=b;void 0!==c&&(d.plugin=c);d=f(d);if(void 0===d)return a.error("ViewerAppExportManager.deregisterExport","Export with id "+b+" and plugin "+c+" not found"),!1;c=g.splice(d,1)[0];a.info("ViewerAppExportManager.deregisterExport",'Deregistered export "'+c.name+'" with id '+b);return!0};e.getExportById=function(a,b){var c={};
   c.id=a;void 0!==b&&(c.plugin=b);return e.getUniqueExportByProperties(c)};e.getExportByName=function(a,b){var c={};c.name=a;void 0!==b&&(c.plugin=b);return e.getUniqueExportByProperties(c)};e.getExportByIdOrName=function(a,b){var c={};c.id=a;void 0!==b&&(c.plugin=b);b=e.getUniqueExportByProperties(c);if(void 0!==b)return b;delete c.id;c.name=a;return e.getUniqueExportByProperties(c)};e.getExportsByProperties=function(a){return g.filter(function(b){return Object.keys(a).every(function(c){return b.hasOwnProperty(c)&&
   b[c]===a[c]?!0:!1})})};var h=function(a){var b=[];g.forEach(function(c,d){Object.keys(a).every(function(b){return c.hasOwnProperty(b)&&c[b]===a[b]?!0:!1})&&b.push(d)});return b},f=function(a){a=h(a);if(1===a.length)return a[0]};e.getUniqueExportByProperties=function(a){a=e.getExportsByProperties(a);if(1===a.length)return a[0]};e.getExportDefinitions=function(){var a=[];g.forEach(function(b){b=module$src$shared$util$GlobalUtils.default.deepCopy({id:b.id,name:b.name,type:b.type,plugin:b.plugin,group:b.group,
   hidden:b.hidden,order:b.order,_name:b._name});a.push(b)});a.sort(function(a,b){var c=a.plugin;var d=b.plugin;"number"===typeof a.order&&"number"===typeof b.order?(c+=Math.floor(1E3*a.order).toString().padStart(8,"0"),d+=Math.floor(1E3*b.order).toString().padStart(8,"0")):(c+=a.name,d+=b.name);return c<d?-1:c>d?1:0});return a};var k=function(a){if(void 0!==a&&"object"===typeof a){var b={};void 0!==a.plugin&&"string"===typeof a.plugin&&(b.plugin=a.plugin);if(void 0!==a.id&&"string"===typeof a.id){b.id=
   a.id;var c=f(b);if(void 0!==c)return c;delete b.id}if(void 0!==a.idOrName&&"string"===typeof a.idOrName){b.id=a.idOrName;c=f(b);if(void 0!==c)return c;delete b.id;b.name=a.idOrName;c=f(b);if(void 0!==c)return c;delete b.name}if(void 0!==a._name&&"string"===typeof a._name&&(b._name=a._name,c=f(b),void 0!==c)||void 0!==a.name&&"string"===typeof a.name&&(b.name=a.name,c=f(b),void 0!==c))return c}};e.getUniqueExportByRequestObject=function(a){a=k(a);if(void 0!==a)return module$src$shared$util$GlobalUtils.default.deepCopy(g[a])};
   e.requestExport=function(b,e){e=module$src$shared$constants$MessagingConstants.default.makeMessageToken(e);var f=function(b,c){e&&(c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR,c,e),a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,c));return b},h=k(b);if(void 0===h)return a.error("ViewerAppExportManager.requestExport","Export not found",b),f(module$src$shared$constants$PluginConstantsGlobal.default.requestExportResults.EXPORT_NOT_FOUND,
   "Export not found");h=g[h];var l=d.getParameterValuesForPlugin(h.plugin,!0);if(b.parameters&&"object"===typeof b.parameters){var m=b.parameters;Object.keys(l).forEach(function(a){m.hasOwnProperty(a)&&(l[a]=m[a])})}if(void 0===c||void 0===c.getPluginByRuntimeId)return a.error("ViewerAppExportManager.requestExport","Plugin manager not found"),f(module$src$shared$constants$PluginConstantsGlobal.default.requestExportResults.PLUGIN_NOT_FOUND,"Plugin manager not found");b=c.getPluginByRuntimeId(h.plugin);
   if(!b)return h="Plugin "+h.plugin+" not found",a.error("ViewerAppExportManager.requestExport",h),f(module$src$shared$constants$PluginConstantsGlobal.default.requestExportResults.PLUGIN_NOT_FOUND,h);e&&(f=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_STATUS,{progress:0},e),a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,f),f=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_STATUS,
   h,e),a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.EXPORT_STATUS,f));return b.requestExport(h.id,l,e)};return e};var module$src$3d$viewport$defaults$DefaultHighlights={default:[{apply:function(b,a){b.material&&(b.material.opacity*=a.opacity,b.material.transparent=!0)},remove:function(b,a){b.material&&(b.material.opacity*=1/a.opacity,b.material.transparent=!1)}},{apply:function(b,a){b.material&&(b.material.color.r+=a.color.r,b.material.color.g+=a.color.g,b.material.color.b+=a.color.b)},remove:function(b,a){b.material&&(b.material.color.r-=a.color.r,b.material.color.g-=a.color.g,b.material.color.b-=a.color.b)}}]};var module$src$3d$InteractionGroupManager={default:function(){var b,a=[],c=function(){b=this};c.prototype.InteractionGroup=function(a){var b={},c=a.name,d=a.selectable||!1,f=a.draggable||!1,k=a.hoverable||!1,l=a.selectionMode||"single",m=function(a){if(!a)return null;if("function"===typeof a.apply&&"function"===typeof a.remove)return a;a.name||(a.name="opacityHighlight");"opacityHighlight"==a.name?(a.apply=module$src$3d$viewport$defaults$DefaultHighlights.default[0].apply,a.remove=module$src$3d$viewport$defaults$DefaultHighlights.default[0].remove,
   a.options)?a.options.opacity||(a.options.opacity=.5):a.options={opacity:.5}:"colorHighlight"==a.name&&(a.apply=module$src$3d$viewport$defaults$DefaultHighlights.default[1].apply,a.remove=module$src$3d$viewport$defaults$DefaultHighlights.default[1].remove,a.options?a.options.color=a.options.color?(0,module$src$shared$util$toTinyColor.default)(a.options.color,"red").toThreeColor():new module$src$externals$three.default.Color(1,0,0):a.options={color:new module$src$externals$three.default.Color(1,0,0)});
   return a.apply&&a.remove?a:null},n={active:a.selectableHighlight&&a.selectableHighlight.active?m(a.selectableHighlight.active):null,passive:a.selectableHighlight&&a.selectableHighlight.passive?m(a.selectableHighlight.passive):null},q={active:a.draggableHighlight&&a.draggableHighlight.active?m(a.draggableHighlight.active):null,passive:a.draggableHighlight&&a.draggableHighlight.passive?m(a.draggableHighlight.passive):null},p={active:a.hoverableHighlight&&a.hoverableHighlight.active?m(a.hoverableHighlight.active):
   null,passive:a.hoverableHighlight&&a.hoverableHighlight.passive?m(a.hoverableHighlight.passive):null};b.getName=function(){return c};b.isSelectable=function(){return d};b.isDraggable=function(){return f};b.isHoverable=function(){return k};b.getSelectionMode=function(){return l};b.getSelectableHighlight=function(){return n};b.getDraggableHighlight=function(){return q};b.getHoverableHighlight=function(){return p};return b};c.prototype.addInteractionGroup=function(c){return c.name&&!b.isInteractionGroup(c.name)?
   (a.push(new b.InteractionGroup(c)),!0):!1};c.prototype.addOrReplaceInteractionGroup=function(c){a=a.filter(function(a){return a.getName()!==c.name});return b.addInteractionGroup(c)};c.prototype.isInteractionGroup=function(a){return null==b.getGroup(a)?!1:!0};c.prototype.getGroup=function(b){for(var c=0,d=a.length;c<d;c++)if(a[c].getName()==b)return a[c];return null};c.prototype.getGroups=function(){return a};return new c}};var module$src$3d$viewportManager$ViewportManagerThreeDManager={default:function(b,a){b.threeDManager={};b.threeDManager.adjustScene=function(){for(var b=0,d=a.length;b<d;b++)a[b].threeDManager.adjustScene()};b.threeDManager.fadeIn=function(b,d){for(var c=[],g=0,h=a.length;g<h;g++)c.push(a[g].threeDManager.fadeIn(b,d));return Promise.all(c)};b.threeDManager.fadeOut=function(b,d){for(var c=[],g=0,h=a.length;g<h;g++)c.push(a[g].threeDManager.fadeOut(b,d));return Promise.all(c)};b.threeDManager.updateInteractions=
   function(b,d){for(var c=0,g=a.length;c<g;c++)a[c].threeDManager.updateInteractions(b,d)};b.threeDManager.removeFromInteractions=function(b){for(var c=0,e=a.length;c<e;c++)a[c].threeDManager.removeFromInteractions(b)};b.threeDManager.addMesh=function(b,d,e){for(var c=0,h=a.length;c<h;c++)a[c].threeDManager.addMesh(b,d[c],e)};b.threeDManager.removeMesh=function(b){for(var c=0,e=a.length;c<e;c++)a[c].threeDManager.removeMesh(b);b.geometry.dispose()};b.threeDManager.addAnchor=function(b,d){var c=[];d.viewports&&
   0!==d.viewports.length&&(c=d.viewports);for(var g=0,h=a.length;g<h;g++)(c.includes(a[g].getViewportRuntimeId())||0===c.length)&&a[g].threeDManager.addAnchor(b,d)};b.threeDManager.removeAnchor=function(b){for(var c=0,e=a.length;c<e;c++)a[c].threeDManager.removeAnchor(b)};b.threeDManager.renderingHandler={};b.threeDManager.renderingHandler.render=function(){for(var b=0,d=a.length;b<d;b++)a[b].threeDManager.renderingHandler.render()};b.threeDManager.renderingHandler.setBlur=function(b,d){for(var c=0,
   g=a.length;c<g;c++)a[c].threeDManager.renderingHandler.setBlur(b,d)};b.threeDManager.renderingHandler.registerForContinuousRendering=function(b,d){for(var c=0,g=a.length;c<g;c++)a[c].threeDManager.renderingHandler.registerForContinuousRendering(b,d)};b.threeDManager.renderingHandler.unregisterForContinuousRendering=function(b){for(var c=0,e=a.length;c<e;c++)a[c].threeDManager.renderingHandler.unregisterForContinuousRendering(b)};b.threeDManager.renderingHandler.containsContinuousRendering=function(b){for(var c=
   [],e=0,g=a.length;e<g;e++)c.push(a[e].threeDManager.renderingHandler.containsContinuousRendering(b));return 1===c.length?c[0]:c};b.threeDManager.renderingHandler.updateShadowMap=function(){for(var b=0,d=a.length;b<d;b++)a[b].threeDManager.renderingHandler.updateShadowMap()};b.threeDManager.renderingHandler.keepUpdatingShadowMap=function(){for(var b=0,d=a.length;b<d;b++)a[b].threeDManager.renderingHandler.keepUpdatingShadowMap()};b.threeDManager.renderingHandler.stopUpdatingShadowMap=function(){for(var b=
   0,d=a.length;b<d;b++)a[b].threeDManager.renderingHandler.stopUpdatingShadowMap()};b.threeDManager.materialHandler={};b.threeDManager.materialHandler.getMaterial=function(b,d,e,g,h){for(var c=[],k=0,l=a.length;k<l;k++)c.push(a[k].threeDManager.materialHandler.getMaterial(b,d,e,g,h));return c}}};var module$src$api$v2$ApiResponse={},GLOBALUTILS$$module$src$api$v2$ApiResponse=module$src$shared$util$GlobalUtils.default,ApiResponse$$module$src$api$v2$ApiResponse=function(b,a,c){this.payload=this.data=this.err=null;Array.isArray(b)||(b=[b]);for(var d=0;d<b.length;d++){var e=b[d];void 0!==e&&null!==e?module$src$shared$util$GlobalUtils.default.typeCheck(e,"string")?b[d]=Error(e):e instanceof Error?b[d]=e:e.hasOwnProperty("m")?(b[d]=Error(e.m),e.hasOwnProperty("d")&&(b[d].data=Error(e.d))):(b[d]=
   Error(),b[d].data=e):null!==e&&(b[d]=null)}1===b.length&&void 0!==b[0]&&null!==b[0]?this.err=b[0]:1<b.length&&(this.err=b);void 0!==a&&null!==a&&(this.data=a);void 0!==c&&null!==c&&(this.payload=c)};module$src$api$v2$ApiResponse.default=function(b,a,c){return new ApiResponse$$module$src$api$v2$ApiResponse(b,a,c)};var module$src$3d$interfaces$api$LightApiInterface={default:function(){this.LIGHTTYPE={AMBIENT:"ambient",DIRECTIONAL:"directional",HEMISPHERE:"hemisphere",POINT:"point",SPOT:"spot",FLASH:"flash"};this.LIGHTSCENE={DEFAULT:"default",LEGACY:"legacy"}}};module$src$3d$interfaces$api$LightApiInterface.default.prototype.updateLight=function(b){};module$src$3d$interfaces$api$LightApiInterface.default.prototype.removeLight=function(b){};
   module$src$3d$interfaces$api$LightApiInterface.default.prototype.getLight=function(b){};module$src$3d$interfaces$api$LightApiInterface.default.prototype.setLightSceneFromID=function(b){};module$src$3d$interfaces$api$LightApiInterface.default.prototype.setLightSceneFromDefinition=function(b){};module$src$3d$interfaces$api$LightApiInterface.default.prototype.getLightScene=function(b){};module$src$3d$interfaces$api$LightApiInterface.default.prototype.getAllLightScenes=function(){};
   module$src$3d$interfaces$api$LightApiInterface.default.prototype.saveLightScene=function(b){};var module$src$3d$interfaces$api$CameraApiInterface={default:function(){this.TYPE={PERSPECTIVE:0,TOP:1,BOTTOM:2,RIGHT:3,LEFT:4,BACK:5,FRONT:6,AR:7};this.CONTROLTYPE={ORBIT:0,FPS:1,ORTHOGRAPHIC:2};this.EVENTTYPE={CAMERA_START:"start",CAMERA_MOVE:"move",CAMERA_END:"end"}}};module$src$3d$interfaces$api$CameraApiInterface.default.prototype.get=function(){};module$src$3d$interfaces$api$CameraApiInterface.default.prototype.updateAsync=function(b,a){};
   module$src$3d$interfaces$api$CameraApiInterface.default.prototype.animateAsync=function(b,a){};module$src$3d$interfaces$api$CameraApiInterface.default.prototype.zoomAsync=function(b,a){};module$src$3d$interfaces$api$CameraApiInterface.default.prototype.resetAsync=function(b){};module$src$3d$interfaces$api$CameraApiInterface.default.prototype.updateMatrices=function(){};module$src$3d$interfaces$api$CameraApiInterface.default.prototype.addEventListener=function(b,a){};
   module$src$3d$interfaces$api$CameraApiInterface.default.prototype.removeEventListener=function(){};var module$src$3d$viewportManager$ViewportManagerApi={},APIResponse$$module$src$3d$viewportManager$ViewportManagerApi=module$src$api$v2$ApiResponse.default,LightApiInterface$$module$src$3d$viewportManager$ViewportManagerApi=new module$src$3d$interfaces$api$LightApiInterface.default,CameraApiInterface$$module$src$3d$viewportManager$ViewportManagerApi=new module$src$3d$interfaces$api$CameraApiInterface.default;
   module$src$3d$viewportManager$ViewportManagerApi.default=function(b,a){var c=function(b,c,g){var d=null;d=a;for(var e=[],k=0,l=d.length;k<l;k++){var m=d[k];b&&(m="camera"===b?m.camera:"lights"===b?m.lights:m);e.push(m[c].call.apply(m[c],[m].concat($jscomp.arrayFromIterable(g))))}1===d.length?e=e[0]:1<d.length&&e[0].constructor===(0,module$src$api$v2$ApiResponse.default)().constructor?e=(0,module$src$api$v2$ApiResponse.default)(e.map(function(a){return a.err}),e.map(function(a){return a.data}),e.map(function(a){return a.payload})):
   1<d.length&&e[0]instanceof Promise&&(e=Promise.all(e).then(function(a){return(0,module$src$api$v2$ApiResponse.default)(a.map(function(a){return a.err}),a.map(function(a){return a.data}),a.map(function(a){return a.payload}))}));return e};b.api={getViewportRuntimeId:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c(null,"getViewportRuntimeId",b)},getContainer:function(b){for(var d=[],g=0;g<arguments.length;++g)d[g-0]=arguments[g];for(g=0;g<a.length;g++)if(a[g].getViewportRuntimeId()===
   d[0])return d.splice(0,1),a[g].getContainer.apply(a[g],$jscomp.arrayFromIterable(d));return c(null,"getContainer",d)},getScreenshot:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c(null,"getScreenshot",b)},getScreenshotAsync:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c(null,"getScreenshotAsync",b)},render:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c(null,"render",b)},updateShadowMap:function(a){for(var b=
   [],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c(null,"updateShadowMap",b)},startContinuousRendering:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c(null,"startContinuousRendering",b)},stopContinuousRendering:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c(null,"stopContinuousRendering",b)},convertTo2D:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c(null,"convertTo2D",b)},pause:function(a){for(var b=
   [],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c(null,"pause",b)},resume:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c(null,"resume",b)},addEventListener:function(a){},removeEventListener:function(a){},getSettingDefinitions:function(){return a[0].getSettingDefinitions()},getSettings:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c(null,"getSettings",b)},getSetting:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=
   arguments[d];return c(null,"getSetting",b)},updateSettingAsync:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c(null,"updateSettingAsync",b)},updateSettingsAsync:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c(null,"updateSettingsAsync",b)},setTransformation:function(b){for(var d=[],g=0;g<arguments.length;++g)d[g-0]=arguments[g];for(g=0;g<a.length;g++)if(a[g].getViewportRuntimeId()===d[0])return d.splice(0,1),a[g].setTransformation.apply(a[g],
   $jscomp.arrayFromIterable(d));return c(null,"setTransformation",d)},getTransformation:function(b){for(var d=[],g=0;g<arguments.length;++g)d[g-0]=arguments[g];for(g=0;g<a.length;g++)if(a[g].getViewportRuntimeId()===d[0])return d.splice(0,1),a[g].getTransformation.apply(a[g],$jscomp.arrayFromIterable(d));return c(null,"getTransformation",d)},applyTransformation:function(b){for(var d=[],g=0;g<arguments.length;++g)d[g-0]=arguments[g];for(g=0;g<a.length;g++)if(a[g].getViewportRuntimeId()===d[0])return d.splice(0,
   1),a[g].applyTransformation.apply(a[g],$jscomp.arrayFromIterable(d));return c(null,"applyTransformation",d)},resetTransformation:function(b){for(var d=[],g=0;g<arguments.length;++g)d[g-0]=arguments[g];for(g=0;g<a.length;g++)if(a[g].getViewportRuntimeId()===d[0])return d.splice(0,1),a[g].resetTransformation.apply(a[g],$jscomp.arrayFromIterable(d));return c(null,"resetTransformation",d)},setLiveTransformation:function(b){for(var d=[],g=0;g<arguments.length;++g)d[g-0]=arguments[g];for(g=0;g<a.length;g++)if(a[g].getViewportRuntimeId()===
   d[0])return d.splice(0,1),a[g].setLiveTransformation.apply(a[g],$jscomp.arrayFromIterable(d));return c(null,"setLiveTransformation",d)},updateSelected:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c(null,"updateSelected",b)},getSelected:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c(null,"getSelected",b)},startExternalDragEvent:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c(null,"startExternalDragEvent",
   b)},toggleGeometry:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c(null,"toggleGeometry",b)}};b.api.camera={addEventListener:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c("camera","addEventListener",b)},removeEventListener:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c("camera","removeEventListener",b)},get:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c("camera",
   "get",b)},updateAsync:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c("camera","updateAsync",b)},animateAsync:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c("camera","animateAsync",b)},zoomAsync:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c("camera","zoomAsync",b)},resetAsync:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c("camera","resetAsync",b)},updateMatrices:function(a){for(var b=
   [],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c("camera","updateMatrices",b)},TYPE:CameraApiInterface$$module$src$3d$viewportManager$ViewportManagerApi.TYPE,CONTROLTYPE:CameraApiInterface$$module$src$3d$viewportManager$ViewportManagerApi.CONTROLTYPE,EVENTTYPE:CameraApiInterface$$module$src$3d$viewportManager$ViewportManagerApi.EVENTTYPE};b.api.lights={updateLight:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c("lights","updateLight",b)},getLight:function(a){for(var b=
   [],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c("lights","getLight",b)},removeLight:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c("lights","removeLight",b)},setLightSceneFromID:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c("lights","setLightSceneFromID",b)},setLightSceneFromDefinition:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c("lights","setLightSceneFromDefinition",b)},getLightScene:function(a){for(var b=
   [],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c("lights","getLightScene",b)},getAllLightScenes:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c("lights","getAllLightScenes",b)},saveLightScene:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c("lights","saveLightScene",b)},LIGHTTYPE:LightApiInterface$$module$src$3d$viewportManager$ViewportManagerApi.LIGHTTYPE,LIGHTSCENE:LightApiInterface$$module$src$3d$viewportManager$ViewportManagerApi.LIGHTSCENE}};var module$node_modules$$tweenjs$tween_js$src$Tween={},_Group$$module$node_modules$$tweenjs$tween_js$src$Tween=function(){this._tweens={};this._tweensAddedDuringUpdate={}};
   _Group$$module$node_modules$$tweenjs$tween_js$src$Tween.prototype={getAll:function(){return Object.keys(this._tweens).map(function(b){return this._tweens[b]}.bind(this))},removeAll:function(){this._tweens={}},add:function(b){this._tweens[b.getId()]=b;this._tweensAddedDuringUpdate[b.getId()]=b},remove:function(b){delete this._tweens[b.getId()];delete this._tweensAddedDuringUpdate[b.getId()]},update:function(b,a){var c=Object.keys(this._tweens);if(0===c.length)return!1;for(b=void 0!==b?b:module$node_modules$$tweenjs$tween_js$src$Tween.default.now();0<
   c.length;){this._tweensAddedDuringUpdate={};for(var d=0;d<c.length;d++){var e=this._tweens[c[d]];e&&!1===e.update(b)&&(e._isPlaying=!1,a||delete this._tweens[c[d]])}c=Object.keys(this._tweensAddedDuringUpdate)}return!0}};module$node_modules$$tweenjs$tween_js$src$Tween.default=new _Group$$module$node_modules$$tweenjs$tween_js$src$Tween;module$node_modules$$tweenjs$tween_js$src$Tween.default.Group=_Group$$module$node_modules$$tweenjs$tween_js$src$Tween;
   module$node_modules$$tweenjs$tween_js$src$Tween.default._nextId=0;module$node_modules$$tweenjs$tween_js$src$Tween.default.nextId=function(){return module$node_modules$$tweenjs$tween_js$src$Tween.default._nextId++};
   module$node_modules$$tweenjs$tween_js$src$Tween.default.now="undefined"===typeof self&&"undefined"!==typeof process&&process.hrtime?function(){var b=process.hrtime();return 1E3*b[0]+b[1]/1E6}:"undefined"!==typeof self&&void 0!==self.performance&&void 0!==self.performance.now?self.performance.now.bind(self.performance):void 0!==Date.now?Date.now:function(){return(new Date).getTime()};
   module$node_modules$$tweenjs$tween_js$src$Tween.default.Tween=function(b,a){this._object=b;this._valuesStart={};this._valuesEnd={};this._valuesStartRepeat={};this._duration=1E3;this._repeat=0;this._repeatDelayTime=void 0;this._reversed=this._isPlaying=this._yoyo=!1;this._delayTime=0;this._startTime=null;this._easingFunction=module$node_modules$$tweenjs$tween_js$src$Tween.default.Easing.Linear.None;this._interpolationFunction=module$node_modules$$tweenjs$tween_js$src$Tween.default.Interpolation.Linear;
   this._chainedTweens=[];this._onStartCallback=null;this._onStartCallbackFired=!1;this._onStopCallback=this._onCompleteCallback=this._onRepeatCallback=this._onUpdateCallback=null;this._group=a||module$node_modules$$tweenjs$tween_js$src$Tween.default;this._id=module$node_modules$$tweenjs$tween_js$src$Tween.default.nextId()};
   module$node_modules$$tweenjs$tween_js$src$Tween.default.Tween.prototype={getId:function(){return this._id},isPlaying:function(){return this._isPlaying},to:function(b,a){this._valuesEnd=Object.create(b);void 0!==a&&(this._duration=a);return this},duration:function(b){this._duration=b;return this},start:function(b){this._group.add(this);this._isPlaying=!0;this._onStartCallbackFired=!1;this._startTime=void 0!==b?"string"===typeof b?module$node_modules$$tweenjs$tween_js$src$Tween.default.now()+parseFloat(b):
   b:module$node_modules$$tweenjs$tween_js$src$Tween.default.now();this._startTime+=this._delayTime;for(var a in this._valuesEnd){if(this._valuesEnd[a]instanceof Array){if(0===this._valuesEnd[a].length)continue;this._valuesEnd[a]=[this._object[a]].concat(this._valuesEnd[a])}void 0!==this._object[a]&&(this._valuesStart[a]=this._object[a],!1===this._valuesStart[a]instanceof Array&&(this._valuesStart[a]*=1),this._valuesStartRepeat[a]=this._valuesStart[a]||0)}return this},stop:function(){if(!this._isPlaying)return this;
   this._group.remove(this);this._isPlaying=!1;null!==this._onStopCallback&&this._onStopCallback(this._object);this.stopChainedTweens();return this},end:function(){this.update(Infinity);return this},stopChainedTweens:function(){for(var b=0,a=this._chainedTweens.length;b<a;b++)this._chainedTweens[b].stop()},group:function(b){this._group=b;return this},delay:function(b){this._delayTime=b;return this},repeat:function(b){this._repeat=b;return this},repeatDelay:function(b){this._repeatDelayTime=b;return this},
   yoyo:function(b){this._yoyo=b;return this},easing:function(b){this._easingFunction=b;return this},interpolation:function(b){this._interpolationFunction=b;return this},chain:function(){this._chainedTweens=arguments;return this},onStart:function(b){this._onStartCallback=b;return this},onUpdate:function(b){this._onUpdateCallback=b;return this},onRepeat:function(b){this._onRepeatCallback=b;return this},onComplete:function(b){this._onCompleteCallback=b;return this},onStop:function(b){this._onStopCallback=
   b;return this},update:function(b){var a;if(b<this._startTime)return!0;!1===this._onStartCallbackFired&&(null!==this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0);var c=(b-this._startTime)/this._duration;c=0===this._duration||1<c?1:c;var d=this._easingFunction(c);for(a in this._valuesEnd)if(void 0!==this._valuesStart[a]){var e=this._valuesStart[a]||0,g=this._valuesEnd[a];g instanceof Array?this._object[a]=this._interpolationFunction(g,d):("string"===typeof g&&
   (g="+"===g.charAt(0)||"-"===g.charAt(0)?e+parseFloat(g):parseFloat(g)),"number"===typeof g&&(this._object[a]=e+(g-e)*d))}null!==this._onUpdateCallback&&this._onUpdateCallback(this._object,c);if(1===c)if(0<this._repeat){isFinite(this._repeat)&&this._repeat--;for(a in this._valuesStartRepeat)"string"===typeof this._valuesEnd[a]&&(this._valuesStartRepeat[a]+=parseFloat(this._valuesEnd[a])),this._yoyo&&(c=this._valuesStartRepeat[a],this._valuesStartRepeat[a]=this._valuesEnd[a],this._valuesEnd[a]=c),this._valuesStart[a]=
   this._valuesStartRepeat[a];this._yoyo&&(this._reversed=!this._reversed);this._startTime=void 0!==this._repeatDelayTime?b+this._repeatDelayTime:b+this._delayTime;null!==this._onRepeatCallback&&this._onRepeatCallback(this._object)}else{null!==this._onCompleteCallback&&this._onCompleteCallback(this._object);b=0;for(a=this._chainedTweens.length;b<a;b++)this._chainedTweens[b].start(this._startTime+this._duration);return!1}return!0}};
   module$node_modules$$tweenjs$tween_js$src$Tween.default.Easing={Linear:{None:function(b){return b}},Quadratic:{In:function(b){return b*b},Out:function(b){return b*(2-b)},InOut:function(b){return 1>(b*=2)?.5*b*b:-.5*(--b*(b-2)-1)}},Cubic:{In:function(b){return b*b*b},Out:function(b){return--b*b*b+1},InOut:function(b){return 1>(b*=2)?.5*b*b*b:.5*((b-=2)*b*b+2)}},Quartic:{In:function(b){return b*b*b*b},Out:function(b){return 1- --b*b*b*b},InOut:function(b){return 1>(b*=2)?.5*b*b*b*b:-.5*((b-=2)*b*b*
   b-2)}},Quintic:{In:function(b){return b*b*b*b*b},Out:function(b){return--b*b*b*b*b+1},InOut:function(b){return 1>(b*=2)?.5*b*b*b*b*b:.5*((b-=2)*b*b*b*b+2)}},Sinusoidal:{In:function(b){return 1-Math.cos(b*Math.PI/2)},Out:function(b){return Math.sin(b*Math.PI/2)},InOut:function(b){return.5*(1-Math.cos(Math.PI*b))}},Exponential:{In:function(b){return 0===b?0:Math.pow(1024,b-1)},Out:function(b){return 1===b?1:1-Math.pow(2,-10*b)},InOut:function(b){return 0===b?0:1===b?1:1>(b*=2)?.5*Math.pow(1024,b-1):
   .5*(-Math.pow(2,-10*(b-1))+2)}},Circular:{In:function(b){return 1-Math.sqrt(1-b*b)},Out:function(b){return Math.sqrt(1- --b*b)},InOut:function(b){return 1>(b*=2)?-.5*(Math.sqrt(1-b*b)-1):.5*(Math.sqrt(1-(b-=2)*b)+1)}},Elastic:{In:function(b){return 0===b?0:1===b?1:-Math.pow(2,10*(b-1))*Math.sin(5*(b-1.1)*Math.PI)},Out:function(b){return 0===b?0:1===b?1:Math.pow(2,-10*b)*Math.sin(5*(b-.1)*Math.PI)+1},InOut:function(b){if(0===b)return 0;if(1===b)return 1;b*=2;return 1>b?-.5*Math.pow(2,10*(b-1))*Math.sin(5*
   (b-1.1)*Math.PI):.5*Math.pow(2,-10*(b-1))*Math.sin(5*(b-1.1)*Math.PI)+1}},Back:{In:function(b){return b*b*(2.70158*b-1.70158)},Out:function(b){return--b*b*(2.70158*b+1.70158)+1},InOut:function(b){return 1>(b*=2)?.5*b*b*(3.5949095*b-2.5949095):.5*((b-=2)*b*(3.5949095*b+2.5949095)+2)}},Bounce:{In:function(b){return 1-module$node_modules$$tweenjs$tween_js$src$Tween.default.Easing.Bounce.Out(1-b)},Out:function(b){return b<1/2.75?7.5625*b*b:b<2/2.75?7.5625*(b-=1.5/2.75)*b+.75:b<2.5/2.75?7.5625*(b-=2.25/
   2.75)*b+.9375:7.5625*(b-=2.625/2.75)*b+.984375},InOut:function(b){return.5>b?.5*module$node_modules$$tweenjs$tween_js$src$Tween.default.Easing.Bounce.In(2*b):.5*module$node_modules$$tweenjs$tween_js$src$Tween.default.Easing.Bounce.Out(2*b-1)+.5}}};
   module$node_modules$$tweenjs$tween_js$src$Tween.default.Interpolation={Linear:function(b,a){var c=b.length-1,d=c*a,e=Math.floor(d),g=module$node_modules$$tweenjs$tween_js$src$Tween.default.Interpolation.Utils.Linear;return 0>a?g(b[0],b[1],d):1<a?g(b[c],b[c-1],c-d):g(b[e],b[e+1>c?c:e+1],d-e)},Bezier:function(b,a){for(var c=0,d=b.length-1,e=Math.pow,g=module$node_modules$$tweenjs$tween_js$src$Tween.default.Interpolation.Utils.Bernstein,h=0;h<=d;h++)c+=e(1-a,d-h)*e(a,h)*b[h]*g(d,h);return c},CatmullRom:function(b,
   a){var c=b.length-1,d=c*a,e=Math.floor(d),g=module$node_modules$$tweenjs$tween_js$src$Tween.default.Interpolation.Utils.CatmullRom;return b[0]===b[c]?(0>a&&(e=Math.floor(d=c*(1+a))),g(b[(e-1+c)%c],b[e],b[(e+1)%c],b[(e+2)%c],d-e)):0>a?b[0]-(g(b[0],b[0],b[1],b[1],-d)-b[0]):1<a?b[c]-(g(b[c],b[c],b[c-1],b[c-1],d-c)-b[c]):g(b[e?e-1:0],b[e],b[c<e+1?c:e+1],b[c<e+2?c:e+2],d-e)},Utils:{Linear:function(b,a,c){return(a-b)*c+b},Bernstein:function(b,a){var c=module$node_modules$$tweenjs$tween_js$src$Tween.default.Interpolation.Utils.Factorial;
   return c(b)/c(a)/c(b-a)},Factorial:function(){var b=[1];return function(a){var c=1;if(b[a])return b[a];for(var d=a;1<d;d--)c*=d;return b[a]=c}}(),CatmullRom:function(b,a,c,d,e){b=.5*(c-b);d=.5*(d-a);var g=e*e;return(2*a-2*c+b+d)*e*g+(-3*a+3*c-2*b-d)*g+b*e+a}}};/*
    *****************************************************************************
   Copyright (c) Microsoft Corporation. All rights reserved.
   Licensed under the Apache License, Version 2.0 (the "License"); you may not use
   this file except in compliance with the License. You may obtain a copy of the
   License at http://www.apache.org/licenses/LICENSE-2.0
   
   THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
   KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
   WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
   MERCHANTABLITY OR NON-INFRINGEMENT.
   
   See the Apache Version 2.0 License for specific language governing permissions
   and limitations under the License.
   *****************************************************************************/
   var module$node_modules$shapedivernodemodule_viewersettings$bundle={default:{}};Object.defineProperty(module$node_modules$shapedivernodemodule_viewersettings$bundle.default,"__esModule",{value:!0});
   var Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle=function(){function b(a,b,d,e){void 0===e&&(e=!0);this._value=a;this._type=b;this._desc=d;this._persistent=e}Object.defineProperty(b.prototype,"desc",{get:function(){return this._desc},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"persistent",{get:function(){return this._persistent},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"type",{get:function(){return this._type},enumerable:!0,
   configurable:!0});Object.defineProperty(b.prototype,"value",{get:function(){return this._value},set:function(a){this._value=a},enumerable:!0,configurable:!0});return b}(),BaseSettings$$module$node_modules$shapedivernodemodule_viewersettings$bundle=function(){function b(){}Object.defineProperty(b.prototype,"settings",{get:function(){return this._settings},set:function(a){this._settings=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"version",{get:function(){return this._version},
   enumerable:!0,configurable:!0});b.prototype.getSettingDefinitions=function(){var a={};this._getSettingDefinitions(this._settings,a,"");return a};b.prototype.getSettingObject=function(a){a=a.split(".");for(var b=this._settings,d=0;d<a.length;d++)if(b=b[a[d]],b instanceof Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle&&d<a.length-1)b=b.value;else{if(b instanceof Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle)return b;if(!b)break}};b.prototype.getSettings=
   function(a){void 0===a&&(a=!1);var b={};this._getSettings(this._settings,a,b,"");return b};b.prototype.toJSON=function(a){void 0===a&&(a=!1);return this._toJSON(this._settings,a)};b.prototype._fromJSON=function(a,b){if(a)for(var c in b)if(b[c]instanceof Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle){var e=b[c];e="object"===typeof e.value&&null!==e.value?Object.values(e.value):[];0!==e.length&&e[0]instanceof Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle?
   this._fromJSON(a[c],b[c].value):void 0!==a[c]&&(b[c].value=a[c])}else this._fromJSON(a[c],b[c])};b.prototype._toJSON=function(a,b){var c={},e;for(e in a)if(a[e]instanceof Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle){var g=a[e];if(!b||g.persistent)g="object"===typeof g.value&&null!==g.value?Object.values(g.value):[],c[e]=0!==g.length&&g[0]instanceof Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle?this._toJSON(a[e].value,b):a[e].value}else c[e]=a[e]instanceof
   String||"string"===typeof a[e]?a[e]:this._toJSON(a[e],b);return c};b.prototype._getSettingDefinitions=function(a,b,d){d=d?d+".":"";for(var c in a)if(a[c]instanceof Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle){var g=a[c];g="object"===typeof g.value&&null!==g.value?Object.values(g.value):[];0!==g.length&&g[0]instanceof Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle?(a[c].desc&&(b[d+c]={},b[d+c].descripton=a[c].desc,"string"===typeof a[c].type||a[c].type instanceof
   String)&&(b[d+c].type=a[c].type),this._getSettingDefinitions(a[c].value,b,d+c)):a[c].desc&&(b[d+c]={},b[d+c].descripton=a[c].desc,"string"===typeof a[c].type||a[c].type instanceof String)&&(b[d+c].type=a[c].type)}else a[c]instanceof String||"string"===typeof a[c]||this._getSettingDefinitions(a[c],b,d+c)};b.prototype._getSettings=function(a,b,d,e){e=e?e+".":"";for(var c in a)if(a[c]instanceof Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle){var h=a[c];if(!b||h.persistent)h=
   "object"===typeof h.value&&null!==h.value?Object.values(h.value):[],0!==h.length&&h[0]instanceof Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle?this._getSettings(a[c].value,b,d,e+c):d[e+c]=a[c].value}else a[c]instanceof String||"string"===typeof a[c]?d[e+c]=a[c]:this._getSettings(a[c],b,d,e+c)};return b}(),SettingsVersion$$module$node_modules$shapedivernodemodule_viewersettings$bundle=function(){function b(a){void 0===a&&(a="");this._versionLevels=[1,0,0];a=a.split(".");for(var b=
   0,d=Math.min(a.length,this._versionLevels.length);b<d;b++)this._versionLevels[b]=+a[b]}Object.defineProperty(b.prototype,"versionLevels",{get:function(){return this._versionLevels},enumerable:!0,configurable:!0});b.prototype.equalTo=function(a){if(a.versionLevels.length!==this._versionLevels.length)return!1;for(var b=0;b<this._versionLevels.length;b++)if(a.versionLevels[b]!==this._versionLevels[b])return!1;return!0};b.prototype.isLowerThan=function(a){for(var b=0;b<this._versionLevels.length&&!(this._versionLevels[b]>
   a.versionLevels[b]);b++)if(this._versionLevels[b]<a.versionLevels[b])return!0;return!1};b.prototype.toString=function(){return this._versionLevels.join(".")};return b}(),extendStatics$$module$node_modules$shapedivernodemodule_viewersettings$bundle=function(b,a){extendStatics$$module$node_modules$shapedivernodemodule_viewersettings$bundle=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return extendStatics$$module$node_modules$shapedivernodemodule_viewersettings$bundle(b,
   a)};function __extends$$module$node_modules$shapedivernodemodule_viewersettings$bundle(b,a){function c(){this.constructor=b}extendStatics$$module$node_modules$shapedivernodemodule_viewersettings$bundle(b,a);b.prototype=null===a?Object.create(a):(c.prototype=a.prototype,new c)}
   module$node_modules$shapedivernodemodule_viewersettings$bundle.default.Settings_1_0=function(b){function a(a){var c=b.call(this)||this;c._version=new SettingsVersion$$module$node_modules$shapedivernodemodule_viewersettings$bundle("1.0");c._settings={build_date:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle("","string","",!1),build_version:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle("","string","",!1),settings_version:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle("1.0",
   "string","",!0),ambientOcclusion:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!0,function(a){return!0}),autoRotateSpeed:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(0,function(a){return!0}),backgroundColor:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle("0xffffffff",function(a){return!0}),bumpAmplitude:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(1,function(a){return!0}),camera:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle({position:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle({x:0,
   y:0,z:0},function(a){return!0}),target:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle({x:0,y:0,z:0},function(a){return!0})},function(a){return!0}),cameraAutoAdjust:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!1,function(a){return!0}),cameraMovementDuration:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(0,function(a){return!0}),cameraOrtho:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle({position:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle({x:0,
   y:0,z:0},function(a){return!0}),target:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle({x:0,y:0,z:0},function(a){return!0})},function(a){return!0}),cameraRevertAtMouseUp:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!1,function(a){return!0}),clearAlpha:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(1,function(a){return!0}),clearColor:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle("#ffffff",
   function(a){return!0}),commitParameters:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!1,function(a){return!0}),controlDamping:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(.1,function(a){return!0}),controlNames:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle({},function(a){return!0}),controlOrder:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle([],function(a){return!0}),defaultMaterialColor:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle("#d3d3d3",
   function(a){return!0}),disablePan:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!1,function(a){return!0}),disableZoom:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!1,function(a){return!0}),enableAutoRotation:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!1,function(a){return!0}),enableRotation:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!0,function(a){return!0}),environmentMap:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle("none",
   function(a){return!0}),environmentMapResolution:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle("1024",function(a){return!0}),fov:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(45,function(a){return!0}),lightScene:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle("default",function(a){return!0}),lightScenes:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(null,function(a){return!0}),panSpeed:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(.5,
   function(a){return!0}),parametersHidden:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle([],function(a){return!0}),pointSize:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(1,function(a){return!0}),revertAtMouseUpDuration:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(800,function(a){return!0}),rotateSpeed:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(.25,function(a){return!0}),showEnvironmentMap:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!1,
   function(a){return!0}),showGrid:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!1,function(a){return!0}),showGroundPlane:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!1,function(a){return!0}),showShadows:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!0,function(a){return!0}),topView:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!1,function(a){return!0}),zoomExtentFactor:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(1,
   function(a){return!0}),zoomSpeed:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(1,function(a){return!0})};if(a){a.clearAlpha&&a.clearColor||!a.backgroundColor||"string"!==typeof a.backgroundColor||(a.clearColor=a.backgroundColor.substring(0,8),a.clearAlpha=parseInt(a.backgroundColor.substring(8),16)/255);if(a.defaultMaterialColor&&Array.isArray(a.defaultMaterialColor)){for(var e="#",g=0;g<a.defaultMaterialColor.length;g++)e+=Number(a.defaultMaterialColor[g]).toString(16);
   a.defaultMaterialColor=e}c._fromJSON(a,c._settings)}return c}__extends$$module$node_modules$shapedivernodemodule_viewersettings$bundle(a,b);a.prototype.convertFromPreviousVersion=function(a){return this};a.prototype.convertToPreviousVersion=function(){return this};return a}(BaseSettings$$module$node_modules$shapedivernodemodule_viewersettings$bundle);
   module$node_modules$shapedivernodemodule_viewersettings$bundle.default.Settings_2_0=function(b){function a(a){var c=b.call(this)||this;c._version=new SettingsVersion$$module$node_modules$shapedivernodemodule_viewersettings$bundle("2.0");c._settings={build_date:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle("","string","",!1),build_version:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle("","string","",!1),settings_version:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle("2.0",
   "string","",!0),ar:{enableCameraSync:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!1,"boolean","Enable / disable synchronisation of the camera with AR tracking information. Enabling this will disable the orbit controls.",!1),enableCameraSyncInitial:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!1,"boolean","Enable / disable the inital synchronisation of the camera with AR tracking information. Enabling this will disable the orbit controls."),
   enableLightingEstimation:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!0,"boolean","Enable / disable automatic lighting estimation. Enabling this stores the current state of the lights which will get restored once automatic lighting estimation gets disabled again."),enableTouchControls:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!0,"boolean","Enable / disable touch controls for placement of objects in the AR scene while AR camera synchronisation is enabled."),
   enableTouchControlRotation:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!0,"boolean","Enable / disable rotation of objects in the AR scene by means of touch controls. Typically this should be enabled for objects to be placed horizontally."),enableAutomaticPlacement:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!0,"boolean","Enable / disable initial automatic placement of objects in the AR scene as soon as plane anchors get detected. Automatic placement stops once the user starts to interact."),
   defaultHitTestType:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle("existingPlaneUsingGeometry",function(a){return"featurePoint estimatedHorizontalPlane estimatedVerticalPlane existingPlane existingPlaneUsingExtent existingPlaneUsingGeometry".split(" ").includes(a)},"Default type of feature to use for hit tests, used by touch controls. ")},defaultMaterial:{bumpAmplitude:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(1,"notnegative","Bump amplitude of the default material"),
   color:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle("#d3d3d3","string","Color of the default material"),metalness:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(0,"factor","Metalness of the default material"),roughness:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(1,"factor","Roughness of the default material")},parameters:{controlOrder:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle([],
   "stringarray",""),controlNames:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle({},function(a){return!0},""),parametersHidden:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle([],"stringarray","")},viewer:{blurSceneWhenBusy:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!0,"boolean","Blur or don't blur the scene while a process is busy"),ignoreSuperseded:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!0,
   "boolean","Ignore intermediate solutions which at the time of their arrival have already been superseded by another customization request",!1),loggingLevel:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(-1,function(a){return-1<=a&&3>=a},"Level of log messages shown on the console, allowed values: -1 (none), 0 (error), 1 (warn), 2 (info), 3 (debug)",!1),messageLoggingLevel:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(-1,function(a){return-1<=
   a&&3>=a},"Log level to be used for logging internal messages, allowed values: -1 (none), 0 (error), 1 (warn), 2 (info), 3 (debug)",!1),showMessages:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!0,"boolean","Show or don't show user messages in the viewport",!1),hasRestoredSettings:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!1,"boolean","True if settings have been restored from a settings object delivered by a CommPlugin",!1),commitParameters:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!1,
   "boolean","Use or don't commit mode for parameters"),commitSettings:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!1,"boolean","Use or don't commit mode for settings"),viewerRuntimeId:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle("","string","The runtime id of this viewer",!1),scene:{show:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!1,"boolean","Show / hide the scene",!1),showSceneTransition:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle("1s",
   "string",""),camera:{autoAdjust:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!1,"boolean","Enable / disable that the camera adjusts to geometry updates"),cameraMovementDuration:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(800,"notnegative","Default duration of camera movements"),cameraTypes:{perspective:{default:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle({position:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle({x:0,
   y:0,z:0},"vector3any","Default position for the perspective camera"),target:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle({x:0,y:0,z:0},"vector3any","Default target for the perspective camera")},function(a){return!0},"Default position and target for the perspective camera"),fov:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(45,"notnegative","Camera frustum vertical field of view angle, unit degree, interval [0,180]"),controls:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(0,
   function(a){return 0===a||1===a},"Set camera control type")},orthographic:{default:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle({position:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle({x:0,y:0,z:0},"vector3any","Default position for the orthographic camera"),target:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle({x:0,y:0,z:0},"vector3any","Default target for the orthographic camera")},function(a){return!0},"Default position and target for the orthographic camera")},
   active:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(0,function(a){return 0<=a&&6>=a},"Set camera type")},controls:{orbit:{autoRotationSpeed:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(0,"number","Speed of autoration, can be negative, also refer to enableAutoRotation"),damping:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(.1,"notnegative","How much to damp camera movements by the user"),enableAutoRotation:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!1,
   "boolean","Enable / disable automatic rotation of the camera, also refer to autoRotationSpeed"),enableKeyPan:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!1,"boolean","Enable / disable panning using the keyboard, also refer to enablePan"),enablePan:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!0,"boolean","Enable / disable panning in general, also refer to enableKeyPan"),enableRotation:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!0,
   "boolean","Enable / disable camera rotation"),enableZoom:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!0,"boolean","Enable / disable zooming"),input:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle({keys:{up:38,down:40,left:37,right:39},mouse:{rotate:0,zoom:1,pan:2},touch:{rotate:1,zoom:2,pan:3}},"any"),keyPanSpeed:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(.5,"factor","Speed of panning when using the keyboard"),
   movementSmoothness:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(.5,"factor","How much to the current movement is affected by the previous one"),restrictions:{position:{cube:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle({min:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle({x:-Infinity,y:-Infinity,z:-Infinity},"vector3any","Restriction of the camera position inside a cube, minimum corner of the cube"),max:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle({x:Infinity,
   y:Infinity,z:Infinity},"vector3any","Restriction of the camera position inside a cube, maximum corner of the cube")},function(a){return!0},"Restriction of the camera position inside a cube, minimum and maximum corner of the cube",!1),sphere:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle({center:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle({x:0,y:0,z:0},"vector3any","Restriction of the camera position inside a sphere, center of the sphere"),
   radius:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(Infinity,"notnegative","Restriction of the camera position inside a sphere, radius of the sphere")},function(a){return!0},"Restriction of the camera position inside a sphere, center and radius of the sphere",!1)},target:{cube:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle({min:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle({x:-Infinity,y:-Infinity,z:-Infinity},
   "vector3any","Restriction of the camera target inside a cube, minimum corner of the cube"),max:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle({x:Infinity,y:Infinity,z:Infinity},"vector3any","Restriction of the camera target inside a cube, maximum corner of the cube")},function(a){return!0},"Restriction of the camera target inside a cube, minimum and maximum corner of the cube",!1),sphere:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle({center:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle({x:0,
   y:0,z:0},"vector3any","Restriction of the camera target inside a sphere, center of the sphere"),radius:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(Infinity,"notnegative","Restriction of the camera target inside a sphere, radius of the sphere")},function(a){return!0},"Restriction of the camera target inside a sphere, center and radius of the sphere",!1)},rotation:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle({minPolarAngle:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(0,
   function(a){return!0},"Minimum polar angle of the camera position with respect to the camera target, unit degree, interval [0,180]"),maxPolarAngle:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(180,function(a){return!0},"Maximum polar angle of the camera position with respect to the camera target, unit degree, interval [0,180]"),minAzimuthAngle:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(-Infinity,"number","Minimum azimuth angle of the camera position with respect to the camera target, unit degree, interval [-180,180]"),
   maxAzimuthAngle:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(Infinity,"number","Maximum azimuth angle of the camera position with respect to the camera target, unit degree, interval [-180,180]")},function(a){return!0},"Minimum and maximum polar and azimuth angle of the camera position with respect to the camera target, unit degree",!1),zoom:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle({minDistance:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(0,
   "notnegative","Minimum distance between camera position and target"),maxDistance:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(Infinity,"notnegative","Maximum distance between camera position and target")},function(a){return!0},"Minimum and maximum distance between camera position and target",!1)},rotationSpeed:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(.5,"factor","Speed of camera rotation"),panSpeed:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(.5,
   "factor","Speed of panning"),zoomSpeed:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(.5,"factor","Speed of zooming")},fps:{},orthographic:{damping:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(.1,"notnegative","How much to damp camera movements by the user"),enableKeyPan:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!1,"boolean","Enable / disable panning using the keyboard, also refer to enablePan"),enablePan:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!0,
   "boolean","Enable / disable panning in general, also refer to enableKeyPan"),enableZoom:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!0,"boolean","Enable / disable zooming"),input:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle({keys:{up:38,down:40,left:37,right:39},mouse:{rotate:0,zoom:1,pan:2},touch:{rotate:1,zoom:2,pan:3}},"any"),keyPanSpeed:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(.5,"factor","Speed of panning when using the keyboard"),
   movementSmoothness:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(.5,"factor","How much to the current movement is affected by the previous one"),panSpeed:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(.5,"factor","Speed of panning"),zoomSpeed:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(.5,"factor","Speed of zooming")}},enableCameraControls:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!0,
   "boolean","Enable / disable camera controls"),revertAtMouseUp:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!1,"boolean","Enable / disable if the mouse should reset on mouse up"),revertAtMouseUpDuration:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(800,"notnegative","The duration of the transition of the revertAtMouseUp"),zoomExtentsFactor:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(1,"number","Factor to apply to the bounding box before zooming to extents")},
   duration:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(0,"notnegative","Set fade in / fade out duration"),fullscreen:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!1,"boolean","Enable / disable fullscreen mode",!1),gridVisibility:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!0,"boolean","Show / hide the grid"),groundPlaneReflectionThreshold:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(.01,
   "notnegative","Allows to control the distance to objects that are still reflected by the groundplane"),groundPlaneReflectionVisibility:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!1,"boolean","Enable / disable the reflectivity of the groundplane"),groundPlaneVisibility:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!0,"boolean","Show / hide the ground plane"),lights:{helper:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!1,
   "boolean","Show / hide the light helpers"),lightScene:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle("default","string"),lightScenes:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle({},"any")},material:{environmentMap:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle("none",function(a){return!0},"Name of the environment map to use, or an array of 6 image URLs making up the cube mapped environment map (px, nx, pz, nz, py, ny)"),
   environmentMapAsBackground:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!1,"boolean","Show / hide the environment map in the background"),environmentMapResolution:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle("1024",function(a){return["256","512","1024","2048"].includes(a)},"Image resolution to be used for the named environment maps (available resolutions: 256, 512, 1024)")},render:{ambientOcclusion:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!0,
   "boolean","Enable / disable ambient occlusion for rendering"),beautyRenderDelay:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(50,"notnegative","Amount of which the beauty rendering is delayed"),clearColor:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle("#ffffff","string","Set background color"),clearAlpha:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(1,"factor","Set background alpha value"),pointSize:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(1,
   "notnegative","Set size of point objects"),shadows:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(!0,"boolean","Enable / disable shadows for rendering"),sao:{samples:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(8,"notnegative"),intensity:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(.1,"notnegative"),kernelRadius:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(8,"notnegative"),standardDev:new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle(25,
   "notnegative")}}}}};a&&c._fromJSON(a,c._settings);return c}__extends$$module$node_modules$shapedivernodemodule_viewersettings$bundle(a,b);a.prototype.convertFromPreviousVersion=function(a){a=a.settings;this._settings.viewer.scene.render.clearAlpha.value=a.clearAlpha.value;this._settings.viewer.scene.render.clearColor.value=a.clearColor.value;this._settings.defaultMaterial.color.value=a.defaultMaterialColor.value;this._settings.build_date.value=a.build_date.value;this._settings.build_version.value=
   a.build_version.value;if(5!==a.camera.value.position.value.x||5!==a.camera.value.position.value.y||5!==a.camera.value.position.value.z||0!==a.camera.value.target.value.x||0!==a.camera.value.target.value.y||0!==a.camera.value.target.value.z)this._settings.viewer.scene.camera.cameraTypes.perspective.default.value.position.value=a.camera.value.position.value,this._settings.viewer.scene.camera.cameraTypes.perspective.default.value.target.value=a.camera.value.target.value;if(5!==a.cameraOrtho.value.position.value.x||
   5!==a.cameraOrtho.value.position.value.y||5!==a.cameraOrtho.value.position.value.z||0!==a.cameraOrtho.value.target.value.x||0!==a.cameraOrtho.value.target.value.y||0!==a.cameraOrtho.value.target.value.z)this._settings.viewer.scene.camera.cameraTypes.orthographic.default.value.position.value=a.cameraOrtho.value.position.value,this._settings.viewer.scene.camera.cameraTypes.orthographic.default.value.target.value=a.cameraOrtho.value.target.value;this._settings.viewer.scene.render.ambientOcclusion.value=
   a.ambientOcclusion.value;this._settings.viewer.scene.camera.controls.orbit.autoRotationSpeed.value=a.autoRotateSpeed.value;this._settings.defaultMaterial.bumpAmplitude.value=a.bumpAmplitude.value;this._settings.viewer.scene.camera.autoAdjust.value=a.cameraAutoAdjust.value;this._settings.viewer.scene.camera.cameraMovementDuration.value=a.cameraMovementDuration.value;this._settings.viewer.scene.camera.revertAtMouseUp.value=a.cameraRevertAtMouseUp.value;this._settings.viewer.commitParameters.value=a.commitParameters.value;
   this._settings.viewer.scene.camera.controls.orbit.damping.value=a.controlDamping.value;this._settings.viewer.scene.camera.controls.orthographic.damping.value=a.controlDamping.value;this._settings.parameters.controlNames.value=a.controlNames.value;this._settings.parameters.controlOrder.value=a.controlOrder.value;this._settings.viewer.scene.camera.controls.orbit.enablePan.value=!a.disablePan.value;this._settings.viewer.scene.camera.controls.orthographic.enablePan.value=!a.disablePan.value;this._settings.viewer.scene.camera.controls.orbit.enableZoom.value=
   !a.disableZoom.value;this._settings.viewer.scene.camera.controls.orthographic.enableZoom.value=!a.disableZoom.value;this._settings.viewer.scene.camera.controls.orbit.enableAutoRotation.value=a.enableAutoRotation.value;this._settings.viewer.scene.camera.controls.orbit.enableRotation.value=a.enableRotation.value;this._settings.viewer.scene.material.environmentMap.value=a.environmentMap.value;this._settings.viewer.scene.material.environmentMapResolution.value=a.environmentMapResolution.value;this._settings.viewer.scene.camera.cameraTypes.perspective.fov.value=
   a.fov.value;this._settings.viewer.scene.lights.lightScene.value=a.lightScene.value;this._settings.viewer.scene.lights.lightScenes.value=a.lightScenes.value;this._settings.viewer.scene.camera.controls.orbit.panSpeed.value=a.panSpeed.value;this._settings.parameters.parametersHidden.value=a.parametersHidden.value;this._settings.viewer.scene.render.pointSize.value=a.pointSize.value;this._settings.viewer.scene.camera.revertAtMouseUpDuration.value=a.revertAtMouseUpDuration.value;this._settings.viewer.scene.camera.controls.orbit.rotationSpeed.value=
   a.rotateSpeed.value;this._settings.viewer.scene.material.environmentMapAsBackground.value=a.showEnvironmentMap.value;this._settings.viewer.scene.gridVisibility.value=a.showGrid.value;this._settings.viewer.scene.groundPlaneVisibility.value=a.showGroundPlane.value;this._settings.viewer.scene.render.shadows.value=a.showShadows.value;a.topView.value&&(this._settings.viewer.scene.camera.cameraTypes.active.value=1);this._settings.viewer.scene.camera.zoomExtentsFactor.value=a.zoomExtentFactor.value;this._settings.viewer.scene.camera.controls.orbit.zoomSpeed.value=
   a.zoomSpeed.value;this._settings.viewer.scene.camera.controls.orthographic.zoomSpeed.value=a.zoomSpeed.value;return this};a.prototype.convertToPreviousVersion=function(){var a=new module$node_modules$shapedivernodemodule_viewersettings$bundle.default.Settings_1_0;a.settings.build_date.value=this._settings.build_date.value;a.settings.build_version.value=this._settings.build_version.value;a.settings.ambientOcclusion.value=this._settings.viewer.scene.render.ambientOcclusion.value;a.settings.autoRotateSpeed.value=
   this._settings.viewer.scene.camera.controls.orbit.autoRotationSpeed.value;a.settings.bumpAmplitude.value=this._settings.defaultMaterial.bumpAmplitude.value;a.settings.camera.value=(new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle({position:this._settings.viewer.scene.camera.cameraTypes.perspective.default.value.position.value,target:this._settings.viewer.scene.camera.cameraTypes.perspective.default.value.target.value},function(a){return!0})).value;a.settings.cameraAutoAdjust.value=
   this._settings.viewer.scene.camera.autoAdjust.value;a.settings.cameraMovementDuration.value=this._settings.viewer.scene.camera.cameraMovementDuration.value;a.settings.cameraOrtho.value=(new Setting$$module$node_modules$shapedivernodemodule_viewersettings$bundle({position:this._settings.viewer.scene.camera.cameraTypes.orthographic.default.value.position.value,target:this._settings.viewer.scene.camera.cameraTypes.orthographic.default.value.target.value},function(a){return!0})).value;a.settings.cameraRevertAtMouseUp.value=
   this._settings.viewer.scene.camera.revertAtMouseUp.value;a.settings.clearAlpha.value=this._settings.viewer.scene.render.clearAlpha.value;a.settings.clearColor.value=this._settings.viewer.scene.render.clearColor.value;a.settings.commitParameters.value=this._settings.viewer.commitParameters.value;a.settings.controlDamping.value=this._settings.viewer.scene.camera.controls.orbit.damping.value;this._settings.parameters.controlNames.value&&(a.settings.controlNames.value=this._settings.parameters.controlNames.value);
   this._settings.parameters.controlOrder.value&&(a.settings.controlOrder.value=this._settings.parameters.controlOrder.value);a.settings.defaultMaterialColor.value=this._settings.defaultMaterial.color.value;a.settings.disablePan.value=!this._settings.viewer.scene.camera.controls.orbit.enablePan.value;a.settings.disableZoom.value=!this._settings.viewer.scene.camera.controls.orbit.enableZoom.value;a.settings.enableAutoRotation.value=this._settings.viewer.scene.camera.controls.orbit.enableAutoRotation.value;
   a.settings.enableRotation.value=this._settings.viewer.scene.camera.controls.orbit.enableRotation.value;a.settings.environmentMap.value=this._settings.viewer.scene.material.environmentMap.value;a.settings.environmentMapResolution.value=this._settings.viewer.scene.material.environmentMapResolution.value;a.settings.fov.value=this._settings.viewer.scene.camera.cameraTypes.perspective.fov.value;a.settings.lightScene.value=this._settings.viewer.scene.lights.lightScene.value;a.settings.lightScenes.value=
   this._settings.viewer.scene.lights.lightScenes.value;a.settings.panSpeed.value=this._settings.viewer.scene.camera.controls.orbit.panSpeed.value;this._settings.parameters.parametersHidden.value&&(a.settings.parametersHidden.value=this._settings.parameters.parametersHidden.value);a.settings.pointSize.value=this._settings.viewer.scene.render.pointSize.value;a.settings.revertAtMouseUpDuration.value=this._settings.viewer.scene.camera.revertAtMouseUpDuration.value;a.settings.rotateSpeed.value=this._settings.viewer.scene.camera.controls.orbit.rotationSpeed.value;
   a.settings.showEnvironmentMap.value=this._settings.viewer.scene.material.environmentMapAsBackground.value;a.settings.showGrid.value=this._settings.viewer.scene.gridVisibility.value;a.settings.showGroundPlane.value=this._settings.viewer.scene.groundPlaneVisibility.value;a.settings.showShadows.value=this._settings.viewer.scene.render.shadows.value;a.settings.topView.value=1===this._settings.viewer.scene.camera.cameraTypes.active.value;a.settings.zoomExtentFactor.value=this._settings.viewer.scene.camera.zoomExtentsFactor.value;
   a.settings.zoomSpeed.value=this._settings.viewer.scene.camera.controls.orbit.zoomSpeed.value;return a};return a}(BaseSettings$$module$node_modules$shapedivernodemodule_viewersettings$bundle);var ViewerVersionSettingsVersion$$module$node_modules$shapedivernodemodule_viewersettings$bundle=function(){return function(b,a){this.viewer_version=new SettingsVersion$$module$node_modules$shapedivernodemodule_viewersettings$bundle(b);this.settings_version=new SettingsVersion$$module$node_modules$shapedivernodemodule_viewersettings$bundle(a)}}();
   module$node_modules$shapedivernodemodule_viewersettings$bundle.default.SettingsConversion=function(){function b(){this._settingsVersions=[];this._versions={"1.0.0":module$node_modules$shapedivernodemodule_viewersettings$bundle.default.Settings_1_0,"2.0.0":module$node_modules$shapedivernodemodule_viewersettings$bundle.default.Settings_2_0};this._mapViewerVersionSettingsVersion=[new ViewerVersionSettingsVersion$$module$node_modules$shapedivernodemodule_viewersettings$bundle("2.18.0","2.0")];for(var a=
   0,b=Object.keys(this._versions);a<b.length;a++)this._settingsVersions.push(new this._versions[b[a]])}b.prototype.convert=function(a,b,d){void 0===d&&(d=!1);a=this.createSettingsObject(a);var c=a.version,g=new SettingsVersion$$module$node_modules$shapedivernodemodule_viewersettings$bundle(b);b=this._findVersionIndex(c);c=this._findVersionIndex(g);if(-1===b||-1===c)return a.toJSON();if(b<c)for(;b<c;)b+=1,a=(new (this._versions[this._settingsVersions[b].version.toString()])).convertFromPreviousVersion(a);
   else if(b>c)for(;b>c;)--b,a=a.convertToPreviousVersion();return a.toJSON(d)};b.prototype.createSettingsObject=function(a){if(!a.settings_version)return new module$node_modules$shapedivernodemodule_viewersettings$bundle.default.Settings_1_0(a);var b=new SettingsVersion$$module$node_modules$shapedivernodemodule_viewersettings$bundle(a.settings_version);return new (this._versions[b.toString()])(a)};b.prototype.mapViewerVersionToSettingsVersion=function(a){a=new SettingsVersion$$module$node_modules$shapedivernodemodule_viewersettings$bundle(a||
   "0.0.0");for(var b=0,d=this._mapViewerVersionSettingsVersion;b<d.length;b++){var e=d[b];if(e.viewer_version.isLowerThan(a)||e.viewer_version.equalTo(a))return e.settings_version.toString()}return"1.0"};b.prototype._findVersionIndex=function(a){a=new SettingsVersion$$module$node_modules$shapedivernodemodule_viewersettings$bundle(a.toString());for(var b=0;b<this._settingsVersions.length;b++)if(this._settingsVersions[b].version.equalTo(a))return b;for(b=a.versionLevels[a.versionLevels.length-1]=0;b<
   this._settingsVersions.length;b++)if(this._settingsVersions[b].version.equalTo(a))return b;return-1};return b}();var module$src$3d$interfaces$ThreeDManagerInterface={default:function(b){this.lightHandler=this.materialHandler=this.cameraHandler=this.renderingHandler=null;this.success=!0;module$src$shared$mixins$GlobalMixin.default.call(this);module$src$shared$util$GlobalUtils.default.inject(b.loggingHandler,this);module$src$shared$util$GlobalUtils.default.inject(b.messagingHandler,this)}};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.init=function(b){};
   module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.adjustScene=function(){};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.computeBoundingBox=function(b){};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.pause=function(){};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.resume=function(){};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.destroy=function(){};
   module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.reload=function(){};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.addMesh=function(b,a,c){};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.removeMesh=function(b){};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.addAnchor=function(b,a){};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.removeAnchor=function(b){};
   module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.fadeIn=function(b,a){};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.fadeOut=function(b,a){};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.setLiveTransformation=function(b,a,c,d,e){};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.updateInteractions=function(b,a){};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.removeFromInteractions=function(b){};
   module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.toggleGeometry=function(){};var module$src$3d$viewport$ThreeDManagerConstants={},threeDManagerConstants$$module$src$3d$viewport$ThreeDManagerConstants,_convert=function(b,a){for(var c in b){if("value"===c)return _hasSubValue(b[c])?_convert(b[c],a):b[c];"desc"!==c&&(a[c]={},a[c]=_convert(b[c],a[c]))}return a},_hasSubValue=function(b){if("object"===typeof b)for(var a in b)if("value"===a||_hasSubValue(b[a]))return!0;return!1},GLOBAL_UTILS=module$src$shared$util$GlobalUtils.default,LOGGING_CONSTANTS=module$src$shared$constants$LoggingConstants.default,
   LOGGING_LEVELS=module$src$shared$constants$LoggingConstants.default.loggingLevels,cameraViewTypes={MIN:0,PERSPECTIVE:0,TOP:1,BOTTOM:2,RIGHT:3,LEFT:4,BACK:5,FRONT:6,MAX:6},cameraControlsTypes={MIN:0,ORBIT:0,FPS:1,ORTHOGRAPHIC:2,MAX:2},settingsDefinition={camera:{autoRotationSpeed:{value:0},damping:{value:.1},defaults:{perspective:{value:{position:{value:{x:0,y:0,z:0}},target:{value:{x:0,y:0,z:0}}}},orthographic:{value:{position:{value:{x:0,y:0,z:0}},target:{value:{x:0,y:0,z:0}}}}},enableAutoRotation:{value:!1},
   enableKeyPan:{value:!1},enablePan:{value:!0},enableRotation:{value:!0},enableZoom:{value:!0},fov:{value:45},keyPanSpeed:{value:1},restrictions:{position:{cube:{value:{min:{value:{x:-Infinity,y:-Infinity,z:-Infinity}},max:{value:{x:Infinity,y:Infinity,z:Infinity}}}},sphere:{value:{center:{value:{x:0,y:0,z:0}},radius:{value:Infinity}}}},target:{cube:{value:{min:{value:{x:-Infinity,y:-Infinity,z:-Infinity}},max:{value:{x:Infinity,y:Infinity,z:Infinity}}}},sphere:{value:{center:{value:{x:0,y:0,z:0}},
   radius:{value:Infinity}}}},rotation:{value:{minPolarAngle:{value:0},maxPolarAngle:{value:180},minAzimuthAngle:{value:-Infinity},maxAzimuthAngle:{value:Infinity}}},zoom:{value:{minDistance:{value:0},maxDistance:{value:Infinity}}}},rotationSpeed:{value:.5},panSpeed:{value:.5},type:{value:cameraViewTypes.PERSPECTIVE},zoomSpeed:{value:1}}},defaultSettings={};_convert(settingsDefinition,defaultSettings);
   threeDManagerConstants$$module$src$3d$viewport$ThreeDManagerConstants={cameraLegacyDefinition:settingsDefinition,cameraLegacyDefaultSettings:defaultSettings,loggingLevels:LOGGING_LEVELS,cameraViewTypes:cameraViewTypes};module$src$3d$viewport$ThreeDManagerConstants.default=module$src$shared$util$GlobalUtils.default.deepCopy(threeDManagerConstants$$module$src$3d$viewport$ThreeDManagerConstants);var module$src$3d$viewport$shaders$ShaderFile={default:{}};module$src$3d$viewport$shaders$ShaderFile.default.basic_vert="\nvarying vec2 vUv;\n\nvoid main() {\n\tvUv = uv;\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n\n";module$src$3d$viewport$shaders$ShaderFile.default.blend_frag="\nuniform sampler2D tStandard;\nuniform sampler2D tBeauty;\t\t\nuniform vec2 size;\nuniform float amount;\n\nvarying vec2 vUv;\n\nvoid main() {\n\tgl_FragColor =  texture2D(tStandard, vUv) * (1.0-amount) + texture2D(tBeauty, vUv) * amount;\n}\n\n";
   module$src$3d$viewport$shaders$ShaderFile.default.blur_frag="\n#include <common>\n#include <packing>\n\nuniform sampler2D tAO;\nuniform sampler2D tDiffuse;\n\nuniform sampler2D tDepth;\n\nuniform float cameraNear;\nuniform float cameraFar;\nuniform vec2 size;\nuniform int orientation;\n\nuniform float sampleWeights[ KERNEL_RADIUS + 1 ];\n\nvarying vec2 vUv;\n\t\t\nconst float depthCutoff = 1.0;\n\nvoid main() {\n\tfloat depth = unpackRGBAToDepth( texture2D( tDepth, vUv ) );\n\tif( depth >= ( 1.0 - EPSILON ) ) {\n\t\tgl_FragColor = texture2D(tDiffuse, vUv);\n\t\treturn;\n\t}\n\n\tfloat centerViewZ = -perspectiveDepthToViewZ( depth, cameraNear, cameraFar );\n\tvec2 size = 1.0 / size;\n\n\tfloat weightSum = sampleWeights[0];\n\tvec4 sum = texture2D(tAO, vUv) * sampleWeights[0];\n\n\tvec2 position;\n\tfor(int i = 1; i <= KERNEL_RADIUS; i++){\n\t\tif(orientation == 0){\n\t\t\tposition = vec2(vUv.x - size.x*float(i), vUv.y);\n\t\t}else if(orientation == 1){\n\t\t\tposition = vec2(vUv.x, vUv.y - size.y*float(i));\n\t\t}\n\t\tfloat positionDepth = unpackRGBAToDepth( texture2D( tDepth, position ) );\n\t\tfloat viewZ = -perspectiveDepthToViewZ( positionDepth, cameraNear, cameraFar );\n\t\tif( abs( viewZ - centerViewZ ) > depthCutoff ) break;\n\t\tfloat weight = sampleWeights[i];\n\t\tsum += texture2D( tAO, position ) * weight;\n\t\tweightSum += weight;\n\t}\n\n\tfor(int i = 1; i <= KERNEL_RADIUS; i++){\n\t\tif(orientation == 0){\n\t\t\tposition = vec2(vUv.x + size.x*float(i), vUv.y);\n\t\t}else if(orientation == 1){\n\t\t\tposition = vec2(vUv.x, vUv.y + size.y*float(i));\n\t\t}\n\t\tfloat positionDepth = unpackRGBAToDepth( texture2D( tDepth, position ) );\n\t\tfloat viewZ = -perspectiveDepthToViewZ( positionDepth, cameraNear, cameraFar );\n\t\tif( abs( viewZ - centerViewZ ) > depthCutoff ) break;\n\t\tfloat weight = sampleWeights[i];\n\t\tsum += texture2D( tAO, position ) * weight;\n\t\tweightSum += weight;\n\t}\n\n\tif(orientation == 1){\n\t\tvec4 texel = texture2D(tDiffuse, vUv);\n\t\tgl_FragColor = (sum / weightSum) * texel;\n\t}else{\n\t\tgl_FragColor = (sum / weightSum);\n\t}\n}\n\n";
   module$src$3d$viewport$shaders$ShaderFile.default.copy_frag="\nuniform float opacity;\nuniform sampler2D tDiffuse;\n\nvarying vec2 vUv;\n\nvoid main() {\nvec4 texel = texture2D( tDiffuse, vUv );\ngl_FragColor = opacity * texel;\n}\n\n";module$src$3d$viewport$shaders$ShaderFile.default.gem_frag="#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvarying vec4 initialPosition;\nvarying vec3 initialNormal;\n\nvarying vec3 frag_position;\nvarying vec3 frag_normal;\n\nuniform vec3 center;\nuniform float radius;\nuniform samplerCube sphericalNormalMap;\nuniform mat3 normalMatrix;\nuniform mat4 modelMatrix;\nuniform mat4 inverseModelMatrix;\nuniform mat3 inverseTransposeModelMatrix;\n\nuniform samplerCube impurityMap;\nuniform float impurityScale;\nuniform vec3 colorTransferBegin;\nuniform vec3 colorTransferEnd;\nuniform float refractionIndex;\nuniform float gamma;\nuniform float contrast;\nuniform float brightness;\nuniform float dispersion;\nuniform float tracingOpacity;\n\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradianceTemp( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * geometry.normal.x, geometry.normal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * geometry.normal.x, geometry.normal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevelTemp( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadianceTemp( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\tfloat specularMIPLevel = getSpecularMIPLevelTemp( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent ));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n\nvec3 calculateReflectedLight(vec3 position, vec3 normal, vec3 viewDir, PhysicalMaterial material, int depth) {\n\t\n\tGeometricContext currentGeometry;\n\tcurrentGeometry.position = (modelMatrix * vec4(position, 1.0)).xyz;\n\tcurrentGeometry.normal = normalize(inverseTransposeModelMatrix * normal);\n\tcurrentGeometry.viewDir = normalize(inverseTransposeModelMatrix * -viewDir);\n\n\tReflectedLight rLight;\n\tIncidentLight dLight;\n\n\tfloat temp = material.specularRoughness;\n\tmaterial.specularRoughness = 0.5;\n\n\t#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\t\tPointLight pointLight;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\t\tpointLight = pointLights[ i ];\n\t\t\tgetPointDirectLightIrradiance( pointLight, currentGeometry, dLight );\n\t\t\t#ifdef USE_SHADOWMAP\n\t\t\tdLight.color *= all( bvec2( pointLight.shadow, dLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t\t#endif\n\t\t\tRE_Direct( dLight, currentGeometry, material, rLight );\n\t\t}\n\t#endif\n\t#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\t\tSpotLight spotLight;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\t\tspotLight = spotLights[ i ];\n\t\t\tgetSpotDirectLightIrradiance( spotLight, currentGeometry, dLight );\n\t\t\t#ifdef USE_SHADOWMAP\n\t\t\tdLight.color *= all( bvec2( spotLight.shadow, dLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t\t#endif\n\t\t\tRE_Direct( dLight, currentGeometry, material, rLight );\n\t\t}\n\t#endif\n\t#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\t\tDirectionalLight directionalLight;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\t\tdirectionalLight = directionalLights[ i ];\n\t\t\tgetDirectionalDirectLightIrradiance( directionalLight, currentGeometry, dLight );\n\t\t\t#ifdef USE_SHADOWMAP\n\t\t\tdLight.color *= all( bvec2( directionalLight.shadow, dLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t\t#endif\n\t\t\tRE_Direct( dLight, currentGeometry, material, rLight );\n\t\t}\n\t#endif\n\tmaterial.specularRoughness = temp;\n\t\n\t#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\t\tRectAreaLight rectAreaLight;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\t\trectAreaLight = rectAreaLights[ i ];\n\t\t\tRE_Direct_RectArea( rectAreaLight, currentGeometry, material, rLight );\n\t\t}\n\t#endif\n\n\t#if defined( RE_IndirectDiffuse )\n\t\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t\t#pragma unroll_loop\n\t\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], currentGeometry );\n\t\t\t}\n\t\t#endif\n\t#endif\n\t#if defined( RE_IndirectSpecular )\n\t\tvec3 radiance = vec3( 0.0 );\n\t\tvec3 clearCoatRadiance = vec3( 0.0 );\n\t#endif\n\n\n\t#if defined( RE_IndirectDiffuse )\n\t\t#ifdef USE_LIGHTMAP\n\t\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\t\tlightMapIrradiance *= PI;\n\t\t\t#endif\n\t\t\tirradiance += lightMapIrradiance;\n\t\t#endif\n\t\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tirradiance += getLightProbeIndirectIrradianceTemp( currentGeometry, maxMipLevel );\n\t\t#endif\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t\tradiance += getLightProbeIndirectRadianceTemp( currentGeometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t\t#ifndef STANDARD\n\t\t\tclearCoatRadiance += getLightProbeIndirectRadianceTemp( currentGeometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t\t#endif\n\t#endif\n\n\n\n\t#if defined( RE_IndirectDiffuse )\n\t\tRE_IndirectDiffuse( irradiance, currentGeometry, material, rLight );\n\t#endif\n\t#if defined( RE_IndirectSpecular )\n\t\tRE_IndirectSpecular( radiance, clearCoatRadiance, currentGeometry, material, rLight );\n\t#endif\n\n\tif(depth >= 0) {\n\t\tfloat frac = float(depth) / float(DEPTH);\n\t\trLight.indirectSpecular *= (1.0-frac) * colorTransferBegin + frac * colorTransferEnd;\n\t}\n\n\tvec3 color = rLight.indirectSpecular + rLight.directSpecular + rLight.indirectDiffuse + rLight.directDiffuse;\n\tcolor = pow(color, vec3(1.0/gamma)); // gamma\n\tcolor.rgb = ((color.rgb - 0.5) * max(contrast, 0.0)) + 0.5; // contrast\n\tcolor += vec3(brightness, brightness, brightness); // brightness\n\treturn color;\n}\n\nvec3 normalLookUp(vec3 dir) {\n\tvec4 s = textureCube(sphericalNormalMap, dir);\n\tif(s.a < 1.0/256.0) {\n\t\treturn normalize(vec3(-s.x, -s.y, -s.z));\n\t} else if(s.a < 3.0/256.0) {\n\t\treturn normalize(vec3(-s.x, -s.y, s.z));\n\t} else if(s.a < 5.0/256.0) {\n\t\treturn normalize(vec3(-s.x, s.y, -s.z));\n\t} else if(s.a < 7.0/256.0) {\n\t\treturn normalize(vec3(s.x, -s.y, -s.z));\n\t} else if(s.a < 9.0/256.0) {\n\t\treturn normalize(vec3(-s.x, s.y, s.z));\n\t} else if(s.a < 11.0/256.0) {\n\t\treturn normalize(vec3(s.x, -s.y, s.z));\n\t} else if(s.a < 13.0/256.0) {\n\t\treturn normalize(vec3(s.x, s.y, -s.z));\n\t} else {\n\t\treturn normalize(s.xyz);\n\t}\n}\n\n#ifdef USE_IMPURITY_MAP\n\tfloat impurityLookUp(vec3 dir) {\n\t\tvec3 c = textureCube(impurityMap, dir).rgb;\n\t\treturn (c.x + c.y + c.z) / 3.0;\n\t}\n#endif\n\nvec3 raySphereIntersection(vec3 o, vec3 d) {\n\n\tvec3 oc = o - center;\nfloat a = dot(d, d);\nfloat b = 2.0 * dot(oc, d);\nfloat c = dot(oc,oc) - radius*radius;\nfloat discriminant = b*b - 4.0*a*c;\nif(discriminant < 0.0){\nreturn vec3(0.0);\n}\nelse{\nreturn o +( (-b + sqrt(discriminant)) / (2.0*a)) * d;\n}\n}\n\nvec3 hueToSaturatedColor(float hue) {\nfloat r,g,b;\nif (hue < 0.25){\n\t\tfloat t = 1.0 - (hue / 0.25);\nr = 1.0;\ng = 1.0;\nb = t;\n\t} else if (hue < 0.5){\n\tfloat t = 1.0 - (hue - 0.25 / 0.25);\n\t\tr = 1.0;\ng = t;\nb = 0.0;\n\t} else if (hue < 0.75){\n\tfloat t = 1.0 - (hue - 0.5 / 0.25);\n\t\tr = t;\ng = 0.0;\nb = 1.0 - t;\n} else {\n\tfloat t = hue - 0.75 / 0.25;\nr = t;\ng = t;\nb = 1.0;\n}\nreturn vec3(r, g, b) / 0.5 + 0.5;\n}\n\nvoid main() {\n\tvec3 frag_normal_normalized = frag_normal;\n\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\n\tvec3 initialDirection = normalize( frag_position - (inverseModelMatrix*vec4(cameraPosition,1.0)).xyz );\n\n\n\tvec4 outgoingLight;\n\tfloat r_0 = (1.0-refractionIndex)/(1.0+refractionIndex);\n\tr_0 = r_0*r_0;\n\n\tfloat cos_theta_0 = -dot(initialDirection, frag_normal_normalized);\n\tfloat r_0_outside = (refractionIndex-1.0)/(refractionIndex+1.0);\n\tr_0_outside = r_0_outside*r_0_outside;\n\tfloat initialProbability = r_0_outside + (1.0 - r_0_outside)*pow(1.0 - cos_theta_0, 5.0);\n\n\t\t\t\t\n\toutgoingLight = vec4(calculateReflectedLight(frag_position, frag_normal_normalized, initialDirection, material, -1), 1.0);\n\tif(DEPTH > 0)\n\t\toutgoingLight *= initialProbability;\n\t\t\n\tvec3 tempColor;\n\n\t#ifdef DISPERSION\n\t\tconst int loop = 3;\n\t\tvec3 dispersionColor;\n\t#else\n\t\tconst int loop = 1;\n\t#endif\n\t\tfor(int j = 0; j < loop; j++){\n\t\t\tvec3 refractedDirection = refract(initialDirection, frag_normal_normalized, 1.0/refractionIndex + float(j)*dispersion);\n\t\t\tvec3 newPosition = raySphereIntersection(frag_position, refractedDirection);\n\t\t\tvec3 lookUpVector = normalize(newPosition - center);\n\t\t\tvec3 newNormal = normalLookUp(lookUpVector);\n\t\t\tvec3 newDirection = reflect(refractedDirection, newNormal);\n\n\t\t\tfloat currentProbability = 1.0;\n\n\t\t\t#ifdef USE_IMPURITY_MAP\n\t\t\t\tfloat impurityProbability = impurityLookUp(lookUpVector);\n\t\t\t\tcurrentProbability -= impurityProbability * impurityScale;\n\t\t\t\t//gl_FragColor = vec4(vec3(impurityProbability), 1.0);\n\t\t\t\t//return;\n\t\t\t#endif\n\t\t\t\n\t\t\t// if(0 == DEPTH) {\n\t\t\t// \tgl_FragColor = vec4(0.5 * newNormal + 0.5, 1.0);\n\t\t\t// \treturn;\n\t\t\t// }\n\n\t\t\ttempColor = vec3(0.0);\n\t\t\tfor(int i = 0; i < DEPTH; i++) {\n\t\t\t\t// small position correction to avoid artefacts\n\t\t\t\tnewPosition = newPosition - lookUpVector * 1e-6;\n\t\t\t\tnewPosition = raySphereIntersection(newPosition, newDirection);\n\t\t\t\tlookUpVector = normalize(newPosition - center);\n\t\t\t\tnewNormal = normalLookUp(lookUpVector);\n\t\t\t\n\t\t\t\tfloat cos_theta = dot(newDirection, newNormal);\n\t\t\t\tfloat ratio;\n\t\t\t\tif(cos_theta > 0.0) {\n\t\t\t\t\tratio = refractionIndex;\n\t\t\t\t} else {\n\t\t\t\t\tcos_theta = -cos_theta;\n\t\t\t\t\tratio = 1.0 / refractionIndex;\n\t\t\t\t}\n\t\t\t\tfloat cos_theta_2 = 1.0 - ratio*ratio * (1.0 - cos_theta*cos_theta);\n\t\t\t\tfloat probability = r_0 + (1.0 - r_0)*pow(1.0 - cos_theta, 5.0);\n\t\t\t\tif(cos_theta_2 < 0.0) probability = 0.0;\n\n\t\t\t\tvec3 refracted = refract(newDirection, newNormal*-1.0, 1.0/refractionIndex);\n\t\t\t\ttempColor += probability * currentProbability * calculateReflectedLight(newPosition, newNormal*-1.0, reflect(refracted, newNormal), material, i);\n\t\t\t\tif(i+1 == DEPTH)\n\t\t\t\t\ttempColor += (1.0 - probability) * currentProbability * calculateReflectedLight(newPosition, newNormal, newDirection, material, i);\n\n\t\t\t\tnewDirection = reflect(newDirection, newNormal);\n\n\t\t\t\t// if(i+1 == DEPTH) {\n\t\t\t\t// \tgl_FragColor = vec4(0.5 * newNormal + 0.5, 1.0);\n\t\t\t\t// \treturn;\n\t\t\t\t// }\n\n\t\t\t\tcurrentProbability *= (1.0 - probability);\n\t\t\t}\n\n\t\t\t#ifdef DISPERSION\n\t\t\t\tif(j == 0) {\n\t\t\t\t\tdispersionColor.r = tempColor.r;\t\n\t\t\t\t} else if(j == 1) {\n\t\t\t\t\tdispersionColor.g = tempColor.g;\t\n\t\t\t\t} else if(j == 2) {\n\t\t\t\t\tdispersionColor.b = tempColor.b;\t\n\t\t\t\t}\n\t\t\t\ttempColor = dispersionColor;\n\t\t\t#endif\n\t\t}\t\n\n\tif(DEPTH > 0)\n\t\toutgoingLight.rgb += (1.0 - initialProbability) * tempColor;\n\n\tfloat alpha = (1.0 - initialProbability) + initialProbability*tracingOpacity;\n\tgl_FragColor = vec4(outgoingLight.rgb, alpha*diffuseColor.a);\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n\n";
   module$src$3d$viewport$shaders$ShaderFile.default.gem_vert="#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\nvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvarying vec3 frag_position;\nvarying vec3 frag_normal;\n\nvoid main() {\n#include <uv_vertex>\n#include <uv2_vertex>\n#include <color_vertex>\n#include <beginnormal_vertex>\n#include <morphnormal_vertex>\n#include <skinbase_vertex>\n#include <skinnormal_vertex>\n#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\nvNormal = normalize( transformedNormal );\n#endif\n#include <begin_vertex>\n#include <morphtarget_vertex>\n#include <skinning_vertex>\n#include <displacementmap_vertex>\n#include <project_vertex>\n#include <logdepthbuf_vertex>\n#include <clipping_planes_vertex>\nvViewPosition = - mvPosition.xyz;\nvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#include <shadowmap_vertex>\n#include <fog_vertex>\n\nfrag_position = position;\nfrag_normal = objectNormal;\n}\n\n";
   module$src$3d$viewport$shaders$ShaderFile.default.normal_frag="varying highp vec3 vNormal;\n\nfloat decodeFloat(float f) {\n\tfloat r = mod(f, 1.0/255.0);\n\treturn /*r > 0.5/256.0 ? f + (1.0/256.0) - r : */f - r;\n}\n\nvec3 decodeVec3(vec3 v) {\n\treturn vec3(decodeFloat(v.x), decodeFloat(v.y), decodeFloat(v.z));\n}\n\nfloat signEncoding(vec3 v) {\n\tfloat code = 1.0;\n\t if(v.x < 0.0 && v.y < 0.0 && v.z < 0.0) {\n\t\tcode = 0.0;\n\t} else if (v.x < 0.0 && v.y < 0.0) {\n\t\tcode = 2.0/256.0;\n\t} else if (v.x < 0.0 && v.z < 0.0) {\n\t\tcode = 4.0/256.0;\n\t} else if (v.y < 0.0 && v.z < 0.0) {\n\t\tcode = 6.0/256.0;\n\t} else if (v.x < 0.0) {\n\t\tcode = 8.0/256.0;\n\t} else if (v.y < 0.0) {\n\t\tcode = 10.0/256.0;\n\t} else if (v.z < 0.0) {\n\t\tcode = 12.0/256.0;\n\t}\n\treturn code;\n}\n\nvoid main() {\n\tvec3 n = normalize(vNormal);\n\tgl_FragColor = vec4(decodeVec3(abs(n)), signEncoding(n));\n}\n\n";
   module$src$3d$viewport$shaders$ShaderFile.default.normal_vert="varying vec3 vNormal;\n\nvoid main() {\nvNormal = normal;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n\n";module$src$3d$viewport$shaders$ShaderFile.default.refl_frag="uniform vec3 color;\nuniform sampler2D tDiffuse;\nuniform sampler2D tDepth;\nuniform vec3 worldPosition;\nuniform float far;\nuniform mat4 viewMatrixInv;\nvarying vec4 vUv;\nuniform float threshold;\n\nfloat blendOverlay( float base, float blend ) {\nreturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );\n}\n\nvec3 blendOverlay( vec3 base, vec3 blend ) {\nreturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );\n}\n\nfloat decompress(float a){\nreturn a < .5 ? -a * (far * 2.0) : (a-.5) * (far * 2.0);\n}\n\nvoid main() {\nfloat depth = ((decompress(texture2DProj(tDepth, vUv).a) - worldPosition.z) / far) * (1.0/threshold);\ngl_FragColor = vec4( blendOverlay( texture2DProj( tDiffuse, vUv ).rgb, color ), 1.0 - max(0.0, min(1.0, depth)) );\n}\n\n";
   module$src$3d$viewport$shaders$ShaderFile.default.refl_vert="uniform mat4 textureMatrix;\nvarying vec4 vUv;\n\nvoid main() {\n\tvUv = textureMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n\n";module$src$3d$viewport$shaders$ShaderFile.default.sao_frag="\n#include <common>\n#include <packing>\n\nvarying vec2 vUv;\n\nuniform sampler2D tDepth;\nuniform sampler2D tNormal;\n\nuniform float cameraNear;\nuniform float cameraFar;\nuniform mat4 cameraProjectionMatrix;\nuniform mat4 cameraInverseProjectionMatrix;\n\nuniform vec2 size;\nuniform float intensity;\nuniform float scale;\nuniform float kernelRadius;\n\nvec3 getViewPosition(const in vec2 screenPosition, const in float depth, const in float viewZ) {\n\tfloat clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];\n\tvec4 clipPosition = vec4((vec3(screenPosition, depth) - 0.5) * 2.0, 1.0);\n\tclipPosition *= clipW; // unprojection\n\n\treturn (cameraInverseProjectionMatrix * clipPosition).xyz;\n}\n\nfloat getOcclusion(const in vec3 centerViewPosition, const in vec3 centerViewNormal, const in vec3 sampleViewPosition) {\n\tvec3 viewDelta = sampleViewPosition - centerViewPosition;\n\tfloat viewDistance = length(viewDelta);\n\tfloat scaledScreenDistance = scale * viewDistance;\n\treturn max(0.0, (dot(centerViewNormal, viewDelta))/scaledScreenDistance)/(1.0 + pow2(scaledScreenDistance));\n}\n\nfloat getAmbientOcclusion(const in vec3 centerViewPosition) {\n\tvec3 centerViewNormal = unpackRGBToNormal(texture2D(tNormal, vUv).xyz);\n\n\tfloat angle = rand(vUv) * PI2;\n\tvec2 radius = vec2(kernelRadius * (1.0/float(SAMPLES)))/size;\n\tvec2 radiusStep = radius;\n\tfloat occlusionSum = 0.0;\n\tfloat weightSum = 0.0;\n\tfloat angleStep = PI2 * 3.0/float(SAMPLES);\n\n\tfor(int i = 0; i < SAMPLES; i ++) {\n\t\tvec2 sampleUv = vUv + vec2(cos(angle), sin(angle)) * radius;\n\t\tradius += radiusStep;\n\t\tangle += PI2 * 3.0/float(SAMPLES);\n\n\t\tfloat sampleDepth = unpackRGBAToDepth(texture2D(tDepth, sampleUv));\n\t\tif(sampleDepth >= (1.0 - EPSILON)) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tfloat sampleViewZ = perspectiveDepthToViewZ(sampleDepth, cameraNear, cameraFar);\n\t\tvec3 sampleViewPosition = getViewPosition(sampleUv, sampleDepth, sampleViewZ);\n\t\tocclusionSum += getOcclusion(centerViewPosition, centerViewNormal, sampleViewPosition);\n\t\tweightSum += 1.0;\n\t}\n\n\tif(weightSum == 0.0) discard;\n\n\treturn occlusionSum * (intensity/weightSum);\n}\n\nvoid main() {\n\tfloat centerDepth = unpackRGBAToDepth(texture2D(tDepth, vUv));\n\tif(centerDepth >= (1.0 - EPSILON)) {\n\t\tdiscard;\n\t}\n\tfloat centerViewZ = perspectiveDepthToViewZ(centerDepth, cameraNear, cameraFar);\n\tvec3 viewPosition = getViewPosition(vUv, centerDepth, centerViewZ);\n\tfloat ao = 1.0 - getAmbientOcclusion(viewPosition);\n\tgl_FragColor = vec4(ao, ao, ao, 1);\n}\n\n";
   module$src$3d$viewport$shaders$ShaderFile.default.simple_blur_frag="\nuniform sampler2D tDiffuse;\nuniform sampler2D tAO;\t\t\nuniform vec2 size;\nuniform int orientation;\n\nvarying vec2 vUv;\n\nvoid main() {\n\tvec4 sum = vec4( 0.0 );\n\tvec2 or = vec2(0,0);\n\n\tif(orientation==0){\n\t\tor = vec2(1,0);\n\t}else{\n\t\tor = vec2(0,1);\n\t}\n\tvec2 off = vec2(3.2307692308) * or;\n\tsum += texture2D(tAO, vUv) * 0.29411764705882354;\n\tsum += texture2D(tAO, vUv + (off / size)) * 0.35294117647058826;\n\tsum += texture2D(tAO, vUv - (off / size)) * 0.35294117647058826;\n\t\n\tif(orientation == 1){\n\t\tgl_FragColor =  texture2D( tDiffuse, vUv );\n\t\tgl_FragColor.xyz *= sum.x;\n\t}else{\n\t\tgl_FragColor = sum;\n\t}\n}\n\n";
   module$src$3d$viewport$shaders$ShaderFile.default.standard_frag="#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\nuniform float clearCoat;\nuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\nvarying vec3 vNormal;\n#endif\nvarying vec4 worldPos;\n\nuniform float shadowOpacity;\nuniform float lightReflectivity;\n\nuniform float threeDNoiseScale;\nuniform float threeDNoiseDistanceFade;\nuniform float threeDNoiseOpacity;\nfloat threeDAmbient = 1.0;\n\n#if NUM_ADD_MAPS > 0\nuniform int mapsSize;\nuniform sampler2D additionalMaps0;\n#if NUM_ADD_MAPS > 1\nuniform sampler2D additionalMaps1;\n#endif\n#if NUM_ADD_MAPS > 2\nuniform sampler2D additionalMaps2;\n#endif\n#if NUM_ADD_MAPS > 3\nuniform sampler2D additionalMaps3;\n#endif\n#if NUM_ADD_MAPS > 4\nuniform sampler2D additionalMaps4;\n#endif\nuniform int mapPropertyType[NUM_ADD_MAPS];\nuniform vec3 mapPropertyColor[NUM_ADD_MAPS];\nuniform mat3 uvTransformAddMap[NUM_ADD_MAPS];\nvarying vec2 vUvOriginal;\n#endif\n\n#ifdef USE_RGBMAP\nuniform sampler2D rgbMap;\n#endif\n\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#if defined( USE_MAP )\nvarying vec2 vUvMap;\n#endif\n#if defined( USE_BUMPMAP )\nvarying vec2 vUvBumpMap;\n#endif\n#if defined( USE_NORMALMAP )\nvarying vec2 vUvNormalMap;\n#endif\n#if defined( USE_SPECULARMAP )\nvarying vec2 vUvSpecularMap;\n#endif\n#if defined( USE_ALPHAMAP )\nvarying vec2 vUvAlphaMap;\n#endif\n#if defined( USE_EMISSIVEMAP )\nvarying vec2 vUvEmissiveMap;\n#endif\n#if defined( USE_ROUGHNESSMAP )\nvarying vec2 vUvRoughnessMap;\n#endif\n#if defined( USE_METALNESSMAP )\nvarying vec2 vUvMetalnessMap;\n#endif\n\n\n\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_pars_fragment>\n\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\nvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\nvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n#ifdef ENVMAP_TYPE_CUBE\nvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n#ifdef LOD_BLACK_LIST\nvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n#else\n#ifdef TEXTURE_LOD_EXT\nvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n#else\nvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n#endif\n#endif\nenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\nvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\nvec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );\n#else\nvec4 envMapColor = vec4( 0.0 );\n#endif\nreturn PI * envMapColor.rgb * envMapIntensity;\n}\nfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\nfloat maxMIPLevelScalar = float( maxMIPLevel );\nfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\nreturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n}\nvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n#ifdef ENVMAP_MODE_REFLECTION\nvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n#else\nvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n#endif\nreflectVec = inverseTransformDirection( reflectVec, viewMatrix );\nfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n#ifdef ENVMAP_TYPE_CUBE\nvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n#ifdef LOD_BLACK_LIST\nvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n#else\n#ifdef TEXTURE_LOD_EXT\nvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n#else\nvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n#endif\n#endif\nenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\nvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\nvec4 envMapColor = textureCubeUV( envMap, queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n#elif defined( ENVMAP_TYPE_EQUIREC )\nvec2 sampleUV;\nsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\nsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n#ifdef LOD_BLACK_LIST\nvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n#else\n#ifdef TEXTURE_LOD_EXT\nvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n#else\nvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n#endif\n#endif\n\nenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n#elif defined( ENVMAP_TYPE_SPHERE )\nvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n#ifdef LOD_BLACK_LIST\nvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n#else\n#ifdef TEXTURE_LOD_EXT\nvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n#else\nvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n#endif\n#endif\nenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n#endif\nreturn envMapColor.rgb * envMapIntensity;\n}\n#endif\n\n\n\n#include <fog_pars_fragment>\n#ifdef USE_3D_NOISE\n\tvec3 random3(vec3 c) {\n\t\tfloat j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));\n\t\tvec3 r;\n\t\tr.z = fract(512.0*j);\n\t\tj *= .125;\n\t\tr.x = fract(512.0*j);\n\t\tj *= .125;\n\t\tr.y = fract(512.0*j);\n\t\treturn r-0.5;\n\t}\n\n\tconst float F3 =  0.3333333;\n\tconst float G3 =  0.1666667;\n\tfloat snoise(vec3 p) {\n\t\tvec3 s = floor(p + dot(p, vec3(F3)));\n\t\tvec3 x = p - s + dot(s, vec3(G3));\n\t\t\n\t\tvec3 e = step(vec3(0.0), x - x.yzx);\n\t\tvec3 i1 = e*(1.0 - e.zxy);\n\t\tvec3 i2 = 1.0 - e.zxy*(1.0 - e);\n\t\t\t\n\t\tvec3 x1 = x - i1 + G3;\n\t\tvec3 x2 = x - i2 + 2.0*G3;\n\t\tvec3 x3 = x - 1.0 + 3.0*G3;\n\n\t\tvec4 w = vec4(dot(x, x), dot(x1, x1), dot(x2, x2), dot(x3, x3));\t\t\n\t\tw = max(0.6 - w, 0.0);\n\t\tw = w*w*w;\n\n\t\tvec4 d = vec4(dot(random3(s), x), dot(random3(s + i1), x1), dot(random3(s + i2), x2), dot(random3(s + 1.0), x3)) * w;\n\t\treturn dot(d, vec4(52.0));\n\t}\n#endif\n\n#ifdef USE_3D_NOISE_F999\n\tvec3 noise(vec3 m) { return vec3(0); }\n#endif\n\n#ifdef USE_3D_NOISE_F0\n\tvec3 noise(vec3 m) {\n\t\tvec3 i, n;\n\t\ti = m.xzx + m.y;\n\t\tn.x = snoise(i);\n\t\ti = m.yzy + m.x;\n\t\tn.y = snoise(i);\n\t\ti = m.zxy;\n\t\tn.z = snoise(i);\n\t\treturn normalize(n);\n\t}\n#endif\n\n#ifdef USE_3D_NOISE_F1\n\tvec3 noise(vec3 m) {\n\t\tvec3 i = m;\n\t\tm.x = snoise(i);\n\t\ti = vec3(m.yzx);\n\t\tm.y = snoise(i);\n\t\tm.z = cos(m.z*5.0);\n\t\treturn normalize(m);\n\t}\n#endif\n\n#ifdef USE_3D_NOISE_F2\n\tvec3 noise(vec3 m) {\n\t\tm.x = 0.3333333* cos(m.z);\n\t\tm.y = 0.3333333* sin(m.z)+snoise(vec3(m.z));\n\t\tm.z = 0.3333333* cos(m.z*5.0);\n\t\treturn normalize(m);\n\t}\n#endif\n\n#ifdef USE_3D_NOISE_F3\n\tvec3 noise(vec3 m) {\n\t\tvec3 i = vec3( m.z);\n\t\tm.x = 0.1333333* snoise(4.0*i);\n\t\ti = vec3(m.yzx);\n\t\tm.y = 0.05333333* snoise(4.0*i);\n\t\ti = vec3(m.zxy);\n\t\tm.z = 0.1333333* snoise(4.0*i);\n\t\treturn normalize(m);\n\t}\n#endif\n\n\n\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\nuniform float lightWorldSize;\nuniform float lightFrustum;\n\n#if defined(USE_SHADOWMAP)\n#ifdef USE_PCSS_SHADOW\n#define softShadowSamples 20\n#define near 25.0\nvec2 poissonDisk[softShadowSamples];\n\nvoid initPoissonSamples(const in vec2 randomSeed) {\nfloat angleStep = PI2 * 11.0/float(softShadowSamples);\nfloat angle = rand(randomSeed) * PI2;\nfloat radius = 1.0/float(softShadowSamples);\n\nfor(int i = 0; i < softShadowSamples; i ++) {\npoissonDisk[i] = vec2(cos(angle), sin(angle)) * pow(radius, 0.75);\nradius += 1.0/float(softShadowSamples);\nangle += angleStep;\n}\n}\n\nfloat penumbraSize(const in float zReceiver, const in float zBlocker) {\nreturn (zReceiver - zBlocker)/zBlocker;\n}\n\nfloat findBlocker(sampler2D shadowMap, const in vec2 uv, const in float zReceiver) {\nfloat searchRadius = (lightWorldSize/lightFrustum) * (zReceiver - near)/zReceiver;\nfloat blockerDepthSum = 0.0;\nint numBlockers = 0;\n\nfor(int i = 0; i < softShadowSamples; i++) {\nfloat shadowMapDepth = unpackRGBAToDepth(texture2D(shadowMap, uv + poissonDisk[i] * searchRadius));\nif (shadowMapDepth < zReceiver) {\nblockerDepthSum += shadowMapDepth;\nnumBlockers ++;\n}\n}\n\nif(numBlockers == 0) return -1.0;\nreturn blockerDepthSum/float(numBlockers);\n}\n\nfloat PCF_Filter(sampler2D shadowMap, vec2 uv, float zReceiver, float filterRadius) {\nfloat sum = 0.0;\nfor(int i = 0; i < softShadowSamples; i ++) {\nfloat depth = unpackRGBAToDepth(texture2D(shadowMap, uv + poissonDisk[ i ] * filterRadius));\nif(zReceiver <= depth) sum += 1.0;\n}\nfor(int i = 0; i < softShadowSamples; i ++) {\nfloat depth = unpackRGBAToDepth(texture2D(shadowMap, uv + -poissonDisk[ i ].yx * filterRadius));\nif(zReceiver <= depth) sum += 1.0;\n}\nreturn sum/(2.0 * float(softShadowSamples));\n}\n\nfloat PCSS (sampler2D shadowMap, vec4 coords) {\nvec2 uv = coords.xy;\nfloat zReceiver = coords.z;\n\ninitPoissonSamples(uv);\nfloat avgBlockerDepth = findBlocker(shadowMap, uv, zReceiver);\n\nif(avgBlockerDepth == -1.0) return 1.0;\n\nfloat penumbraRatio = penumbraSize(zReceiver, avgBlockerDepth);\nfloat filterRadius = penumbraRatio * (lightWorldSize/lightFrustum) * near/zReceiver;\n\nreturn PCF_Filter(shadowMap, uv, zReceiver, filterRadius);\n}\n#endif\n\n#if NUM_DIR_LIGHTS > 0\nuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\nvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n#endif\n\n\nfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\nreturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n}\nfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\nconst vec2 offset = vec2( 0.0, 1.0 );\nvec2 texelSize = vec2( 1.0 ) / size;\nvec2 centroidUV = floor( uv * size + 0.5 ) / size;\nfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\nfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\nfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\nfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\nvec2 f = fract( uv * size + 0.5 );\nfloat a = mix( lb, lt, f.y );\nfloat b = mix( rb, rt, f.y );\nfloat c = mix( a, b, f.x );\nreturn c;\n}\nfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\nshadowCoord.xyz /= shadowCoord.w;\nshadowCoord.z += shadowBias;\nbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\nbool inFrustum = all( inFrustumVec );\nbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\nbool frustumTest = all( frustumTestVec );\nif ( frustumTest ) {\n#if defined(USE_PCSS_SHADOW)\nreturn PCSS(shadowMap, shadowCoord);\n#elif defined( SHADOWMAP_TYPE_PCF )\nvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\nfloat dx0 = - texelSize.x * shadowRadius;\nfloat dy0 = - texelSize.y * shadowRadius;\nfloat dx1 = + texelSize.x * shadowRadius;\nfloat dy1 = + texelSize.y * shadowRadius;\nreturn (\ntexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\ntexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\ntexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\ntexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\ntexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\ntexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\ntexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\ntexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\ntexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n) * ( 1.0 / 9.0 );\n#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\nvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\nfloat dx0 = - texelSize.x * shadowRadius;\nfloat dy0 = - texelSize.y * shadowRadius;\nfloat dx1 = + texelSize.x * shadowRadius;\nfloat dy1 = + texelSize.y * shadowRadius;\nreturn (\ntexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\ntexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\ntexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\ntexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\ntexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\ntexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\ntexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\ntexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\ntexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n) * ( 1.0 / 9.0 );\n#else\nreturn texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n#endif\n}\nreturn 1.0;\n}\nvec2 cubeToUV( vec3 v, float texelSizeY ) {\nvec3 absV = abs( v );\nfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\nabsV *= scaleToCube;\nv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\nvec2 planar = v.xy;\nfloat almostATexel = 1.5 * texelSizeY;\nfloat almostOne = 1.0 - almostATexel;\nif ( absV.z >= almostOne ) {\nif ( v.z > 0.0 )\nplanar.x = 4.0 - v.x;\n} else if ( absV.x >= almostOne ) {\nfloat signX = sign( v.x );\nplanar.x = v.z * signX + 2.0 * signX;\n} else if ( absV.y >= almostOne ) {\nfloat signY = sign( v.y );\nplanar.x = v.x + 2.0 * signY + 2.0;\nplanar.y = v.z * signY - 2.0;\n}\nreturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n}\nfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\nvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\nvec3 lightToPosition = shadowCoord.xyz;\nvec3 bd3D = normalize( lightToPosition );\nfloat dp = ( length( lightToPosition ) - shadowBias ) / 1000.0;\n#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\nvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\nreturn (\ntexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\ntexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\ntexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\ntexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\ntexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\ntexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\ntexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\ntexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\ntexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n) * ( 1.0 / 9.0 );\n#else\nreturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n#endif\n}\n#endif\n\n\n#ifdef USE_BUMPMAP\nuniform sampler2D bumpMap;\nuniform float bumpScale;\nvec2 dHdxy_fwd() {\nvec2 dSTdx = dFdx( vUvBumpMap );\nvec2 dSTdy = dFdy( vUvBumpMap );\nfloat Hll = bumpScale * texture2D( bumpMap, vUvBumpMap ).x;\nfloat dBx = bumpScale * texture2D( bumpMap, vUvBumpMap + dSTdx ).x - Hll;\nfloat dBy = bumpScale * texture2D( bumpMap, vUvBumpMap + dSTdy ).x - Hll;\nreturn vec2( dBx, dBy );\n}\nvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\nvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\nvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\nvec3 vN = surf_norm;\nvec3 R1 = cross( vSigmaY, vN );\nvec3 R2 = cross( vN, vSigmaX );\nfloat fDet = dot( vSigmaX, R1 );\nvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\nreturn normalize( abs( fDet ) * surf_norm - vGrad );\n}\n#endif\n\n\n#ifdef USE_NORMALMAP\nuniform sampler2D normalMap;\nuniform vec2 normalScale;\nvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\nvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\nvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\nvec2 st0 = dFdx( vUvNormalMap.st );\nvec2 st1 = dFdy( vUvNormalMap.st );\nvec3 S = normalize( q0 * st1.t - q1 * st0.t );\nvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\nvec3 N = normalize( surf_norm );\nvec3 mapN = texture2D( normalMap, vUvNormalMap ).xyz * 2.0 - 1.0;\nmapN.xy = normalScale * mapN.xy;\nmat3 tsn = mat3( S, T, N );\nreturn normalize( tsn * mapN );\n}\n#endif\n\n\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n#ifdef USE_COLOR\ndiffuseColor.rgb = vColor;\n#endif\n\n\n\n#if NUM_ADD_MAPS > 0\nvec4 texelColorAdd = texture2D( additionalMaps0, (uvTransformAddMap[0] * vec3(vUvOriginal, 1.0)).xy);\ntexelColorAdd = mapTexelToLinear( texelColorAdd );\n\nif(mapPropertyType[0] == 0){\ndiffuseColor = texelColorAdd.a * vec4(texelColorAdd.rgb, 1.0) + (1.0 - texelColorAdd.a) * diffuseColor;\n}else if(mapPropertyType[0] == 1){\ndiffuseColor = texelColorAdd.a * vec4(mapPropertyColor[0], 1.0) + (1.0 - texelColorAdd.a) * diffuseColor;\n}\n#endif\n#if NUM_ADD_MAPS > 1\n\ntexelColorAdd = texture2D( additionalMaps1, (uvTransformAddMap[1] * vec3(vUvOriginal, 1.0)).xy);\ntexelColorAdd = mapTexelToLinear( texelColorAdd );\n\nif(mapPropertyType[1] == 0){\ndiffuseColor = texelColorAdd.a * vec4(texelColorAdd.rgb, 1.0) + (1.0 - texelColorAdd.a) * diffuseColor;\n}else if(mapPropertyType[1] == 1){\ndiffuseColor = texelColorAdd.a * vec4(mapPropertyColor[1], 1.0) + (1.0 - texelColorAdd.a) * diffuseColor;\n}\n\n#endif\n#if NUM_ADD_MAPS > 2\n\ntexelColorAdd = texture2D( additionalMaps2, (uvTransformAddMap[2] * vec3(vUvOriginal, 1.0)).xy);\ntexelColorAdd = mapTexelToLinear( texelColorAdd );\n\nif(mapPropertyType[2] == 0){\ndiffuseColor = texelColorAdd.a * vec4(texelColorAdd.rgb, 1.0) + (1.0 - texelColorAdd.a) * diffuseColor;\n}else if(mapPropertyType[2] == 1){\ndiffuseColor = texelColorAdd.a * vec4(mapPropertyColor[2], 1.0) + (1.0 - texelColorAdd.a) * diffuseColor;\n}\n\n#endif\n#if NUM_ADD_MAPS > 3\n\ntexelColorAdd = texture2D( additionalMaps3, (uvTransformAddMap[3] * vec3(vUvOriginal, 1.0)).xy);\ntexelColorAdd = mapTexelToLinear( texelColorAdd );\n\nif(mapPropertyType[3] == 0){\ndiffuseColor = texelColorAdd.a * vec4(texelColorAdd.rgb, 1.0) + (1.0 - texelColorAdd.a) * diffuseColor;\n}else if(mapPropertyType[3] == 1){\ndiffuseColor = texelColorAdd.a * vec4(mapPropertyColor[3], 1.0) + (1.0 - texelColorAdd.a) * diffuseColor;\n}\n\n#endif\n#if NUM_ADD_MAPS > 4\n\ntexelColorAdd = texture2D( additionalMaps4, (uvTransformAddMap[4] * vec3(vUvOriginal, 1.0)).xy);\ntexelColorAdd = mapTexelToLinear( texelColorAdd );\n\nif(mapPropertyType[4] == 0){\ndiffuseColor = texelColorAdd.a * vec4(texelColorAdd.rgb, 1.0) + (1.0 - texelColorAdd.a) * diffuseColor;\n}else if(mapPropertyType[4] == 1){\ndiffuseColor = texelColorAdd.a * vec4(mapPropertyColor[4], 1.0) + (1.0 - texelColorAdd.a) * diffuseColor;\n}\n\n#endif\n\n#ifdef USE_MAP\nvec4 texelColor = texture2D( map, vUvMap );\ntexelColor = mapTexelToLinear( texelColor );\n\ndiffuseColor *= texelColor;\n#endif\n\n\n#ifdef USE_ALPHAMAP\ndiffuseColor.a *= texture2D( alphaMap, vUvAlphaMap ).g;\n#endif\n\n\n\t#include <alphatest_fragment>\nfloat roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n#ifdef USE_RGBMAP\nvec4 texelRoughness = texture2D( rgbMap, vUvRoughnessMap );\n#else\nvec4 texelRoughness = texture2D( roughnessMap, vUvRoughnessMap );\n#endif\nroughnessFactor *= texelRoughness.g;\n#endif\n\n\nfloat metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n#ifdef USE_RGBMAP\nvec4 texelMetalness = texture2D( rgbMap, vUvMetalnessMap );\n#else\nvec4 texelMetalness = texture2D( metalnessMap, vUvMetalnessMap );\n#endif\nmetalnessFactor *= texelMetalness.b;\n#endif\n\n\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n#ifdef USE_3D_NOISE\nvec3 threeDNoise = noise(worldPos.xyz / threeDNoiseScale);\nfloat op = threeDNoiseOpacity * (1.0 / (1.0 + vViewPosition.z * threeDNoiseDistanceFade));\nfloat dotP = dot(normal, threeDNoise);\nif(dotP < 0.0) threeDNoise *= -1.0;\n\ndotP = abs(dotP);\n\nnormal = (1.0 - op) * normal + op * threeDNoise;\nroughnessFactor += ((1.0 - roughnessFactor) * (1.0 - dotP)) * op;\nmetalnessFactor *= (1.0 - dotP * op);\n\nthreeDAmbient = min(1.0, (1.0 - op) + dotP * op);\ndiffuseColor.rgb *= min(1.0, (1.0 - op) + dotP * op);\n#endif\n\n\n\t#include <lights_physical_fragment>\n\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\nfloat invShadowAmount;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t// #ifdef USE_SHADOWMAP\n\t        // directLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t// #endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t//#ifdef USE_SHADOWMAP\n\t\t//#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\ninvShadowAmount = all(bvec2(directionalLight.shadow, directLight.visible)) ? getShadow(directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ]) : 1.0;\ndirectLight.color *= min((invShadowAmount + (1.0 - shadowOpacity)), 1.0);\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearCoatRadiance = vec3( 0.0 );\n#endif\n\n\n\n#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t#ifndef STANDARD\n\t\tclearCoatRadiance += getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t#endif\n#else\nvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\nreflectVec = inverseTransformDirection( reflectVec, viewMatrix );\nradiance += (vec3((reflectVec.z + 1.0) / 2.0) + 0.5) / 1.5;\n#endif\n\n\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\n\t#ifdef USE_3D_NOISE\n\t\treflectedLight.indirectDiffuse *= threeDAmbient;\n#endif\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular * lightReflectivity + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n\n\n";
   module$src$3d$viewport$shaders$ShaderFile.default.standard_vert="#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nvarying vec4 worldPos;\n#include <common>\n#if defined( USE_MAP )\nvarying vec2 vUvMap;\nuniform mat3 uvTransformMap;\n#endif\n#if defined( USE_BUMPMAP )\nvarying vec2 vUvBumpMap;\nuniform mat3 uvTransformBumpMap;\n#endif\n#if defined( USE_NORMALMAP )\nvarying vec2 vUvNormalMap;\nuniform mat3 uvTransformNormalMap;\n#endif\n#if defined( USE_SPECULARMAP )\nvarying vec2 vUvSpecularMap;\nuniform mat3 uvTransformSpecularMap;\n#endif\n#if defined( USE_ALPHAMAP )\nvarying vec2 vUvAlphaMap;\nuniform mat3 uvTransformAlphaMap;\n#endif\n#if defined( USE_EMISSIVEMAP )\nvarying vec2 vUvEmissiveMap;\nuniform mat3 uvTransformEmissiveMap;\n#endif\n#if defined( USE_ROUGHNESSMAP )\nvarying vec2 vUvRoughnessMap;\nuniform mat3 uvTransformRoughnessMap;\n#endif\n#if defined( USE_METALNESSMAP )\nvarying vec2 vUvMetalnessMap;\nuniform mat3 uvTransformMetalnessMap;\n#endif\n\n#if NUM_ADD_MAPS > 0\nvarying vec2 vUvOriginal;\nuniform int mapsSize;\n#endif\n\n\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t// #if NUM_SPOT_LIGHTS > 0\n\t// \tuniform mat4 spotShadowMatrix[ 0 ];\n\t// \tvarying vec4 vSpotShadowCoord[ 0 ];\n\t// #endif\n\t// #if NUM_POINT_LIGHTS > 0\n\t// \tuniform mat4 pointShadowMatrix[ 0 ];\n\t// \tvarying vec4 vPointShadowCoord[ 0 ];\n\t// #endif\n#endif\n\n\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n#if defined( USE_MAP )\n\tvUvMap = (uvTransformMap * vec3(uv, 1)).xy;\n#endif\n#if defined( USE_BUMPMAP )\nvUvBumpMap = (uvTransformBumpMap * vec3(uv, 1)).xy;\n#endif\n#if defined( USE_NORMALMAP )\nvUvNormalMap = (uvTransformNormalMap * vec3(uv, 1)).xy;\n#endif\n#if defined( USE_SPECULARMAP )\n\tvUvSpecularMap = (uvTransformSpecularMap * vec3(uv, 1)).xy;\n#endif\n#if defined( USE_ALPHAMAP )\n\tvUvAlphaMap = (uvTransformAlphaMap * vec3(uv, 1)).xy;\n#endif\n#if defined( USE_EMISSIVEMAP )\n\tvUvEmissiveMap = (uvTransformEmissiveMap * vec3(uv, 1)).xy;\n#endif\n#if defined( USE_ROUGHNESSMAP )\n\tvUvRoughnessMap = (uvTransformRoughnessMap * vec3(uv, 1)).xy;\n#endif\n#if defined( USE_METALNESSMAP )\n\tvUvMetalnessMap = (uvTransformMetalnessMap * vec3(uv, 1)).xy;\n#endif\n\n#if NUM_ADD_MAPS > 0\n\tvUvOriginal = uv;\n#endif\n\n\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t// #if NUM_SPOT_LIGHTS > 0\n\t// #pragma unroll_loop\n\t// for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t// \tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t// }\n\t// #endif\n\t// #if NUM_POINT_LIGHTS > 0\n\t// #pragma unroll_loop\n\t// for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t// \tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t// }\n\t// #endif\n#endif\n\n\n\tworldPos = worldPosition;\n}\n\n";
   module$src$3d$viewport$shaders$ShaderFile.default.world_z_frag="varying vec4 position_VS;\nuniform float far;\n\nfloat compress(float a){\nreturn a < 0.0 ? -a / (2.0 * far) : a / (2.0 * far) + .5;\n}\n\nvoid main() {\n\tgl_FragColor = vec4(1,1,1, compress(position_VS.z));\n}\n\n";module$src$3d$viewport$shaders$ShaderFile.default.world_z_vert="varying vec4 position_VS;\n\nvoid main() {\nposition_VS = modelMatrix * vec4( position, 1.0 );\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n\n";var module$src$3d$viewport$materials$Reflector={},THREE$$module$src$3d$viewport$materials$Reflector=module$src$externals$three.default,Shaders$$module$src$3d$viewport$materials$Reflector=module$src$3d$viewport$shaders$ShaderFile.default;module$src$externals$three.default=module$src$externals$three.default;
   module$src$externals$three.default.Reflector=function(b,a){module$src$externals$three.default.Mesh.call(this,b);this.type="Reflector";var c=this;a=a||{};b=void 0!==a.color?new module$src$externals$three.default.Color(a.color):new module$src$externals$three.default.Color(8355711);var d=a.textureWidth||512,e=a.textureHeight||512,g=a.clipBias||0,h=void 0!==a.recursion?a.recursion:0,f=new module$src$externals$three.default.Plane,k=new module$src$externals$three.default.Vector3,l=new module$src$externals$three.default.Vector3,
   m=new module$src$externals$three.default.Vector3,n=new module$src$externals$three.default.Matrix4,q=new module$src$externals$three.default.Vector3(0,0,-1),p=new module$src$externals$three.default.Vector4,u=new module$src$externals$three.default.Vector4,t=new module$src$externals$three.default.Vector3,r=new module$src$externals$three.default.Vector3,v=new module$src$externals$three.default.Vector4,w=new module$src$externals$three.default.Matrix4,y=new module$src$externals$three.default.PerspectiveCamera,
   x=new module$src$externals$three.default.WebGLRenderTarget(d,e,{minFilter:module$src$externals$three.default.LinearFilter,magFilter:module$src$externals$three.default.LinearFilter,format:module$src$externals$three.default.RGBFormat,stencilBuffer:!1});module$src$externals$three.default.Math.isPowerOfTwo(d)&&module$src$externals$three.default.Math.isPowerOfTwo(e)||(x.texture.generateMipmaps=!1);a={uniforms:{color:{type:"c",value:null},tDiffuse:{type:"t",value:null},tDepth:{type:"t",value:null},textureMatrix:{type:"m4",
   value:null},worldPosition:{type:"v3",value:new module$src$externals$three.default.Vector3(0,0,0)},far:{type:"f",value:1},threshold:{type:"f",value:100}},fragmentShader:module$src$3d$viewport$shaders$ShaderFile.default.refl_frag,vertexShader:module$src$3d$viewport$shaders$ShaderFile.default.refl_vert};var A=new module$src$externals$three.default.ShaderMaterial(a),z=new module$src$externals$three.default.ShaderMaterial({uniforms:{far:{type:"f",value:1}},vertexShader:module$src$3d$viewport$shaders$ShaderFile.default.world_z_vert,
   fragmentShader:module$src$3d$viewport$shaders$ShaderFile.default.world_z_frag}),B=new module$src$externals$three.default.WebGLRenderTarget(d,e,{minFilter:module$src$externals$three.default.NearestFilter,magFilter:module$src$externals$three.default.NearestFilter,format:module$src$externals$three.default.RGBAFormat,type:module$src$externals$three.default.FloatType});A.uniforms.tDiffuse.value=x.texture;A.uniforms.tDepth.value=B.texture;A.uniforms.color.value=b;A.uniforms.textureMatrix.value=w;A.uniforms.worldPosition.value=
   l;A.uniforms.threshold.value=c.threshold=.01;this.material=A;this.material.transparent=!0;this.onBeforeRender=function(a,b,d){if("recursion"in d.userData){if(d.userData.recursion===h)return;d.userData.recursion++}A.uniforms.threshold.value=c.threshold;z.uniforms.far.value=d.far;A.uniforms.far.value=d.far;l.setFromMatrixPosition(c.matrixWorld);m.setFromMatrixPosition(d.matrixWorld);n.extractRotation(c.matrixWorld);k.set(0,0,1);k.applyMatrix4(n);t.subVectors(l,m);if(!(0<t.dot(k))){t.reflect(k).negate();
   t.add(l);n.extractRotation(d.matrixWorld);q.set(0,0,-1);q.applyMatrix4(n);q.add(m);r.subVectors(l,q);r.reflect(k).negate();r.add(l);y.position.copy(t);y.up.set(0,1,0);y.up.applyMatrix4(n);y.up.reflect(k);y.lookAt(r);y.far=d.far;y.updateMatrixWorld();y.projectionMatrix.copy(d.projectionMatrix);y.userData.recursion=0;w.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);w.multiply(y.projectionMatrix);w.multiply(y.matrixWorldInverse);w.multiply(c.matrixWorld);f.setFromNormalAndCoplanarPoint(k,l);f.applyMatrix4(y.matrixWorldInverse);
   p.set(f.normal.x,f.normal.y,f.normal.z,f.constant);var e=y.projectionMatrix;v.x=(Math.sign(p.x)+e.elements[8])/e.elements[0];v.y=(Math.sign(p.y)+e.elements[9])/e.elements[5];v.z=-1;v.w=(1+e.elements[10])/e.elements[14];p.multiplyScalar(2/p.dot(v));e.elements[2]=p.x;e.elements[6]=p.y;e.elements[10]=p.z+1-g;e.elements[14]=p.w;c.visible=!1;e=b.background;b.background=null;var J=a.getRenderTarget(),E=a.vr.enabled,F=a.shadowMap.autoUpdate,K=a.getClearColor().getHex(),L=a.getClearAlpha();a.vr.enabled=!1;
   a.shadowMap.autoUpdate=!1;a.render(b,y,x,!0);a.setClearColor(16777215,1);b.overrideMaterial=z;a.render(b,y,B,!0);a.vr.enabled=E;a.shadowMap.autoUpdate=F;a.setClearColor(K,L);b.overrideMaterial=null;a.setRenderTarget(J);b.background=e;b=d.bounds;void 0!==b&&(d=a.getSize(),e=a.getPixelRatio(),u.x=b.x*d.width*e,u.y=b.y*d.height*e,u.z=b.z*d.width*e,u.w=b.w*d.height*e,a.state.viewport(u));c.visible=!0}};this.getRenderTarget=function(){return x}};module$src$externals$three.default.Reflector.prototype=Object.create(module$src$externals$three.default.Mesh.prototype);
   module$src$externals$three.default.Reflector.prototype.constructor=module$src$externals$three.default.Reflector;var module$src$3d$viewport$helpers$ThreeDManagerHelpers={default:function(b,a){var c=b.pathUtils,d=b.scene,e=b.geometryNode,g,h=new module$src$externals$three.default.Object3D,f=new module$src$externals$three.default.Object3D,k=[],l=[],m=[],n=[],q=[],p=!1,u=!0,t=!0,r=window.devicePixelRatio;b=function(){g=this;h.visible=!1;d.add(h);f.visible=!1;d.add(f)};b.prototype._createTransformationObject=function(a,b){b.pivot=b.pivot?new module$src$externals$three.default.Vector3(b.pivot.x,b.pivot.y,b.pivot.z):
   null;if("rotation"===b.type){var d={degree:0},g=(new module$src$externals$three.default.Vector3(b.rotationAxis.x,b.rotationAxis.y,b.rotationAxis.z)).normalize();var f=(new module$node_modules$$tweenjs$tween_js$src$Tween.default.Tween(d,a)).to({degree:b.rotationDegree*Math.PI/180},b.duration);if(b.parent&&b.pivot)f.onUpdate(function(){var a=new module$src$externals$three.default.Matrix4,h=new module$src$externals$three.default.Matrix4,l=new module$src$externals$three.default.Matrix4,m=c.getPathObject(e,
   b.parent);m&&(m.updateMatrix(!0),m.updateMatrixWorld(!0),h=m.matrixWorld);l.makeTranslation(b.pivot.x,b.pivot.y,b.pivot.z);a.multiply(l);a.multiply((new module$src$externals$three.default.Matrix4).makeRotationAxis(g,d.degree));a.multiply((new module$src$externals$three.default.Matrix4).getInverse(l));f.transformationMatrix=h.multiply(a)});else if(b.parent)f.onUpdate(function(){var a=new module$src$externals$three.default.Matrix4,h=new module$src$externals$three.default.Matrix4,l=c.getPathObject(e,
   b.parent);l&&(l.updateMatrix(!0),l.updateMatrixWorld(!0),h=l.matrixWorld);a.multiply((new module$src$externals$three.default.Matrix4).makeRotationAxis(g,d.degree));f.transformationMatrix=h.multiply(a)});else if(b.pivot)f.onUpdate(function(){var a=new module$src$externals$three.default.Matrix4,c=new module$src$externals$three.default.Matrix4;c.makeTranslation(b.pivot.x,b.pivot.y,b.pivot.z);a.multiply(c);a.multiply((new module$src$externals$three.default.Matrix4).makeRotationAxis(g,d.degree));a.multiply((new module$src$externals$three.default.Matrix4).getInverse(c));
   f.transformationMatrix=a});else f.onUpdate(function(){var a=new module$src$externals$three.default.Matrix4;a.multiply((new module$src$externals$three.default.Matrix4).makeRotationAxis(g,d.degree));f.transformationMatrix=a})}else if("translation"===b.type){var h={x:0,y:0,z:0};f=(new module$node_modules$$tweenjs$tween_js$src$Tween.default.Tween(h,a)).to({x:b.translationVector.x,y:b.translationVector.y,z:b.translationVector.z},b.duration);if(b.parent)f.onUpdate(function(){var a=new module$src$externals$three.default.Matrix4,
   d=new module$src$externals$three.default.Matrix4,g=c.getPathObject(e,b.parent);g&&(g.updateMatrix(!0),g.updateMatrixWorld(!0),d=g.matrixWorld);a.makeTranslation(h.x,h.y,h.z);f.transformationMatrix=d.multiply(a)});else f.onUpdate(function(){var a=new module$src$externals$three.default.Matrix4;a.makeTranslation(h.x,h.y,h.z);f.transformationMatrix=a})}else if("scaling"===b.type){var l={x:1,y:1,z:1};f=(new module$node_modules$$tweenjs$tween_js$src$Tween.default.Tween(l,a)).to({x:b.scalingVector.x,y:b.scalingVector.y,
   z:b.scalingVector.z},b.duration);if(b.parent&&b.pivot)f.onUpdate(function(){var a=new module$src$externals$three.default.Matrix4,d=new module$src$externals$three.default.Matrix4,g=new module$src$externals$three.default.Matrix4,h=c.getPathObject(e,b.parent);h&&(h.updateMatrix(!0),h.updateMatrixWorld(!0),d=h.matrixWorld);g.makeTranslation(b.pivot.x,b.pivot.y,b.pivot.z);a.multiply(g);a.multiply((new module$src$externals$three.default.Matrix4).makeScale(l.x,l.y,l.z));a.multiply((new module$src$externals$three.default.Matrix4).getInverse(g));
   f.transformationMatrix=d.multiply(a)});else if(b.parent)f.onUpdate(function(){var a=new module$src$externals$three.default.Matrix4,d=new module$src$externals$three.default.Matrix4,g=c.getPathObject(e,b.parent);g&&(g.updateMatrix(!0),g.updateMatrixWorld(!0),d=g.matrixWorld);a.multiply((new module$src$externals$three.default.Matrix4).makeScale(l.x,l.y,l.z));f.transformationMatrix=d.multiply(a)});else if(b.pivot)f.onUpdate(function(){var a=new module$src$externals$three.default.Matrix4,c=new module$src$externals$three.default.Matrix4;
   c.makeTranslation(b.pivot.x,b.pivot.y,b.pivot.z);a.multiply(c);a.multiply((new module$src$externals$three.default.Matrix4).makeScale(l.x,l.y,l.z));a.multiply((new module$src$externals$three.default.Matrix4).getInverse(c));f.transformationMatrix=a});else f.onUpdate(function(){var a=new module$src$externals$three.default.Matrix4;a.multiply((new module$src$externals$three.default.Matrix4).makeScale(l.x,l.y,l.z));f.transformationMatrix=a})}f.transformationMatrix=new module$src$externals$three.default.Matrix4;
   f.hasParent=!1;b.parent&&(f.hasParent=!0);f.gloablDuration=b.delay+b.duration;b.repeat&&(f.gloablDuration+=f.gloablDuration*b.repeat);b.repeat&&f.repeat(b.repeat);b.repeat&&b.yoyo&&f.yoyo(!0);f.onComplete(function(){f.stop()});f.delay(b.delay);f.easing(b.easing);return f};b.prototype.dispatchEvent=function(b){for(var c=new CustomEvent(b.type),d=$jscomp.makeIterator(b),e=d.next();!e.done;e=d.next())e=e.value,c[e]=b[e];a.renderingHandler.getDomElement().dispatchEvent(c);return c};b.prototype.initialize=
   function(){p=!0};b.prototype.isInitialized=function(){return p};b.prototype.addMesh=function(a,b,c){l.push(a);m.push(b);k.push({mesh:a,material:b,properties:c})};b.prototype.removeMesh=function(a){for(var b={},c=0,d=k.length;c<d;b={mat:b.mat},c++)if(a===k[c].mesh){b.mat=m[c];l.splice(c,1);m.splice(c,1);k.splice(c,1);b.mat&&("alphaMap aoMap bumpMap displacementMap emissiveMap lightMap map metalnessMap normalMap roughnessMap rgbMap additionalMaps0 additionalMaps1 additionalMaps2 additionalMaps3 additionalMaps4 reflectionNormalMap dispersionMap reflectionMap".split(" ").forEach(function(a){return function(b){a.mat[b]&&
   a.mat[b].dispose&&a.mat[b].dispose()}}(b)),b.mat.dispose());break}};b.prototype.addAnchor=function(b,f){var h={object:b,properties:Object.assign({lastPos:new module$src$externals$three.default.Vector2},f)};if(f.intersectionTarget&&(module$src$shared$util$GlobalUtils.default.typeCheck(f.intersectionTarget,"string")||module$src$shared$util$GlobalUtils.default.isArrayOfType(f.intersectionTarget,"string"))){var l=[];if(Array.isArray(f.intersectionTarget))for(var m=0;m<f.intersectionTarget.length;m++){var k=
   c.getPathObject(e,f.intersectionTarget[m]);k&&l.push(k)}else(m=c.getPathObject(e,f.intersectionTarget))&&l.push(m);h.properties.intersectionTarget=l}n.push(h);l={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_ANCHOR_ADD,viewportRuntimeId:a.threeDManager.runtimeId,anchors:[]};m=a.renderingHandler.getSize().width;k=a.renderingHandler.getSize().height;var u=a.cameraHandler.camera,t=a.renderingHandler.getCanvas().getBoundingClientRect(),q=!1,E=new module$src$externals$three.default.Vector3,
   p=new module$src$externals$three.default.Vector3,v=new module$src$externals$three.default.Raycaster;b.updateMatrixWorld(!0);E.setFromMatrixPosition(b.matrixWorld);p.set(E.x,E.y,E.z);p.project(u);p.x=m/2*p.x+m/2;p.y=-(k/2*p.y)+k/2;p.x=0>p.x?Math.ceil(p.x):Math.floor(p.x);p.y=0>p.y?Math.ceil(p.y):Math.floor(p.y);if(1>=p.x||p.x>=m-1||1>=p.y||p.y>=k-1)q=!0;p.xPixel=p.x/r;p.yPixel=p.y/r;v.ray.direction.copy(E);v.ray.origin.set(0,0,0);u.localToWorld(v.ray.origin);v.ray.direction.sub(v.ray.origin);var w=
   v.ray.direction.length();v.ray.direction.normalize();var I=Number.MAX_VALUE;d.traverseVisible(function(a){a instanceof module$src$externals$three.default.Mesh&&(a=v.intersectObject(a),a.length&&a[0].distance<I&&(I=a[0].distance))});u.getWorldDirection(E);u=v.ray.direction.dot(E);l.anchors.push(Object.assign({location:{x:b.position.x,y:b.position.y,z:b.position.z},containerX:p.xPixel,containerY:p.yPixel,containerWidth:m/r,containerHeight:k/r,clientX:p.xPixel+t.left,clientY:p.yPixel+t.top,pageX:p.xPixel+
   t.left+window.pageXOffset,pageY:p.yPixel+t.top+window.pageYOffset,viewport:a.threeDManager.runtimeId,hidden:I<w,overflow:q,distance:w,viewingAngle:u,scenePath:f.path,format:f.format,data:f.data},{updateFunction:function(a){return h.properties.update=a}}));b=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_ANCHORDATA,l);a.threeDManager.message(l.type,b);g.dispatchEvent(l)};b.prototype.removeAnchor=function(b){var c,
   e={},f=0;for(c=n.length;f<c;e={raycaster:e.raycaster,closestIntersectionDistance:e.closestIntersectionDistance},f++)if(b===n[f].object){c=n[f];var h=c.properties;c={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_ANCHOR_REMOVE,viewportRuntimeId:a.threeDManager.runtimeId,anchors:[]};var l=a.renderingHandler.getSize().width,m=a.renderingHandler.getSize().height,k=a.cameraHandler.camera,u=a.renderingHandler.getCanvas().getBoundingClientRect(),t=!1,q=new module$src$externals$three.default.Vector3,
   p=new module$src$externals$three.default.Vector3;e.raycaster=new module$src$externals$three.default.Raycaster;b.updateMatrixWorld(!0);q.setFromMatrixPosition(b.matrixWorld);p.set(q.x,q.y,q.z);p.project(k);p.x=l/2*p.x+l/2;p.y=-(m/2*p.y)+m/2;p.x=0>p.x?Math.ceil(p.x):Math.floor(p.x);p.y=0>p.y?Math.ceil(p.y):Math.floor(p.y);if(1>=p.x||p.x>=l-1||1>=p.y||p.y>=m-1)t=!0;p.xPixel=p.x/r;p.yPixel=p.y/r;e.raycaster.ray.direction.copy(q);e.raycaster.ray.origin.set(0,0,0);k.localToWorld(e.raycaster.ray.origin);
   e.raycaster.ray.direction.sub(e.raycaster.ray.origin);var v=e.raycaster.ray.direction.length();e.raycaster.ray.direction.normalize();e.closestIntersectionDistance=Number.MAX_VALUE;d.traverseVisible(function(a){return function(b){b instanceof module$src$externals$three.default.Mesh&&(b=a.raycaster.intersectObject(b),b.length&&b[0].distance<a.closestIntersectionDistance&&(a.closestIntersectionDistance=b[0].distance))}}(e));k.getWorldDirection(q);k=e.raycaster.ray.direction.dot(q);c.anchors.push({location:{x:b.position.x,
   y:b.position.y,z:b.position.z},containerX:p.xPixel,containerY:p.yPixel,containerWidth:l/r,containerHeight:m/r,clientX:p.xPixel+u.left,clientY:p.yPixel+u.top,pageX:p.xPixel+u.left+window.pageXOffset,pageY:p.yPixel+u.top+window.pageYOffset,viewport:a.threeDManager.runtimeId,hidden:e.closestIntersectionDistance<v,overflow:t,distance:v,viewingAngle:k,scenePath:h.path,format:h.format,data:h.data});b=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_ANCHORDATA,
   c);a.threeDManager.message(c.type,b);g.dispatchEvent(c);n.splice(f,1);break}};b.prototype.getMeshes=function(){return l};b.prototype.getMaterials=function(){return m};b.prototype.getMeshMaterialObjects=function(){return k};b.prototype.getAnchors=function(){return n};b.prototype.toggleMeshes=function(a){for(var b=0,c=k.length;b<c;b++)a&&(k[b].mesh.material=k[b].material)};b.prototype.togglePointSize=function(b){e.traverse(function(c){c.hasOwnProperty("material")&&c instanceof module$src$externals$three.default.Points&&
   (c.material.size=b?a.threeDManager.getSetting("render.pointSize"):1)})};b.prototype.toggleGeometry=function(b,c){for(var d=0;d<b.length;d++)if(module$src$shared$util$GlobalUtils.default.typeCheck(b[d],"string")){var e=q.indexOf(b[d]);-1<e&&q.splice(e,1)}for(b=0;b<c.length;b++)module$src$shared$util$GlobalUtils.default.typeCheck(c[b],"string")&&(q.includes(c[b])||q.push(c[b]));a.renderingHandler.updateShadowMap()};b.prototype.toggleHiddenGeometry=function(a){for(var b=0;b<q.length;b++){var d=c.getPathObject(e,
   q[b]);d&&(d.visible=!a,d.hiddenObject=a)}};b.prototype.addSceneObject=function(a){h.add(a)};b.prototype.removeSceneObject=function(a){h.remove(a)};b.prototype.setLiveTransformation=function(b,d,f,h,l){var m={};m.reset=h;m.duration=l;h=[];l=0;for(var k=d.length;l<k;l++){var n=c.getPathObject(e,d[l]);n&&h.push(n)}m.sceneObjects=h;m.sceneObjectPaths=d;var u=[];m.maxDuration=0;m.hasParent=!1;d=0;for(h=f.length;d<h;d++)l=g._createTransformationObject(b,f[d]),m.maxDuration=Math.max(m.maxDuration,l.gloablDuration),
   m.hasParent=m.hasParent||l.hasParent,u.push(l);m.maxDuration===m.duration&&(m.duration=Infinity);m.tweens=u;m.start=function(){for(var a=0,b=u.length;a<b;a++)u[a].start()};m.prev=new module$src$externals$three.default.Matrix4;m.promise=new Promise(function(b,c){m.stopTransformation=function(){a.renderingHandler.unregisterForContinuousRendering("liveTransformationEvent");!1===a.renderingHandler.containsContinuousRendering("liveTransformationEvent")&&(a.renderingHandler.stopUpdatingShadowMap(),a.renderingHandler.updateShadowMap());
   m.stopped=!0;b(!0)}});m.stopCalled=!1;m.stopAndReset=!1;m.stop=function(a){m.stopCalled=!0;m.stopAndReset=a};a.renderingHandler.keepUpdatingShadowMap();a.renderingHandler.registerForContinuousRendering("liveTransformationEvent");a.threeDManager.transformationGroups.push(m);return m};b.prototype.toggleSceneObjects=function(a){u=a;a||(h.visible=a)};b.prototype.addViewportObject=function(a){f.add(a)};b.prototype.removeViewportObject=function(a){f.remove(a)};b.prototype.toggleViewportObjects=function(a){t=
   a;a||(f.visible=a)};b.prototype.toggleSceneBackground=function(b){a.materialHandler.getSceneBackground&&(d.background=b?a.materialHandler.getSceneBackground():null)};b.prototype.toggleViewportMatrix=function(b){e.applyMatrix(b?a.threeDManager.transformationMatrix:(new module$src$externals$three.default.Matrix4).getInverse(a.threeDManager.transformationMatrix,!0));f.applyMatrix(b?a.threeDManager.transformationMatrix:(new module$src$externals$three.default.Matrix4).getInverse(a.threeDManager.transformationMatrix,
   !0))};b.prototype.toggleLiveTransformations=function(b,d){var f=[];if(b)for(var g=0;g<a.threeDManager.transformationGroups.length;g++){var h=a.threeDManager.transformationGroups[g];if(!h.stopped){h.initTime||(h.initTime=d);var l=h.tweens,m=h.sceneObjects,k=new module$src$externals$three.default.Matrix4,n=!1,u=0;for(b=l.length;u<b;u++){var t=l[u];t.update(d);k.multiply(t.transformationMatrix);t.isPlaying()&&(n=!0)}h.active=!h.stopCalled&&n&&!(d>h.duration+h.initTime);l=0;for(b=m.length;l<b;l++)m[l]&&
   (m[l].parent||(n=c.getPathObject(e,h.sceneObjectPaths[l]),m[l]=n),m[l].applyMatrix(k),f.includes(m[l])||f.push(m[l]));h.prev.getInverse(k)}}else for(g=0;g<a.threeDManager.transformationGroups.length;g++)if(h=a.threeDManager.transformationGroups[g],!h.stopped){m=h.sceneObjects;b=!1;if(!1===h.active)for(k=0;k<a.threeDManager.transformationGroups.length;k++)a.threeDManager.transformationGroups[k].maxDuration===h.maxDuration&&a.threeDManager.transformationGroups[k].initTime===h.initTime&&k<g&&!0!==a.threeDManager.transformationGroups[k].stopped&&
   (b=!0);if(!1===h.active&&!1===b){if(d>h.duration+h.initTime||h.stopCalled)for(k=h.tweens,l=0,b=k.length;l<b;l++)k[l].stop();k=0;for(b=m.length;k<b;k++)if(m[k]){l=new module$src$externals$three.default.Matrix4;if(!0===h.reset&&!0!==h.stopCalled||!0===h.stopAndReset)m[k].applyMatrix(h.prev);else{m[k].updateMatrix(!0);m[k].updateMatrixWorld(!0);n=!0;for(u=0;16>u;u++)l.elements[u]-.001<m[k].matrix.elements[u]&&m[k].matrix.elements[u]<l.elements[u]+.001||(n=!1);n&&(m[k].matrix.identity(),m[k].matrixWorld.identity(),
   m[k].updateMatrix(!0),m[k].updateMatrixWorld(!0))}f.includes(m[k])||f.push(m[k])}h.stopTransformation()}else for(k=0,b=m.length;k<b;k++)m[k]&&(m[k].applyMatrix(h.prev),f.includes(m[k])||f.push(m[k]))}return f};b.prototype.toggleViewport=function(a,b){t&&(f.visible=a);u&&(h.visible=a);this.toggleHiddenGeometry(a);this.toggleMeshes(a);this.togglePointSize(a);this.toggleSceneBackground(a);this.toggleViewportMatrix(a);b&&this.toggleLiveTransformations(a,b)};b.prototype.destroyViewport=function(){l.length=
   0;m.length=0;k.length=0;n.length=0;d.remove(h);d.remove(f)};return new b}};var module$src$3d$interfaces$handlers$RenderingHandlerInterface={default:function(){}};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.render=function(b){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.renderHidden=function(){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.onResize=function(b,a){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.getSize=function(){};
   module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.start=function(){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.pause=function(){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.resume=function(){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.destroy=function(){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.getScreenshot=function(){};
   module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.getDomElement=function(){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.getCanvas=function(){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.getRendererInfo=function(){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.setBlur=function(b,a){};
   module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.registerForContinuousRendering=function(b,a){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.unregisterForContinuousRendering=function(b){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.containsContinuousRendering=function(b){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.updateShadowMap=function(){};
   module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.keepUpdatingShadowMap=function(){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.stopUpdatingShadowMap=function(){};var module$src$3d$viewport$helpers$handlers$RenderingHandlerHelpers={default:function(b){var a=b.handlers,c=b.geometryNode,d,e,g,h,f,k,l,m,n=window.devicePixelRatio;b=function(){d=this;k=new module$src$externals$three.default.Vector3;l=new module$src$externals$three.default.Vector3;m=new module$src$externals$three.default.Raycaster};b.prototype.createWebGLRenderer=function(a,b){var c={success:!0,message:"",messageLevel:module$src$shared$constants$LoggingConstants.default.loggingLevels.INFO};f=Object.assign({},
   b);g=a;try{var l=f.canvas;l||(l=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),l.id=("string"===typeof g.id&&0<g.id.length?g.id:"sdv-container-viewport")+"-canvas",g.appendChild(l),f.canvas=l);c.containerId=g.id;l.addEventListener("webglcontextlost",d.onContextLost,!1);l.addEventListener("webglcontextrestored",d.onContextRestore,!1);var m={alpha:f.alpha,depth:f.depth,stencil:f.stencil,antialias:f.antialias,premultipliedAlpha:f.premultipliedAlpha,preserveDrawingBuffer:f.preserveDrawingBuffer,
   powerPreference:f.powerPreference};e=l.getContext("webgl",m)||l.getContext("experimental-webgl",m);if(null===e)if(e=l.getContext("webgl")||l.getContext("experimental-webgl"),null!==e)c.message="We were unable to get a WebGL context using the requested attributes, falling back to default attributes.",c.messageLevel=module$src$shared$constants$LoggingConstants.default.loggingLevels.WARN;else throw Error("We were unable to get a WebGL context.");void 0===e.getShaderPrecisionFormat&&(e.getShaderPrecisionFormat=
   function(){return{rangeMin:1,rangeMax:1,precision:1}});f.context=e;h=new module$src$externals$three.default.WebGLRenderer(f);c.renderer=h}catch(v){f.canvas&&((a=f.canvas.parentNode)&&a.removeChild(f.canvas),delete f.canvas),c.success=!1,c.message=v.message,c.messageLevel=module$src$shared$constants$LoggingConstants.default.loggingLevels.ERROR}return c};b.prototype.getWebGLContext=function(){return e};b.prototype.handleCreateWebGLRendererResponse=function(b,c,d,e){if(d=!0===c.success?d:e)c.messageScope=
   d;!1===c.success&&(e=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.STATUS_MESSAGE,c),a.threeDManager.message(module$src$shared$constants$MessagingConstants.default.messageTopics.STATUS_FAILED,e));a.threeDManager.log(c.messageLevel,b,d,c.message);a.threeDManager.log(c.messageLevel|module$src$shared$constants$LoggingConstants.default.loggingLevels.LOG_TO_SERVER,b,{success:c.success,message:c.message,messageLevel:c.messageLevel,
   messageScope:c.messageScope,webglreport:c.webglreport});return!0===c.success};b.prototype.onContextLost=function(b){b.preventDefault();b.stopImmediatePropagation();a.threeDManager&&(f.canvas&&(f.canvas.removeEventListener("webglcontextlost",d.onContextLost,!1),f.canvas.removeEventListener("webglcontextrestored",d.onContextRestore,!1),(b=f.canvas.parentNode)&&b.removeChild(f.canvas),delete f.canvas),b=d.createWebGLRenderer(g,f),d.handleCreateWebGLRendererResponse("onContextLost",b,"WebGL context was lost and could be restored",
   "WebGL context was lost and could not be restored"),!1!==b.success&&a.threeDManager.reload())};b.prototype.onContextRestore=function(a){a.preventDefault();a.stopImmediatePropagation()};b.prototype.processAnchors=function(b,d,e,f){var g;if(0<f.length){var h=b.context.canvas;var u=h.width;var t=h.height}var q={};b=0;for(g=f.length;b<g;q={closestIntersectionDistance:q.closestIntersectionDistance},b++){var p=f[b];var z=p.object;p=p.properties;if(p.update){z.updateMatrixWorld(!0);k.setFromMatrixPosition(z.matrixWorld);
   l.set(k.x,k.y,k.z);l.project(e);l.x=u/2*l.x+u/2;l.y=-(t/2*l.y)+t/2;l.x=0>l.x?Math.ceil(l.x):Math.floor(l.x);l.y=0>l.y?Math.ceil(l.y):Math.floor(l.y);var B=h.getBoundingClientRect(),J=!1;if(1>=l.x||l.x>=u-1||1>=l.y||l.y>=t-1)J=!0;l.xPixel=l.x/n;l.yPixel=l.y/n;m.ray.direction.copy(k);m.ray.origin.set(0,0,0);e.localToWorld(m.ray.origin);m.ray.direction.sub(m.ray.origin);var F=m.ray.direction.length();m.ray.direction.normalize();q.closestIntersectionDistance=Number.MAX_VALUE;if(!0===p.hideable)if(p.intersectionTarget)if(p.intersectionTarget instanceof
   module$src$externals$three.default.Box3){var E=new module$src$externals$three.default.Ray(e.position,z.position.clone().sub(e.position).normalize()),G=new module$src$externals$three.default.Vector3;if(G=E.intersectBox(p.intersectionTarget,G))q.closestIntersectionDistance=G.distanceTo(e.position)}else{if(Array.isArray(p.intersectionTarget))for(E=0;E<p.intersectionTarget.length;E++){G=!1;for(var H=p.intersectionTarget[E].parent;H!==c;){if(!H){G=!0;break}H=H.parent}!0===G?(p.intersectionTarget.splice(E,
   1),E--):p.intersectionTarget[E].traverseVisible(function(a){return function(b){b instanceof module$src$externals$three.default.Mesh&&(b=m.intersectObject(b),b.length&&b[0].distance<a.closestIntersectionDistance&&(a.closestIntersectionDistance=b[0].distance))}}(q))}}else d.traverseVisible(function(a){return function(b){b instanceof module$src$externals$three.default.Mesh&&(b=m.intersectObject(b),b.length&&b[0].distance<a.closestIntersectionDistance&&(a.closestIntersectionDistance=b[0].distance))}}(q));
   e.getWorldDirection(k);E=m.ray.direction.dot(k);z={location:{x:z.position.x,y:z.position.y,z:z.position.z},containerX:l.xPixel,containerY:l.yPixel,containerWidth:u/n,containerHeight:t/n,clientX:l.xPixel+B.left,clientY:l.yPixel+B.top,pageX:l.xPixel+B.left+window.pageXOffset,pageY:l.yPixel+B.top+window.pageYOffset,viewport:a.threeDManager.runtimeId,hidden:p.hideable?q.closestIntersectionDistance<F:!1,overflow:J,distance:F,viewingAngle:E,scenePath:p.path,format:p.format,data:p.data};p.lastPos.x=l.x;
   p.lastPos.y=l.y;p.update(z)}}};return new b}};var module$src$3d$viewport$passes$SSAAPass={},THREE$$module$src$3d$viewport$passes$SSAAPass=module$src$externals$three.default,Shaders$$module$src$3d$viewport$passes$SSAAPass=module$src$3d$viewport$shaders$ShaderFile.default;
   module$src$3d$viewport$passes$SSAAPass.default=function(b){var a=new module$src$externals$three.default.ShaderMaterial({uniforms:{tDiffuse:{value:null},opacity:{value:1}},attributes:["position","uv"],vertexShader:module$src$3d$viewport$shaders$ShaderFile.default.basic_vert,fragmentShader:module$src$3d$viewport$shaders$ShaderFile.default.copy_frag});a.premultipliedAlpha=!0;a.transparent=!0;a.blending=module$src$externals$three.default.AdditiveBlending;a.depthTest=!1;a.depthWrite=!1;var c=new module$src$externals$three.default.OrthographicCamera(-1,
   1,1,-1,0,1),d=new module$src$externals$three.default.Scene,e=new module$src$externals$three.default.Mesh(new module$src$externals$three.default.PlaneGeometry(2,2),a);e.frustumCulled=!1;d.add(e);var g=new module$src$externals$three.default.WebGLRenderTarget(b.width,b.height,{minFilter:module$src$externals$three.default.LinearFilter,magFilter:module$src$externals$three.default.LinearFilter,format:module$src$externals$three.default.RGBAFormat});g.texture.name="SSAAPass.sample";var h=[[[0,0]],[[4,4],
   [-4,-4]],[[-2,-6],[6,-2],[-6,2],[2,6]],[[1,-3],[-1,3],[5,1],[-3,-5],[-5,5],[-7,-1],[3,7],[7,-7]],[[1,1],[-1,-3],[-3,2],[4,-1],[-5,-2],[2,5],[5,3],[3,-5],[-2,6],[0,-7],[-4,-6],[-6,4],[-8,0],[7,-4],[6,7],[-7,-8]],[[-4,-7],[-7,-5],[-3,-5],[-5,-4],[-1,-4],[-2,-2],[-6,-1],[-4,0],[-7,1],[-1,2],[-6,3],[-3,3],[-7,6],[-3,6],[-5,7],[-1,7],[5,-7],[1,-6],[6,-5],[4,-4],[2,-3],[7,-2],[1,-1],[4,-1],[2,1],[6,2],[0,4],[4,4],[2,5],[7,5],[5,6],[3,7]]];this.render=function(b,k,l,m,n){e=new module$src$externals$three.default.Mesh(new module$src$externals$three.default.PlaneGeometry(2,
   2),a);e.frustumCulled=!1;d.children.length=0;d.add(e);var f=h[Math.max(0,Math.min(n,5))];n=b.autoClear;b.autoClear=!1;var p=b.getClearColor().getHex(),u=b.getClearAlpha(),t=1/f.length;a.uniforms.tDiffuse.value=g.texture;f.forEach(function(e,h){var n=t;l.setViewOffset&&l.setViewOffset(m.width,m.height,.0625*e[0],.0625*e[1],m.width,m.height);n+=.03125*(-.5+(h+.5)/f.length);a.uniforms.opacity.value=n;b.setClearColor(p,u);b.render(k,l,g,!0);0===h&&b.setClearColor(0,0);b.render(d,c,m,0===h)});d.remove(e);
   e.geometry.dispose();e=void 0;l.clearViewOffset&&l.clearViewOffset();b.autoClear=n;b.setClearColor(p,u)};this.dispose=function(){g&&(g.dispose(),g=null)};this.setSize=function(a,b){g.setSize(a,b)}};var module$src$3d$viewport$passes$SaoPass={},THREE$$module$src$3d$viewport$passes$SaoPass=module$src$externals$three.default,Shaders$$module$src$3d$viewport$passes$SaoPass=module$src$3d$viewport$shaders$ShaderFile.default;
   module$src$3d$viewport$passes$SaoPass.default=function(b){function a(a,b){for(var c=[],d=0;d<=b;d++)c.push(Math.exp(-(d*d)/(2*a*a))/(Math.sqrt(2*Math.PI)*a));return c}function c(a){n.uniforms.cameraNear.value=a.near;n.uniforms.cameraFar.value=a.far;n.uniforms.cameraProjectionMatrix.value=a.projectionMatrix;n.uniforms.cameraInverseProjectionMatrix.value.getInverse(a.projectionMatrix,!0);u.uniforms.cameraNear.value=a.near;u.uniforms.cameraFar.value=a.far;t.uniforms.cameraNear.value=a.near;t.uniforms.cameraFar.value=
   a.far}var d=b.settings,e=new module$src$externals$three.default.MeshDepthMaterial;e.depthPacking=module$src$externals$three.default.RGBADepthPacking;e.blending=module$src$externals$three.default.NoBlending;e.side=module$src$externals$three.default.DoubleSide;var g=new module$src$externals$three.default.MeshNormalMaterial;g.blending=module$src$externals$three.default.NoBlending;g.side=module$src$externals$three.default.DoubleSide;var h=new module$src$externals$three.default.WebGLRenderTarget(b.width,
   b.height,{minFilter:module$src$externals$three.default.NearestFilter,magFilter:module$src$externals$three.default.NearestFilter,format:module$src$externals$three.default.RGBAFormat}),f=h.clone(),k=h.clone(),l=h.clone(),m={defines:{SAMPLES:d.getSetting("samples")},uniforms:{tDepth:{type:"t",value:null},tNormal:{type:"t",value:null},cameraNear:{type:"f",value:1},cameraFar:{type:"f",value:100},cameraProjectionMatrix:{type:"m4",value:new module$src$externals$three.default.Matrix4},cameraInverseProjectionMatrix:{type:"m4",
   value:new module$src$externals$three.default.Matrix4},scale:{type:"f",value:.1},kernelRadius:{type:"f",value:d.getSetting("kernelRadius")},size:{type:"v2",value:new module$src$externals$three.default.Vector2(b.width,b.height)},intensity:{type:"f",value:d.getSetting("intensity")}},attributes:["position","uv"],vertexShader:module$src$3d$viewport$shaders$ShaderFile.default.basic_vert,fragmentShader:module$src$3d$viewport$shaders$ShaderFile.default.sao_frag},n=new module$src$externals$three.default.ShaderMaterial(m);
   n.uniforms.tDepth.value=f.texture;n.uniforms.tNormal.value=k.texture;n.needsUpdate=!1;m={KERNEL_RADIUS:d.getSetting("kernelRadius")};b={tAO:{type:"t",value:null},tDiffuse:{type:"t",value:null},tDepth:{type:"t",value:null},size:{type:"v2",value:new module$src$externals$three.default.Vector2(b.width,b.height)},sampleWeights:{type:"1fv",value:a(d.getSetting("standardDev"),d.getSetting("kernelRadius"))},orientation:{type:"i",value:0},cameraNear:{type:"f",value:10},cameraFar:{type:"f",value:1E3}};var q=
   module$src$3d$viewport$shaders$ShaderFile.default.basic_vert,p=module$src$3d$viewport$shaders$ShaderFile.default.blur_frag,u=new module$src$externals$three.default.ShaderMaterial({uniforms:module$src$externals$three.default.UniformsUtils.clone(b),defines:m,vertexShader:q,fragmentShader:p});u.uniforms.tAO.value=h.texture;u.uniforms.tDepth.value=f.texture;u.uniforms.orientation.value=0;var t=new module$src$externals$three.default.ShaderMaterial({uniforms:module$src$externals$three.default.UniformsUtils.clone(b),
   defines:m,vertexShader:q,fragmentShader:p});t.uniforms.tAO.value=l.texture;t.uniforms.tDepth.value=f.texture;t.uniforms.orientation.value=1;var r=new module$src$externals$three.default.OrthographicCamera(-1,1,1,-1,0,1),v=new module$src$externals$three.default.Scene,w=new module$src$externals$three.default.Mesh(new module$src$externals$three.default.PlaneGeometry(2,2),null);v.add(w);this.render=function(a,b,d,m,q){c(d);b.traverse(function(a){a.material&&!a.material.renderAO&&(a.wasItVisible=a.visible,
   a.visible=!1)});t.uniforms.tDiffuse.value=m.texture;m=b.background;b.background=null;var p=a.getClearColor().getHex(),x=a.getClearAlpha();a.setClearColor(16777215);b.overrideMaterial=e;a.render(b,d,f,!0);a.setClearColor(7829503);b.overrideMaterial=g;a.render(b,d,k,!0);a.setClearColor(p,x);w.material=n;a.render(v,r,h,!0);w.material=u;a.render(v,r,l,!0);w.material=t;a.render(v,r,q,!0);b.overrideMaterial=null;b.background=m;b.traverse(function(a){a.material&&!a.material.renderAO&&(a.visible=a.wasItVisible)})};
   d.registerHook("samples",function(a){n.defines.samples=a;n.needsUpdate=!0});d.registerHook("intensity",function(a){n.uniforms.intensity.value=a});d.registerHook("kernelRadius",function(b){u.defines.KERNEL_RADIUS=b;t.defines.KERNEL_RADIUS=b;u.uniforms.sampleWeights.value=a(d.getSetting("standardDev"),b);t.uniforms.sampleWeights.value=a(d.getSetting("standardDev"),b);u.needsUpdate=!0;t.needsUpdate=!0});d.registerHook("standardDev",function(b){u.uniforms.sampleWeights.value=a(b,d.getSetting("kernelRadius"));
   t.uniforms.sampleWeights.value=a(b,d.getSetting("kernelRadius"))});this.setSize=function(a,b){n.uniforms.size.value.set(a,b);u.uniforms.size.value.set(a,b);t.uniforms.size.value.set(a,b);h.setSize(a,b);f.setSize(a,b);k.setSize(a,b);l.setSize(a,b)}};var module$src$3d$viewport$handlers$BeautyRenderHandler={default:function(b,a){var c=b.settings,d=b.scene,e=b.renderer,g,h=e.getPixelRatio(),f=e.getSize().width*h,k=e.getSize().height*h,l=!1,m=!1,n,q,p,u,t,r,v,w,y,x=0,A,z,B;h=function(){g=this;/(android)/i.test(navigator.userAgent)&&-1<navigator.userAgent.toLowerCase().indexOf("firefox")&&(l=!0);m=(/iPad|iPhone|iPod/.test(navigator.platform)||"MacIntel"===navigator.platform&&1<navigator.maxTouchPoints)&&!window.MSStream;n=new module$src$3d$viewport$passes$SSAAPass.default({width:f,
   height:k});q=new module$src$3d$viewport$passes$SaoPass.default({settings:c.getSection("sao"),width:f,height:k});p=new module$src$externals$three.default.WebGLRenderTarget(f,k,{minFilter:module$src$externals$three.default.LinearFilter,magFilter:module$src$externals$three.default.LinearFilter,format:module$src$externals$three.default.RGBAFormat,stencilBuffer:!1});p.texture.name="hidden.rt";u=p.clone();u.texture.name="standard.rt";t=p.clone();t.texture.name="ssaa.rt";r=p.clone();r.texture.name="ao.rt";
   v=new module$src$externals$three.default.ShaderMaterial({uniforms:{tStandard:{value:null},tBeauty:{value:null},size:{type:"v2",value:new module$src$externals$three.default.Vector2(512,512)},amount:{type:"f",value:0}},attributes:["position","uv"],vertexShader:module$src$3d$viewport$shaders$ShaderFile.default.basic_vert,fragmentShader:module$src$3d$viewport$shaders$ShaderFile.default.blend_frag});v.uniforms.tStandard.value=u.texture;v.uniforms.tBeauty.value=t.texture;v.uniforms.size.value.set(f,k);
   v.uniforms.amount.value=0;A=new module$src$externals$three.default.OrthographicCamera(-1,1,1,-1,0,1);z=new module$src$externals$three.default.Scene;B=new module$src$externals$three.default.Mesh(new module$src$externals$three.default.PlaneGeometry(2,2),v);z.add(B)};h.prototype._setToggleSoftShadows=function(b){for(var c=a.threeDManager.helpers.getMeshMaterialObjects(),d=a.threeDManager._getExchangeMeshMaterialObjects(),e=0,f=c.length;e<f;e++){var g=c[e].mesh,h=c[e].material,l=void 0;if("ShapeDiverStandardMaterial"===
   h.type&&g.geometry&&"TextGeometry"!==g.geometry.type){for(var m=-1,k=0,n=d.length;k<n;k++)if(d[k].mesh===g){m=k;l=d[k].material;break}-1===m&&(l=a.materialHandler.getMaterial(),l.deepCopy(h),l.defines.USE_PCSS_SHADOW="",l.softShadow=!0,m=d.length,d.push({mesh:g,material:l}));if(h.softShadow!==b){c[e].material=l;d[m].material=h;g.material=l;for(var u in h)"uuid"!==u&&"defines"!==u&&"vertexShader"!==u&&"fragmentShader"!==u&&"softShadow"!==u&&g.material[u]!==h[u]&&(g.material[u]=h[u]);for(var t in g.material.defines)"USE_PCSS_SHADOW"===
   t||g.material.defines[t]&&h.defines[t]||(delete g.material.defines[t],g.material.needsUpdate=!0);for(var q in h.defines)"USE_PCSS_SHADOW"===q||g.material.defines[q]&&h.defines[q]||(g.material.defines[q]=h.defines[q],g.material.needsUpdate=!0)}}}};h.prototype._startBlending=function(b,f){a.renderingHandler.registerForContinuousRendering("beautyRenderBlending",!1);w=performance.now();x=0;v.uniforms.tStandard.value=b.texture;v.uniforms.tBeauty.value=f.texture;c.getSetting("shadows")&&g._setToggleSoftShadows(!1);
   e.render(d,a.cameraHandler.camera,p,!0)};h.prototype.renderStandard=function(){e.render(d,a.cameraHandler.camera)};h.prototype.beautyRenderingActive=function(){var a=c.getSetting("shadows");return c.getSetting("ambientOcclusion")&&!m||a};h.prototype.renderBeauty=function(){var b=c.getSetting("shadows"),f=c.getSetting("ambientOcclusion");e.render(d,a.cameraHandler.camera);n.render(e,d,a.cameraHandler.camera,u,2);b&&g._setToggleSoftShadows(!0);f&&!m?(b=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.GENERIC,
   {viewportRuntimeId:a.threeDManager.runtimeId}),a.threeDManager.message(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_RENDER_BEAUTY_START,b),n.render(e,d,a.cameraHandler.camera,t,2),q.render(e,d,a.cameraHandler.camera,t,r),e.render(d,a.cameraHandler.camera,p,!0),g._startBlending(u,r)):b?(b=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.GENERIC,{viewportRuntimeId:a.threeDManager.runtimeId}),
   a.threeDManager.message(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_RENDER_BEAUTY_START,b),n.render(e,d,a.cameraHandler.camera,t,2),e.render(d,a.cameraHandler.camera,p,!0),g._startBlending(u,t)):e.render(d,a.cameraHandler.camera)};h.prototype.renderBlending=function(){v.uniforms.amount.value=x;e.render(z,A,null,!0);y=performance.now();var b=(y-w)/1E3;w=y;x+=Math.min(b/1.5,.1);1<=x&&(x=0,a.renderingHandler.unregisterForContinuousRendering("beautyRenderBlending"),b=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.GENERIC,
   {viewportRuntimeId:a.threeDManager.runtimeId}),a.threeDManager.message(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_RENDER_BEAUTY_END,b))};h.prototype.renderHidden=function(){a.threeDManager&&a.cameraHandler&&a.cameraHandler.camera&&(a.threeDManager.helpers.toggleViewport(!0),e.render(d,a.cameraHandler.camera,p),a.threeDManager.helpers.toggleViewport(!1))};h.prototype.updateCustomUniforms=function(){d.traverse(function(a){if(a.material)if("ShapeDiverStandardMaterial"===
   a.material.type){a.material.uniforms.lightWorldSize.value=a.material.lightWorldSize;a.material.uniforms.lightFrustum.value=a.material.lightFrustum;a.material.uniforms.shadowOpacity.value=a.material.shadowOpacity;a.material.uniforms.lightReflectivity.value=a.material.lightReflectivity;a.material.uniforms.rgbMap.value=a.material.rgbMap;a.material.uniforms.threeDNoiseOpacity.value=a.material.threeDNoiseOpacity;a.material.uniforms.threeDNoiseID.value=a.material.threeDNoiseID;a.material.uniforms.threeDNoiseScale.value=
   a.material.threeDNoiseScale;a.material.uniforms.threeDNoiseDistanceFade.value=a.material.threeDNoiseDistanceFade;if(0<a.material.threeDNoiseOpacity&&""!==a.material.defines["USE_3D_NOISE_F"+a.material.threeDNoiseID]&&(0<=a.material.threeDNoiseID&&3>=a.material.threeDNoiseID||999===a.material.threeDNoiseID)){for(var b in a.material.defines)0===b.indexOf("USE_3D_NOISE_F")&&delete a.material.defines[b];a.material.defines["USE_3D_NOISE_F"+a.material.threeDNoiseID]="";a.material.needsUpdate=!0}if(0<a.material.threeDNoiseOpacity&&
   ""!==a.material.defines.USE_3D_NOISE)a.material.defines.USE_3D_NOISE="",a.material.needsUpdate=!0,-1===a.material.threeDNoiseID&&(a.material.threeDNoiseID=0,a.material.uniforms.threeDNoiseID.value=a.material.threeDNoiseID,a.material.defines.USE_3D_NOISE_F0="");else if(0>=a.material.threeDNoiseOpacity&&""===a.material.defines.USE_3D_NOISE){for(var c in a.material.defines)0===c.indexOf("USE_3D_NOISE_F")&&delete a.material.defines[c];delete a.material.defines.USE_3D_NOISE;a.material.needsUpdate=!0}a.material.map&&
   (a.material.uniforms.uvTransformMap.value=a.material.map.uvTransform,a.material.map.matrix.identity());a.material.specularMap&&(a.material.uniforms.uvTransformSpecularMap.value=a.material.specularMap.uvTransform,a.material.specularMap.matrix.identity());a.material.normalMap&&(a.material.uniforms.uvTransformNormalMap.value=a.material.normalMap.uvTransform,a.material.normalMap.matrix.identity());a.material.bumpMap&&(a.material.uniforms.uvTransformBumpMap.value=a.material.bumpMap.uvTransform,a.material.bumpMap.matrix.identity());
   a.material.roughnessMap&&(a.material.uniforms.uvTransformRoughnessMap.value=a.material.roughnessMap.uvTransform,a.material.roughnessMap.matrix=new module$src$externals$three.default.Matrix3);a.material.metalnessMap&&(a.material.uniforms.uvTransformMetalnessMap.value=a.material.metalnessMap.uvTransform,a.material.metalnessMap.matrix=new module$src$externals$three.default.Matrix3);a.material.alphaMap&&(a.material.uniforms.uvTransformAlphaMap.value=a.material.alphaMap.uvTransform,a.material.alphaMap.matrix.identity());
   a.material.emissiveMap&&(a.material.uniforms.uvTransformEmissiveMap.value=a.material.emissiveMap.uvTransform,a.material.emissiveMap.matrix.identity());if(0!==a.material.mapsSize){a.material.uniforms.mapsSize.value=a.material.mapsSize;0<a.material.mapsSize&&a.material.defines.NUM_ADD_MAPS!==a.material.mapsSize&&(a.material.defines.NUM_ADD_MAPS=a.material.mapsSize,a.material.needsUpdate=!0);for(;5>a.material.mapPropertyType.length;)a.material.mapPropertyType.push(-1);for(;5>a.material.mapPropertyColor.length;)a.material.mapPropertyColor.push(new module$src$externals$three.default.Color(0));
   for(;5>a.material.uvTransformAddMap.length;)a.material.uvTransformAddMap.push((new module$src$externals$three.default.Matrix3).identity());a.material.uniforms.mapPropertyType.value=a.material.mapPropertyType;a.material.uniforms.mapPropertyColor.value=a.material.mapPropertyColor;a.material.uniforms.uvTransformAddMap.value=a.material.uvTransformAddMap;b=0;for(c=a.material.mapsSize;b<c;b++)0===b&&(a.material.uniforms.additionalMaps0.value=a.material.additionalMaps0),1===b&&(a.material.uniforms.additionalMaps1.value=
   a.material.additionalMaps1),2===b&&(a.material.uniforms.additionalMaps2.value=a.material.additionalMaps2),3===b&&(a.material.uniforms.additionalMaps3.value=a.material.additionalMaps3),4===b&&(a.material.uniforms.additionalMaps4.value=a.material.additionalMaps4)}else a.material.uniforms.mapsSize.value=0,0!==a.material.defines.NUM_ADD_MAPS&&(a.material.defines.NUM_ADD_MAPS=0,a.material.needsUpdate=!0);l&&""!==a.material.defines.LOD_BLACK_LIST&&(a.material.defines.LOD_BLACK_LIST="",a.material.needsUpdate=
   !0)}else"ShapeDiverGemMaterial"===a.material.type&&(a.material.uniforms.refractionIndex.value=a.material.refractionIndex,a.material.uniforms.center.value=a.material.center,a.material.uniforms.radius.value=a.material.radius,a.material.uniforms.sphericalNormalMap.value=a.material.sphericalNormalMap,a.material.uniforms.dispersion.value=a.material.dispersion,a.material.uniforms.contrast.value=a.material.contrast,a.material.uniforms.gamma.value=a.material.gamma,a.material.uniforms.brightness.value=a.material.brightness,
   a.material.uniforms.tracingOpacity.value=a.material.tracingOpacity,a.material.uniforms.impurityMap.value=a.material.impurityMap,a.material.uniforms.impurityScale.value=a.material.impurityScale,a.material.uniforms.colorTransferBegin.value=a.material.colorTransferBegin,a.material.uniforms.colorTransferEnd.value=a.material.colorTransferEnd,a.material.inverseModelMatrix=(new module$src$externals$three.default.Matrix4).getInverse(a.matrixWorld),a.material.uniforms.inverseModelMatrix.value=a.material.inverseModelMatrix,
   a.material.inverseTransposeModelMatrix=(new module$src$externals$three.default.Matrix3).getNormalMatrix((new module$src$externals$three.default.Matrix4).getInverse(a.matrixWorld).transpose()),a.material.uniforms.inverseTransposeModelMatrix.value=a.material.inverseTransposeModelMatrix,a.material.defines.DEPTH!=a.material.depth&&(a.material.defines.DEPTH=a.material.depth,a.material.needsUpdate=!0),""===a.material.defines.DISPERSION&&0===a.material.dispersion&&(delete a.material.defines.DISPERSION,a.material.needsUpdate=
   !0),""!==a.material.defines.DISPERSION&&0!==a.material.dispersion&&(a.material.defines.DISPERSION="",a.material.needsUpdate=!0),""===a.material.defines.USE_IMPURITY_MAP&&null===a.material.impurityMap&&(delete a.material.defines.USE_IMPURITY_MAP,a.material.needsUpdate=!0),""!==a.material.defines.USE_IMPURITY_MAP&&null!==a.material.impurityMap&&(a.material.defines.USE_IMPURITY_MAP="",a.material.needsUpdate=!0))})};h.prototype.setSize=function(a,b){var c=e.getPixelRatio();a*=c;b*=c;q.setSize(a,b);n.setSize(a,
   b);p.setSize(a,b);u.setSize(a,b);t.setSize(a,b);r.setSize(a,b);v.uniforms.size.value.set(a,b)};return new h(b)}};var module$src$3d$viewport$handlers$RenderingHandler={default:function(b,a){var c=b.settings,d=b.scene,e=b.geometryNode,g=b.container,h=b.pathUtils,f=[],k,l,m=g.offsetWidth,n=g.offsetHeight,q=!1,p=-1,u=null,t,r,v=!1,w=!1,y=-1,x=null,A=null,z=!0,B=!1,J=!1,F=Date.now(),E=0,G=0,H=function(a,b,c){b!==c&&k.render()},C=function(b){if(!module$src$shared$util$GlobalUtils.default.typeCheck(b,"boolean",a.threeDManager.warn,"RenderingHandler.Hook->shadows"))return!1;a.lightHandler.setToggleLightShadows(b);return!0},
   I=function(b){return module$src$shared$util$GlobalUtils.default.typeCheck(b,"boolean",a.threeDManager.warn,"RenderingHandler.Hook->ambientOcclusion")?!0:!1},K=function(b){if(!module$src$shared$util$GlobalUtils.default.typeCheck(b,"color",a.threeDManager.warn,"RenderingHandler.Hook->clearColor"))return!1;b=(0,module$src$shared$util$toTinyColor.default)(b);null!==A?r.setClearColor(b.toThreeColor(),A):r.setClearColor(b.toThreeColor());k.render();return!0},L=function(b){if(!module$src$shared$util$GlobalUtils.default.typeCheck(b,
   "notnegative",a.threeDManager.warn,"RenderingHandler.Hook->clearAlpha"))return!1;A=b;r.setClearAlpha(b);k.render();return!0},Q=function(b){return module$src$shared$util$GlobalUtils.default.typeCheck(b,"notnegative",a.threeDManager.warn,"RenderingHandler.Hook->pointSize")?!0:!1},S=function(){k.render()},D=function(){module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.call(this);k=this;l=module$src$modules$shapediver_state_dashboard$StateDashboard.default.StateDashboardLibrary.getInstance(a.threeDManager.viewerApi.getSetting("viewerRuntimeId"));
   t=new module$src$3d$viewport$helpers$handlers$RenderingHandlerHelpers.default({handlers:a,geometryNode:e,pathUtils:h});var b=t.createWebGLRenderer(g,{antialias:!0,alpha:!0,preserveDrawingBuffer:!0});a.threeDManager.success=b.success;t.handleCreateWebGLRendererResponse("RenderingHandler",b,"WebGL context was created","WebGL context could not be created");if(!1===b.success)return null;r=b.renderer;r.setPixelRatio(window.devicePixelRatio);r.setSize(m,n,!0);r.setClearColor((0,module$src$shared$util$toTinyColor.default)(c.getSetting("clearColor"),
   "white").toThreeColor(),c.getSetting("clearAlpha"));r.shadowMap.enabled=!0;r.shadowMap.autoUpdate=!1;r.shadowMap.needsUpdate=!0;r.shadowMap.type=module$src$externals$three.default.PCFShadowMap;r.gammaFactor=1;r.gammaInput=!1;r.gammaOutput=!0;r.textureUnitCount=b.renderer.context.getParameter(b.renderer.context.MAX_TEXTURE_IMAGE_UNITS);r.textureUnitCount||(r.textureUnitCount=8);r.depth=!1;window.onresize=function(){-1===y&&k.registerForContinuousRendering("registeredResizeEvent");clearTimeout(y);y=
   setTimeout(function(){y=-1;k.unregisterForContinuousRendering("registeredResizeEvent");k.render()},250)};a.beautyRenderHandler=new module$src$3d$viewport$handlers$BeautyRenderHandler.default({settings:c,scene:d,geometryNode:e,renderer:r},a);a.threeDManager.beautyRenderHandler=a.beautyRenderHandler;a.threeDManager.viewerApi.state.addEventListener(a.threeDManager.viewerApi.state.EVENTTYPE.BUSY,function(){-1===f.indexOf("busyMode")&&k.registerForContinuousRendering("busyMode")});a.threeDManager.viewerApi.state.addEventListener(a.threeDManager.viewerApi.state.EVENTTYPE.IDLE,
   function(){k.unregisterForContinuousRendering("busyMode")});c.registerNotifier("shadows",H);c.registerNotifier("ambientOcclusion",H);c.registerNotifier("pointSize",S);c.registerHook("shadows",C);c.registerHook("ambientOcclusion",I);c.registerHook("clearColor",K);c.registerHook("clearAlpha",L);c.registerHook("pointSize",Q)};$jscomp.inherits(D,module$src$3d$interfaces$handlers$RenderingHandlerInterface.default);D.prototype._resizeEvent=function(){k.registerForContinuousRendering("unregisteredResizeEvent",
   !1);setTimeout(function(){k.unregisterForContinuousRendering("unregisteredResizeEvent")},100)};D.prototype._beforeRender=function(b){r.clear();module$node_modules$$tweenjs$tween_js$src$Tween.default.update(b);a.cameraHandler.updateCameraControls(b-F);if(document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement||document.mozFullScreenElement){var c=!0;if("true"==r.domElement.getAttribute("sdv-fullscreen")||null==r.domElement.parentNode){b=screen.width;var d=screen.height}else b=
   r.domElement.parentNode.offsetWidth,d=r.domElement.parentNode.offsetHeight}else c=!1,b=r.domElement.parentNode.offsetWidth,d=r.domElement.parentNode.offsetHeight;if(b!==m||d!==n||q!==c)k._resizeEvent(),m=b,n=d,q=c,r.setSize(m,n,!0),a.cameraHandler.onResize(m,n),a.beautyRenderHandler.setSize(m,n);a.beautyRenderHandler.updateCustomUniforms();if(!0===v||!0===w)v=!1,r.shadowMap.needsUpdate=!0};D.prototype._getExtension=function(a){return r.extensions.get(a)};D.prototype._getTextureUnitCount=function(){return r.textureUnitCount};
   D.prototype._framerateMeasurement=function(b,c){0===b?(E+=c,G++,1E3<E&&(G-=(E-1E3)/c,b=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.GENERIC,{type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_FRAMERATE,viewportRuntimeId:a.threeDManager.runtimeId,framerate:G}),a.threeDManager.message(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_FRAMERATE,b),G=E=0)):G=E=0};D.prototype.render=
   function(b){if(l.firstTimeVisible.resolved&&!1!==B&&a.threeDManager&&r.domElement&&!1!==a.threeDManager.getSetting("show")&&z&&0!==b-F)if(u&&(clearTimeout(u),u=null),b){-1===p&&(F=b);k._framerateMeasurement(p,b-F);p=1===f.length&&-1!==f.indexOf("beautyRenderBlending")?2:0===f.length&&!0===J?1:0;J=!1;if(0===p&&-1!==f.indexOf("beautyRenderBlending")){k.unregisterForContinuousRendering("beautyRenderBlending");var e=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.GENERIC);
   a.threeDManager.message(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_RENDER_BEAUTY_CANCEL,e)}k._beforeRender(b);a.threeDManager.helpers.toggleViewport(!0,b);0==p?a.beautyRenderHandler.renderStandard():2==p?a.beautyRenderHandler.renderBlending():1==p&&a.beautyRenderHandler.renderBeauty();t.processAnchors(r,d,a.cameraHandler.camera,a.threeDManager.helpers.getAnchors());a.threeDManager.helpers.toggleViewport(!1,b);0<f.length?requestAnimationFrame(k.render):(0===p&&a.beautyRenderHandler.beautyRenderingActive()&&
   (u=setTimeout(function(){J=!0;u=null;requestAnimationFrame(k.render)},c.getSetting("beautyRenderDelay"))),p=-1);F=b}else-1!==f.indexOf("beautyRenderBlending")?(k.unregisterForContinuousRendering("beautyRenderBlending"),b=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.GENERIC),a.threeDManager.message(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_RENDER_BEAUTY_CANCEL,b)):-1===p&&requestAnimationFrame(k.render)};
   D.prototype.renderHidden=function(){a.beautyRenderHandler.renderHidden()};D.prototype.onResize=function(a,b){r.setSize(a,b)};D.prototype.getSize=function(){return r.getSize()};D.prototype.start=function(){B=!0};D.prototype.pause=function(){z=!1};D.prototype.resume=function(){z=!0;p=-1};D.prototype.destroy=function(){r.dispose();try{r.forceContextLoss()}catch(N){}};D.prototype.getScreenshot=function(){return r.domElement.toDataURL("image/png")};D.prototype.getDomElement=function(){return r.domElement};
   D.prototype.getCanvas=function(){return r.context.canvas};D.prototype.getRendererInfo=function(){return r.info};D.prototype.setBlur=function(a,b){null!=b&&b.hasOwnProperty("duration")?(x=x||Promise.resolve(),x=x.then(function(){var c={r:a?0:3};return new Promise(function(d){(new module$node_modules$$tweenjs$tween_js$src$Tween.default.Tween(c)).to({r:a?3:1},b.duration).onUpdate(function(){r.domElement.style.filter="blur("+c.r+"px)"}).onComplete(function(){r.domElement.style.filter=a?"blur(3px)":"";
   d()}).start()})})):x=(x||Promise.resolve()).then(function(){r.domElement.style.filter=a?"blur(3px)":""})};D.prototype.registerForContinuousRendering=function(a,b){void 0!==a&&(f.includes("cameraMoving")&&"cameraMoving"===a||f.push(a),!1!==b&&k.render())};D.prototype.unregisterForContinuousRendering=function(a){a=f.indexOf(a);-1<a&&f.splice(a,1)};D.prototype.containsContinuousRendering=function(a){return-1===f.indexOf(a)?!1:!0};D.prototype.updateShadowMap=function(){v=!0};D.prototype.keepUpdatingShadowMap=
   function(){w=!0};D.prototype.stopUpdatingShadowMap=function(){w=!1};D.prototype.getRenderer=function(){return r};return new D(b)}};var module$src$3d$viewport$helpers$handlers$MaterialHandlerHelpers={default:function(b,a){var c=a.nameSimple;a=function(){};a.prototype.checkMaterials=function(){var a=b.renderingHandler.getRendererInfo();if(a&&a.programs){a=a.programs;for(var e=0,g=a.length;e<g;e++){var h=a[e];if(h.diagnostics&&!1===h.diagnostics.runnable){if(h.name===c){var f={message:h,messageLevel:module$src$shared$constants$LoggingConstants.default.loggingLevels.ERROR,messageScope:"Shader program could not be created"},k=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.STATUS_MESSAGE,
   f);b.threeDManager.message(module$src$shared$constants$MessagingConstants.default.messageTopics.STATUS_FAILED,k);b.threeDManager.log(f.messageLevel,f.messageScope,f);b.threeDManager.log(f.messageLevel|module$src$shared$constants$LoggingConstants.default.loggingLevels.LOG_TO_SERVER,f.messageScope,f);b.threeDManager.viewerApi.viewports.destroy(b.threeDManager.runtimeId)}else{f=b.threeDManager.helpers.getMeshMaterialObjects();for(var l=0,m=f.length;l<m;l++)if(k=f[l],k.material.program&&k.material.program.id===
   h.id){k.material=b.materialHandler.getSimpleMaterial(k.properties);break}}delete h.diagnostics}}}};return new a}};var module$src$3d$viewport$handlers$MaterialHandler={default:{}},__awaiter$$module$src$3d$viewport$handlers$MaterialHandler=this&&module$src$3d$viewport$handlers$MaterialHandler.default.__awaiter||function(b,a,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,h){function f(a){try{l(d.next(a))}catch(n){h(n)}}function g(a){try{l(d["throw"](a))}catch(n){h(n)}}function l(a){a.done?c(a.value):e(a.value).then(f,g)}l((d=d.apply(b,a||[])).next())})},
   __generator$$module$src$3d$viewport$handlers$MaterialHandler=this&&module$src$3d$viewport$handlers$MaterialHandler.default.__generator||function(b,a){function c(a){return function(b){return d([a,b])}}function d(c){if(g)throw new TypeError("Generator is already executing.");for(;e;)try{if(g=1,h&&(f=c[0]&2?h["return"]:c[0]?h["throw"]||((f=h["return"])&&f.call(h),0):h.next)&&!(f=f.call(h,c[1])).done)return f;if(h=0,f)c=[c[0]&2,f.value];switch(c[0]){case 0:case 1:f=c;break;case 4:return e.label++,{value:c[1],
   done:!1};case 5:e.label++;h=c[1];c=[0];continue;case 7:c=e.ops.pop();e.trys.pop();continue;default:if(!(f=e.trys,f=0<f.length&&f[f.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!f||c[1]>f[0]&&c[1]<f[3]))e.label=c[1];else if(6===c[0]&&e.label<f[1])e.label=f[1],f=c;else if(f&&e.label<f[2])e.label=f[2],e.ops.push(c);else{f[2]&&e.ops.pop();e.trys.pop();continue}}c=a.call(b,e)}catch(m){c=[6,m],h=0}finally{g=f=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e={label:0,sent:function(){if(f[0]&
   1)throw f[1];return f[1]},trys:[],ops:[]},g,h,f,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k},__values$$module$src$3d$viewport$handlers$MaterialHandler=this&&module$src$3d$viewport$handlers$MaterialHandler.default.__values||function(b){var a="function"===typeof Symbol&&Symbol.iterator,c=a&&b[a],d=0;if(c)return c.call(b);if(b&&"number"===typeof b.length)return{next:function(){b&&d>=b.length&&(b=void 0);return{value:b&&
   b[d++],done:!b}}};throw new TypeError(a?"Object is not iterable.":"Symbol.iterator is not defined.");},__importStar$$module$src$3d$viewport$handlers$MaterialHandler=this&&module$src$3d$viewport$handlers$MaterialHandler.default.__importStar||function(b){if(b&&b.__esModule)return b;var a={};if(null!=b)for(var c in b)Object.hasOwnProperty.call(b,c)&&(a[c]=b[c]);a["default"]=b;return a},__importDefault$$module$src$3d$viewport$handlers$MaterialHandler=this&&module$src$3d$viewport$handlers$MaterialHandler.default.__importDefault||
   function(b){return b&&b.__esModule?b:{"default":b}};Object.defineProperty(module$src$3d$viewport$handlers$MaterialHandler.default,"__esModule",{value:!0});
   var THREE$$module$src$3d$viewport$handlers$MaterialHandler=__importStar$$module$src$3d$viewport$handlers$MaterialHandler(module$src$externals$three.default),GLOBAL_UTILS$$module$src$3d$viewport$handlers$MaterialHandler=__importStar$$module$src$3d$viewport$handlers$MaterialHandler(module$src$shared$util$GlobalUtils.default),SHADERS$$module$src$3d$viewport$handlers$MaterialHandler=__importStar$$module$src$3d$viewport$handlers$MaterialHandler(module$src$3d$viewport$shaders$ShaderFile.default),MaterialHandlerHelpers_1$$module$src$3d$viewport$handlers$MaterialHandler=
   __importDefault$$module$src$3d$viewport$handlers$MaterialHandler(module$src$3d$viewport$helpers$handlers$MaterialHandlerHelpers.default),MaterialHandlerInsance$$module$src$3d$viewport$handlers$MaterialHandler=function(){function b(a,b){var c=this;this._handlers=b;this._envMapFilenames="px nx pz nz py ny".split(" ");this._envMapNamesJPG="default default_bw blurred_lights georgentor georgentor_blur georgentor_blue_blur georgentor_bw_blur levelsets lythwood_field mountains ocean piazza_san_marco residential_garden room_abstract_1 sky storage_room storm subway_entrance subway_entrance_bw_blur white yokohama".split(" ");
   this._envMapNamesPNG=[];this._envMapUrlPrefix="https://viewer.shapediver.com/v2/envmaps/";this._gemSphericalMaps={};this._textureUnitCount=0;this._usedEnvironmentMaps=[];this._active=!0;this._environmentMap=null;this._lightFrustum=6.5;this._lightWorldSize=.005;this._mipmapBlackListed=!1;this._sceneBackground=null;this._settings=a.settings;this._pathUtils=a.pathUtils;this._scene=a.scene;this._helpers=new MaterialHandlerHelpers_1$$module$src$3d$viewport$handlers$MaterialHandler.default(b,{nameStandard:"ShapeDiverStandardMaterial",
   nameSimple:"MeshPhongMaterial"});b.renderingHandler._getExtension("EXT_shader_texture_lod")||(this._mipmapBlackListed=!0);this._textureUnitCount=b.renderingHandler._getTextureUnitCount();this._settings.registerHook("environmentMap",function(a){return c.environmentMapHook(a)});this._settings.updateSettingAsync("environmentMap",this._settings.getSetting("environmentMap"));this._settings.registerHook("environmentMapAsBackground",this.environmentMapAsBackgroundHook.bind(this));this._settings.registerHook("environmentMapResolution",
   this.environmentMapResolutionHook.bind(this))}b.prototype.adjustToBoundingSphere=function(a){this._lightWorldSize=a.radius/25*.005;this._lightFrustum=a.radius/25*6.5;a=this._handlers.threeDManager.helpers.getMaterials();for(var b=0,d=a.length;b<d;b++){var e=a[b];"ShapeDiverStandardMaterial"==e.type&&(e.lightWorldSize=this._lightWorldSize,e.lightFrustum=this._lightFrustum)}};b.prototype.compile=function(){this._handlers.beautyRenderHandler.renderHidden();this._helpers.checkMaterials()};b.prototype.createCubeNormalMap=
   function(a,b,d){b=this.getTransformationPath(a)+b;if(this._gemSphericalMaps[b+"_"+d])return this._gemSphericalMaps[b+"_"+d];var c=new THREE$$module$src$3d$viewport$handlers$MaterialHandler.Scene,g=new THREE$$module$src$3d$viewport$handlers$MaterialHandler.CubeCamera(.001,1E4,d);g.renderTarget.texture.generateMipmaps=!1;g.renderTarget.texture.minFilter=THREE$$module$src$3d$viewport$handlers$MaterialHandler.NearestFilter;g.renderTarget.texture.magFilter=THREE$$module$src$3d$viewport$handlers$MaterialHandler.NearestFilter;
   g.renderTarget.texture.format=THREE$$module$src$3d$viewport$handlers$MaterialHandler.RGBAFormat;c.add(g);if(!this._gemNormalMaterial){var h=THREE$$module$src$3d$viewport$handlers$MaterialHandler.UniformsUtils.merge([THREE$$module$src$3d$viewport$handlers$MaterialHandler.UniformsLib.common,{emissive:{value:new THREE$$module$src$3d$viewport$handlers$MaterialHandler.Color(0)},roughness:{value:.5},metalness:{value:0},envMapIntensity:{value:1}}]),f=SHADERS$$module$src$3d$viewport$handlers$MaterialHandler.normal_vert,
   k=SHADERS$$module$src$3d$viewport$handlers$MaterialHandler.normal_frag;this._gemNormalMaterial=new THREE$$module$src$3d$viewport$handlers$MaterialHandler.ShaderMaterial({uniforms:THREE$$module$src$3d$viewport$handlers$MaterialHandler.UniformsUtils.clone(h),defines:{STANDARD:""},vertexShader:f,fragmentShader:k});this._gemNormalMaterial.blending=THREE$$module$src$3d$viewport$handlers$MaterialHandler.NoBlending;this._gemNormalMaterial.side=THREE$$module$src$3d$viewport$handlers$MaterialHandler.DoubleSide;
   c.overrideMaterial=this._gemNormalMaterial}a=new THREE$$module$src$3d$viewport$handlers$MaterialHandler.Mesh(a.geometry.clone(),this._gemNormalMaterial);a.geometry.center();c.add(a);g.update(this._handlers.renderingHandler.getRenderer(),c);c.remove(a);this._gemSphericalMaps[b+"_"+d]=g.renderTarget.texture;return this._gemSphericalMaps[b+"_"+d]};b.prototype.destroy=function(){};b.prototype.getEnvironmentMap=function(){return this._environmentMap};b.prototype.getMaterial=function(a,b,d,e,g){null==a&&
   (a={});!a.attributes&&b&&b.geometry&&b.geometry.attributes&&(a.attributes=Object.keys(b.geometry.attributes));"gem"===a.materialType?(e=this.createCubeNormalMap(b,d,a.resolution),b.geometry.boundingSphere||b.geometry.computeBoundingSphere(),g=b.geometry.boundingSphere.center,d=b.geometry.boundingSphere.radius,a.side=THREE$$module$src$3d$viewport$handlers$MaterialHandler.FrontSide,a=Object.assign({inverseModelMatrix:(new THREE$$module$src$3d$viewport$handlers$MaterialHandler.Matrix4).getInverse(b.matrixWorld),
   inverseTransposeModelMatrix:(new THREE$$module$src$3d$viewport$handlers$MaterialHandler.Matrix3).getNormalMatrix((new THREE$$module$src$3d$viewport$handlers$MaterialHandler.Matrix4).getInverse(b.matrixWorld).transpose()),center:g,radius:d,sphericalNormalMap:e,envMap:a.environmentMap?a.environmentMap:this._environmentMap,customEnvMap:!!a.environmentMap},a),a=new THREE$$module$src$3d$viewport$handlers$MaterialHandler.ShapeDiverGemMaterial(a)):(a=new THREE$$module$src$3d$viewport$handlers$MaterialHandler.ShapeDiverStandardMaterial(Object.assign({textureUnitCount:this._textureUnitCount,
   lightWorldSize:this._lightWorldSize,lightFrustum:this._lightFrustum,envMap:this._environmentMap,renderAO:!0},a)),e&&a.color.set(e.toRgbString()),g&&(a.vertexColors=THREE$$module$src$3d$viewport$handlers$MaterialHandler.VertexColors),this._handlers.lightHandler.reevaluateNumberOfShadowMaps(a.availableTextures));return a};b.prototype.getSceneBackground=function(){return this._sceneBackground};b.prototype.getSimpleMaterial=function(a){return new THREE$$module$src$3d$viewport$handlers$MaterialHandler.MeshPhongMaterial(Object.assign({shininess:a.metalness?
   128*a.metalness:0},a))};b.prototype.pause=function(){this._active=!1};b.prototype.resume=function(){this._active=!0};b.prototype.setSceneBackground=function(a){this._sceneBackground=a};b.prototype.assignEnvironmentMap=function(a){this._settings.getSetting("environmentMapAsBackground")&&(this._sceneBackground=a.map);for(var b=this._handlers.threeDManager.helpers.getMaterials(),d=0,e=b.length;d<e;d++){var g=b[d];"ShapeDiverStandardMaterial"==g.type?(g.envMap=a.map,g.needsUpdate=!0):"ShapeDiverGemMaterial"!=
   g.type||g.customEnvMap||(g.envMap=a.map)}this._environmentMap=a.map;this._handlers.renderingHandler.render()};b.prototype.environmentMapAsBackgroundHook=function(a){if(!GLOBAL_UTILS$$module$src$3d$viewport$handlers$MaterialHandler.typeCheck(a,"boolean",this._handlers.threeDManager.warn,"MaterialHandler.Hook->environmentMapAsBackground"))return!1;if(this._handlers.threeDManager.getSetting("groundPlaneReflectionVisibility")&&a)return this._handlers.threeDManager.warn("MaterialHandler.Hook->environmentMapAsBackground",
   "The ground plane reflection and the environment as background do not work together right now."),!1;this._sceneBackground=a?this._environmentMap:null;this._handlers.renderingHandler.render();return!0};b.prototype.environmentMapHook=function(a,b){return __awaiter$$module$src$3d$viewport$handlers$MaterialHandler(this,void 0,void 0,function(){var c,e,g,h,f,k,l,m,n,q,p,u,t;return __generator$$module$src$3d$viewport$handlers$MaterialHandler(this,function(d){switch(d.label){case 0:c="MaterialHandler.setEnvironmentMap";
   if(void 0===a)return this._handlers.threeDManager.warn(c,"No input was provided, the environment map was not set."),[2,Promise.resolve(!1)];if("none"===a)return this.assignEnvironmentMap({name:"none",map:null}),[2,Promise.resolve(!0)];if(GLOBAL_UTILS$$module$src$3d$viewport$handlers$MaterialHandler.typeCheck(a,"string")&&a.startsWith('["https')&&a.endsWith('"]')){f=a;try{a=JSON.parse(f)}catch(v){a=f}}k=b||this._settings.getSetting("environmentMapResolution");if(GLOBAL_UTILS$$module$src$3d$viewport$handlers$MaterialHandler.typeCheck(a,
   "string"))e=a.toLowerCase().replace(/ /g,"_"),g=e+k;else if(Array.isArray(a)){h=a;if(6!==h.length)return this._handlers.threeDManager.warn(c,"The number of URLs was not 6, the environment map was not set."),[2,Promise.resolve(!1)];g=e=JSON.stringify(h,null,0)}try{for(l=__values$$module$src$3d$viewport$handlers$MaterialHandler(this._usedEnvironmentMaps),m=l.next();!m.done;m=l.next())if(n=m.value,n.name===g)return this.assignEnvironmentMap(n),[2,Promise.resolve(!0)]}catch(v){u={error:v}}finally{try{m&&
   !m.done&&(t=l.return)&&t.call(l)}finally{if(u)throw u.error;}}if(void 0===h)if(h=[],q=void 0,0<=this._envMapNamesJPG.indexOf(e))for(q=0;q<this._envMapFilenames.length;q++)h.push(this._envMapUrlPrefix+k+"/"+e+"/"+this._envMapFilenames[q]+".jpg");else if(0<=this._envMapNamesPNG.indexOf(e))for(q=0;q<this._envMapFilenames.length;q++)h.push(this._envMapUrlPrefix+k+"/"+e+"/"+this._envMapFilenames[q]+".png");else if(a.startsWith("https://")||a.startsWith("http://"))for(a.endsWith("/")||(a+="/"),q=0;q<this._envMapFilenames.length;q++)h.push(a+
   this._envMapFilenames[q]+".jpg");else return"none"!==a&&this._handlers.threeDManager.warn(c,"Environment map name not found, and not a base URL",a),[2,Promise.resolve(!1)];d.label=1;case 1:return d.trys.push([1,3,,4]),[4,this.loadEnvironmentMap(g,h)];case 2:return p=d.sent(),this._usedEnvironmentMaps.push(p),this.assignEnvironmentMap(p),[2,Promise.resolve(!0)];case 3:return d.sent(),this._handlers.threeDManager.warn(c,"Was not able to load the environment map, the environment map was not set."),[2,
   Promise.resolve(!1)];case 4:return[2]}})})};b.prototype.environmentMapResolutionHook=function(a){if(!["256","512","1024","2048"].includes(a))return this._handlers.threeDManager.warn("MaterialHandler.setEnvironmentMapResolution","No valid input was provided, the environment map was not changed."),Promise.resolve(!1);var b=this._settings.getSetting("environmentMap");return"none"===b?Promise.resolve(!0):this.environmentMapHook(b,a)};b.prototype.getTransformationPath=function(a){a=this._pathUtils.getObjectPath(a);
   return a.substring(0,a.indexOf(".",a.indexOf("transformation_")))};b.prototype.loadEnvironmentMap=function(a,b){return new Promise(function(c,e){(new THREE$$module$src$3d$viewport$handlers$MaterialHandler.CubeTextureLoader).load(b,function(b){b.format=THREE$$module$src$3d$viewport$handlers$MaterialHandler.RGBFormat;b.mapping=THREE$$module$src$3d$viewport$handlers$MaterialHandler.CubeReflectionMapping;this._mipmapBlackListed&&(b.generateMipmaps=!1,b.minFilter=THREE$$module$src$3d$viewport$handlers$MaterialHandler.LinearFilter,
   b.magFilter=THREE$$module$src$3d$viewport$handlers$MaterialHandler.LinearFilter);c({name:a,map:b})},null,function(a){e(a)})})};return b}();
   module$src$3d$viewport$handlers$MaterialHandler.default.MaterialHandler=function(){function b(a,b){this._materialHandlerInstance=new MaterialHandlerInsance$$module$src$3d$viewport$handlers$MaterialHandler(a,b)}b.prototype.adjustToBoundingSphere=function(a){this._materialHandlerInstance.adjustToBoundingSphere(a)};b.prototype.compile=function(){this._materialHandlerInstance.compile()};b.prototype.destroy=function(){this._materialHandlerInstance.destroy()};b.prototype.getEnvironmentMap=function(){return this._materialHandlerInstance.getEnvironmentMap()};
   b.prototype.getMaterial=function(a,b,d,e,g){return this._materialHandlerInstance.getMaterial(a,b,d,e,g)};b.prototype.getSceneBackground=function(){return this._materialHandlerInstance.getSceneBackground()};b.prototype.getSimpleMaterial=function(a){return this._materialHandlerInstance.getSimpleMaterial(a)};b.prototype.pause=function(){this._materialHandlerInstance.pause()};b.prototype.resume=function(){this._materialHandlerInstance.resume()};b.prototype.setSceneBackground=function(a){this._materialHandlerInstance.setSceneBackground(a)};
   return b}();var module$src$3d$viewport$interfaces$ICameraHandler={default:{}};Object.defineProperty(module$src$3d$viewport$interfaces$ICameraHandler.default,"__esModule",{value:!0});var CameraType$$module$src$3d$viewport$interfaces$ICameraHandler;
   (function(b){b[b.MIN=0]="MIN";b[b.PERSPECTIVE=0]="PERSPECTIVE";b[b.TOP=1]="TOP";b[b.BOTTOM=2]="BOTTOM";b[b.RIGHT=3]="RIGHT";b[b.LEFT=4]="LEFT";b[b.BACK=5]="BACK";b[b.FRONT=6]="FRONT";b[b.AR=7]="AR";b[b.MAX=7]="MAX"})(CameraType$$module$src$3d$viewport$interfaces$ICameraHandler=module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType||(module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType={}));var ControlType$$module$src$3d$viewport$interfaces$ICameraHandler;
   (function(b){b[b.MIN=0]="MIN";b[b.ORBIT=0]="ORBIT";b[b.FPS=1]="FPS";b[b.ORTHOGRAPHIC=2]="ORTHOGRAPHIC";b[b.MAX=2]="MAX"})(ControlType$$module$src$3d$viewport$interfaces$ICameraHandler=module$src$3d$viewport$interfaces$ICameraHandler.default.ControlType||(module$src$3d$viewport$interfaces$ICameraHandler.default.ControlType={}));var CameraEventType$$module$src$3d$viewport$interfaces$ICameraHandler;
   (function(b){b.CAMERA_START="start";b.CAMERA_MOVE="move";b.CAMERA_END="end"})(CameraEventType$$module$src$3d$viewport$interfaces$ICameraHandler=module$src$3d$viewport$interfaces$ICameraHandler.default.CameraEventType||(module$src$3d$viewport$interfaces$ICameraHandler.default.CameraEventType={}));var module$node_modules$detect_hover$lib$index={default:{}};Object.defineProperty(module$node_modules$detect_hover$lib$index.default,"__esModule",{value:!0});
   module$node_modules$detect_hover$lib$index.default.default={update:function(){"undefined"!==typeof window&&"function"===typeof window.matchMedia&&(module$node_modules$detect_hover$lib$index.default.default.hover=window.matchMedia("(hover: hover)").matches,module$node_modules$detect_hover$lib$index.default.default.none=window.matchMedia("(hover: none)").matches||window.matchMedia("(hover: on-demand)").matches,module$node_modules$detect_hover$lib$index.default.default.anyHover=window.matchMedia("(any-hover: hover)").matches,
   module$node_modules$detect_hover$lib$index.default.default.anyNone=window.matchMedia("(any-hover: none)").matches||window.matchMedia("(any-hover: on-demand)").matches)}};module$node_modules$detect_hover$lib$index.default.default.update();var module$node_modules$detect_pointer$lib$index={default:{}};Object.defineProperty(module$node_modules$detect_pointer$lib$index.default,"__esModule",{value:!0});
   module$node_modules$detect_pointer$lib$index.default.default={update:function(){"undefined"!==typeof window&&"function"===typeof window.matchMedia&&(module$node_modules$detect_pointer$lib$index.default.default.fine=window.matchMedia("(pointer: fine)").matches,module$node_modules$detect_pointer$lib$index.default.default.coarse=window.matchMedia("(pointer: coarse)").matches,module$node_modules$detect_pointer$lib$index.default.default.none=window.matchMedia("(pointer: none)").matches,module$node_modules$detect_pointer$lib$index.default.default.anyFine=
   window.matchMedia("(any-pointer: fine)").matches,module$node_modules$detect_pointer$lib$index.default.default.anyCoarse=window.matchMedia("(any-pointer: coarse)").matches,module$node_modules$detect_pointer$lib$index.default.default.anyNone=window.matchMedia("(any-pointer: none)").matches)}};module$node_modules$detect_pointer$lib$index.default.default.update();var module$node_modules$detect_touch_events$lib$index={default:{}};Object.defineProperty(module$node_modules$detect_touch_events$lib$index.default,"__esModule",{value:!0});module$node_modules$detect_touch_events$lib$index.default.default={update:function(){"undefined"!==typeof window&&(module$node_modules$detect_touch_events$lib$index.default.default.hasSupport="ontouchstart"in window,module$node_modules$detect_touch_events$lib$index.default.default.browserSupportsApi=!!window.TouchEvent)}};module$node_modules$detect_touch_events$lib$index.default.default.update();var module$node_modules$detect_passive_events$lib$index={default:{}};Object.defineProperty(module$node_modules$detect_passive_events$lib$index.default,"__esModule",{value:!0});
   module$node_modules$detect_passive_events$lib$index.default.default={update:function(){if("undefined"!==typeof window&&"function"===typeof window.addEventListener){var b=!1,a=Object.defineProperty({},"passive",{get:function(){b=!0}}),c=function(){};window.addEventListener("testPassiveEventSupport",c,a);window.removeEventListener("testPassiveEventSupport",c,a);module$node_modules$detect_passive_events$lib$index.default.default.hasSupport=b}}};module$node_modules$detect_passive_events$lib$index.default.default.update();var module$node_modules$detect_it$lib$index={default:{}};Object.defineProperty(module$node_modules$detect_it$lib$index.default,"__esModule",{value:!0});
   var _detectHover$$module$node_modules$detect_it$lib$index=module$node_modules$detect_hover$lib$index.default,_detectHover2$$module$node_modules$detect_it$lib$index=_interopRequireDefault$$module$node_modules$detect_it$lib$index(module$node_modules$detect_hover$lib$index.default),_detectPointer$$module$node_modules$detect_it$lib$index=module$node_modules$detect_pointer$lib$index.default,_detectPointer2$$module$node_modules$detect_it$lib$index=_interopRequireDefault$$module$node_modules$detect_it$lib$index(module$node_modules$detect_pointer$lib$index.default),
   _detectTouchEvents$$module$node_modules$detect_it$lib$index=module$node_modules$detect_touch_events$lib$index.default,_detectTouchEvents2$$module$node_modules$detect_it$lib$index=_interopRequireDefault$$module$node_modules$detect_it$lib$index(module$node_modules$detect_touch_events$lib$index.default),_detectPassiveEvents$$module$node_modules$detect_it$lib$index=module$node_modules$detect_passive_events$lib$index.default,_detectPassiveEvents2$$module$node_modules$detect_it$lib$index=_interopRequireDefault$$module$node_modules$detect_it$lib$index(module$node_modules$detect_passive_events$lib$index.default);
   function _interopRequireDefault$$module$node_modules$detect_it$lib$index(b){return b&&b.__esModule?b:{default:b}}
   function determineDeviceType$$module$node_modules$detect_it$lib$index(b,a,c,d){return b&&(a||c)?"hybrid":b&&Object.keys(d.detectHover).filter(function(a){return"update"!==a}).every(function(a){return!1===d.detectHover[a]})&&Object.keys(d.detectPointer).filter(function(a){return"update"!==a}).every(function(a){return!1===d.detectPointer[a]})?window.navigator&&/android/.test(window.navigator.userAgent.toLowerCase())?"touchOnly":"hybrid":b?"touchOnly":"mouseOnly"}
   module$node_modules$detect_it$lib$index.default.default={state:{detectHover:_detectHover2$$module$node_modules$detect_it$lib$index.default,detectPointer:_detectPointer2$$module$node_modules$detect_it$lib$index.default,detectTouchEvents:_detectTouchEvents2$$module$node_modules$detect_it$lib$index.default,detectPassiveEvents:_detectPassiveEvents2$$module$node_modules$detect_it$lib$index.default},update:function(){module$node_modules$detect_it$lib$index.default.default.state.detectHover.update();module$node_modules$detect_it$lib$index.default.default.state.detectPointer.update();
   module$node_modules$detect_it$lib$index.default.default.state.detectTouchEvents.update();module$node_modules$detect_it$lib$index.default.default.state.detectPassiveEvents.update();module$node_modules$detect_it$lib$index.default.default.updateOnlyOwnProperties()},updateOnlyOwnProperties:function(){if("undefined"!==typeof window){module$node_modules$detect_it$lib$index.default.default.passiveEvents=module$node_modules$detect_it$lib$index.default.default.state.detectPassiveEvents.hasSupport||!1;module$node_modules$detect_it$lib$index.default.default.hasTouch=
   module$node_modules$detect_it$lib$index.default.default.state.detectTouchEvents.hasSupport||!1;module$node_modules$detect_it$lib$index.default.default.deviceType=determineDeviceType$$module$node_modules$detect_it$lib$index(module$node_modules$detect_it$lib$index.default.default.hasTouch,module$node_modules$detect_it$lib$index.default.default.state.detectHover.anyHover,module$node_modules$detect_it$lib$index.default.default.state.detectPointer.anyFine,module$node_modules$detect_it$lib$index.default.default.state);
   module$node_modules$detect_it$lib$index.default.default.hasMouse="touchOnly"!==module$node_modules$detect_it$lib$index.default.default.deviceType;module$node_modules$detect_it$lib$index.default.default.primaryInput="mouseOnly"===module$node_modules$detect_it$lib$index.default.default.deviceType&&"mouse"||"touchOnly"===module$node_modules$detect_it$lib$index.default.default.deviceType&&"touch"||module$node_modules$detect_it$lib$index.default.default.state.detectPointer.fine&&"mouse"||module$node_modules$detect_it$lib$index.default.default.state.detectPointer.coarse&&
   "touch"||"mouse";var b;if(b=/windows/.test(window.navigator.userAgent.toLowerCase())&&/chrome/.test(window.navigator.userAgent.toLowerCase()))b=parseInt(/Chrome\/([0-9.]+)/.exec(navigator.userAgent)[1],10),b=59<=b&&62>b;b&&module$node_modules$detect_it$lib$index.default.default.hasTouch&&(module$node_modules$detect_it$lib$index.default.default.deviceType="hybrid",module$node_modules$detect_it$lib$index.default.default.hasMouse=!0,module$node_modules$detect_it$lib$index.default.default.primaryInput=
   "mouse")}}};module$node_modules$detect_it$lib$index.default.default.updateOnlyOwnProperties();var module$src$3d$viewport$helpers$HooksAndNotifiers={default:{}};Object.defineProperty(module$src$3d$viewport$helpers$HooksAndNotifiers.default,"__esModule",{value:!0});module$src$3d$viewport$helpers$HooksAndNotifiers.default.registerHooksAndNotifiers=function(b,a,c,d){for(var e in c)a.registerHook(e,c[e].bind(b));for(e in d)a.registerNotifier(e,d[e].bind(b))};var module$src$3d$viewport$handlers$camera$hooks$CameraHooksAndNotifiers={default:{}};Object.defineProperty(module$src$3d$viewport$handlers$camera$hooks$CameraHooksAndNotifiers.default,"__esModule",{value:!0});var StateDashboard_1$$module$src$3d$viewport$handlers$camera$hooks$CameraHooksAndNotifiers=module$src$modules$shapediver_state_dashboard$StateDashboard.default,ICameraHandler_1$$module$src$3d$viewport$handlers$camera$hooks$CameraHooksAndNotifiers=module$src$3d$viewport$interfaces$ICameraHandler.default;
   module$src$3d$viewport$handlers$camera$hooks$CameraHooksAndNotifiers.default.CameraHooks={autoAdjust:function(b){var a=this;if(!this._globalUtils.typeCheck(b,"boolean",this._handlers.threeDManager.warn,"CameraHandler.Hook->autoAdjust"))return!1;b&&!this._autoAdjustEventListenerToken&&(this._autoAdjustEventListenerToken=this._handlers.threeDManager.viewerApi.scene.addEventListener(this._handlers.threeDManager.viewerApi.scene.EVENTTYPE.SUBSCENE_PUBLISHED,function(){a._settings.getSetting("autoAdjust")&&
   a._handlers.threeDManager.getSetting("show")&&a.zoomExtents({default:!0})}));return!0},cameraMovementDuration:function(b){return!0},enableCameraControls:function(b){if(!this._globalUtils.typeCheck(b,"boolean",this._handlers.threeDManager.warn,"CameraHandler.Hook->enableCameraControls"))return!1;this._cameraControls.enabled=b;return!0},revertAtMouseUp:function(b){var a=this;if(!this._globalUtils.typeCheck(b,"boolean",this._handlers.threeDManager.warn,"CameraHandler.Hook->revertAtMouseUp"))return!1;
   b=this._handlers.renderingHandler.getDomElement();this._revertAtMouseUpEventListenerToken||(this._revertAtMouseUpEventListenerToken=b.addEventListener("mouseup",function(){a._settings.getSetting("revertAtMouseUp")&&a.resetPositionAndTarget({duration:a._settings.getSetting("revertAtMouseUpDuration")})},this._detect_it.passiveEvents?{capture:!1,passive:!0}:!1));this._revertAtMouseOutEventListenerToken||(this._revertAtMouseOutEventListenerToken=b.addEventListener("mouseout",function(){a._settings.getSetting("revertAtMouseUp")&&
   a.resetPositionAndTarget({duration:a._settings.getSetting("revertAtMouseUpDuration")})},this._detect_it.passiveEvents?{capture:!1,passive:!0}:!1));this._revertAtTouchEndEventListenerToken||(this._revertAtTouchEndEventListenerToken=b.addEventListener("touchend",function(){a._settings.getSetting("revertAtMouseUp")&&a.resetPositionAndTarget({duration:a._settings.getSetting("revertAtMouseUpDuration")})},this._detect_it.passiveEvents?{capture:!1,passive:!0}:!1));if(!this._revertAtMouseWheelEventListenerToken){var c=
   0,d=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";this._revertAtMouseWheelEventListenerToken=b.addEventListener(d,function(){clearTimeout(c);a._settings.getSetting("revertAtMouseUp")&&(c=setTimeout(function(){a.resetPositionAndTarget({duration:a._settings.getSetting("revertAtMouseUpDuration")})},300))},this._detect_it.passiveEvents?{capture:!1,passive:!0}:!1)}return!0},revertAtMouseUpDuration:function(b){return!0},zoomExtentsFactor:function(b){return!0},defaults:function(b){return this._settings.updateSetting("defaults.perspective",
   b.perspective)&&this._settings.updateSetting("defaults.orthographic",b.orthographic)},"defaults.perspective.position":function(b){return this._settings.updateSetting("cameraTypes.perspective.default.position",b)},"defaults.perspective.target":function(b){return this._settings.updateSetting("cameraTypes.perspective.default.target",b)},"defaults.perspective":function(b){5===b.position.x&&5===b.position.y&&5===b.position.z&&0===b.target.x&&0===b.target.y&&0===b.target.z&&(b.position={x:0,y:0,z:0});return this._settings.updateSetting("cameraTypes.perspective.default",
   b)},"defaults.orthographic.position":function(b){return this._settings.updateSetting("cameraTypes.orthographic.default.position",b)},"defaults.orthographic.target":function(b){return this._settings.updateSetting("cameraTypes.orthographic.default.target",b)},"defaults.orthographic":function(b){5===b.position.x&&5===b.position.y&&5===b.position.z&&0===b.target.x&&0===b.target.y&&0===b.target.z&&(b.position={x:0,y:0,z:0});return this._settings.updateSetting("cameraTypes.orthographic.default",b)},fov:function(b){return this._settings.updateSetting("cameraTypes.perspective.fov",
   b)},type:function(b){return this._settings.updateSetting("cameraTypes.active",b)},autoRotationSpeed:function(b){return this._settings.updateSetting("controls.orbit.autoRotationSpeed",b)},damping:function(b){return this._settings.updateSetting("controls.orbit.damping",b)},enableAutoRotation:function(b){return this._settings.updateSetting("controls.orbit.enableAutoRotation",b)},enableKeyPan:function(b){return this._settings.updateSetting("controls.orbit.enableKeyPan",b)},enablePan:function(b){return this._settings.updateSetting("controls.orbit.enablePan",
   b)},enableRotation:function(b){return this._settings.updateSetting("controls.orbit.enableRotation",b)},enableZoom:function(b){return this._settings.updateSetting("controls.orbit.enableZoom",b)},keyPanSpeed:function(b){return this._settings.updateSetting("controls.orbit.keyPanSpeed",b)},"restrictions.position.cube.min":function(b){return this._settings.updateSetting("controls.orbit.restrictions.position.cube.min",b)},"restrictions.position.cube.max":function(b){return this._settings.updateSetting("controls.orbit.restrictions.position.cube.max",
   b)},"restrictions.position.cube":function(b){return this._settings.updateSetting("controls.orbit.restrictions.position.cube",b)},"restrictions.position.sphere.center":function(b){return this._settings.updateSetting("controls.orbit.restrictions.position.sphere.center",b)},"restrictions.position.sphere.radius":function(b){return this._settings.updateSetting("controls.orbit.restrictions.position.sphere.radius",b)},"restrictions.position.sphere":function(b){return this._settings.updateSetting("controls.orbit.restrictions.position.sphere",
   b)},"restrictions.target.cube.min":function(b){return this._settings.updateSetting("controls.orbit.restrictions.target.cube.min",b)},"restrictions.target.cube.max":function(b){return this._settings.updateSetting("controls.orbit.restrictions.target.cube.max",b)},"restrictions.target.cube":function(b){return this._settings.updateSetting("controls.orbit.restrictions.target.cube",b)},"restrictions.target.sphere.center":function(b){return this._settings.updateSetting("controls.orbit.restrictions.target.sphere.center",
   b)},"restrictions.target.sphere.radius":function(b){return this._settings.updateSetting("controls.orbit.restrictions.target.sphere.radius",b)},"restrictions.target.sphere":function(b){return this._settings.updateSetting("controls.orbit.restrictions.target.sphere",b)},"restrictions.rotation.minPolarAngle":function(b){return this._settings.updateSetting("controls.orbit.restrictions.rotation.minPolarAngle",b)},"restrictions.rotation.maxPolarAngle":function(b){return this._settings.updateSetting("controls.orbit.restrictions.rotation.maxPolarAngle",
   b)},"restrictions.rotation.minAzimuthAngle":function(b){return this._settings.updateSetting("controls.orbit.restrictions.rotation.minAzimuthAngle",b)},"restrictions.rotation.maxAzimuthAngle":function(b){return this._settings.updateSetting("controls.orbit.restrictions.rotation.maxAzimuthAngle",b)},"restrictions.rotation":function(b){return this._settings.updateSetting("controls.orbit.restrictions.rotation",b)},"restrictions.zoom.minDistance":function(b){return this._settings.updateSetting("controls.orbit.restrictions.zoom.minDistance",
   b)},"restrictions.zoom.maxDistance":function(b){return this._settings.updateSetting("controls.orbit.restrictions.zoom.maxDistance",b)},"restrictions.zoom":function(b){return this._settings.updateSetting("controls.orbit.restrictions.zoom",b)},rotationSpeed:function(b){return this._settings.updateSetting("controls.orbit.rotationSpeed",b)},panSpeed:function(b){return this._settings.updateSetting("controls.orbit.panSpeed",b)},zoomSpeed:function(b){return this._settings.updateSetting("controls.orbit.zoomSpeed",
   b)}};
   module$src$3d$viewport$handlers$camera$hooks$CameraHooksAndNotifiers.default.CameraNotifiers={zoomExtentsFactor:function(){var b,a=module$src$modules$shapediver_state_dashboard$StateDashboard.default.StateDashboardLibrary.getInstance(this._handlers.threeDManager.viewerApi.getSetting("viewerRuntimeId"));a.firstTimeVisible.resolved&&a.settingsLoaded.resolved&&null!==(b=a.getCustomState(this._handlers.threeDManager.api.getViewportRuntimeId()+"_settingsRestored"))&&void 0!==b&&b.resolved&&(b=this.getPositionAndTarget(),(this._settings.getSetting("cameraTypes.active")!==
   module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType.PERSPECTIVE||0!==b.position.x||0!==b.position.y||0!==b.position.z||0!==b.target.x||0!==b.target.y||0!==b.target.z)&&this._active&&this.zoomExtents())},"cameraTypes.active":function(){return this._settings.forceSetting("type",this._settings.getSetting("cameraTypes.active"))},"cameraTypes.perspective.default.position":function(){return this._settings.forceSetting("defaults.perspective.position",this._settings.getSetting("cameraTypes.perspective.default.position"))},
   "cameraTypes.perspective.default.target":function(){return this._settings.forceSetting("defaults.perspective.target",this._settings.getSetting("cameraTypes.perspective.default.target"))},"cameraTypes.perspective.default":function(){return this._settings.forceSetting("defaults.perspective",this._settings.getSetting("cameraTypes.perspective.default"))},"cameraTypes.orthographic.default.position":function(){return this._settings.forceSetting("defaults.orthographic.position",this._settings.getSetting("cameraTypes.orthographic.default.position"))},
   "cameraTypes.orthographic.default.target":function(){return this._settings.forceSetting("defaults.orthographic.target",this._settings.getSetting("cameraTypes.orthographic.default.target"))},"cameraTypes.orthographic.default":function(){return this._settings.forceSetting("defaults.orthographic",this._settings.getSetting("cameraTypes.orthographic.default"))},"cameraTypes.perspective.fov":function(){return this._settings.forceSetting("fov",this._settings.getSetting("cameraTypes.perspective.fov"))},"controls.orbit.autoRotationSpeed":function(){return this._settings.forceSetting("autoRotationSpeed",
   this._settings.getSetting("controls.orbit.autoRotationSpeed"))},"controls.orbit.damping":function(){return this._settings.forceSetting("damping",this._settings.getSetting("controls.orbit.damping"))},"controls.orbit.controls.orbit.enableAutoRotation":function(){return this._settings.forceSetting("enableAutoRotation",this._settings.getSetting("controls.orbit.enableAutoRotation"))},"controls.orbit.enableKeyPan":function(){return this._settings.forceSetting("enableKeyPan",this._settings.getSetting("controls.orbit.enableKeyPan"))},
   "controls.orbit.enablePan":function(){return this._settings.forceSetting("enablePan",this._settings.getSetting("controls.orbit.enablePan"))},"controls.orbit.enableRotation":function(){return this._settings.forceSetting("enableRotation",this._settings.getSetting("controls.orbit.enableRotation"))},"controls.orbit.enableZoom":function(){return this._settings.forceSetting("enableZoom",this._settings.getSetting("controls.orbit.enableZoom"))},"controls.orbit.keyPanSpeed":function(){return this._settings.forceSetting("keyPanSpeed",
   this._settings.getSetting("controls.orbit.keyPanSpeed"))},"controls.orbit.restrictions.position.cube.min":function(){return this._settings.forceSetting("restrictions.position.cube.min",this._settings.getSetting("controls.orbit.restrictions.position.cube.min"))},"controls.orbit.restrictions.position.cube.max":function(){return this._settings.forceSetting("restrictions.position.cube.max",this._settings.getSetting("controls.orbit.restrictions.position.cube.max"))},"controls.orbit.restrictions.position.cube":function(){return this._settings.forceSetting("restrictions.position.cube",
   this._settings.getSetting("controls.orbit.restrictions.position.cube"))},"controls.orbit.restrictions.position.sphere.center":function(){return this._settings.forceSetting("restrictions.position.sphere.center",this._settings.getSetting("controls.orbit.restrictions.position.sphere.center"))},"controls.orbit.restrictions.position.sphere.radius":function(){return this._settings.forceSetting("restrictions.position.sphere.radius",this._settings.getSetting("controls.orbit.restrictions.position.sphere.radius"))},
   "controls.orbit.restrictions.position.sphere":function(){return this._settings.forceSetting("restrictions.position.sphere",this._settings.getSetting("controls.orbit.restrictions.position.sphere"))},"controls.orbit.restrictions.target.cube.min":function(){return this._settings.forceSetting("restrictions.target.cube.min",this._settings.getSetting("controls.orbit.restrictions.target.cube.min"))},"controls.orbit.restrictions.target.cube.max":function(){return this._settings.forceSetting("restrictions.target.cube.max",
   this._settings.getSetting("controls.orbit.restrictions.target.cube.max"))},"controls.orbit.restrictions.target.cube":function(){return this._settings.forceSetting("restrictions.target.cube",this._settings.getSetting("controls.orbit.restrictions.target.cube"))},"controls.orbit.restrictions.target.sphere.center":function(){return this._settings.forceSetting("restrictions.target.sphere.center",this._settings.getSetting("controls.orbit.restrictions.target.sphere.center"))},"controls.orbit.restrictions.target.sphere.radius":function(){return this._settings.forceSetting("restrictions.target.sphere.radius",
   this._settings.getSetting("controls.orbit.restrictions.target.sphere.radius"))},"controls.orbit.restrictions.target.sphere":function(){return this._settings.forceSetting("restrictions.target.sphere",this._settings.getSetting("controls.orbit..restrictions.target.sphere"))},"controls.orbit.restrictions.rotation.minPolarAngle":function(){return this._settings.forceSetting("restrictions.rotation.minPolarAngle",this._settings.getSetting("controls.orbit.restrictions.rotation.minPolarAngle"))},"controls.orbit.restrictions.rotation.maxPolarAngle":function(){return this._settings.forceSetting("restrictions.rotation.maxPolarAngle",
   this._settings.getSetting("controls.orbit.restrictions.rotation.maxPolarAngle"))},"controls.orbit.restrictions.rotation.minAzimuthAngle":function(){return this._settings.forceSetting("restrictions.rotation.minAzimuthAngle",this._settings.getSetting("controls.orbit.restrictions.rotation.minAzimuthAngle"))},"controls.orbit.restrictions.rotation.maxAzimuthAngle":function(){return this._settings.forceSetting("restrictions.rotation.maxAzimuthAngle",this._settings.getSetting("controls.orbit.restrictions.rotation.maxAzimuthAngle"))},
   "controls.orbit.restrictions.rotation":function(){return this._settings.forceSetting("restrictions.rotation",this._settings.getSetting("controls.orbit.restrictions.rotation"))},"controls.orbit.restrictions.zoom.minDistance":function(){return this._settings.forceSetting("restrictions.zoom.minDistance",this._settings.getSetting("controls.orbit.restrictions.zoom.minDistance"))},"controls.orbit.restrictions.zoom.maxDistance":function(){return this._settings.forceSetting("restrictions.zoom.maxDistance",
   this._settings.getSetting("controls.orbit.restrictions.zoom.maxDistance"))},"controls.orbit.restrictions.zoom":function(){return this._settings.forceSetting("restrictions.zoom",this._settings.getSetting("controls.orbit.restrictions.zoom"))},"controls.orbit.rotationSpeed":function(){return this._settings.forceSetting("rotationSpeed",this._settings.getSetting("controls.orbit.rotationSpeed"))},"controls.orbit.panSpeed":function(){return this._settings.forceSetting("panSpeed",this._settings.getSetting("controls.orbit.panSpeed"))},
   "controls.orbit.zoomSpeed":function(){return this._settings.forceSetting("zoomSpeed",this._settings.getSetting("controls.orbit.zoomSpeed"))}};var module$src$3d$viewport$handlers$camera$BaseCameraHandler={default:{}},__importDefault$$module$src$3d$viewport$handlers$camera$BaseCameraHandler=this&&module$src$3d$viewport$handlers$camera$BaseCameraHandler.default.__importDefault||function(b){return b&&b.__esModule?b:{"default":b}};Object.defineProperty(module$src$3d$viewport$handlers$camera$BaseCameraHandler.default,"__esModule",{value:!0});
   var THREE$$module$src$3d$viewport$handlers$camera$BaseCameraHandler=module$src$externals$three.default,MessagingConstants_1$$module$src$3d$viewport$handlers$camera$BaseCameraHandler=__importDefault$$module$src$3d$viewport$handlers$camera$BaseCameraHandler(module$src$shared$constants$MessagingConstants.default),MessagePrototype_1$$module$src$3d$viewport$handlers$camera$BaseCameraHandler=__importDefault$$module$src$3d$viewport$handlers$camera$BaseCameraHandler(module$src$shared$messages$MessagePrototype.default),
   GlobalUtils_js_1$$module$src$3d$viewport$handlers$camera$BaseCameraHandler=__importDefault$$module$src$3d$viewport$handlers$camera$BaseCameraHandler(module$src$shared$util$GlobalUtils.default),detect_it_1$$module$src$3d$viewport$handlers$camera$BaseCameraHandler=__importDefault$$module$src$3d$viewport$handlers$camera$BaseCameraHandler(module$node_modules$detect_it$lib$index.default),HooksAndNotifiers_1$$module$src$3d$viewport$handlers$camera$BaseCameraHandler=module$src$3d$viewport$helpers$HooksAndNotifiers.default,
   CameraHooksAndNotifiers_1$$module$src$3d$viewport$handlers$camera$BaseCameraHandler=module$src$3d$viewport$handlers$camera$hooks$CameraHooksAndNotifiers.default,StateDashboard_1$$module$src$3d$viewport$handlers$camera$BaseCameraHandler=module$src$modules$shapediver_state_dashboard$StateDashboard.default;
   module$src$3d$viewport$handlers$camera$BaseCameraHandler.default.BaseCameraHandler=function(){function b(a,b){this._handlers=b;this._active=!0;this._cameraMatrix=new module$src$externals$three.default.Matrix4;this._eventListenerCounter=0;this.TWEEN_ID=this.CAMERA_MOVING_ID="cameraMoving";this._detect_it=detect_it_1$$module$src$3d$viewport$handlers$camera$BaseCameraHandler.default;this._globalUtils=GlobalUtils_js_1$$module$src$3d$viewport$handlers$camera$BaseCameraHandler.default;this._settings=a.settings;
   this._geometryNode=a.geometryNode;this._container=a.container;this._sceneBS=new module$src$externals$three.default.Sphere(new module$src$externals$three.default.Vector3,1);this._firstTimeVisible=module$src$modules$shapediver_state_dashboard$StateDashboard.default.StateDashboardLibrary.getInstance(b.threeDManager.viewerApi.getSetting("viewerRuntimeId")).firstTimeVisible;module$src$3d$viewport$helpers$HooksAndNotifiers.default.registerHooksAndNotifiers(this,this._settings,module$src$3d$viewport$handlers$camera$hooks$CameraHooksAndNotifiers.default.CameraHooks,
   module$src$3d$viewport$handlers$camera$hooks$CameraHooksAndNotifiers.default.CameraNotifiers)}Object.defineProperty(b.prototype,"camera",{get:function(){return this._camera},enumerable:!0,configurable:!0});b.prototype.decreaseEventListenerCounter=function(){this._eventListenerCounter--};b.prototype.destroy=function(){};b.prototype.getPositionAndTarget=function(){return{position:this._globalUtils.deepCopy(this._cameraControls.position),target:this._globalUtils.deepCopy(this._cameraControls.target)}};
   b.prototype.increaseEventListenerCounter=function(){this._eventListenerCounter++};b.prototype.pause=function(){this._active=!1;this._cameraControls.enabled=!1};b.prototype.resume=function(){this._active=!0;this._camera.updateProjectionMatrix();this._cameraControls.enabled=this._settings.getSetting("enableCameraControls");this._cameraControls.reset()};b.prototype.setViewAndProjectionMatrix=function(a,b){this._cameraMatrix.getInverse(a);this._cameraMatrix.decompose(this._camera.position,this._camera.quaternion,
   this._camera.scale);this._camera.projectionMatrix.copy(b)};b.prototype.updateCameraControls=function(a){this._settings.getSetting("enableCameraControls")&&(this._cameraControls.update(a),this._handlers.renderingHandler.unregisterForContinuousRendering(this.CAMERA_MOVING_ID),this._cameraControls.isMoving()&&this._handlers.renderingHandler.registerForContinuousRendering(this.CAMERA_MOVING_ID,!1))};b.prototype.cameraMovementEventDispatch=function(a,b,d){if(0!==this._eventListenerCounter){if(a)if(b)var c=
   MessagingConstants_1$$module$src$3d$viewport$handlers$camera$BaseCameraHandler.default.messageTopics.SCENE_CAMERA_MOVE;else d=0,c=MessagingConstants_1$$module$src$3d$viewport$handlers$camera$BaseCameraHandler.default.messageTopics.SCENE_CAMERA_START;else b&&(c=MessagingConstants_1$$module$src$3d$viewport$handlers$camera$BaseCameraHandler.default.messageTopics.SCENE_CAMERA_END);a=new MessagePrototype_1$$module$src$3d$viewport$handlers$camera$BaseCameraHandler.default(MessagingConstants_1$$module$src$3d$viewport$handlers$camera$BaseCameraHandler.default.messageDataTypes.SCENE_CAMERA,
   {type:c,cameraDefinition:{position:this._cameraControls.position,target:this._cameraControls.target},duration:d});this._handlers.threeDManager.message(c,a)}};return b}();var module$src$3d$viewport$handlers$camera$controls$fps$FPSLogic={default:{}};Object.defineProperty(module$src$3d$viewport$handlers$camera$controls$fps$FPSLogic.default,"__esModule",{value:!0});var THREE$$module$src$3d$viewport$handlers$camera$controls$fps$FPSLogic=module$src$externals$three.default;
   module$src$3d$viewport$handlers$camera$controls$fps$FPSLogic.default.FPSLogic=function(){function b(a){this._controls=a;this._keysPressed=[]}b.prototype.move=function(a){this._keysPressed=a;this._controls.applyPositionMatrix(new module$src$externals$three.default.Matrix4,!0);this._controls.applyTargetMatrix(new module$src$externals$three.default.Matrix4,!0)};b.prototype.reset=function(){this._keysPressed=[]};b.prototype.rotate=function(a,b){var c=new module$src$externals$three.default.Vector3;this._controls.camera.getWorldDirection(c);
   c.normalize();var e=(new module$src$externals$three.default.Vector3).crossVectors(this._controls.camera.up,c).normalize(),g=(new module$src$externals$three.default.Vector3).crossVectors(e,c).normalize(),h=this._controls.position,f=this._controls.target,k=h.distanceTo(f);c=c.clone();c.applyAxisAngle(g,Math.PI/180*a*.1);c.applyAxisAngle(e,Math.PI/180*b*.1);a=h.clone().add(c.multiplyScalar(k)).clone().sub(f);this._controls.applyTargetMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(a.x,
   a.y,a.z),!0)};b.prototype.update=function(a){var b=0,d=0,e=0;-1!==this._keysPressed.indexOf("w")&&d++;-1!==this._keysPressed.indexOf("a")&&b++;-1!==this._keysPressed.indexOf("s")&&d--; -1!==this._keysPressed.indexOf("d")&&b--; -1!==this._keysPressed.indexOf("shift")&&e--; -1!==this._keysPressed.indexOf("control")&&e++;if((0!==b||0!==d||0!==e)&&a){a/=16.6666;var g=new module$src$externals$three.default.Vector3;this._controls.camera.getWorldDirection(g);g.normalize();var h=(new module$src$externals$three.default.Vector3).crossVectors(this._controls.camera.up,
   g).normalize(),f=(new module$src$externals$three.default.Vector3).crossVectors(h,g).normalize();d=g.clone().multiplyScalar(a*d*.5);d.add(h.clone().multiplyScalar(a*b*.5));d.add(f.clone().multiplyScalar(a*e*.5));this._controls.applyPositionMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(d.x,d.y,d.z),!0);this._controls.applyTargetMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(d.x,d.y,d.z),!0)}};return b}();var module$src$3d$viewport$handlers$camera$controls$fps$FPSManager={default:{}};Object.defineProperty(module$src$3d$viewport$handlers$camera$controls$fps$FPSManager.default,"__esModule",{value:!0});var FPSLogic_1$$module$src$3d$viewport$handlers$camera$controls$fps$FPSManager=module$src$3d$viewport$handlers$camera$controls$fps$FPSLogic.default;
   module$src$3d$viewport$handlers$camera$controls$fps$FPSManager.default.FPSManager=function(){function b(a,b,d,e){var c=this;this._settings=a;this._cameraControls=b;this._triggerRender=d;this._logWarning=e;this._activeLock=!1;this._keysPressed=[];this._storedSettings={};this._cameraLogic=new module$src$3d$viewport$handlers$camera$controls$fps$FPSLogic.default.FPSLogic(this._cameraControls);document.addEventListener("pointerlockchange",function(a){c._activeLock=!c._activeLock},!1);document.addEventListener("keyup",
   function(a){a=c._keysPressed.indexOf(a.key.toLowerCase());-1<a&&(c._keysPressed.splice(a,1),c._cameraLogic.move(c._keysPressed))});this._cameraControls.registerCameraControls(this)}b.prototype.isWithinRestrictions=function(a,b){return!0};b.prototype.onKeyDown=function(a){-1===this._keysPressed.indexOf(a.key.toLowerCase())&&(this._keysPressed.push(a.key.toLowerCase()),this._cameraLogic.move(this._keysPressed))};b.prototype.onMouseDown=function(a){a.srcElement instanceof Element&&(!1===this._activeLock?
   a.srcElement.requestPointerLock():document.exitPointerLock())};b.prototype.onMouseMove=function(a){!0===this._activeLock&&this._cameraLogic.rotate(a.movementX,a.movementY)};b.prototype.onMouseUp=function(a){};b.prototype.onMouseWheel=function(a){};b.prototype.onTouchEnd=function(a){};b.prototype.onTouchMove=function(a){};b.prototype.onTouchStart=function(a){};b.prototype.reset=function(){this._keysPressed=[];this._cameraLogic.reset()};b.prototype.restrict=function(a,b){return{position:a,target:b}};
   b.prototype.update=function(a){this._cameraLogic.update(a)};return b}();var module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsEventDistribution={default:{}};Object.defineProperty(module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsEventDistribution.default,"__esModule",{value:!0});
   module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsEventDistribution.default.OrbitControlsEventDistribution=function(){function b(a,b,d){this._settings=a;this._controls=b;this._cameraLogic=d;this._active={rotation:!1,zoom:!1,pan:!1}}b.prototype.onDown=function(a){var b=this.convertInput(a),d=b.x;b=b.y;var e=window.TouchEvent&&a instanceof TouchEvent?a.touches.length:a.button,g=window.TouchEvent&&a instanceof TouchEvent?this._settings.getSetting("input").touch:this._settings.getSetting("input").mouse;
   e===g.rotate&&this._settings.getSetting("enableRotation")&&(this._cameraLogic.rotate(d,b,this._active.rotation,window.TouchEvent&&a instanceof TouchEvent),this._active.rotation=!0,this._active.pan=!1,this._active.zoom=!1);e===g.pan&&this._settings.getSetting("enablePan")&&(this._cameraLogic.pan(d,b,this._active.pan,window.TouchEvent&&a instanceof TouchEvent),this._active.rotation=!1,this._active.pan=!0,this._active.zoom=!1);e===g.zoom&&this._settings.getSetting("enableZoom")&&(window.TouchEvent&&
   a instanceof TouchEvent&&2===this._settings.getSetting("input").touch.zoom&&(d=(a.touches[0].pageX-a.touches[1].pageX)/window.innerWidth*(window.innerWidth/window.innerHeight),b=(a.touches[0].pageY-a.touches[1].pageY)/window.innerHeight),this._cameraLogic.zoom(d,b,this._active.zoom,window.TouchEvent&&a instanceof TouchEvent),this._active.rotation=!1,this._active.pan=!1,this._active.zoom=!0)};b.prototype.onKey=function(a){if(this._settings.getSetting("enableKeyPan"))switch(a.keyCode){case this._settings.getSetting("input").keys.up:this._cameraLogic.pan(0,
   0,!1,!1);this._cameraLogic.pan(0,.05*this._settings.getSetting("keyPanSpeed"),!0,!1);a.preventDefault();a.stopPropagation();break;case this._settings.getSetting("input").keys.down:this._cameraLogic.pan(0,0,!1,!1);this._cameraLogic.pan(0,.05*-this._settings.getSetting("keyPanSpeed"),!0,!1);a.preventDefault();a.stopPropagation();break;case this._settings.getSetting("input").keys.left:this._cameraLogic.pan(0,0,!1,!1);this._cameraLogic.pan(.05*this._settings.getSetting("keyPanSpeed"),0,!0,!1);a.preventDefault();
   a.stopPropagation();break;case this._settings.getSetting("input").keys.right:this._cameraLogic.pan(0,0,!1,!1),this._cameraLogic.pan(.05*-this._settings.getSetting("keyPanSpeed"),0,!0,!1),a.preventDefault(),a.stopPropagation()}};b.prototype.onKeyDown=function(a){this.onKey(a)};b.prototype.onMouseDown=function(a){this.onDown(a)};b.prototype.onMouseMove=function(a){this.onMove(a)};b.prototype.onMouseUp=function(a){this.onUp(a)};b.prototype.onMouseWheel=function(a){this.onWheel(a)};b.prototype.onMove=
   function(a){var b=this.convertInput(a),d=b.x;b=b.y;this._settings.getSetting("enableRotation")&&this._active.rotation&&this._cameraLogic.rotate(d,b,this._active.rotation,window.TouchEvent&&a instanceof TouchEvent);this._settings.getSetting("enablePan")&&this._active.pan&&this._cameraLogic.pan(d,b,this._active.pan,window.TouchEvent&&a instanceof TouchEvent);this._settings.getSetting("enableZoom")&&this._active.zoom&&(window.TouchEvent&&a instanceof TouchEvent&&2===this._settings.getSetting("input").touch.zoom&&
   (d=(a.touches[0].pageX-a.touches[1].pageX)/window.innerWidth*(window.innerWidth/window.innerHeight),b=(a.touches[0].pageY-a.touches[1].pageY)/window.innerHeight),this._cameraLogic.zoom(d,b,this._active.zoom,window.TouchEvent&&a instanceof TouchEvent))};b.prototype.onTouchEnd=function(a){this.onUp(a)};b.prototype.onTouchMove=function(a){this.onMove(a)};b.prototype.onTouchStart=function(a){this.onDown(a)};b.prototype.onUp=function(a){this._active.rotation=!1;this._active.zoom=!1;this._active.pan=!1};
   b.prototype.onWheel=function(a){if(this._settings.getSetting("enableZoom")){var b=0;void 0!==a.deltaY?b=-a.deltaY:void 0!==a.detail&&(b=-a.detail);0<Math.sign(b)?(this._cameraLogic.zoom(0,0,!1,!1),this._cameraLogic.zoom(1,0,!0,!1)):(this._cameraLogic.zoom(1,0,!1,!1),this._cameraLogic.zoom(0,0,!0,!1))}};b.prototype.reset=function(){this._active={rotation:!1,zoom:!1,pan:!1}};b.prototype.convertInput=function(a){var b=window.innerWidth/window.innerHeight;return a instanceof MouseEvent?{x:a.clientX/window.innerWidth*
   b,y:a.clientY/window.innerHeight}:{x:a.touches[0].pageX/window.innerWidth*b,y:a.touches[0].pageY/window.innerHeight}};return b}();var module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsLogic={default:{}};Object.defineProperty(module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsLogic.default,"__esModule",{value:!0});var THREE$$module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsLogic=module$src$externals$three.default;
   module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsLogic.default.OrbitControlsLogic=function(){function b(a,b){var c=this;this._settings=a;this._controls=b;this._damping={rotation:{time:0,duration:0,theta:0,phi:0},zoom:{time:0,duration:0,delta:0},pan:{time:0,duration:0,offset:new module$src$externals$three.default.Vector3}};this._dollyStart=this._dollyEnd=this._dollyDelta=0;this._panDelta=new module$src$externals$three.default.Vector2;this._panEnd=new module$src$externals$three.default.Vector2;
   this._panStart=new module$src$externals$three.default.Vector2;this._rotateDelta=new module$src$externals$three.default.Vector2;this._rotateEnd=new module$src$externals$three.default.Vector2;this._rotateStart=new module$src$externals$three.default.Vector2;this._settingsAdjustements={autoRotationSpeed:2*Math.PI/60/60,damping:1,movementSmoothness:1,panSpeed:2,rotationSpeed:Math.PI,zoomSpeed:.025};this._touchAdjustements={autoRotationSpeed:1,damping:1,movementSmoothness:1,panSpeed:1.5,rotationSpeed:2,
   zoomSpeed:100};this._quat=(new module$src$externals$three.default.Quaternion).setFromUnitVectors(new module$src$externals$three.default.Vector3(0,0,1),new module$src$externals$three.default.Vector3(0,1,0));this._quatInverse=this._quat.clone().inverse();this._adjustedSettings={autoRotationSpeed:this._settings.getSetting("autoRotationSpeed")*this._settingsAdjustements.autoRotationSpeed,damping:this._settings.getSetting("damping")*this._settingsAdjustements.damping,movementSmoothness:this._settings.getSetting("movementSmoothness")*
   this._settingsAdjustements.movementSmoothness,panSpeed:this._settings.getSetting("panSpeed")*this._settingsAdjustements.panSpeed,rotationSpeed:this._settings.getSetting("rotationSpeed")*this._settingsAdjustements.rotationSpeed,zoomSpeed:this._settings.getSetting("zoomSpeed")*this._settingsAdjustements.zoomSpeed};Object.keys(this._adjustedSettings).forEach(function(a){c._settings.registerHook(a,function(b){c._adjustedSettings[a]=b*c._settingsAdjustements[a];return!0})})}b.prototype.isWithinRestrictions=
   function(a,b){var c=this._settings.getSetting("restrictions.position.cube"),e=this._settings.getSetting("restrictions.position.sphere");c=new module$src$externals$three.default.Box3(new module$src$externals$three.default.Vector3(c.min.x,c.min.y,c.min.z),new module$src$externals$three.default.Vector3(c.max.x,c.max.y,c.max.z));e=new module$src$externals$three.default.Sphere(new module$src$externals$three.default.Vector3(e.center.x,e.center.y,e.center.z),e.radius);var g=this._settings.getSetting("restrictions.target.cube"),
   h=this._settings.getSetting("restrictions.target.sphere");g=new module$src$externals$three.default.Box3(new module$src$externals$three.default.Vector3(g.min.x,g.min.y,g.min.z),new module$src$externals$three.default.Vector3(g.max.x,g.max.y,g.max.z));h=new module$src$externals$three.default.Sphere(new module$src$externals$three.default.Vector3(h.center.x,h.center.y,h.center.z),h.radius);if(!(c.containsPoint(a)&&e.containsPoint(a)&&g.containsPoint(b)&&h.containsPoint(b)))return!1;c=a.distanceTo(b);if(c>
   this._settings.getSetting("restrictions.zoom.maxDistance")||c<this._settings.getSetting("restrictions.zoom.minDistance"))return!1;c=this._settings.getSetting("restrictions.rotation.minPolarAngle")*(Math.PI/180);e=this._settings.getSetting("restrictions.rotation.maxPolarAngle")*(Math.PI/180);h=this._settings.getSetting("restrictions.rotation.minAzimuthAngle")*(Math.PI/180);g=this._settings.getSetting("restrictions.rotation.maxAzimuthAngle")*(Math.PI/180);if(-Infinity!==h||Infinity!==g||0!==c||180!==
   e){var f=new module$src$externals$three.default.Vector3;f.copy(a).sub(b);f.applyQuaternion(this._quat);a=(new module$src$externals$three.default.Spherical).setFromVector3(f);if(a.theta<h||a.theta>g||a.phi<c||a.phi>e)return!1}return!0};b.prototype.pan=function(a,b,d,e){e&&(a/=window.devicePixelRatio,b/=window.devicePixelRatio);if(d){if(this._panEnd.set(a,b),this._panDelta.subVectors(this._panEnd,this._panStart),0!==this._panDelta.x||0!==this._panDelta.y)this._panStart.copy(this._panEnd),a=this.panDeltaToOffset(this._panDelta.multiplyScalar(this._adjustedSettings.panSpeed*
   (e?this._touchAdjustements.panSpeed:1))),0<this._damping.pan.duration&&(a.x=0>a.x?Math.min(a.x,this._adjustedSettings.movementSmoothness*this._damping.pan.offset.x):Math.max(a.x,this._adjustedSettings.movementSmoothness*this._damping.pan.offset.x),a.y=0>a.y?Math.min(a.y,this._adjustedSettings.movementSmoothness*this._damping.pan.offset.y):Math.max(a.y,this._adjustedSettings.movementSmoothness*this._damping.pan.offset.y),a.z=0>a.z?Math.min(a.z,this._adjustedSettings.movementSmoothness*this._damping.pan.offset.z):
   Math.max(a.z,this._adjustedSettings.movementSmoothness*this._damping.pan.offset.z)),e=1-Math.max(.01,Math.min(1,this._adjustedSettings.damping)),b=(Math.log(1/Math.abs(a.x))-5*Math.log(10))/Math.log(e),d=(Math.log(1/Math.abs(a.y))-5*Math.log(10))/Math.log(e),e=(Math.log(1/Math.abs(a.z))-5*Math.log(10))/Math.log(e),this._damping.pan.time=0,this._damping.pan.duration=16.6666*Math.max(b,Math.max(d,e)),this._damping.pan.offset=a.clone(),this._damping.rotation.duration=0,this._damping.zoom.duration=0,
   this._controls.applyTargetMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(a.x,a.y,a.z),!0),this._controls.applyPositionMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(a.x,a.y,a.z),!0)}else this._panStart.set(a,b)};b.prototype.reset=function(){this._damping={rotation:{time:0,duration:0,theta:0,phi:0},zoom:{time:0,duration:0,delta:0},pan:{time:0,duration:0,offset:new module$src$externals$three.default.Vector3}};this._dollyStart=this._dollyEnd=this._dollyDelta=
   0;this._panDelta=new module$src$externals$three.default.Vector2;this._panEnd=new module$src$externals$three.default.Vector2;this._panStart=new module$src$externals$three.default.Vector2;this._rotateDelta=new module$src$externals$three.default.Vector2;this._rotateEnd=new module$src$externals$three.default.Vector2;this._rotateStart=new module$src$externals$three.default.Vector2};b.prototype.restrict=function(a,b){var c=this._settings.getSetting("restrictions.position.cube"),e=this._settings.getSetting("restrictions.position.sphere");
   c=new module$src$externals$three.default.Box3(new module$src$externals$three.default.Vector3(c.min.x,c.min.y,c.min.z),new module$src$externals$three.default.Vector3(c.max.x,c.max.y,c.max.z));e=new module$src$externals$three.default.Sphere(new module$src$externals$three.default.Vector3(e.center.x,e.center.y,e.center.z),e.radius);c.containsPoint(a)||c.clampPoint(a,a);e.containsPoint(a)||e.clampPoint(a,a);c=this._settings.getSetting("restrictions.target.cube");e=this._settings.getSetting("restrictions.target.sphere");
   c=new module$src$externals$three.default.Box3(new module$src$externals$three.default.Vector3(c.min.x,c.min.y,c.min.z),new module$src$externals$three.default.Vector3(c.max.x,c.max.y,c.max.z));e=new module$src$externals$three.default.Sphere(new module$src$externals$three.default.Vector3(e.center.x,e.center.y,e.center.z),e.radius);c.containsPoint(b)||c.clampPoint(b,b);e.containsPoint(b)||e.clampPoint(b,b);c=a.distanceTo(b);if(c>this._settings.getSetting("restrictions.zoom.maxDistance")||c<this._settings.getSetting("restrictions.zoom.minDistance"))e=
   new module$src$externals$three.default.Vector3,e.copy(a).sub(b).normalize(),a=Math.max(this._settings.getSetting("restrictions.zoom.minDistance"),Math.min(this._settings.getSetting("restrictions.zoom.maxDistance"),c)),a=b.clone().add(e.multiplyScalar(a));e=this._settings.getSetting("restrictions.rotation.minPolarAngle")*(Math.PI/180);c=this._settings.getSetting("restrictions.rotation.maxPolarAngle")*(Math.PI/180);var g=this._settings.getSetting("restrictions.rotation.minAzimuthAngle")*(Math.PI/180),
   h=this._settings.getSetting("restrictions.rotation.maxAzimuthAngle")*(Math.PI/180);if(-Infinity!==g||Infinity!==h||0!==e||180!==c){var f=new module$src$externals$three.default.Vector3;f.copy(a).sub(b);f.applyQuaternion(this._quat);var k=(new module$src$externals$three.default.Spherical).setFromVector3(f);if(k.theta<g||k.theta>h||k.phi<e||k.phi>c)k.theta=Math.max(g,Math.min(h,k.theta)),k.phi=Math.max(e,Math.min(c,k.phi)),k.makeSafe(),f.setFromSpherical(k),f.applyQuaternion(this._quatInverse),a=f.add(b)}return{position:a,
   target:b}};b.prototype.rotate=function(a,b,d,e){e&&(a/=window.devicePixelRatio,b/=window.devicePixelRatio);d?(this._rotateEnd.set(a,b),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart),this._rotateStart.copy(this._rotateEnd),0!=this._controls.domElement.clientWidth&&0!=this._controls.domElement.clientHeight&&(a=new module$src$externals$three.default.Spherical,e=this._adjustedSettings.rotationSpeed*(e?this._touchAdjustements.rotationSpeed:1),a.theta-=e*this._rotateDelta.x,a.phi-=e*this._rotateDelta.y,
   0<this._damping.rotation.duration&&(a.theta+=(this._damping.rotation.theta-a.theta)*this._adjustedSettings.movementSmoothness,a.phi+=(this._damping.rotation.phi-a.phi)*this._adjustedSettings.movementSmoothness),e=this.rotationSphericalToOffset(a),d=1-Math.max(.01,Math.min(1,this._adjustedSettings.damping)),b=(Math.log(1/Math.abs(a.theta))-5*Math.log(10))/Math.log(d),d=(Math.log(1/Math.abs(a.phi))-5*Math.log(10))/Math.log(d),this._damping.rotation.time=0,this._damping.rotation.duration=16.6666*Math.max(b,
   d),this._damping.rotation.theta=a.theta,this._damping.rotation.phi=a.phi,this._damping.pan.duration=0,this._damping.zoom.duration=0,this._controls.applyPositionMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(e.x,e.y,e.z),!0))):this._rotateStart.set(a,b)};b.prototype.update=function(a,b){!0===b&&(this._damping.zoom.duration=0,this._damping.pan.duration=0,this._damping.rotation.duration=0);b=1-Math.max(.01,Math.min(1,this._adjustedSettings.damping));if(0<this._damping.pan.duration)if(this._damping.pan.time+
   a>this._damping.pan.duration)this._damping.pan.time=this._damping.pan.duration,this._damping.pan.duration=0;else{this._damping.pan.time+=a;var c=this._damping.pan.time/16.6666;c=this._damping.pan.offset.clone().multiplyScalar(Math.pow(b,c));this._controls.applyTargetMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(c.x,c.y,c.z));this._controls.applyPositionMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(c.x,c.y,c.z))}else this._damping.pan.time=0;if(0<
   this._damping.rotation.duration)if(this._damping.rotation.time+a>this._damping.rotation.duration)this._damping.rotation.time=this._damping.rotation.duration,this._damping.rotation.duration=0;else{this._damping.rotation.time+=a;c=this._damping.rotation.time/16.6666;var e=new module$src$externals$three.default.Spherical;e.theta=this._damping.rotation.theta*Math.pow(b,c);e.phi=this._damping.rotation.phi*Math.pow(b,c);c=this.rotationSphericalToOffset(e);this._controls.applyPositionMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(c.x,
   c.y,c.z))}else this._damping.rotation.time=0;0<this._damping.zoom.duration?this._damping.zoom.time+a>this._damping.zoom.duration?(this._damping.zoom.time=this._damping.zoom.duration,this._damping.zoom.duration=0):(this._damping.zoom.time+=a,c=this._damping.zoom.time/16.6666,c=this.zoomDistanceToOffset(this._damping.zoom.delta*Math.pow(b,c)),this._controls.applyPositionMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(c.x,c.y,c.z))):this._damping.zoom.time=0;this._settings.getSetting("enableAutoRotation")&&
   (e=new module$src$externals$three.default.Spherical(1,0,-this._adjustedSettings.autoRotationSpeed),c=this.rotationSphericalToOffset(e),this._controls.applyPositionMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(c.x,c.y,c.z)))};b.prototype.zoom=function(a,b,d,e){a=Math.sqrt(a*a+b*b);e&&(a/=window.devicePixelRatio);d?(this._dollyEnd=a,this._dollyDelta=this._dollyEnd-this._dollyStart,this._dollyStart=this._dollyEnd,0<this._damping.zoom.duration&&(this._dollyDelta=0>this._dollyDelta?
   Math.min(this._dollyDelta,this._adjustedSettings.movementSmoothness*this._damping.zoom.delta):Math.max(this._dollyDelta,this._adjustedSettings.movementSmoothness*this._damping.zoom.delta)),d=-this._dollyDelta*this._adjustedSettings.zoomSpeed*(e?this._touchAdjustements.zoomSpeed:1),e=(Math.log(1/Math.abs(this._dollyDelta))-5*Math.log(10))/Math.log(1-Math.max(.01,Math.min(1,this._adjustedSettings.damping))),this._damping.zoom.time=0,this._damping.zoom.duration=16.6666*e,this._damping.zoom.delta=d,this._damping.rotation.duration=
   0,this._damping.pan.duration=0,d=this.zoomDistanceToOffset(d),this._controls.applyPositionMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(d.x,d.y,d.z),!0)):this._dollyStart=a};b.prototype.panDeltaToOffset=function(a){var b=new module$src$externals$three.default.Vector3,d=new module$src$externals$three.default.Vector3;b.copy(this._controls.getPositionWithManualUpdates()).sub(this._controls.getTargetWithManualUpdates());b=b.length();b*=Math.tan(this._controls.camera.fov/2*Math.PI/
   180);var e=new module$src$externals$three.default.Vector3;e.setFromMatrixColumn(this._controls.camera.matrix,0);e.multiplyScalar(-(2*a.x*b));d.add(e);e=new module$src$externals$three.default.Vector3;e.setFromMatrixColumn(this._controls.camera.matrix,1);e.multiplyScalar(2*a.y*b);d.add(e);return d.clone()};b.prototype.rotationSphericalToOffset=function(a){var b=new module$src$externals$three.default.Vector3;b.copy(this._controls.getPositionWithManualUpdates()).sub(this._controls.getTargetWithManualUpdates());
   b.applyQuaternion(this._quat);var d=(new module$src$externals$three.default.Spherical).setFromVector3(b);d.theta+=a.theta;d.phi+=a.phi;a=this._settings.getSetting("restrictions.rotation.minAzimuthAngle")*(Math.PI/180);var e=this._settings.getSetting("restrictions.rotation.maxAzimuthAngle")*(Math.PI/180);d.theta>Math.PI?(d.theta-=2*Math.PI,a>d.theta&&(d.theta+=2*Math.PI)):d.theta<-Math.PI&&(d.theta+=2*Math.PI,e<d.theta&&(d.theta-=2*Math.PI));d.makeSafe();b.setFromSpherical(d);b.applyQuaternion(this._quatInverse);
   b.add(this._controls.getTargetWithManualUpdates());b.sub(this._controls.getPositionWithManualUpdates());return b.clone()};b.prototype.zoomDistanceToOffset=function(a){var b=new module$src$externals$three.default.Vector3;b.copy(this._controls.getPositionWithManualUpdates()).sub(this._controls.getTargetWithManualUpdates());return b.clone().multiplyScalar(a)};return b}();var module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsHooks={default:{}};Object.defineProperty(module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsHooks.default,"__esModule",{value:!0});
   module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsHooks.default.OrbitControlsHooks={autoRotationSpeed:function(b){if(!this._globalUtils.typeCheck(b,"float",this._logWarning,"OrbitControls.Hook->autoRotationSpeed"))return!1;0!==b?this._settings.updateSetting("enableAutoRotation",!0):this._settings.updateSetting("enableAutoRotation",!1);return!0},damping:function(b){return this._globalUtils.typeCheck(b,"notnegative",this._logWarning,"OrbitControls.Hook->damping")?!0:!1},enableAutoRotation:function(b){if(!this._globalUtils.typeCheck(b,
   "boolean",this._logWarning,"OrbitControls.Hook->enableAutoRotation"))return!1;b&&this._triggerRender();return!0},enableKeyPan:function(b){return this._globalUtils.typeCheck(b,"boolean",this._logWarning,"OrbitControls.Hook->enableKeyPan")?!0:!1},enablePan:function(b){return this._globalUtils.typeCheck(b,"boolean",this._logWarning,"OrbitControls.Hook->enablePan")?!0:!1},enableRotation:function(b){return this._globalUtils.typeCheck(b,"boolean",this._logWarning,"OrbitControls.Hook->enableRotation")?!0:
   !1},enableZoom:function(b){return this._globalUtils.typeCheck(b,"boolean",this._logWarning,"OrbitControls.Hook->enableZoom")?!0:!1},input:function(b){return!0},keyPanSpeed:function(b){return this._globalUtils.typeCheck(b,"number",this._logWarning,"OrbitControls.Hook->keyPanSpeed")?!0:!1},movementSmoothness:function(b){return this._globalUtils.typeCheck(b,"number",this._logWarning,"OrbitControls.Hook->movementSmoothness")?!0:!1},"restrictions.position.cube.min":function(b){var a=this._settings.getSetting("restrictions.position.cube");
   a.min=b;return this._settings.updateSetting("restrictions.position.cube",a)},"restrictions.position.cube.max":function(b){var a=this._settings.getSetting("restrictions.position.cube");a.max=b;return this._settings.updateSetting("restrictions.position.cube",a)},"restrictions.position.cube":function(b){if(!this._globalUtils.typeCheck(b.min,"vector3any",this._logWarning,"OrbitControls.Hook->restrictions.position.cube")||!this._globalUtils.typeCheck(b.max,"vector3any",this._logWarning,"OrbitControls.Hook->restrictions.position.cube"))return!1;
   this._triggerRender();return!0},"restrictions.position.sphere.center":function(b){var a=this._settings.getSetting("restrictions.position.sphere");a.center=b;return this._settings.updateSetting("restrictions.position.sphere",a)},"restrictions.position.sphere.radius":function(b){var a=this._settings.getSetting("restrictions.position.sphere");a.radius=b;return this._settings.updateSetting("restrictions.position.sphere",a)},"restrictions.position.sphere":function(b){if(!this._globalUtils.typeCheck(b.center,
   "vector3any",this._logWarning,"OrbitControls.Hook->restrictions.position.sphere")||!this._globalUtils.typeCheck(b.radius,"notnegative",this._logWarning,"OrbitControls.Hook->restrictions.position.sphere"))return!1;this._triggerRender();return!0},"restrictions.target.cube.min":function(b){var a=this._settings.getSetting("restrictions.target.cube");a.min=b;return this._settings.updateSetting("restrictions.target.cube",a)},"restrictions.target.cube.max":function(b){var a=this._settings.getSetting("restrictions.target.cube");
   a.max=b;return this._settings.updateSetting("restrictions.target.cube",a)},"restrictions.target.cube":function(b){if(!this._globalUtils.typeCheck(b.min,"vector3any",this._logWarning,"OrbitControls.Hook->restrictions.target.cube")||!this._globalUtils.typeCheck(b.max,"vector3any",this._logWarning,"OrbitControls.Hook->restrictions.target.cube"))return!1;this._triggerRender();return!0},"restrictions.target.sphere.center":function(b){var a=this._settings.getSetting("restrictions.target.sphere");a.center=
   b;return this._settings.updateSetting("restrictions.target.sphere",a)},"restrictions.target.sphere.radius":function(b){var a=this._settings.getSetting("restrictions.target.sphere");a.radius=b;return this._settings.updateSetting("restrictions.target.sphere",a)},"restrictions.target.sphere":function(b){if(!this._globalUtils.typeCheck(b.center,"vector3any",this._logWarning,"OrbitControls.Hook->restrictions.target.sphere")||!this._globalUtils.typeCheck(b.radius,"notnegative",this._logWarning,"OrbitControls.Hook->restrictions.target.sphere"))return!1;
   this._triggerRender();return!0},"restrictions.rotation.minPolarAngle":function(b){var a=this._settings.getSetting("restrictions.rotation");a.minPolarAngle=b;return this._settings.updateSetting("restrictions.rotation",a)},"restrictions.rotation.maxPolarAngle":function(b){var a=this._settings.getSetting("restrictions.rotation");a.maxPolarAngle=b;return this._settings.updateSetting("restrictions.rotation",a)},"restrictions.rotation.minAzimuthAngle":function(b){var a=this._settings.getSetting("restrictions.rotation");
   a.minAzimuthAngle=b;return this._settings.updateSetting("restrictions.rotation",a)},"restrictions.rotation.maxAzimuthAngle":function(b){var a=this._settings.getSetting("restrictions.rotation");a.maxAzimuthAngle=b;return this._settings.updateSetting("restrictions.rotation",a)},"restrictions.rotation":function(b){if(!(this._globalUtils.typeCheck(b.minPolarAngle,"number",this._logWarning,"OrbitControls.Hook->restrictions.rotation")&&this._globalUtils.typeCheck(b.maxPolarAngle,"number",this._logWarning,
   "OrbitControls.Hook->restrictions.rotation")&&this._globalUtils.typeCheck(b.minAzimuthAngle,"number",this._logWarning,"OrbitControls.Hook->restrictions.rotation")&&this._globalUtils.typeCheck(b.maxAzimuthAngle,"number",this._logWarning,"OrbitControls.Hook->restrictions.rotation")))return!1;this._triggerRender();return!0},"restrictions.zoom.minDistance":function(b){var a=this._settings.getSetting("restrictions.zoom");a.minDistance=b;return this._settings.updateSetting("restrictions.zoom",a)},"restrictions.zoom.maxDistance":function(b){var a=
   this._settings.getSetting("restrictions.zoom");a.maxDistance=b;return this._settings.updateSetting("restrictions.zoom",a)},"restrictions.zoom":function(b){if(!this._globalUtils.typeCheck(b.minDistance,"number",this._logWarning,"OrbitControls.Hook->restrictions.zoom")||!this._globalUtils.typeCheck(b.maxDistance,"number",this._logWarning,"OrbitControls.Hook->restrictions.zoom"))return!1;this._triggerRender();return!0},rotationSpeed:function(b){return this._globalUtils.typeCheck(b,"float",this._logWarning,
   "OrbitControls.Hook->rotationSpeed")?!0:!1},panSpeed:function(b){return this._globalUtils.typeCheck(b,"number",this._logWarning,"OrbitControls.Hook->panSpeed")?!0:!1},zoomSpeed:function(b){return this._globalUtils.typeCheck(b,"notnegative",this._logWarning,"OrbitControls.Hook->zoomSpeed")?!0:!1}};module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsHooks.default.OrbitControlsNotifiers={};var module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsManager={default:{}},__importDefault$$module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsManager=this&&module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsManager.default.__importDefault||function(b){return b&&b.__esModule?b:{"default":b}};Object.defineProperty(module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsManager.default,"__esModule",{value:!0});
   var GlobalUtils_js_1$$module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsManager=__importDefault$$module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsManager(module$src$shared$util$GlobalUtils.default),OrbitControlsEventDistribution_1$$module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsManager=module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsEventDistribution.default,OrbitControlsLogic_1$$module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsManager=
   module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsLogic.default,OrbitControlsHooks_1$$module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsManager=module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsHooks.default,HooksAndNotifiers_1$$module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsManager=module$src$3d$viewport$helpers$HooksAndNotifiers.default;
   module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsManager.default.OrbitControlsManager=function(){function b(a,b,d,e){this._settings=a;this._cameraControls=b;this._triggerRender=d;this._logWarning=e;this._globalUtils=GlobalUtils_js_1$$module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsManager.default;this._cameraLogic=new module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsLogic.default.OrbitControlsLogic(this._settings,this._cameraControls);this._cameraEventDistribution=
   new module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsEventDistribution.default.OrbitControlsEventDistribution(this._settings,this._cameraControls,this._cameraLogic);this._cameraControls.registerCameraControls(this);module$src$3d$viewport$helpers$HooksAndNotifiers.default.registerHooksAndNotifiers(this,this._settings,module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsHooks.default.OrbitControlsHooks,module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsHooks.default.OrbitControlsNotifiers)}
   b.prototype.isWithinRestrictions=function(a,b){return this._cameraLogic.isWithinRestrictions(a,b)};b.prototype.onKeyDown=function(a){this._cameraEventDistribution.onKeyDown(a)};b.prototype.onMouseDown=function(a){this._cameraEventDistribution.onMouseDown(a)};b.prototype.onMouseMove=function(a){this._cameraEventDistribution.onMouseMove(a)};b.prototype.onMouseUp=function(a){this._cameraEventDistribution.onMouseUp(a)};b.prototype.onMouseWheel=function(a){this._cameraEventDistribution.onMouseWheel(a)};
   b.prototype.onTouchEnd=function(a){this._cameraEventDistribution.onTouchEnd(a)};b.prototype.onTouchMove=function(a){this._cameraEventDistribution.onTouchMove(a)};b.prototype.onTouchStart=function(a){this._cameraEventDistribution.onTouchStart(a)};b.prototype.reset=function(){this._cameraEventDistribution.reset();this._cameraLogic.reset()};b.prototype.restrict=function(a,b){return this._cameraLogic.restrict(a,b)};b.prototype.update=function(a,b){this._cameraLogic.update(a,b)};return b}();var module$src$3d$viewport$handlers$camera$hooks$PerspectiveCameraHooksAndNotifiers={default:{}},__awaiter$$module$src$3d$viewport$handlers$camera$hooks$PerspectiveCameraHooksAndNotifiers=this&&module$src$3d$viewport$handlers$camera$hooks$PerspectiveCameraHooksAndNotifiers.default.__awaiter||function(b,a,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,h){function f(a){try{l(d.next(a))}catch(n){h(n)}}function g(a){try{l(d["throw"](a))}catch(n){h(n)}}
   function l(a){a.done?c(a.value):e(a.value).then(f,g)}l((d=d.apply(b,a||[])).next())})},__generator$$module$src$3d$viewport$handlers$camera$hooks$PerspectiveCameraHooksAndNotifiers=this&&module$src$3d$viewport$handlers$camera$hooks$PerspectiveCameraHooksAndNotifiers.default.__generator||function(b,a){function c(a){return function(b){return d([a,b])}}function d(c){if(g)throw new TypeError("Generator is already executing.");for(;e;)try{if(g=1,h&&(f=c[0]&2?h["return"]:c[0]?h["throw"]||((f=h["return"])&&
   f.call(h),0):h.next)&&!(f=f.call(h,c[1])).done)return f;if(h=0,f)c=[c[0]&2,f.value];switch(c[0]){case 0:case 1:f=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++;h=c[1];c=[0];continue;case 7:c=e.ops.pop();e.trys.pop();continue;default:if(!(f=e.trys,f=0<f.length&&f[f.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!f||c[1]>f[0]&&c[1]<f[3]))e.label=c[1];else if(6===c[0]&&e.label<f[1])e.label=f[1],f=c;else if(f&&e.label<f[2])e.label=f[2],e.ops.push(c);else{f[2]&&e.ops.pop();
   e.trys.pop();continue}}c=a.call(b,e)}catch(m){c=[6,m],h=0}finally{g=f=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},g,h,f,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k};Object.defineProperty(module$src$3d$viewport$handlers$camera$hooks$PerspectiveCameraHooksAndNotifiers.default,"__esModule",{value:!0});
   var FPSManager_1$$module$src$3d$viewport$handlers$camera$hooks$PerspectiveCameraHooksAndNotifiers=module$src$3d$viewport$handlers$camera$controls$fps$FPSManager.default,OrbitControlsManager_1$$module$src$3d$viewport$handlers$camera$hooks$PerspectiveCameraHooksAndNotifiers=module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsManager.default,ICameraHandler_1$$module$src$3d$viewport$handlers$camera$hooks$PerspectiveCameraHooksAndNotifiers=module$src$3d$viewport$interfaces$ICameraHandler.default,
   StateDashboard_1$$module$src$3d$viewport$handlers$camera$hooks$PerspectiveCameraHooksAndNotifiers=module$src$modules$shapediver_state_dashboard$StateDashboard.default;
   module$src$3d$viewport$handlers$camera$hooks$PerspectiveCameraHooksAndNotifiers.default.PerspectiveCameraHooks={controls:function(b){if(b!==module$src$3d$viewport$interfaces$ICameraHandler.default.ControlType.ORBIT&&b!==module$src$3d$viewport$interfaces$ICameraHandler.default.ControlType.FPS)return this._handlers.threeDManager.warn("PerspectiveCameraHandler.Hook->controls","The specified control type is not permitted for this camera type."),!1;if(b===this._perspectiveSettings.getSetting("controls"))return!0;
   b===module$src$3d$viewport$interfaces$ICameraHandler.default.ControlType.ORBIT?(document.exitPointerLock(),this._cameraControlsManager=new module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsManager.default.OrbitControlsManager(this._settings.getSection("controls.orbit"),this._cameraControls,this._handlers.renderingHandler.render,this._handlers.threeDManager.warn)):(this._cameraControlsManager=new module$src$3d$viewport$handlers$camera$controls$fps$FPSManager.default.FPSManager(this._settings.getSection("controls.fps"),
   this._cameraControls,this._handlers.renderingHandler.render,this._handlers.threeDManager.warn),this._handlers.renderingHandler.getCanvas().requestPointerLock());return!0},"default.position":function(b){return this._globalUtils.typeCheck(b,"vector3obj",this._handlers.threeDManager.warn,"PerspectiveCameraHandler.Hook->default.position")?Promise.resolve(!0):Promise.resolve(!1)},"default.target":function(b){return this._globalUtils.typeCheck(b,"vector3obj",this._handlers.threeDManager.warn,"PerspectiveCameraHandler.Hook->default.target")?
   Promise.resolve(!0):Promise.resolve(!1)},"default":function(b){return __awaiter$$module$src$3d$viewport$handlers$camera$hooks$PerspectiveCameraHooksAndNotifiers(this,void 0,void 0,function(){var a,c;return __generator$$module$src$3d$viewport$handlers$camera$hooks$PerspectiveCameraHooksAndNotifiers(this,function(d){switch(d.label){case 0:if(!this._globalUtils.typeCheck(b.position,"vector3obj",this._handlers.threeDManager.warn,"PerspectiveCameraHandler.Hook->default")||!this._globalUtils.typeCheck(b.target,
   "vector3obj",this._handlers.threeDManager.warn,"PerspectiveCameraHandler.Hook->default"))return[2,Promise.resolve(!1)];a=module$src$modules$shapediver_state_dashboard$StateDashboard.default.StateDashboardLibrary.getInstance(this._handlers.threeDManager.viewerApi.getSetting("viewerRuntimeId"));c=a.firstTimeVisible.resolved?this._settings.getSetting("cameraMovementDuration"):0;return 0!==b.position.x||0!==b.position.y||0!==b.position.z||0!==b.target.x||0!==b.target.y||0!==b.target.z?[3,2]:[4,this.zoomExtents({duration:c})];
   case 1:return d.sent(),[3,4];case 2:return[4,this.setPositionAndTarget(b.position,b.target,{duration:c})];case 3:d.sent(),d.label=4;case 4:return[2,Promise.resolve(!0)]}})})},fov:function(b){if(!this._globalUtils.typeCheck(b,"notnegative",this._handlers.threeDManager.warn,"PerspectiveCameraHandler.Hook->fov"))return!1;10<this._camera.fov&&10>b?(this._camera.near=100*this._camera.near*b,this._camera.far=100*this._camera.far*b):10>this._camera.fov&&10<b&&(this._camera.near/=100*this._camera.fov,this._camera.far/=
   100*this._camera.fov);this._camera.fov=b;this._camera.updateProjectionMatrix();this._handlers.renderingHandler.render();return!0}};module$src$3d$viewport$handlers$camera$hooks$PerspectiveCameraHooksAndNotifiers.default.PerspectiveCameraNotifiers={};var module$src$3d$viewport$handlers$camera$controls$CameraEventManager={default:{}};Object.defineProperty(module$src$3d$viewport$handlers$camera$controls$CameraEventManager.default,"__esModule",{value:!0});
   module$src$3d$viewport$handlers$camera$controls$CameraEventManager.default.CameraEventManager=function(){function b(a){this._controls=a;this._currentMousePosition={x:0,y:0};this.addEventListeners()}Object.defineProperty(b.prototype,"cameraControlsManager",{set:function(a){this._cameraControlsManager=a},enumerable:!0,configurable:!0});b.prototype.dispose=function(){this.removeEventListerners()};b.prototype.addEventListeners=function(){this._controls.domElement.addEventListener("mousewheel",this.onMouseWheel.bind(this),
   {passive:!1});this._controls.domElement.addEventListener("MozMousePixelScroll",this.onMouseWheel.bind(this),{passive:!1});this._controls.domElement.addEventListener("mousedown",this.onMouseDown.bind(this),{passive:!1});this._controls.domElement.addEventListener("mousemove",this.onMouseMove.bind(this),{passive:!1});this._controls.domElement.addEventListener("mouseup",this.onMouseUp.bind(this),{passive:!1});this._controls.domElement.addEventListener("mouseout",this.onMouseUp.bind(this),{passive:!1});
   this._controls.domElement.addEventListener("touchstart",this.onTouchStart.bind(this),{passive:!1});this._controls.domElement.addEventListener("touchmove",this.onTouchMove.bind(this),{passive:!1});this._controls.domElement.addEventListener("touchend",this.onTouchEnd.bind(this),{passive:!1});window.addEventListener("keydown",this.onKeyDown.bind(this),{passive:!1});window.addEventListener("mousemove",this.onKeyDownMousePositionHelper.bind(this),{passive:!1});this._controls.domElement.addEventListener("contextmenu",
   this.onContextMenu.bind(this),{passive:!1})};b.prototype.onContextMenu=function(a){!1!==this._controls.enabled&&a.preventDefault()};b.prototype.onKeyDown=function(a){if(!1!==this._controls.enabled&&this._controls.domElement===document.elementFromPoint(this._currentMousePosition.x,this._currentMousePosition.y))this._cameraControlsManager.onKeyDown(a)};b.prototype.onKeyDownMousePositionHelper=function(a){this._currentMousePosition={x:a.pageX,y:a.pageY}};b.prototype.onMouseDown=function(a){!1!==this._controls.enabled&&
   (a.preventDefault(),this._cameraControlsManager.onMouseDown(a))};b.prototype.onMouseMove=function(a){!1!==this._controls.enabled&&(a.preventDefault(),this._cameraControlsManager.onMouseMove(a))};b.prototype.onMouseUp=function(a){if(!1!==this._controls.enabled)this._cameraControlsManager.onMouseUp(a)};b.prototype.onMouseWheel=function(a){!1!==this._controls.enabled&&(a.preventDefault(),a.stopPropagation(),this._cameraControlsManager.onMouseWheel(a))};b.prototype.onTouchEnd=function(a){if(!1!==this._controls.enabled)this._cameraControlsManager.onTouchEnd(a)};
   b.prototype.onTouchMove=function(a){if(!1!==this._controls.enabled)this._cameraControlsManager.onTouchMove(a)};b.prototype.onTouchStart=function(a){if(!1!==this._controls.enabled)this._cameraControlsManager.onTouchStart(a)};b.prototype.removeEventListerners=function(){this._controls.domElement.removeEventListener("mousewheel",this.onMouseWheel.bind(this),!1);this._controls.domElement.removeEventListener("MozMousePixelScroll",this.onMouseWheel.bind(this),!1);this._controls.domElement.removeEventListener("mousedown",
   this.onMouseDown.bind(this),!1);this._controls.domElement.removeEventListener("mousemove",this.onMouseMove.bind(this),!1);this._controls.domElement.removeEventListener("mouseup",this.onMouseUp.bind(this),!1);this._controls.domElement.removeEventListener("mouseout",this.onMouseUp.bind(this),!1);this._controls.domElement.removeEventListener("touchstart",this.onTouchStart.bind(this),!1);this._controls.domElement.removeEventListener("touchmove",this.onTouchMove.bind(this),!1);this._controls.domElement.removeEventListener("touchend",
   this.onTouchEnd.bind(this),!1);window.removeEventListener("keydown",this.onKeyDown.bind(this),!1);window.removeEventListener("mousemove",this.onKeyDownMousePositionHelper.bind(this),!1);this._controls.domElement.removeEventListener("contextmenu",this.onContextMenu.bind(this),!1)};return b}();var module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraLinearInterpolation={default:{}};Object.defineProperty(module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraLinearInterpolation.default,"__esModule",{value:!0});var THREE$$module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraLinearInterpolation=module$src$externals$three.default;
   module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraLinearInterpolation.default.CameraLinearInterpolation=function(){function b(a,b,d){this._cameraControls=a;this._from=b;this._to=d}b.prototype.onComplete=function(a){a=(new module$src$externals$three.default.Vector3(this._to.position.x,this._to.position.y,this._to.position.z)).sub(this._cameraControls.position);this._cameraControls.applyPositionMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(a.x,a.y,
   a.z));a=(new module$src$externals$three.default.Vector3(this._to.target.x,this._to.target.y,this._to.target.z)).sub(this._cameraControls.target);this._cameraControls.applyTargetMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(a.x,a.y,a.z))};b.prototype.onStop=function(a){};b.prototype.onUpdate=function(a){var b=this._from.position.clone().multiplyScalar(1-a.delta).add(this._to.position.clone().multiplyScalar(a.delta)).clone().sub(this._cameraControls.position);this._cameraControls.applyPositionMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(b.x,
   b.y,b.z));a=this._from.target.clone().multiplyScalar(1-a.delta).add(this._to.target.clone().multiplyScalar(a.delta)).clone().sub(this._cameraControls.target);this._cameraControls.applyTargetMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(a.x,a.y,a.z))};return b}();var module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraSphericalInterpolation={default:{}};Object.defineProperty(module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraSphericalInterpolation.default,"__esModule",{value:!0});var THREE$$module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraSphericalInterpolation=module$src$externals$three.default;
   module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraSphericalInterpolation.default.CameraSphericalInterpolation=function(){function b(a,b,d){this._cameraControls=a;this._from=b;this._to=d;this._radius_from=this._from.position.distanceTo(this._from.target);this._direction_from=this._from.position.clone().sub(this._from.target).normalize();this._radius_to=this._to.position.distanceTo(this._to.target);this._direction_to=this._to.position.clone().sub(this._to.target).normalize();
   this._axis=this._direction_to.clone().cross(this._direction_from).normalize();this._c_angle=-Math.acos(this._direction_to.dot(this._direction_from))}b.prototype.onComplete=function(a){a=(new module$src$externals$three.default.Vector3(this._to.position.x,this._to.position.y,this._to.position.z)).sub(this._cameraControls.position);this._cameraControls.applyPositionMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(a.x,a.y,a.z));a=(new module$src$externals$three.default.Vector3(this._to.target.x,
   this._to.target.y,this._to.target.z)).sub(this._cameraControls.target);this._cameraControls.applyTargetMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(a.x,a.y,a.z))};b.prototype.onStop=function(a){};b.prototype.onUpdate=function(a){var b=this._from.target.clone().multiplyScalar(1-a.delta).add(this._to.target.clone().multiplyScalar(a.delta)),d=b.clone().sub(this._cameraControls.target);this._cameraControls.applyTargetMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(d.x,
   d.y,d.z));d=this._c_angle*a.delta;d=this._direction_from.clone().applyAxisAngle(this._axis,d).normalize();a=b.clone().add(d.clone().multiplyScalar(this._radius_from*(1-a.delta)+this._radius_to*a.delta)).clone().sub(this._cameraControls.position);this._cameraControls.applyPositionMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(a.x,a.y,a.z))};return b}();var module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraCylindricalInterpolation={default:{}};Object.defineProperty(module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraCylindricalInterpolation.default,"__esModule",{value:!0});var THREE$$module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraCylindricalInterpolation=module$src$externals$three.default;
   module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraCylindricalInterpolation.default.CameraCylindricalInterpolation=function(){function b(a,b,d){this._cameraControls=a;this._from=b;this._to=d;this._h_from=this._from.position.z-this._from.target.z;this._from_position_heightAdjusted=new module$src$externals$three.default.Vector3(this._from.position.x,this._from.position.y,this._from.target.z);this._r_from=this._from_position_heightAdjusted.distanceTo(this._from.target);this._dir_from=
   this._from_position_heightAdjusted.sub(this._from.target).normalize();this._h_to=this._to.position.z-this._to.target.z;this._to_position_heightAdjusted=new module$src$externals$three.default.Vector3(this._to.position.x,this._to.position.y,this._to.target.z);this._r_to=this._to_position_heightAdjusted.distanceTo(this._to.target);this._dir_to=this._to_position_heightAdjusted.sub(this._to.target).normalize();0===this._dir_from.x&&0===this._dir_from.y&&0===this._dir_from.z&&(this._dir_from=new module$src$externals$three.default.Vector3(1,
   0,0));0===this._dir_to.x&&0===this._dir_to.y&&0===this._dir_to.z&&(this._dir_to=new module$src$externals$three.default.Vector3(1,0,0));this._lorr=this._dir_to.clone().cross(this._dir_from);a=Math.min(1,Math.max(-1,this._dir_to.dot(this._dir_from)));this._shortest_angle=0<Math.min(1,Math.max(-1,this._lorr.dot(new module$src$externals$three.default.Vector3(0,0,1))))?-Math.acos(a):Math.acos(a)}b.prototype.onComplete=function(a){a=(new module$src$externals$three.default.Vector3(this._to.position.x,this._to.position.y,
   this._to.position.z)).sub(this._cameraControls.position);this._cameraControls.applyPositionMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(a.x,a.y,a.z));a=(new module$src$externals$three.default.Vector3(this._to.target.x,this._to.target.y,this._to.target.z)).sub(this._cameraControls.target);this._cameraControls.applyTargetMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(a.x,a.y,a.z))};b.prototype.onStop=function(a){};b.prototype.onUpdate=function(a){var b=
   this._from.target.clone().multiplyScalar(1-a.delta).add(this._to.target.clone().multiplyScalar(a.delta)),d=b.clone().sub(this._cameraControls.target);this._cameraControls.applyTargetMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(d.x,d.y,d.z));d=this._shortest_angle*a.delta;d=this._dir_from.clone().applyAxisAngle(new module$src$externals$three.default.Vector3(0,0,1),d);b=b.clone().add(d.clone().multiplyScalar(this._r_from*(1-a.delta)+this._r_to*a.delta));b.add(new module$src$externals$three.default.Vector3(0,
   0,this._h_from*(1-a.delta)+this._h_to*a.delta));a=b.clone().sub(this._cameraControls.position);this._cameraControls.applyPositionMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(a.x,a.y,a.z))};return b}();var module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraMultipleInterpolation={default:{}};Object.defineProperty(module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraMultipleInterpolation.default,"__esModule",{value:!0});var THREE$$module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraMultipleInterpolation=module$src$externals$three.default;
   module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraMultipleInterpolation.default.CameraMultipleInterpolation=function(){function b(a,b,d){this._cameraControls=a;this._path=b;this._interpolationFunction=d;this.end={position:{x:[],y:[],z:[]},target:{x:[],y:[],z:[]}};for(a=0;a<this._path.length;a++)this.end.position.x.push(this._path[a].position.x),this.end.position.y.push(this._path[a].position.y),this.end.position.z.push(this._path[a].position.z),this.end.target.x.push(this._path[a].target.x),
   this.end.target.y.push(this._path[a].target.y),this.end.target.z.push(this._path[a].target.z)}b.prototype.onComplete=function(a){a=(new module$src$externals$three.default.Vector3(this._path[this._path.length-1].position.x,this._path[this._path.length-1].position.y,this._path[this._path.length-1].position.z)).sub(this._cameraControls.position);this._cameraControls.applyPositionMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(a.x,a.y,a.z));a=(new module$src$externals$three.default.Vector3(this._path[this._path.length-
   1].target.x,this._path[this._path.length-1].target.y,this._path[this._path.length-1].target.z)).sub(this._cameraControls.target);this._cameraControls.applyTargetMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(a.x,a.y,a.z))};b.prototype.onStop=function(a){};b.prototype.onUpdate=function(a){var b=(new module$src$externals$three.default.Vector3(this._interpolationFunction(this.end.position.x,a.delta),this._interpolationFunction(this.end.position.y,a.delta),this._interpolationFunction(this.end.position.z,
   a.delta))).clone().sub(this._cameraControls.position);this._cameraControls.applyPositionMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(b.x,b.y,b.z));a=(new module$src$externals$three.default.Vector3(this._interpolationFunction(this.end.target.x,a.delta),this._interpolationFunction(this.end.target.y,a.delta),this._interpolationFunction(this.end.target.z,a.delta))).clone().sub(this._cameraControls.target);this._cameraControls.applyTargetMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(a.x,
   a.y,a.z))};return b}();var module$src$3d$viewport$handlers$camera$controls$CameraInterpolationManager={default:{}},__importDefault$$module$src$3d$viewport$handlers$camera$controls$CameraInterpolationManager=this&&module$src$3d$viewport$handlers$camera$controls$CameraInterpolationManager.default.__importDefault||function(b){return b&&b.__esModule?b:{"default":b}};Object.defineProperty(module$src$3d$viewport$handlers$camera$controls$CameraInterpolationManager.default,"__esModule",{value:!0});
   var TWEEN$$module$src$3d$viewport$handlers$camera$controls$CameraInterpolationManager=module$node_modules$$tweenjs$tween_js$src$Tween.default,GlobalUtils_js_1$$module$src$3d$viewport$handlers$camera$controls$CameraInterpolationManager=__importDefault$$module$src$3d$viewport$handlers$camera$controls$CameraInterpolationManager(module$src$shared$util$GlobalUtils.default),CameraLinearInterpolation_1$$module$src$3d$viewport$handlers$camera$controls$CameraInterpolationManager=module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraLinearInterpolation.default,
   CameraSphericalInterpolation_1$$module$src$3d$viewport$handlers$camera$controls$CameraInterpolationManager=module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraSphericalInterpolation.default,CameraCylindricalInterpolation_1$$module$src$3d$viewport$handlers$camera$controls$CameraInterpolationManager=module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraCylindricalInterpolation.default,CameraMultipleInterpolation_1$$module$src$3d$viewport$handlers$camera$controls$CameraInterpolationManager=
   module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraMultipleInterpolation.default;
   module$src$3d$viewport$handlers$camera$controls$CameraInterpolationManager.default.CameraInterpolationManager=function(){function b(a){this._cameraControls=a;this._globalUtils=GlobalUtils_js_1$$module$src$3d$viewport$handlers$camera$controls$CameraInterpolationManager.default;this.Tween=function(){function a(a,b,c){var d=this;this._properties={delta:0};this._tween=new module$node_modules$$tweenjs$tween_js$src$Tween.default.Tween(this._properties);this._tween.easing(a.easing);this._tween.to({delta:1},
   a.duration);this._tween.onUpdate(function(a){b.onUpdate(a)});this._tween.onStop(function(a){if(b.onStop)b.onStop(a);d._resolve(!0)});this._tween.onComplete(function(a){if(b.onComplete)b.onComplete(a);c();d._resolve(!0)})}a.prototype.start=function(){var a=this;return new Promise(function(b){a._resolve=b;a._tween.start()})};a.prototype.stop=function(){this._tween.stop()};return a}();this._tween=null}b.prototype.active=function(){return this._tween?!0:!1};b.prototype.interpolate=function(a,b){var c=
   this;void 0===b&&(b={});this._tween&&(this._tween.stop(),this._tween=null);b=this.optionsParser(b);this._tween=new this.Tween(b,2===a.length?this.getCameraInterpolation(a[0],a[1],b.coordinates):new module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraMultipleInterpolation.default.CameraMultipleInterpolation(this._cameraControls,a,b.interpolation),function(){c._tween=null});return this._tween.start()};b.prototype.stop=function(){this._tween&&this._tween.stop();this._tween=null};
   b.prototype.getCameraInterpolation=function(a,b,d){switch(d){case "spherical":return new module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraSphericalInterpolation.default.CameraSphericalInterpolation(this._cameraControls,a,b);case "cylindrical":return new module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraCylindricalInterpolation.default.CameraCylindricalInterpolation(this._cameraControls,a,b);default:return new module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraLinearInterpolation.default.CameraLinearInterpolation(this._cameraControls,
   a,b)}};b.prototype.optionsParser=function(a){return{default:a.default||!1,duration:this._globalUtils.typeCheck(a.duration,"notnegative")?a.duration:0,easing:this._globalUtils.typeCheck(a.easing,"string")?this._globalUtils.getAtPath(module$node_modules$$tweenjs$tween_js$src$Tween.default.Easing,a.easing)||module$node_modules$$tweenjs$tween_js$src$Tween.default.Easing.Quartic.InOut:"function"===typeof a.easing?a.easing:module$node_modules$$tweenjs$tween_js$src$Tween.default.Easing.Quartic.InOut,coordinates:"spherical"!==
   a.coordinates&&"linear"!==a.coordinates&&"cylindrical"!==a.coordinates?"cylindrical":a.coordinates,interpolation:this._globalUtils.typeCheck(a.interpolation,"string")?this._globalUtils.getAtPath(module$node_modules$$tweenjs$tween_js$src$Tween.default.Interpolation,a.interpolation)||module$node_modules$$tweenjs$tween_js$src$Tween.default.Interpolation.CatmullRom:"function"===typeof a.interpolation?a.interpolation:module$node_modules$$tweenjs$tween_js$src$Tween.default.Interpolation.CatmullRom}};return b}();var module$src$3d$viewport$handlers$camera$controls$CameraControls={default:{}};Object.defineProperty(module$src$3d$viewport$handlers$camera$controls$CameraControls.default,"__esModule",{value:!0});
   var CameraEventManager_1$$module$src$3d$viewport$handlers$camera$controls$CameraControls=module$src$3d$viewport$handlers$camera$controls$CameraEventManager.default,CameraInterpolationManager_1$$module$src$3d$viewport$handlers$camera$controls$CameraControls=module$src$3d$viewport$handlers$camera$controls$CameraInterpolationManager.default,THREE$$module$src$3d$viewport$handlers$camera$controls$CameraControls=module$src$externals$three.default;
   module$src$3d$viewport$handlers$camera$controls$CameraControls.default.CameraControls=function(){function b(a,b,d,e,g,h){this._camera=a;this._domElement=d;this._onChange=e;this._eventDispatch=g;this._adjustOrthographicSides=h;this._cameraInterpolationManager=new module$src$3d$viewport$handlers$camera$controls$CameraInterpolationManager.default.CameraInterpolationManager(this);this._moving=this._manualInteraction=!1;this._movingDuration=0;this._nonmanualInteraction=!1;this._position=new module$src$externals$three.default.Vector3;
   this._target=new module$src$externals$three.default.Vector3;this._position=b.position.clone();this._target=b.target.clone();this._camera.position.set(this._position.x,this._position.y,this._position.z);this._camera.lookAt(this._target);this._cameraEventManager=new module$src$3d$viewport$handlers$camera$controls$CameraEventManager.default.CameraEventManager(this);this._manualInteractionMatrices={position:[],target:[]};this._nonmanualInteractionMatrices={position:[],target:[]}}Object.defineProperty(b.prototype,
   "camera",{get:function(){return this._camera},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"domElement",{get:function(){return this._domElement},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"enabled",{get:function(){return this._enabled},set:function(a){a||(this._manualInteraction=!1,this._manualInteractionMatrices={position:[],target:[]},this._nonmanualInteraction=!1,this._nonmanualInteractionMatrices={position:[],target:[]},this._cameraInterpolationManager.active()&&
   this._cameraInterpolationManager.stop(),this._cameraControlsManager&&this._cameraControlsManager.reset());this._enabled=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"position",{get:function(){return this.getPosition().clone()},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"target",{get:function(){return this.getTarget().clone()},enumerable:!0,configurable:!0});b.prototype.animate=function(a,b){if(b&&0===b.duration)return this.immediateUpdate(a[a.length-
   1].position,a[a.length-1].target);this._manualInteraction=!1;this._manualInteractionMatrices={position:[],target:[]};this._onChange();return this._cameraInterpolationManager.interpolate(a,b)};b.prototype.applyPositionMatrix=function(a,b){void 0===b&&(b=!1);this._manualInteraction||b?(this._manualInteraction=!0,this._manualInteractionMatrices.position.push(a)):(this._nonmanualInteraction=!0,this._nonmanualInteractionMatrices.position.push(a));this._onChange()};b.prototype.applyTargetMatrix=function(a,
   b){void 0===b&&(b=!1);this._manualInteraction||b?(this._manualInteraction=!0,this._manualInteractionMatrices.target.push(a)):(this._nonmanualInteraction=!0,this._nonmanualInteractionMatrices.target.push(a));this._onChange()};b.prototype.applyUpMatrix=function(a,b){throw Error("Method not implemented.");};b.prototype.dispose=function(){this._cameraEventManager.dispose()};b.prototype.getPositionWithManualUpdates=function(){var a=(new module$src$externals$three.default.Vector3).set(this._position.x,
   this._position.y,this._position.z);if(this._manualInteraction)for(var b=this._manualInteractionMatrices.position.length-1;0<=b;b--)a.applyMatrix4(this._manualInteractionMatrices.position[b]);return a};b.prototype.getTargetWithManualUpdates=function(){var a=(new module$src$externals$three.default.Vector3).set(this._target.x,this._target.y,this._target.z);if(this._manualInteraction)for(var b=this._manualInteractionMatrices.target.length-1;0<=b;b--)a.applyMatrix4(this._manualInteractionMatrices.target[b]);
   return a};b.prototype.isMoving=function(){return this._manualInteraction||this._nonmanualInteraction};b.prototype.isWithinRestrictions=function(a,b){return this._cameraControlsManager.isWithinRestrictions(a,b)};b.prototype.registerCameraControls=function(a){this._cameraControlsManager=a;this._cameraEventManager.cameraControlsManager=a};b.prototype.reset=function(){this._cameraInterpolationManager.active()&&this._cameraInterpolationManager.stop();this._cameraControlsManager&&this._cameraControlsManager.reset()};
   b.prototype.update=function(a){if(this._enabled){var b=this._cameraControlsManager.restrict(this.getPosition(),this.getTarget()),d=b.target;this._position.copy(b.position);this._target.copy(d);this._camera.position.set(this._position.x,this._position.y,this._position.z);this._camera.lookAt(this._target);!0===this._manualInteraction&&this._cameraInterpolationManager.active()&&this._cameraInterpolationManager.stop();this._manualInteraction=!1;this._manualInteractionMatrices={position:[],target:[]};
   this._nonmanualInteraction=this._cameraInterpolationManager.active();this._nonmanualInteractionMatrices={position:[],target:[]};this.camera.isOrthographicCamera&&this._adjustOrthographicSides();this._cameraControlsManager.update(a,this._nonmanualInteraction);this._eventDispatch(this._manualInteraction||this._nonmanualInteraction,this._moving,this._movingDuration+=a);this._moving=this._manualInteraction||this._nonmanualInteraction;this._moving||(this._movingDuration=0);(this._manualInteraction||this._nonmanualInteraction)&&
   this._onChange()}};b.prototype.getPosition=function(){var a=(new module$src$externals$three.default.Vector3).set(this._position.x,this._position.y,this._position.z);if(this._manualInteraction)for(var b=this._manualInteractionMatrices.position.length-1;0<=b;b--)a.applyMatrix4(this._manualInteractionMatrices.position[b]);else if(this._nonmanualInteraction)for(b=this._nonmanualInteractionMatrices.position.length-1;0<=b;b--)a.applyMatrix4(this._nonmanualInteractionMatrices.position[b]);return a};b.prototype.getTarget=
   function(){var a=(new module$src$externals$three.default.Vector3).set(this._target.x,this._target.y,this._target.z);if(this._manualInteraction)for(var b=this._manualInteractionMatrices.target.length-1;0<=b;b--)a.applyMatrix4(this._manualInteractionMatrices.target[b]);else if(this._nonmanualInteraction)for(b=this._nonmanualInteractionMatrices.target.length-1;0<=b;b--)a.applyMatrix4(this._nonmanualInteractionMatrices.target[b]);return a};b.prototype.immediateUpdate=function(a,b){a=this._cameraControlsManager.restrict(a,
   b);this._position.copy(a.position);this._target.copy(a.target);this._camera.position.set(this._position.x,this._position.y,this._position.z);this._camera.lookAt(this._target);this._manualInteraction=!1;this._manualInteractionMatrices={position:[],target:[]};this._nonmanualInteraction=!1;this._nonmanualInteractionMatrices={position:[],target:[]};this._cameraInterpolationManager.active()&&this._cameraInterpolationManager.stop();this.camera.isOrthographicCamera&&this._adjustOrthographicSides();this._onChange();
   return Promise.resolve(!0)};return b}();var module$src$3d$viewport$handlers$camera$PerspectiveCameraHandler={default:{}},__extends$$module$src$3d$viewport$handlers$camera$PerspectiveCameraHandler=this&&module$src$3d$viewport$handlers$camera$PerspectiveCameraHandler.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return b(a,c)};return function(a,c){function d(){this.constructor=a}b(a,c);
   a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__values$$module$src$3d$viewport$handlers$camera$PerspectiveCameraHandler=this&&module$src$3d$viewport$handlers$camera$PerspectiveCameraHandler.default.__values||function(b){var a="function"===typeof Symbol&&Symbol.iterator,c=a&&b[a],d=0;if(c)return c.call(b);if(b&&"number"===typeof b.length)return{next:function(){b&&d>=b.length&&(b=void 0);return{value:b&&b[d++],done:!b}}};throw new TypeError(a?"Object is not iterable.":"Symbol.iterator is not defined.");
   };Object.defineProperty(module$src$3d$viewport$handlers$camera$PerspectiveCameraHandler.default,"__esModule",{value:!0});
   var BaseCameraHandler_1$$module$src$3d$viewport$handlers$camera$PerspectiveCameraHandler=module$src$3d$viewport$handlers$camera$BaseCameraHandler.default,THREE$$module$src$3d$viewport$handlers$camera$PerspectiveCameraHandler=module$src$externals$three.default,HooksAndNotifiers_1$$module$src$3d$viewport$handlers$camera$PerspectiveCameraHandler=module$src$3d$viewport$helpers$HooksAndNotifiers.default,PerspectiveCameraHooksAndNotifiers_1$$module$src$3d$viewport$handlers$camera$PerspectiveCameraHandler=
   module$src$3d$viewport$handlers$camera$hooks$PerspectiveCameraHooksAndNotifiers.default,CameraControls_1$$module$src$3d$viewport$handlers$camera$PerspectiveCameraHandler=module$src$3d$viewport$handlers$camera$controls$CameraControls.default,OrbitControlsManager_1$$module$src$3d$viewport$handlers$camera$PerspectiveCameraHandler=module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsManager.default;
   module$src$3d$viewport$handlers$camera$PerspectiveCameraHandler.default.PerspectiveCameraHandler=function(b){function a(a,d){var c=b.call(this,a,d)||this;c._defaultSettings={near:.01,far:100};c._perspectiveSettings=c._settings.getSection("cameraTypes.perspective");c._camera=new module$src$externals$three.default.PerspectiveCamera(c._perspectiveSettings.getSetting("fov"),c._container.offsetWidth/c._container.offsetHeight,c._defaultSettings.near,c._defaultSettings.far);c._camera.up.set(0,0,1);c._handlers.threeDManager.helpers.addSceneObject(c._camera);
   a=c._perspectiveSettings.getSetting("default");0===a.position.x&&0===a.position.y&&0===a.position.z&&0===a.target.x&&0===a.target.y&&0===a.target.z&&(a=c.getZoomExtentsPosition());c._cameraControls=new module$src$3d$viewport$handlers$camera$controls$CameraControls.default.CameraControls(c._camera,a,c._handlers.renderingHandler.getDomElement(),function(){c._handlers.renderingHandler.registerForContinuousRendering(c.CAMERA_MOVING_ID)},c.cameraMovementEventDispatch.bind(c));c._cameraControlsManager=
   new module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsManager.default.OrbitControlsManager(c._settings.getSection("controls.orbit"),c._cameraControls,c._handlers.renderingHandler.render,c._handlers.threeDManager.warn);module$src$3d$viewport$helpers$HooksAndNotifiers.default.registerHooksAndNotifiers(c,c._perspectiveSettings,module$src$3d$viewport$handlers$camera$hooks$PerspectiveCameraHooksAndNotifiers.default.PerspectiveCameraHooks,module$src$3d$viewport$handlers$camera$hooks$PerspectiveCameraHooksAndNotifiers.default.PerspectiveCameraNotifiers);
   return c}__extends$$module$src$3d$viewport$handlers$camera$PerspectiveCameraHandler(a,b);a.prototype.activate=function(){this.resume();this._handlers.threeDManager.getSetting("material.environmentMapAsBackground")&&this._handlers.materialHandler.setSceneBackground(this._handlers.materialHandler.getEnvironmentMap())};a.prototype.adjustToBoundingSphere=function(a){this._sceneBS=a;this._camera.far=10>this._camera.fov?100*this._camera.fov*this._defaultSettings.far*a.radius:this._defaultSettings.far*a.radius;
   this._camera.near=10>this._camera.fov?100*this._camera.fov*this._defaultSettings.near*a.radius:this._defaultSettings.near*a.radius;this._camera.updateProjectionMatrix()};a.prototype.deactivate=function(){this.pause()};a.prototype.getZoomExtentsPosition=function(a){this._camera.updateProjectionMatrix();var b=new module$src$externals$three.default.Box3;b=a||b.setFromObject(this._geometryNode);a=new module$src$externals$three.default.Vector3;b.getCenter(a);var c=new module$src$externals$three.default.Vector3;
   c.subVectors(b.max,a);c.multiplyScalar(this._settings.getSetting("zoomExtentsFactor"));b=new module$src$externals$three.default.Box3((new module$src$externals$three.default.Vector3).subVectors(a,c),(new module$src$externals$three.default.Vector3).addVectors(a,c));c=new module$src$externals$three.default.Vector3;this._camera.getWorldDirection(c);var g=(new module$src$externals$three.default.Vector3).crossVectors(this._camera.up,c).normalize(),h=(new module$src$externals$three.default.Vector3).crossVectors(g,
   c).normalize(),f=a.clone().add(c.clone().multiplyScalar(-1)),k=[];k.push(new module$src$externals$three.default.Vector3(b.min.x,b.min.y,b.min.z));k.push(new module$src$externals$three.default.Vector3(b.min.x,b.min.y,b.max.z));k.push(new module$src$externals$three.default.Vector3(b.min.x,b.max.y,b.min.z));k.push(new module$src$externals$three.default.Vector3(b.min.x,b.max.y,b.max.z));k.push(new module$src$externals$three.default.Vector3(b.max.x,b.min.y,b.min.z));k.push(new module$src$externals$three.default.Vector3(b.max.x,
   b.min.y,b.max.z));k.push(new module$src$externals$three.default.Vector3(b.max.x,b.max.y,b.min.z));k.push(new module$src$externals$three.default.Vector3(b.max.x,b.max.y,b.max.z));b=c.clone().applyAxisAngle(g,this._camera.getEffectiveFOV()/2*(Math.PI/180));var l=c.clone().applyAxisAngle(g,-(this._camera.getEffectiveFOV()/2)*(Math.PI/180)),m=2*Math.atan(Math.tan(this._camera.getEffectiveFOV()*Math.PI/180/2)*this._camera.aspect),n=c.clone().applyAxisAngle(h,m/2);m=c.clone().applyAxisAngle(h,-m/2);var q=
   new module$src$externals$three.default.Plane(g.clone(),0);q.setFromNormalAndCoplanarPoint(g,a);g=new module$src$externals$three.default.Plane(this._camera.up.clone(),0);g.setFromNormalAndCoplanarPoint(h.clone(),a);for(var p=h=0;p<k.length;p++){var u=new module$src$externals$three.default.Vector3;q.projectPoint(k[p],u);var t=u.clone().sub(f).normalize();if(c.dot(b)>c.dot(t)){var r=new module$src$externals$three.default.Vector3;u=b.dot(t)>l.dot(t)?new module$src$externals$three.default.Ray(u,b.clone().multiplyScalar(-1)):
   new module$src$externals$three.default.Ray(u,l.clone().multiplyScalar(-1));u.intersectPlane(g,r);h=Math.max(h,a.distanceTo(r))}u=new module$src$externals$three.default.Vector3;g.projectPoint(k[p],u);t=u.clone().sub(f).normalize();c.dot(n)>c.dot(t)&&(r=new module$src$externals$three.default.Vector3,u=n.dot(t)>m.dot(t)?new module$src$externals$three.default.Ray(u,n.clone().multiplyScalar(-1)):new module$src$externals$three.default.Ray(u,m.clone().multiplyScalar(-1)),u.intersectPlane(q,r),h=Math.max(h,
   a.distanceTo(r)))}f=a.clone().add(c.clone().multiplyScalar(-h));return{position:f.clone(),target:a.clone()}};a.prototype.onResize=function(a,b){this._camera.aspect=a/b;this._camera.setViewOffset(a,b,0,0,a,b);this._camera.updateProjectionMatrix()};a.prototype.resetPositionAndTarget=function(a){var b=this._perspectiveSettings.getSetting("default");0===b.position.x&&0===b.position.y&&0===b.position.z&&0===b.target.x&&0===b.target.y&&0===b.target.z&&(b=this.getZoomExtentsPosition());return this.setPositionAndTarget(b.position,
   b.target,a)};a.prototype.setCameraPath=function(a,b){var c;if(!a||!Array.isArray(a)||0===a.length)return Promise.resolve(!1);var d=[];try{for(var h=__values$$module$src$3d$viewport$handlers$camera$PerspectiveCameraHandler(a),f=h.next();!f.done;f=h.next()){var k=f.value;if(!this._globalUtils.typeCheck(k.position,"vector3any",this._handlers.threeDManager.warn,"PerspectiveCameraHandler.setCameraPath")||!this._globalUtils.typeCheck(k.target,"vector3any",this._handlers.threeDManager.warn,"PerspectiveCameraHandler.setCameraPath"))return Promise.resolve(!1);
   d.push({position:this._globalUtils.toVector3(k.position),target:this._globalUtils.toVector3(k.target)})}}catch(m){var l={error:m}}finally{try{f&&!f.done&&(c=h.return)&&c.call(h)}finally{if(l)throw l.error;}}if(!this._cameraControls.isWithinRestrictions(d[d.length-1].position,d[d.length-1].target))return Promise.resolve(!1);b||(b={});b.duration=0<=b.duration?b.duration:this._settings.getSetting("cameraMovementDuration");b.default&&(this._perspectiveSettings.updateSetting("default.position",d[d.length-
   1].position),this._perspectiveSettings.updateSetting("default.target",d[d.length-1].target));!1===this._firstTimeVisible.resolved&&(b.duration=0);return this._cameraControls.animate(d,b)};a.prototype.setPositionAndTarget=function(a,b,e){if(!this._globalUtils.typeCheck(a,"vector3any",this._handlers.threeDManager.warn,"PerspectiveCameraHandler.setPositionAndTarget")||!this._globalUtils.typeCheck(b,"vector3any",this._handlers.threeDManager.warn,"PerspectiveCameraHandler.setPositionAndTarget"))return Promise.resolve(!1);
   a=this._globalUtils.toVector3(a);b=this._globalUtils.toVector3(b);if(!this._cameraControls.isWithinRestrictions(a,b))return Promise.resolve(!1);e||(e={});e.duration=0<=e.duration?e.duration:this._settings.getSetting("cameraMovementDuration");e.default&&(this._perspectiveSettings.updateSetting("default.position",a),this._perspectiveSettings.updateSetting("default.target",b));!1===this._firstTimeVisible.resolved&&(e.duration=0);return this._cameraControls.animate([{position:this._cameraControls.position.clone(),
   target:this._cameraControls.target.clone()},{position:a,target:b}],e)};a.prototype.zoomExtents=function(a,b){b=b?b instanceof module$src$externals$three.default.Box3?b:this._globalUtils.typeCheck(b,"box3any")?new module$src$externals$three.default.Box3(this._globalUtils.toVector3(b.min),this._globalUtils.toVector3(b.max)):this._handlers.threeDManager.computeBoundingBox(b):this._handlers.threeDManager.computeBoundingBox();b=this.getZoomExtentsPosition(b);return this.setPositionAndTarget(b.position,
   b.target,a)};return a}(module$src$3d$viewport$handlers$camera$BaseCameraHandler.default.BaseCameraHandler);var module$src$3d$viewport$handlers$camera$hooks$OrthographicCameraHooksAndNotifiers={default:{}},__awaiter$$module$src$3d$viewport$handlers$camera$hooks$OrthographicCameraHooksAndNotifiers=this&&module$src$3d$viewport$handlers$camera$hooks$OrthographicCameraHooksAndNotifiers.default.__awaiter||function(b,a,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,h){function f(a){try{l(d.next(a))}catch(n){h(n)}}function g(a){try{l(d["throw"](a))}catch(n){h(n)}}
   function l(a){a.done?c(a.value):e(a.value).then(f,g)}l((d=d.apply(b,a||[])).next())})},__generator$$module$src$3d$viewport$handlers$camera$hooks$OrthographicCameraHooksAndNotifiers=this&&module$src$3d$viewport$handlers$camera$hooks$OrthographicCameraHooksAndNotifiers.default.__generator||function(b,a){function c(a){return function(b){return d([a,b])}}function d(c){if(g)throw new TypeError("Generator is already executing.");for(;e;)try{if(g=1,h&&(f=c[0]&2?h["return"]:c[0]?h["throw"]||((f=h["return"])&&
   f.call(h),0):h.next)&&!(f=f.call(h,c[1])).done)return f;if(h=0,f)c=[c[0]&2,f.value];switch(c[0]){case 0:case 1:f=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++;h=c[1];c=[0];continue;case 7:c=e.ops.pop();e.trys.pop();continue;default:if(!(f=e.trys,f=0<f.length&&f[f.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!f||c[1]>f[0]&&c[1]<f[3]))e.label=c[1];else if(6===c[0]&&e.label<f[1])e.label=f[1],f=c;else if(f&&e.label<f[2])e.label=f[2],e.ops.push(c);else{f[2]&&e.ops.pop();
   e.trys.pop();continue}}c=a.call(b,e)}catch(m){c=[6,m],h=0}finally{g=f=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},g,h,f,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k};Object.defineProperty(module$src$3d$viewport$handlers$camera$hooks$OrthographicCameraHooksAndNotifiers.default,"__esModule",{value:!0});
   var StateDashboard_1$$module$src$3d$viewport$handlers$camera$hooks$OrthographicCameraHooksAndNotifiers=module$src$modules$shapediver_state_dashboard$StateDashboard.default;
   module$src$3d$viewport$handlers$camera$hooks$OrthographicCameraHooksAndNotifiers.default.OrthographicCameraHooks={"default.position":function(b){return this._globalUtils.typeCheck(b,"vector3obj",this._handlers.threeDManager.warn,"OrthographicCameraHandler.Hook->default.position")?Promise.resolve(!0):Promise.resolve(!1)},"default.target":function(b){return this._globalUtils.typeCheck(b,"vector3obj",this._handlers.threeDManager.warn,"OrthographicCameraHandler.Hook->default.target")?Promise.resolve(!0):
   Promise.resolve(!1)},"default":function(b){return __awaiter$$module$src$3d$viewport$handlers$camera$hooks$OrthographicCameraHooksAndNotifiers(this,void 0,void 0,function(){var a,c;return __generator$$module$src$3d$viewport$handlers$camera$hooks$OrthographicCameraHooksAndNotifiers(this,function(d){switch(d.label){case 0:if(!this._globalUtils.typeCheck(b.position,"vector3obj",this._handlers.threeDManager.warn,"OrthographicCameraHandler.Hook->default")||!this._globalUtils.typeCheck(b.target,"vector3obj",
   this._handlers.threeDManager.warn,"OrthographicCameraHandler.Hook->default"))return[2,Promise.resolve(!1)];a=module$src$modules$shapediver_state_dashboard$StateDashboard.default.StateDashboardLibrary.getInstance(this._handlers.threeDManager.viewerApi.getSetting("viewerRuntimeId"));c=a.firstTimeVisible.resolved?this._settings.getSetting("cameraMovementDuration"):0;return 0!==b.position.x||0!==b.position.y||0!==b.position.z||0!==b.target.x||0!==b.target.y||0!==b.target.z?[3,2]:[4,this.zoomExtents({duration:c})];
   case 1:return d.sent(),[3,4];case 2:return[4,this.setPositionAndTarget(b.position,b.target,{duration:c})];case 3:d.sent(),d.label=4;case 4:return[2,Promise.resolve(!0)]}})})}};module$src$3d$viewport$handlers$camera$hooks$OrthographicCameraHooksAndNotifiers.default.OrthographicCameraNotifiers={};var module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicEventDistribution={default:{}};Object.defineProperty(module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicEventDistribution.default,"__esModule",{value:!0});
   module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicEventDistribution.default.OrthographicEventDistribution=function(){function b(a,b,d){this._settings=a;this._controls=b;this._cameraLogic=d;this._active={zoom:!1,pan:!1}}b.prototype.onDown=function(a){var b=this.convertInput(a),d=b.x;b=b.y;var e=window.TouchEvent&&a instanceof TouchEvent?a.touches.length:a.button,g=window.TouchEvent&&a instanceof TouchEvent?this._settings.getSetting("input").touch:this._settings.getSetting("input").mouse;
   e===g.pan&&this._settings.getSetting("enablePan")&&(this._cameraLogic.pan(d,b,this._active.pan,window.TouchEvent&&a instanceof TouchEvent),this._active.pan=!0,this._active.zoom=!1);e===g.zoom&&this._settings.getSetting("enableZoom")&&(window.TouchEvent&&a instanceof TouchEvent&&2===this._settings.getSetting("input").touch.zoom&&(d=(a.touches[0].pageX-a.touches[1].pageX)/window.innerWidth*(window.innerWidth/window.innerHeight),b=(a.touches[0].pageY-a.touches[1].pageY)/window.innerHeight),this._cameraLogic.zoom(d,
   b,this._active.zoom,window.TouchEvent&&a instanceof TouchEvent),this._active.pan=!1,this._active.zoom=!0)};b.prototype.onKey=function(a){if(this._settings.getSetting("enableKeyPan"))switch(a.keyCode){case this._settings.getSetting("input").keys.up:this._cameraLogic.pan(0,0,!1,!1);this._cameraLogic.pan(0,.05*this._settings.getSetting("keyPanSpeed"),!0,!1);a.preventDefault();a.stopPropagation();break;case this._settings.getSetting("input").keys.down:this._cameraLogic.pan(0,0,!1,!1);this._cameraLogic.pan(0,
   .05*-this._settings.getSetting("keyPanSpeed"),!0,!1);a.preventDefault();a.stopPropagation();break;case this._settings.getSetting("input").keys.left:this._cameraLogic.pan(0,0,!1,!1);this._cameraLogic.pan(.05*this._settings.getSetting("keyPanSpeed"),0,!0,!1);a.preventDefault();a.stopPropagation();break;case this._settings.getSetting("input").keys.right:this._cameraLogic.pan(0,0,!1,!1),this._cameraLogic.pan(.05*-this._settings.getSetting("keyPanSpeed"),0,!0,!1),a.preventDefault(),a.stopPropagation()}};
   b.prototype.onKeyDown=function(a){this.onKey(a)};b.prototype.onMouseDown=function(a){this.onDown(a)};b.prototype.onMouseMove=function(a){this.onMove(a)};b.prototype.onMouseUp=function(a){this.onUp(a)};b.prototype.onMouseWheel=function(a){this.onWheel(a)};b.prototype.onMove=function(a){var b=this.convertInput(a),d=b.x;b=b.y;this._settings.getSetting("enablePan")&&this._active.pan&&this._cameraLogic.pan(d,b,this._active.pan,window.TouchEvent&&a instanceof TouchEvent);this._settings.getSetting("enableZoom")&&
   this._active.zoom&&(window.TouchEvent&&a instanceof TouchEvent&&2===this._settings.getSetting("input").touch.zoom&&(d=(a.touches[0].pageX-a.touches[1].pageX)/window.innerWidth*(window.innerWidth/window.innerHeight),b=(a.touches[0].pageY-a.touches[1].pageY)/window.innerHeight),this._cameraLogic.zoom(d,b,this._active.zoom,window.TouchEvent&&a instanceof TouchEvent))};b.prototype.onTouchEnd=function(a){this.onUp(a)};b.prototype.onTouchMove=function(a){this.onMove(a)};b.prototype.onTouchStart=function(a){this.onDown(a)};
   b.prototype.onUp=function(a){this._active.zoom=!1;this._active.pan=!1};b.prototype.onWheel=function(a){if(this._settings.getSetting("enableZoom")){var b=0;void 0!==a.deltaY?b=-a.deltaY:void 0!==a.detail&&(b=-a.detail);0<Math.sign(b)?(this._cameraLogic.zoom(0,0,!1,!1),this._cameraLogic.zoom(1,0,!0,!1)):(this._cameraLogic.zoom(1,0,!1,!1),this._cameraLogic.zoom(0,0,!0,!1))}};b.prototype.reset=function(){this._active={zoom:!1,pan:!1}};b.prototype.convertInput=function(a){var b=window.innerWidth/window.innerHeight;
   return a instanceof MouseEvent?{x:a.clientX/window.innerWidth*b,y:a.clientY/window.innerHeight}:{x:a.touches[0].pageX/window.innerWidth*b,y:a.touches[0].pageY/window.innerHeight}};return b}();var module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicLogic={default:{}};Object.defineProperty(module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicLogic.default,"__esModule",{value:!0});var THREE$$module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicLogic=module$src$externals$three.default;
   module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicLogic.default.OrthographicLogic=function(){function b(a,b){var c=this;this._settings=a;this._controls=b;this._damping={rotation:{time:0,duration:0,theta:0,phi:0},zoom:{time:0,duration:0,delta:0},pan:{time:0,duration:0,offset:new module$src$externals$three.default.Vector3}};this._dollyStart=this._dollyEnd=this._dollyDelta=0;this._panDelta=new module$src$externals$three.default.Vector2;this._panEnd=new module$src$externals$three.default.Vector2;
   this._panStart=new module$src$externals$three.default.Vector2;this._settingsAdjustements={damping:1,movementSmoothness:1,panSpeed:2,zoomSpeed:.025};this._touchAdjustements={damping:1,movementSmoothness:1,panSpeed:2,zoomSpeed:50};this._adjustedSettings={damping:this._settings.getSetting("damping")*this._settingsAdjustements.damping,movementSmoothness:this._settings.getSetting("movementSmoothness")*this._settingsAdjustements.movementSmoothness,panSpeed:this._settings.getSetting("panSpeed")*this._settingsAdjustements.panSpeed,
   zoomSpeed:this._settings.getSetting("zoomSpeed")*this._settingsAdjustements.zoomSpeed};Object.keys(this._adjustedSettings).forEach(function(a){c._settings.registerHook(a,function(b){c._adjustedSettings[a]=b*c._settingsAdjustements[a];return!0})})}b.prototype.pan=function(a,b,d,e){e&&(a/=window.devicePixelRatio,b/=window.devicePixelRatio);if(d){if(this._panEnd.set(a,b),this._panDelta.subVectors(this._panEnd,this._panStart),0!==this._panDelta.x||0!==this._panDelta.y)this._panStart.copy(this._panEnd),
   a=this.panDeltaToOffset(this._panDelta.multiplyScalar(this._adjustedSettings.panSpeed*(e?this._touchAdjustements.panSpeed:1))),0<this._damping.pan.duration&&(a.x=0>a.x?Math.min(a.x,this._adjustedSettings.movementSmoothness*this._damping.pan.offset.x):Math.max(a.x,this._adjustedSettings.movementSmoothness*this._damping.pan.offset.x),a.y=0>a.y?Math.min(a.y,this._adjustedSettings.movementSmoothness*this._damping.pan.offset.y):Math.max(a.y,this._adjustedSettings.movementSmoothness*this._damping.pan.offset.y),
   a.z=0>a.z?Math.min(a.z,this._adjustedSettings.movementSmoothness*this._damping.pan.offset.z):Math.max(a.z,this._adjustedSettings.movementSmoothness*this._damping.pan.offset.z)),e=1-Math.max(.01,Math.min(1,this._adjustedSettings.damping)),b=(Math.log(1/Math.abs(a.x))-5*Math.log(10))/Math.log(e),d=(Math.log(1/Math.abs(a.y))-5*Math.log(10))/Math.log(e),e=(Math.log(1/Math.abs(a.z))-5*Math.log(10))/Math.log(e),this._damping.pan.time=0,this._damping.pan.duration=16.6666*Math.max(b,Math.max(d,e)),this._damping.pan.offset=
   a.clone(),this._damping.zoom.duration=0,this._controls.applyTargetMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(a.x,a.y,a.z),!0),this._controls.applyPositionMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(a.x,a.y,a.z),!0)}else this._panStart.set(a,b)};b.prototype.reset=function(){this._damping={rotation:{time:0,duration:0,theta:0,phi:0},zoom:{time:0,duration:0,delta:0},pan:{time:0,duration:0,offset:new module$src$externals$three.default.Vector3}};
   this._dollyStart=this._dollyEnd=this._dollyDelta=0;this._panDelta=new module$src$externals$three.default.Vector2;this._panEnd=new module$src$externals$three.default.Vector2;this._panStart=new module$src$externals$three.default.Vector2};b.prototype.update=function(a,b){!0===b&&(this._damping.zoom.duration=0,this._damping.pan.duration=0);var c=1-Math.max(.01,Math.min(1,this._adjustedSettings.damping));0<this._damping.pan.duration?this._damping.pan.time+a>this._damping.pan.duration?(this._damping.pan.time=
   this._damping.pan.duration,this._damping.pan.duration=0):(this._damping.pan.time+=a,b=this._damping.pan.time/16.6666,b=this._damping.pan.offset.clone().multiplyScalar(Math.pow(c,b)),this._controls.applyTargetMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(b.x,b.y,b.z)),this._controls.applyPositionMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(b.x,b.y,b.z))):this._damping.pan.time=0;0<this._damping.zoom.duration?this._damping.zoom.time+a>this._damping.zoom.duration?
   (this._damping.zoom.time=this._damping.zoom.duration,this._damping.zoom.duration=0):(this._damping.zoom.time+=a,b=this._damping.zoom.time/16.6666,a=this._damping.zoom.delta*Math.pow(c,b),a=this._controls.getTargetWithManualUpdates().distanceTo(this._controls.getPositionWithManualUpdates())*(1-a),c=new module$src$externals$three.default.Vector3,b=new module$src$externals$three.default.Vector3,c.copy(this._controls.getTargetWithManualUpdates()).sub(this._controls.getPositionWithManualUpdates()).normalize(),
   b.copy(this._controls.getPositionWithManualUpdates().clone().add(c.multiplyScalar(a))),b.sub(this._controls.getTargetWithManualUpdates()),this._controls.applyTargetMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(b.x,b.y,b.z),!0)):this._damping.zoom.time=0};b.prototype.zoom=function(a,b,d,e){a=Math.sqrt(a*a+b*b);e&&(a/=window.devicePixelRatio);d?(this._dollyEnd=a,this._dollyDelta=this._dollyEnd-this._dollyStart,this._dollyStart=this._dollyEnd,0<this._damping.zoom.duration&&
   (this._dollyDelta=0>this._dollyDelta?Math.min(this._dollyDelta,this._adjustedSettings.movementSmoothness*this._damping.zoom.delta):Math.max(this._dollyDelta,this._adjustedSettings.movementSmoothness*this._damping.zoom.delta)),d=this._dollyDelta*this._adjustedSettings.zoomSpeed*(e?this._touchAdjustements.zoomSpeed:1),e=(Math.log(1/Math.abs(this._dollyDelta))-5*Math.log(10))/Math.log(1-Math.max(.01,Math.min(1,this._adjustedSettings.damping))),this._damping.zoom.time=0,this._damping.zoom.duration=16.6666*
   e,this._damping.zoom.delta=d,this._damping.pan.duration=0,d=this._controls.getTargetWithManualUpdates().distanceTo(this._controls.getPositionWithManualUpdates())*(1-d),e=new module$src$externals$three.default.Vector3,a=new module$src$externals$three.default.Vector3,e.copy(this._controls.getTargetWithManualUpdates()).sub(this._controls.getPositionWithManualUpdates()).normalize(),a.copy(this._controls.getPositionWithManualUpdates().clone().add(e.multiplyScalar(d))),a.sub(this._controls.getTargetWithManualUpdates()),
   this._controls.applyTargetMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(a.x,a.y,a.z),!0)):this._dollyStart=a};b.prototype.panDeltaToOffset=function(a){var b=new module$src$externals$three.default.Vector3,d=new module$src$externals$three.default.Vector3;b.copy(this._controls.getPositionWithManualUpdates()).sub(this._controls.getTargetWithManualUpdates());b=new module$src$externals$three.default.Vector3;b.setFromMatrixColumn(this._controls.camera.matrix,0);b.multiplyScalar(-(a.x*
   (this._controls.camera.right-this._controls.camera.left)*.5/this._controls.camera.zoom));d.add(b);b=new module$src$externals$three.default.Vector3;b.setFromMatrixColumn(this._controls.camera.matrix,1);b.multiplyScalar(a.y*(this._controls.camera.right-this._controls.camera.left)*.5/this._controls.camera.zoom);d.add(b);return d.clone()};return b}();var module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicHooks={default:{}};Object.defineProperty(module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicHooks.default,"__esModule",{value:!0});
   module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicHooks.default.OrthographicControlsHooks={damping:function(b){return this._globalUtils.typeCheck(b,"notnegative",this._logWarning,"OrthographicControls.Hook->damping")?!0:!1},enableKeyPan:function(b){return this._globalUtils.typeCheck(b,"boolean",this._logWarning,"OrthographicControls.Hook->enableKeyPan")?!0:!1},enablePan:function(b){return this._globalUtils.typeCheck(b,"boolean",this._logWarning,"OrthographicControls.Hook->enablePan")?
   !0:!1},enableZoom:function(b){return this._globalUtils.typeCheck(b,"boolean",this._logWarning,"OrthographicControls.Hook->enableZoom")?!0:!1},input:function(b){return!0},keyPanSpeed:function(b){return this._globalUtils.typeCheck(b,"number",this._logWarning,"OrthographicControls.Hook->keyPanSpeed")?!0:!1},movementSmoothness:function(b){return this._globalUtils.typeCheck(b,"number",this._logWarning,"OrthographicControls.Hook->movementSmoothness")?!0:!1},panSpeed:function(b){return this._globalUtils.typeCheck(b,
   "number",this._logWarning,"OrthographicControls.Hook->panSpeed")?!0:!1},zoomSpeed:function(b){return this._globalUtils.typeCheck(b,"notnegative",this._logWarning,"OrthographicControls.Hook->zoomSpeed")?!0:!1}};module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicHooks.default.OrthographicControlsNotifiers={};var module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicManager={default:{}},__importDefault$$module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicManager=this&&module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicManager.default.__importDefault||function(b){return b&&b.__esModule?b:{"default":b}};Object.defineProperty(module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicManager.default,"__esModule",{value:!0});
   var GlobalUtils_js_1$$module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicManager=__importDefault$$module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicManager(module$src$shared$util$GlobalUtils.default),OrthographicEventDistribution_1$$module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicManager=module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicEventDistribution.default,OrthographicLogic_1$$module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicManager=
   module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicLogic.default,HooksAndNotifiers_1$$module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicManager=module$src$3d$viewport$helpers$HooksAndNotifiers.default,OrthographicHooks_1$$module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicManager=module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicHooks.default;
   module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicManager.default.OrthographicManager=function(){function b(a,b,d,e){this._settings=a;this._cameraControls=b;this._triggerRender=d;this._logWarning=e;this._globalUtils=GlobalUtils_js_1$$module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicManager.default;this._cameraLogic=new module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicLogic.default.OrthographicLogic(this._settings,this._cameraControls);
   this._cameraEventDistribution=new module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicEventDistribution.default.OrthographicEventDistribution(this._settings,this._cameraControls,this._cameraLogic);this._cameraControls.registerCameraControls(this);module$src$3d$viewport$helpers$HooksAndNotifiers.default.registerHooksAndNotifiers(this,this._settings,module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicHooks.default.OrthographicControlsHooks,module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicHooks.default.OrthographicControlsNotifiers)}
   b.prototype.isWithinRestrictions=function(a,b){return!0};b.prototype.onKeyDown=function(a){this._cameraEventDistribution.onKeyDown(a)};b.prototype.onMouseDown=function(a){this._cameraEventDistribution.onMouseDown(a)};b.prototype.onMouseMove=function(a){this._cameraEventDistribution.onMouseMove(a)};b.prototype.onMouseUp=function(a){this._cameraEventDistribution.onMouseUp(a)};b.prototype.onMouseWheel=function(a){this._cameraEventDistribution.onMouseWheel(a)};b.prototype.onTouchEnd=function(a){this._cameraEventDistribution.onTouchEnd(a)};
   b.prototype.onTouchMove=function(a){this._cameraEventDistribution.onTouchMove(a)};b.prototype.onTouchStart=function(a){this._cameraEventDistribution.onTouchStart(a)};b.prototype.reset=function(){this._cameraEventDistribution.reset();this._cameraLogic.reset()};b.prototype.restrict=function(a,b){return{position:a,target:b}};b.prototype.update=function(a,b){this._cameraLogic.update(a,b)};return b}();var module$src$3d$viewport$handlers$camera$OrthographicCameraHandler={default:{}},__extends$$module$src$3d$viewport$handlers$camera$OrthographicCameraHandler=this&&module$src$3d$viewport$handlers$camera$OrthographicCameraHandler.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return b(a,c)};return function(a,c){function d(){this.constructor=a}b(a,
   c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__values$$module$src$3d$viewport$handlers$camera$OrthographicCameraHandler=this&&module$src$3d$viewport$handlers$camera$OrthographicCameraHandler.default.__values||function(b){var a="function"===typeof Symbol&&Symbol.iterator,c=a&&b[a],d=0;if(c)return c.call(b);if(b&&"number"===typeof b.length)return{next:function(){b&&d>=b.length&&(b=void 0);return{value:b&&b[d++],done:!b}}};throw new TypeError(a?"Object is not iterable.":
   "Symbol.iterator is not defined.");};Object.defineProperty(module$src$3d$viewport$handlers$camera$OrthographicCameraHandler.default,"__esModule",{value:!0});
   var BaseCameraHandler_1$$module$src$3d$viewport$handlers$camera$OrthographicCameraHandler=module$src$3d$viewport$handlers$camera$BaseCameraHandler.default,THREE$$module$src$3d$viewport$handlers$camera$OrthographicCameraHandler=module$src$externals$three.default,HooksAndNotifiers_1$$module$src$3d$viewport$handlers$camera$OrthographicCameraHandler=module$src$3d$viewport$helpers$HooksAndNotifiers.default,OrthographicCameraHooksAndNotifiers_1$$module$src$3d$viewport$handlers$camera$OrthographicCameraHandler=
   module$src$3d$viewport$handlers$camera$hooks$OrthographicCameraHooksAndNotifiers.default,CameraControls_1$$module$src$3d$viewport$handlers$camera$OrthographicCameraHandler=module$src$3d$viewport$handlers$camera$controls$CameraControls.default,OrthographicManager_1$$module$src$3d$viewport$handlers$camera$OrthographicCameraHandler=module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicManager.default,ICameraHandler_1$$module$src$3d$viewport$handlers$camera$OrthographicCameraHandler=
   module$src$3d$viewport$interfaces$ICameraHandler.default;
   module$src$3d$viewport$handlers$camera$OrthographicCameraHandler.default.OrthographicCameraHandler=function(b){function a(a,d){var c=b.call(this,a,d)||this;c._defaultSettings={near:.01,far:1E4};c._orthographicSettings=c._settings.getSection("cameraTypes.orthographic");c._camera=new module$src$externals$three.default.OrthographicCamera(a.container.offsetWidth/a.container.offsetHeight,a.container.offsetWidth/a.container.offsetHeight,1,-1,c._defaultSettings.near,c._defaultSettings.far);c._camera.up.set(0,
   0,1);c._camera.aspect=a.container.offsetWidth/a.container.offsetHeight;c._handlers.threeDManager.helpers.addSceneObject(c._camera);a=c._orthographicSettings.getSetting("default");0===a.position.x&&0===a.position.y&&0===a.position.z&&0===a.target.x&&0===a.target.y&&0===a.target.z&&(a=c.getZoomExtentsPosition());c._cameraControls=new module$src$3d$viewport$handlers$camera$controls$CameraControls.default.CameraControls(c._camera,a,c._handlers.renderingHandler.getDomElement(),function(){c._handlers.renderingHandler.registerForContinuousRendering(c.CAMERA_MOVING_ID)},
   c.cameraMovementEventDispatch.bind(c),function(){var a=c._cameraControls.position.distanceTo(c._cameraControls.target)/2;c._camera.left=-a*c._camera.aspect;c._camera.bottom=-a;c._camera.right=a*c._camera.aspect;c._camera.top=a;c._camera.near=c._defaultSettings.near*a;c._camera.far=c._defaultSettings.far*a;c._camera.updateProjectionMatrix()});c._cameraControlsManager=new module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicManager.default.OrthographicManager(c._settings.getSection("controls.orthographic"),
   c._cameraControls,c._handlers.renderingHandler.render,c._handlers.threeDManager.warn);module$src$3d$viewport$helpers$HooksAndNotifiers.default.registerHooksAndNotifiers(c,c._orthographicSettings,module$src$3d$viewport$handlers$camera$hooks$OrthographicCameraHooksAndNotifiers.default.OrthographicCameraHooks,module$src$3d$viewport$handlers$camera$hooks$OrthographicCameraHooksAndNotifiers.default.OrthographicCameraNotifiers);return c}__extends$$module$src$3d$viewport$handlers$camera$OrthographicCameraHandler(a,
   b);a.prototype.activate=function(){this.resume();this.zoomExtents({duration:0});this._camera.updateProjectionMatrix();this._handlers.materialHandler.setSceneBackground(null)};a.prototype.adjustToBoundingSphere=function(a){this._sceneBS=a;a=this._cameraControls.position.distanceTo(this._cameraControls.target)/2;this._camera.near=this._defaultSettings.near*a;this._camera.far=this._defaultSettings.far*a;this._camera.updateProjectionMatrix()};a.prototype.deactivate=function(){this.pause()};a.prototype.getZoomExtentsPosition=
   function(a){var b=this._sceneBS;a&&a.getBoundingSphere(b);a=2*b.radius*this._settings.getSetting("zoomExtentsFactor");var c=new module$src$externals$three.default.Vector3,g=new module$src$externals$three.default.Vector3;switch(this._settings.getSetting("cameraTypes.active")){case module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType.TOP:c.set(b.center.x,b.center.y,b.center.z+a);break;case module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType.BOTTOM:c.set(b.center.x,b.center.y,
   b.center.z-a);break;case module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType.RIGHT:c.set(b.center.x+a,b.center.y,b.center.z);break;case module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType.LEFT:c.set(b.center.x-a,b.center.y,b.center.z);break;case module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType.BACK:c.set(b.center.x,b.center.y+a,b.center.z);break;case module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType.FRONT:c.set(b.center.x,b.center.y-
   a,b.center.z);break;default:c.set(b.center.x,b.center.y,b.center.z+a)}g.set(b.center.x,b.center.y,b.center.z);return{position:c,target:g}};a.prototype.onResize=function(a,b){this._camera.aspect=a/b;this._camera.left=-this._sceneBS.radius*this._camera.aspect;this._camera.right=this._sceneBS.radius*this._camera.aspect;this._camera.updateProjectionMatrix()};a.prototype.resetPositionAndTarget=function(a){var b=this._orthographicSettings.getSetting("default");0===b.position.x&&0===b.position.y&&0===b.position.z&&
   0===b.target.x&&0===b.target.y&&0===b.target.z&&(b=this.getZoomExtentsPosition());return this.setPositionAndTarget(b.position,b.target,a)};a.prototype.setCameraPath=function(a,b){var c;if(!a||!Array.isArray(a)||0===a.length)return Promise.resolve(!1);b||(b={});b.duration=0<=b.duration?b.duration:this._settings.getSetting("cameraMovementDuration");var d=[];try{for(var h=__values$$module$src$3d$viewport$handlers$camera$OrthographicCameraHandler(a),f=h.next();!f.done;f=h.next()){var k=f.value;if(!this._globalUtils.typeCheck(k.position,
   "vector3any",this._handlers.threeDManager.warn,"OrthographicCameraHandler.setCameraPath")||!this._globalUtils.typeCheck(k.target,"vector3any",this._handlers.threeDManager.warn,"OrthographicCameraHandler.setCameraPath"))return Promise.resolve(!1);var l=this._globalUtils.toVector3(k.position),m=this._globalUtils.toVector3(k.target);if(d.length+1===a.length){if(!this._cameraControls.isWithinRestrictions(l,m))return Promise.resolve(!1);b.default&&(this._orthographicSettings.updateSetting("default.position",
   l),this._orthographicSettings.updateSetting("default.target",m))}m=this.convertTargetForCurrentSide(l,m,l.distanceTo(m)/2,this._settings.getSetting("cameraTypes.active"));d.push({position:l,target:m})}}catch(q){var n={error:q}}finally{try{f&&!f.done&&(c=h.return)&&c.call(h)}finally{if(n)throw n.error;}}!1===this._firstTimeVisible.resolved&&(b.duration=0);return this._cameraControls.animate(d,b)};a.prototype.setPositionAndTarget=function(a,b,e){if(!this._globalUtils.typeCheck(a,"vector3any",this._handlers.threeDManager.warn,
   "OrthographicCameraHandler.setPositionAndTarget")||!this._globalUtils.typeCheck(b,"vector3any",this._handlers.threeDManager.warn,"OrthographicCameraHandler.setPositionAndTarget"))return Promise.resolve(!1);a=this._globalUtils.toVector3(a);b=this._globalUtils.toVector3(b);e||(e={});e.duration=0<=e.duration?e.duration:this._settings.getSetting("cameraMovementDuration");e.coordinates="Linear";if(!this._cameraControls.isWithinRestrictions(a,b))return Promise.resolve(!1);e.default&&(this._orthographicSettings.updateSetting("default.position",
   a),this._orthographicSettings.updateSetting("default.target",b));b=this.convertTargetForCurrentSide(a,b,a.distanceTo(b)/2,this._settings.getSetting("cameraTypes.active"));var c=this._settings.getSetting("cameraTypes.active");this._camera.up.set(0,c===module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType.TOP||c===module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType.BOTTOM?1:0,c===module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType.TOP||c===module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType.BOTTOM?
   0:1);this._camera.updateProjectionMatrix();!1===this._firstTimeVisible.resolved&&(e.duration=0);return this._cameraControls.animate([{position:this._cameraControls.position.clone(),target:this._cameraControls.target.clone()},{position:a,target:b}],e)};a.prototype.zoomExtents=function(a,b){b=b?b instanceof module$src$externals$three.default.Box3?b:this._globalUtils.typeCheck(b,"box3any")?new module$src$externals$three.default.Box3(this._globalUtils.toVector3(b.min),this._globalUtils.toVector3(b.max)):
   this._handlers.threeDManager.computeBoundingBox(b):this._handlers.threeDManager.computeBoundingBox();b=this.getZoomExtentsPosition(b);return this.setPositionAndTarget(b.position,b.target,a)};a.prototype.convertTargetForCurrentSide=function(a,b,e,g){switch(g){case module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType.TOP:b.set(a.x,a.y,a.z-2*e);break;case module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType.BOTTOM:b.set(a.x,a.y,a.z+2*e);break;case module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType.RIGHT:b.set(a.x-
   2*e,a.y,a.z);break;case module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType.LEFT:b.set(a.x+2*e,a.y,a.z);break;case module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType.BACK:b.set(a.x,a.y-2*e,a.z);break;case module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType.FRONT:b.set(a.x,a.y+2*e,a.z);break;default:b.set(a.x,a.y,a.z-2*e)}return b};return a}(module$src$3d$viewport$handlers$camera$BaseCameraHandler.default.BaseCameraHandler);var module$src$3d$viewport$handlers$camera$ProxyCameraHandler={default:{}};Object.defineProperty(module$src$3d$viewport$handlers$camera$ProxyCameraHandler.default,"__esModule",{value:!0});
   var ICameraHandler_1$$module$src$3d$viewport$handlers$camera$ProxyCameraHandler=module$src$3d$viewport$interfaces$ICameraHandler.default,PerspectiveCameraHandler_1$$module$src$3d$viewport$handlers$camera$ProxyCameraHandler=module$src$3d$viewport$handlers$camera$PerspectiveCameraHandler.default,OrthographicCameraHandler_1$$module$src$3d$viewport$handlers$camera$ProxyCameraHandler=module$src$3d$viewport$handlers$camera$OrthographicCameraHandler.default;
   module$src$3d$viewport$handlers$camera$ProxyCameraHandler.default.ProxyCameraHandler=function(){function b(a,b){var c=this;this._handlers=b;this.activate=function(){};this.adjustToBoundingSphere=function(a){c._perspectiveCameraHandler.adjustToBoundingSphere(a);c._orthographicCameraHandler.adjustToBoundingSphere(a)};this.deactivate=function(){};this.decreaseEventListenerCounter=function(){return c._cameraHandler.decreaseEventListenerCounter()};this.destroy=function(){c._perspectiveCameraHandler.destroy();
   c._orthographicCameraHandler.destroy()};this.getPositionAndTarget=function(){return c._cameraHandler.getPositionAndTarget()};this.getZoomExtentsPosition=function(a){return c._cameraHandler.getZoomExtentsPosition(a)};this.increaseEventListenerCounter=function(){return c._cameraHandler.increaseEventListenerCounter()};this.onResize=function(a,b){c._perspectiveCameraHandler.onResize(a,b);c._orthographicCameraHandler.onResize(a,b)};this.pause=function(){return c._cameraHandler.pause()};this.resetPositionAndTarget=
   function(a){return c._cameraHandler.resetPositionAndTarget(a)};this.resume=function(){return c._cameraHandler.resume()};this.setCameraPath=function(a,b){return c._cameraHandler.setCameraPath(a,b)};this.setPositionAndTarget=function(a,b,d){return c._cameraHandler.setPositionAndTarget(a,b,d)};this.setViewAndProjectionMatrix=function(a,b){return c._cameraHandler.setViewAndProjectionMatrix(a,b)};this.updateCameraControls=function(a){return c._cameraHandler.updateCameraControls(a)};this.zoomExtents=function(a,
   b){return c._cameraHandler.zoomExtents(a,b)};this._settings=a.settings;this._perspectiveCameraHandler=new module$src$3d$viewport$handlers$camera$PerspectiveCameraHandler.default.PerspectiveCameraHandler(a,this._handlers);this._orthographicCameraHandler=new module$src$3d$viewport$handlers$camera$OrthographicCameraHandler.default.OrthographicCameraHandler(a,this._handlers);this._cameraHandler=this._perspectiveCameraHandler;this._perspectiveCameraHandler.resume();this._orthographicCameraHandler.pause();
   this._settings.registerNotifier("cameraTypes.active",function(){c._cameraHandler.deactivate();c._cameraHandler=c._settings.getSetting("cameraTypes.active")===module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType.PERSPECTIVE?c._perspectiveCameraHandler:c._orthographicCameraHandler;c._cameraHandler.activate();c._handlers.renderingHandler.render();c._handlers.interactionHandler.updateCamera();return!0})}Object.defineProperty(b.prototype,"camera",{get:function(){return this._cameraHandler.camera},
   enumerable:!0,configurable:!0});return b}();var module$src$3d$interfaces$handlers$LightHandlerInterface={default:function(){}};module$src$3d$interfaces$handlers$LightHandlerInterface.default.prototype.pause=function(){};module$src$3d$interfaces$handlers$LightHandlerInterface.default.prototype.resume=function(){};module$src$3d$interfaces$handlers$LightHandlerInterface.default.prototype.destroy=function(){};module$src$3d$interfaces$handlers$LightHandlerInterface.default.prototype.updateLight=function(b){};
   module$src$3d$interfaces$handlers$LightHandlerInterface.default.prototype.removeLight=function(b){};module$src$3d$interfaces$handlers$LightHandlerInterface.default.prototype.getLight=function(b){};module$src$3d$interfaces$handlers$LightHandlerInterface.default.prototype.setLightSceneFromID=function(b){};module$src$3d$interfaces$handlers$LightHandlerInterface.default.prototype.setLightSceneFromDefinition=function(b){};
   module$src$3d$interfaces$handlers$LightHandlerInterface.default.prototype.getLightScene=function(b){};module$src$3d$interfaces$handlers$LightHandlerInterface.default.prototype.getAllLightScene=function(){};module$src$3d$interfaces$handlers$LightHandlerInterface.default.prototype.saveLightScene=function(b){};module$src$3d$interfaces$handlers$LightHandlerInterface.default.prototype.adjustToBoundingSphere=function(b){};
   module$src$3d$interfaces$handlers$LightHandlerInterface.default.prototype.setToggleLightShadows=function(b){};module$src$3d$interfaces$handlers$LightHandlerInterface.default.prototype.toggleLights=function(b){};var module$src$3d$viewport$defaults$DefaultLights={},THREE$$module$src$3d$viewport$defaults$DefaultLights=module$src$externals$three.default,GLOBAL_UTILS$$module$src$3d$viewport$defaults$DefaultLights=module$src$shared$util$GlobalUtils.default,lightScenes$$module$src$3d$viewport$defaults$DefaultLights={"default":{id:"default",lights:{ambient0:{id:"ambient0",type:"ambient",properties:{color:16777215,intensity:.5}},directional0:{id:"directional0",type:"directional",properties:{color:16777215,intensity:.75,
   direction:{x:.5774,y:-.5774,z:.5774},castShadow:!0}},directional1:{id:"directional1",type:"directional",properties:{color:16777215,intensity:.35,direction:{x:-.25,y:-1,z:1},castShadow:!1}}}},legacy:{id:"legacy",lights:{ambient0:{id:"ambient0",type:"ambient",properties:{color:6579300,intensity:1}},directional0:{id:"directional0",type:"directional",properties:{color:16777215,intensity:1,castShadow:!0,direction:{x:.5774,y:-.5774,z:.5774}}},flash:{id:"flash0",type:"flash",properties:{color:16777215,intensity:.4,
   distance:0,angle:Math.PI/2,penumbra:5,decay:5}}}}},lightProperties$$module$src$3d$viewport$defaults$DefaultLights={ambient:{color:{type:"color",default:16777215},intensity:{type:"notnegative",default:.5}},directional:{color:{type:"color",default:16777215},intensity:{type:"notnegative",default:.5},castShadow:{type:"boolean",default:!1},direction:{type:"vector3any",default:{x:-1,y:0,z:1}}},hemisphere:{skyColor:{type:"color",default:16777215},groundColor:{type:"color",default:16777215},intensity:{type:"notnegative",
   default:.5}},point:{color:{type:"color",default:16777215},intensity:{type:"notnegative",default:.5},distance:{type:"notnegative",default:0},decay:{type:"notnegative",default:2},position:{type:"vector3any",default:{x:0,y:0,z:0}}},spot:{color:{type:"color",default:16777215},intensity:{type:"notnegative",default:.5},distance:{type:"notnegative",default:0},angle:{type:"notnegative",default:Math.PI/4},penumbra:{type:"notnegative",default:.5},decay:{type:"notnegative",default:1},position:{type:"vector3any",
   default:{x:1,y:1,z:1}},target:{type:"vector3any",default:{x:0,y:0,z:0}}},flash:{color:{type:"color",default:16777215},intensity:{type:"notnegative",default:.4},distance:{type:"notnegative",default:0},angle:{type:"notnegative",default:Math.PI/2},penumbra:{type:"notnegative",default:5},decay:{type:"notnegative",default:5}}},lightTypes$$module$src$3d$viewport$defaults$DefaultLights={AMBIENT:"ambient",DIRECTIONAL:"directional",HEMISPHERE:"hemisphere",POINT:"point",SPOT:"spot",FLASH:"flash"},clampingFactor$$module$src$3d$viewport$defaults$DefaultLights=
   230/255,initFunction$$module$src$3d$viewport$defaults$DefaultLights={ambient:function(b,a,c){var d=module$src$shared$util$GlobalUtils.default.toTinyColor(b.properties.color).toThreeColor();b=new module$src$externals$three.default.AmbientLight(d,b.properties.intensity);a.add(b);a=new module$src$externals$three.default.Object3D;c.add(a);return{light:b,helper:new module$src$externals$three.default.Object3D}},directional:function(b,a,c,d,e,g){var h=module$src$shared$util$GlobalUtils.default.toTinyColor(b.properties.color).toThreeColor(),
   f=new module$src$externals$three.default.DirectionalLight(h,b.properties.intensity),k=new module$src$externals$three.default.Object3D;a.add(k);f.target=k;a.add(f);f.direction=module$src$shared$util$GlobalUtils.default.toVector3(b.properties.direction).normalize();f.position.set(d.center.x+f.direction.x*d.radius*2.35,d.center.y+f.direction.y*d.radius*2.35,d.center.z+f.direction.z*d.radius*2.35);f.target.position.set(d.center.x,d.center.y,d.center.z);b.properties.castShadow&&(f.shadows=!0,f.castShadow=
   e?!1:g,f.shadow.camera.up.set(0,0,1),f.shadow.camera.far=8*d.radius,f.shadow.camera.right=1.5*d.radius,f.shadow.camera.left=-1.5*d.radius,f.shadow.camera.top=1.5*d.radius,f.shadow.camera.bottom=-1.5*d.radius,f.shadow.mapSize.width=2048,f.shadow.mapSize.height=2048,f.shadow.radius=2,f.shadow.bias=-.00175,f.shadow.camera.updateProjectionMatrix());b=new module$src$externals$three.default.ArrowHelper(f.direction.clone().multiplyScalar(-1),f.position,f.target.position.distanceTo(f.position),h.clone().multiplyScalar(clampingFactor$$module$src$3d$viewport$defaults$DefaultLights));
   b.cone.material.wireframe=!0;c.add(b);return{light:f,helper:b}},hemisphere:function(b,a,c){var d=module$src$shared$util$GlobalUtils.default.toTinyColor(b.properties.skyColor).toThreeColor(),e=module$src$shared$util$GlobalUtils.default.toTinyColor(b.properties.groundColor).toThreeColor();b=new module$src$externals$three.default.HemisphereLight(d,e,b.properties.intensity);b.position.set(0,0,1);b.up.set(0,0,1);a.add(b);a=new module$src$externals$three.default.Object3D;c.add(a);return{light:b,helper:a}},
   point:function(b,a,c,d){var e=module$src$shared$util$GlobalUtils.default.toTinyColor(b.properties.color).toThreeColor(),g=new module$src$externals$three.default.PointLight(e,b.properties.intensity,b.properties.distance,b.properties.decay);g.position.set(b.properties.position.x,b.properties.position.y,b.properties.position.z);a.add(g);a=new module$src$externals$three.default.IcosahedronBufferGeometry(d.radius/10,0);e=new module$src$externals$three.default.MeshBasicMaterial({color:e.clone().multiplyScalar(clampingFactor$$module$src$3d$viewport$defaults$DefaultLights),
   wireframe:!0,fog:!1});e=new module$src$externals$three.default.Mesh(a,e);a=new module$src$externals$three.default.Object3D;a.add(e);a.position.set(b.properties.position.x,b.properties.position.y,b.properties.position.z);c.add(a);return{light:g,helper:a}},spot:function(b,a,c){var d=module$src$shared$util$GlobalUtils.default.toTinyColor(b.properties.color).toThreeColor(),e=(new module$src$externals$three.default.Vector3(b.properties.position.x,b.properties.position.y,b.properties.position.z)).distanceTo(new module$src$externals$three.default.Vector3(b.properties.target.x,
   b.properties.target.y,b.properties.target.z));e=new module$src$externals$three.default.SpotLight(d,b.properties.intensity,e,b.properties.angle,b.properties.penumbra,b.properties.decay);var g=new module$src$externals$three.default.Object3D;a.add(g);e.target=g;e.position.set(b.properties.position.x,b.properties.position.y,b.properties.position.z);e.target.position.set(b.properties.target.x,b.properties.target.y,b.properties.target.z);e.up.set(0,0,1);a.add(e);b=new module$src$externals$three.default.SpotLightHelper(e,
   d.clone().multiplyScalar(clampingFactor$$module$src$3d$viewport$defaults$DefaultLights));b.up.set(0,0,1);c.add(b);return{light:e,helper:b}},flash:function(b,a,c){var d=module$src$shared$util$GlobalUtils.default.toTinyColor(b.properties.color).toThreeColor();b=new module$src$externals$three.default.SpotLight(d,b.properties.intensity,b.properties.distance,b.properties.angle,b.properties.penumbra,b.properties.decay);b.position.set(0,0,1);b.target=a.cameraHandler.camera;a.cameraHandler.camera.add(b);
   a=new module$src$externals$three.default.Object3D;c.add(a);return{light:b,helper:a}}},updateFunction$$module$src$3d$viewport$defaults$DefaultLights={ambient:function(b,a){var c=module$src$shared$util$GlobalUtils.default.toTinyColor(b.properties.color).toThreeColor();a.light.color=c;a.light.intensity=b.properties.intensity},directional:function(b,a,c,d,e){var g=module$src$shared$util$GlobalUtils.default.toTinyColor(b.properties.color).toThreeColor();a.light.color=g;a.light.intensity=b.properties.intensity;
   a.light.direction=module$src$shared$util$GlobalUtils.default.toVector3(b.properties.direction).normalize();a.light.position.set(c.center.x+a.light.direction.x*c.radius*2.35,c.center.y+a.light.direction.y*c.radius*2.35,c.center.z+a.light.direction.z*c.radius*2.35);a.light.target.position.set(c.center.x,c.center.y,c.center.z);a.light.shadows!==b.properties.castShadow&&(b.properties.castShadow?(a.light.shadows=!0,a.light.castShadow=d?!1:e,a.light.shadow.camera.up.set(0,0,1),a.light.shadow.camera.far=
   8*c.radius,a.light.shadow.camera.right=1.5*c.radius,a.light.shadow.camera.left=-1.5*c.radius,a.light.shadow.camera.top=1.5*c.radius,a.light.shadow.camera.bottom=-1.5*c.radius,a.light.shadow.mapSize.width=2048,a.light.shadow.mapSize.height=2048,a.light.shadow.radius=2,a.light.shadow.bias=-.00175,a.light.shadow.camera.updateProjectionMatrix()):(a.light.shadows=!1,a.light.castShadow=!1));a.helper.setColor(g.clone().multiplyScalar(clampingFactor$$module$src$3d$viewport$defaults$DefaultLights));a.helper.setDirection(a.light.direction.clone().multiplyScalar(-1));
   a.helper.position.set(a.light.position.x,a.light.position.y,a.light.position.z);a.helper.setLength(a.light.target.position.distanceTo(a.light.position))},hemisphere:function(b,a){a.light.intensity=b.properties.intensity;var c=module$src$shared$util$GlobalUtils.default.toTinyColor(b.properties.skyColor).toThreeColor();b=module$src$shared$util$GlobalUtils.default.toTinyColor(b.properties.groundColor).toThreeColor();if(a.light.color!=c||a.light.groundColor!=b)a.light.color=c,a.light.groundColor=b},point:function(b,
   a){var c=module$src$shared$util$GlobalUtils.default.toTinyColor(b.properties.color).toThreeColor();a.light.color=c;a.light.intensity=b.properties.intensity;a.light.distance=b.properties.distance;a.light.decay=b.properties.decay;a.light.position.set(b.properties.position.x,b.properties.position.y,b.properties.position.z);a.helper.children[0].material.color=c.clone().multiplyScalar(clampingFactor$$module$src$3d$viewport$defaults$DefaultLights);a.helper.position.set(b.properties.position.x,b.properties.position.y,
   b.properties.position.z)},spot:function(b,a){var c=module$src$shared$util$GlobalUtils.default.toTinyColor(b.properties.color).toThreeColor();a.light.color=c;a.light.intensity=b.properties.intensity;var d=(new module$src$externals$three.default.Vector3(b.properties.position.x,b.properties.position.y,b.properties.position.z)).distanceTo(new module$src$externals$three.default.Vector3(b.properties.target.x,b.properties.target.y,b.properties.target.z));a.light.distance=d;a.light.angle=b.properties.angle;
   a.light.penumbra=b.properties.penumbra;a.light.decay=b.properties.decay;a.light.position.set(b.properties.position.x,b.properties.position.y,b.properties.position.z);a.light.target.position.set(b.properties.target.x,b.properties.target.y,b.properties.target.z);a.helper.color=c.clone().multiplyScalar(clampingFactor$$module$src$3d$viewport$defaults$DefaultLights);a.helper.update()},flash:function(b,a){var c=module$src$shared$util$GlobalUtils.default.toTinyColor(b.properties.color).toThreeColor();a.light.color=
   c;a.light.intensity=b.properties.intensity;a.light.distance=b.properties.distance;a.light.angle=b.properties.angle;a.light.penumbra=b.properties.penumbra;a.light.decay=b.properties.decay}};
   module$src$3d$viewport$defaults$DefaultLights.default={lightScenes:lightScenes$$module$src$3d$viewport$defaults$DefaultLights,lightProperties:lightProperties$$module$src$3d$viewport$defaults$DefaultLights,lightTypes:lightTypes$$module$src$3d$viewport$defaults$DefaultLights,lightInit:initFunction$$module$src$3d$viewport$defaults$DefaultLights,lightUpdate:updateFunction$$module$src$3d$viewport$defaults$DefaultLights};var module$src$3d$viewport$handlers$LightHandler={default:function(b,a){var c=module$src$3d$viewport$defaults$DefaultLights.default.lightTypes,d=module$src$3d$viewport$defaults$DefaultLights.default.lightInit,e=module$src$3d$viewport$defaults$DefaultLights.default.lightUpdate,g=b.settings,h,f=new module$src$externals$three.default.Object3D,k=new module$src$externals$three.default.Object3D,l=new module$src$externals$three.default.Object3D,m=new module$src$externals$three.default.Object3D,n=new module$src$externals$three.default.Sphere,
   q=!1,p=b.shadows,u={},t=module$src$3d$viewport$defaults$DefaultLights.default.lightScenes,r={},v=module$src$3d$viewport$defaults$DefaultLights.default.lightProperties,w,y="",x=function(b){if(!module$src$shared$util$GlobalUtils.default.typeCheck(b,"string",a.threeDManager.warn,"LightHandler.Hook->lightScene"))return!1;if(!t[b]&&!r[b]){w||(w=module$src$modules$shapediver_state_dashboard$StateDashboard.default.StateDashboardLibrary.getInstance(a.threeDManager.viewerApi.getSetting("viewerRuntimeId")));
   if(w.getCustomState(a.threeDManager.api.getViewportRuntimeId()+"_settingsRestored")&&w.getCustomState(a.threeDManager.api.getViewportRuntimeId()+"_settingsRestored").resolved)return a.threeDManager.warn("LightHandler.Hook->lightScene","The provided light scene is not available."),!1;y=b;return!0}if(t[b]===u.id||r[b]===u.id)return a.threeDManager.warn("LightHandler.Hook->lightScene","The current light scene is already set to this value."),!1;u.id!==b&&h.setLightSceneFromID(b);return!0},A=function(b){if(!b)return!1;
   r=b;w||(w=module$src$modules$shapediver_state_dashboard$StateDashboard.default.StateDashboardLibrary.getInstance(a.threeDManager.viewerApi.getSetting("viewerRuntimeId")));w.getCustomState(a.threeDManager.api.getViewportRuntimeId()+"_settingsRestored")&&w.getCustomState(a.threeDManager.api.getViewportRuntimeId()+"_settingsRestored").resolved||!y||h.setLightSceneFromID(y);return!0},z=function(b){if(!module$src$shared$util$GlobalUtils.default.typeCheck(b,"boolean",a.threeDManager.warn,"LightHandler.Hook->helper"))return!1;
   m.visible=b;a.renderingHandler.updateShadowMap();a.renderingHandler.render();return!0},B=function(){module$src$3d$interfaces$handlers$LightHandlerInterface.default.call(this);h=this;a.threeDManager.helpers.addSceneObject(f);f.add(l);f.add(m);f.visible=a.threeDManager.getSetting("camera.type")==module$src$3d$viewport$ThreeDManagerConstants.default.cameraViewTypes.PERSPECTIVE;m.visible=g.getSetting("helper");a.threeDManager.helpers.addSceneObject(k);k.add(new module$src$externals$three.default.AmbientLight(16777215,
   1));k.visible=a.threeDManager.getSetting("camera.type")!=module$src$3d$viewport$ThreeDManagerConstants.default.cameraViewTypes.PERSPECTIVE;n.radius=25;u=JSON.parse(JSON.stringify(t["default"]));for(var b in u.lights)h.updateLight(u.lights[b]);u.wasUpdated=!1;u.id="default";g.registerHook("lightScene",x);g.registerHook("lightScenes",A);g.registerHook("helper",z)};$jscomp.inherits(B,module$src$3d$interfaces$handlers$LightHandlerInterface.default);B.prototype.pause=function(){};B.prototype.resume=function(){};
   B.prototype.destroy=function(){};B.prototype._getCleanLightScene=function(a){a=JSON.parse(JSON.stringify(a));delete a.wasUpdated;for(var b in a.lights)delete a.lights[b].lightObject,delete a.lights[b].wasUpdated;return a};B.prototype._updateLightObject=function(b,f){if(!f)b.type===c.DIRECTIONAL?f=d[c.DIRECTIONAL](b,l,m,n,q,p):b.type===c.AMBIENT?f=d[c.AMBIENT](b,l,m):b.type===c.HEMISPHERE?f=d[c.HEMISPHERE](b,l,m):b.type===c.POINT?f=d[c.POINT](b,l,m,n):b.type===c.SPOT?f=d[c.SPOT](b,l,m):b.type===c.FLASH&&
   (f=d[c.FLASH](b,a,m),f.visible=a.threeDManager.getSetting("camera.type")==module$src$3d$viewport$ThreeDManagerConstants.default.cameraViewTypes.PERSPECTIVE),b.lightObject=f;else if(b.type===c.DIRECTIONAL)e[c.DIRECTIONAL](b,f,n,q,p);else if(b.type===c.AMBIENT)e[c.AMBIENT](b,f);else if(b.type===c.HEMISPHERE)e[c.HEMISPHERE](b,f);else if(b.type===c.POINT)e[c.POINT](b,f);else if(b.type===c.SPOT)e[c.SPOT](b,f);else if(b.type===c.FLASH)e[c.FLASH](b,f)};B.prototype._createDefault=function(a){var b={},d;for(d in v[a])b[d]=
   v[a][d].default;a===c.SPOT?(a=n.center.clone().add((new module$src$externals$three.default.Vector3(1,0,1)).normalize().multiplyScalar(2*n.radius)),b.position={x:a.x,y:a.y,z:a.z},b.target={x:n.center.x,y:n.center.y,z:n.center.z}):a===c.POINT&&(a=n.center.clone().add((new module$src$externals$three.default.Vector3(0,0,1)).normalize().multiplyScalar(n.radius)),b.position={x:a.x,y:a.y,z:a.z});return b};B.prototype._evaluateProperties=function(a,b,c){for(var d in c.properties)void 0!==b[d]&&null!==b[d]&&
   v[a][d]&&module$src$shared$util$GlobalUtils.default.typeCheck(b[d],v[a][d].type)&&(c.properties[d]=b[d]);return c};B.prototype._parseLightDefinition=function(a,b){if(!a.id||!module$src$shared$util$GlobalUtils.default.typeCheck(a.id,"string")){a.id=0===Object.keys(r).length?"scene":"scene_"+Object.keys(r).length;for(var d=Object.keys(r).length;r[a.id];)a.id="scene_"+d++}if(!a.type||-1===Object.values(c).indexOf(a.type))return null;b||(b={},b.id=a.id,b.type=a.type,b.properties=h._createDefault(a.type));
   return h._evaluateProperties(a.type,a.properties,b)};B.prototype.updateLight=function(b){var c=h._parseLightDefinition(b,b.id&&module$src$shared$util$GlobalUtils.default.typeCheck(b.id,"string")?u.lights[b.id]:null);if(!c||c.type!==b.type)return!1;h._updateLightObject(c,c.lightObject);u.lights[c.id]=c;if(!u.wasUpdated)for(u.wasUpdated=!0,u.id=0===Object.keys(r).length?"scene":"scene_"+Object.keys(r).length,b=Object.keys(r).length;r[u.id];)u.id="scene_"+b++;a.renderingHandler.updateShadowMap();a.renderingHandler.render();
   return!0};B.prototype.removeLight=function(b){return b&&module$src$shared$util$GlobalUtils.default.typeCheck(b,"string")?(m.remove(u.lights[b].lightObject.helper),u.lights[b].lightObject.light.target&&l.remove(u.lights[b].lightObject.light.target),l.remove(u.lights[b].lightObject.light),u.lights[b].type===c.FLASH?a.cameraHandler.camera.remove(u.lights[b].lightObject.light):l.remove(u.lights[b].lightObject.light),delete u.lights[b].lightObject,delete u.lights[b],u.wasUpdated||(u.wasUpdated=!0,u.id=
   module$src$shared$util$GlobalUtils.default.createRandomId()),a.renderingHandler.updateShadowMap(),a.renderingHandler.render(),!0):!1};B.prototype.getLight=function(a){return h._getCleanLightScene(u).lights[a]};B.prototype.setLightSceneFromID=function(a){if(a&&module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")&&(t[a]||r[a])){for(var b in u.lights)h.removeLight(b);var c;t[a]?c=JSON.parse(JSON.stringify(t[a])):r[a]&&(c=JSON.parse(JSON.stringify(r[a])));for(var d in c.lights)h.updateLight(c.lights[d]);
   u.id=c.id;u.wasUpdated=!1;g.updateSetting("lightScene",a);return!0}return!1};B.prototype.setLightSceneFromDefinition=function(a){a.id&&module$src$shared$util$GlobalUtils.default.typeCheck(a.id,"string")&&!t[a.id]||(a.id=module$src$shared$util$GlobalUtils.default.createRandomId());for(var b in u.lights)h.removeLight(b);u={id:a.id,wasUpdated:!1,lights:{}};for(var c in a.lights)h.updateLight(a.lights[c]);h.saveLightScene(a.id);return u.id};B.prototype.getLightScene=function(a){if(a){if(t[a])return h._getCleanLightScene(t[a]);
   if(r[a])return h._getCleanLightScene(r[a])}else return h._getCleanLightScene(u)};B.prototype.getAllLightScenes=function(){return Object.keys(t).concat(Object.keys(r))};B.prototype.saveLightScene=function(a){if(!a||!module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")||t[a]){a=0===Object.keys(r).length?"scene":"scene_"+Object.keys(r).length;for(var b=Object.keys(r).length;r[a];)a="scene_"+b++}u.id=a;u.wasUpdated=!1;r[a]=h._getCleanLightScene(u);g.updateSetting("lightScenes",r);g.updateSetting("lightScene",
   a);return a};B.prototype.adjustToBoundingSphere=function(b){n=b;for(var c in u.lights){var d=u.lights[c].lightObject.light,e=u.lights[c].lightObject.helper;d.isDirectionalLight?(d.position.set(b.center.x+d.direction.x*b.radius*2.35,b.center.y+d.direction.y*b.radius*2.35,b.center.z+d.direction.z*b.radius*2.35),d.target.position.set(b.center.x,b.center.y,b.center.z),e.setDirection(d.direction.clone().multiplyScalar(-1)),e.position.set(d.position.x,d.position.y,d.position.z),e.setLength(d.target.position.distanceTo(d.position)),
   d.shadows&&(d.shadow.camera.far=8*b.radius,d.shadow.camera.right=1.5*b.radius,d.shadow.camera.left=-1.5*b.radius,d.shadow.camera.top=1.5*b.radius,d.shadow.camera.bottom=-1.5*b.radius,d.shadow.camera.updateProjectionMatrix())):d.isPointLight&&(e.children[0].geometry.radius=n.radius/10)}a.renderingHandler.updateShadowMap()};B.prototype.adaptLightingToCameraType=function(a){f.visible=a==module$src$3d$viewport$ThreeDManagerConstants.default.cameraViewTypes.PERSPECTIVE;k.visible=a!=module$src$3d$viewport$ThreeDManagerConstants.default.cameraViewTypes.PERSPECTIVE;
   for(var b in u.lights){var d=u.lights[b];d.type===c.FLASH&&(d.lightObject.visible=a==module$src$3d$viewport$ThreeDManagerConstants.default.cameraViewTypes.PERSPECTIVE)}return!0};B.prototype.setToggleLightShadows=function(a){p=a;for(a=0;a<l.children.length;a++)l.children[a].shadows&&(l.children[a].castShadow=q?!1:p)};B.prototype.shadowSettingOverride=function(b){q||(q=b);q&&(a.threeDManager.warn("LightHandler","Due to restrictions to the number of maps that can be used with this device, the shadows were disabled."),
   h.setToggleLightShadows())};B.prototype.reevaluateNumberOfShadowMaps=function(b){for(var c=a.threeDManager.helpers.getMaterials(),d=0,e=c.length;d<e;d++){var f=c[d];f.availableTextures&&(b=Math.min(b,f.availableTextures))}for(d=c=0;d<l.children.length;d++)l.children[d].castShadow&&c++;h.shadowSettingOverride(c-1>=b)};B.prototype.toggleLights=function(a){l.visible=a};return new B(b)}};var module$src$3d$viewport$handlers$HighlightingHandler={default:function(b,a){var c=b.pathUtils,d=b.geometryNode,e,g=null,h=null,f=[],k=[],l=!1,m=!1,n=function(){e=this};n.prototype._highlight=function(a,b,e){b&&(a=c.getPathObject(d,a.interactionPath+""),a.highlighted!=e&&(a.highlighted=e,a.traverse(function(a){e?b.apply(a,b.options):b.remove(a,b.options)})))};n.prototype.setDragged=function(a){e.setToggleHighlights(!1);h=a;e.setToggleHighlights(!0);return!0};n.prototype.removeDragged=function(){e.setToggleHighlights(!1);
   h=null;e.setToggleHighlights(!0);return!0};n.prototype.getDragged=function(){return h};n.prototype.toggleSelected=function(a){e.setToggleHighlights(!1);for(var b=-1,c=0;c<f.length;c++)void 0!==a.interactionPath?a.interactionPath===f[c].interactionPath&&(b=c):f[c]==a&&(b=c);c=!1;-1<b?f.splice(b,1):(f.push(a),c=!0);m=!0;e.setToggleHighlights(!0,c);return c};n.prototype.setSelected=function(a){if(!a.interactionGroup)return!1;e.setToggleHighlights(!1);for(var b=-1,c=0;c<f.length;c++)void 0!==a.interactionPath?
   a.interactionPath===f[c].interactionPath&&(b=c):f[c]==a&&(b=c);-1===b&&f.push(a);m=-1===b;e.setToggleHighlights(!0);return!0};n.prototype.removeSelected=function(a){if(!a.interactionGroup)return!1;var b=!1;e.setToggleHighlights(!1);for(var c=-1,d=0;d<f.length;d++)void 0!==a.interactionPath?a.interactionPath===f[d].interactionPath&&(c=d):f[d]==a&&(c=d);-1!==c&&(f.splice(c,1),b=!0);m=-1!==c;e.setToggleHighlights(!0);return b};n.prototype.getSelected=function(){return f};n.prototype.setHovered=function(a){e.setToggleHighlights(!1);
   g=a;e.setToggleHighlights(!0);return!0};n.prototype.removeHovered=function(){e.setToggleHighlights(!1);g=null;e.setToggleHighlights(!0);return!0};n.prototype.getHovered=function(){return g};n.prototype.removeObject=function(a){e.removeSelected(a);g===a&&(g=null);h===a&&(h=null);a=k.indexOf(a);-1!=a&&k.splice(a,1);return!0};n.prototype.setInteractable=function(a){if(!Array.isArray(a))return!1;e.setToggleHighlights(!1);k=a;e.setToggleHighlights(!0);return!0};n.prototype.setToggleHighlights=function(b){if("boolean"!==
   typeof b)return a.threeDManager.warn("HighlightingHandler.setToggleHighlights","Not a boolean. The highlighting was not toggled."),!1;if(l==b)return!1;a.threeDManager.helpers.toggleViewport(!0);l=b;if(h){var c=a.interactionGroupManager.getGroup(h.interactionGroup);e._highlight(h,c.getDraggableHighlight().active,b)}var d=0;for(c=f.length;d<c;d++){var n=f[d],q=a.interactionGroupManager.getGroup(n.interactionGroup);e._highlight(n,q.getSelectableHighlight().active,b)}g&&!m&&(c=a.interactionGroupManager.getGroup(g.interactionGroup),
   e._highlight(g,c.getHoverableHighlight().active,b));if(h)for(d=a.interactionGroupManager.getGroup(h.interactionGroup),n=0,c=k.length;n<c;n++)k[n].interactionGroup==h.interactionGroup&&k[n]!=h&&e._highlight(k[n],d.getDraggableHighlight().passive,b);if(g&&!m)for(d=a.interactionGroupManager.getGroup(g.interactionGroup),n=0,c=k.length;n<c;n++)k[n].interactionGroup==g.interactionGroup&&k[n]!=g&&e._highlight(k[n],d.getHoverableHighlight().passive,b);d=0;for(c=f.length;d<c;d++){n=f[d];q=a.interactionGroupManager.getGroup(n.interactionGroup);
   for(var v={i$228:0},w=k.length;v.i$228<w;v={i$228:v.i$228},v.i$228++)k[v.i$228].interactionGroup==n.interactionGroup&&(f.includes(k[v.i$228])||(void 0!==k[v.i$228].interactionPath?0===f.filter(function(a){return function(b){return b.interactionPath===k[a.i$228].interactionPath}}(v)).length&&e._highlight(k[v.i$228],q.getSelectableHighlight().passive,b):e._highlight(k[v.i$228],q.getSelectableHighlight().passive,b)))}m&&(m=l);a.threeDManager.helpers.toggleViewport(!1);return!0};n.prototype.getToggleHighlights=
   function(){return l};return new n(b)}};var module$src$3d$viewport$handlers$InteractionHandler={default:function(b,a){var c=b.pathUtils,d=b.settings,e=b.scene,g=b.geometryNode,h,f=[],k=a.renderingHandler.getDomElement(),l=!1,m,n=new module$src$externals$three.default.Vector3,q=new module$src$externals$three.default.Vector3,p=function(){h=this;m=new module$src$externals$three.default.DragControls(f,a.cameraHandler.camera,k);m.addEventListener("dragstart",h._interactionStartEvent);m.addEventListener("drag",h._interactionEvent);m.addEventListener("dragend",
   h._interactionEndEvent);m.addEventListener("hoveron",h._hoverStartEvent);m.addEventListener("hover",h._hoverEvent);m.addEventListener("hoveroff",h._hoverEndEvent);m.addEventListener("emptyclick",h._interactionEmptyClickEvent);m.addEventListener("mousedowncustom",function(){l=!0});m.addEventListener("mouseupcustom",function(){l=!1});a.highlightingHandler=new module$src$3d$viewport$handlers$HighlightingHandler.default({settings:d,scene:e,geometryNode:g,pathUtils:c},a);a.threeDManager.highlightingHandler=
   a.highlightingHandler};p.prototype._dispatchEvent=function(a){for(var b=new CustomEvent(a.type),c=$jscomp.makeIterator(a),d=c.next();!d.done;d=c.next())d=d.value,b[d]=a[d];k.dispatchEvent(b);return b};p.prototype._interactionStartEvent=function(b){if(b.object.interactionGroup){var d=a.interactionGroupManager.getGroup(b.object.interactionGroup);if(d&&(1==d.isDraggable()||1==d.isSelectable())){var e=void 0===b.object.interactionPath||!0===b.object.parent.meshHelper&&"sub"===b.object.parent.interactionType?
   b.object.parent:c.getPathObject(g,b.object.interactionPath+"");if(1==d.isDraggable()){n.copy(b.object.position);q.copy(b.object.position);a.threeDManager.updateSetting("camera.enableCameraControls",!1);a.renderingHandler.updateShadowMap();a.highlightingHandler.setDragged(b.object);a.renderingHandler.registerForContinuousRendering("interactionInProcess");var f={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_DRAG_START,viewportRuntimeId:a.threeDManager.runtimeId,obj:e,
   scenePath:c.getObjectPath(e),dragPosStart:n.clone(),clientX:b.event.clientX,clientY:b.event.clientY},l=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,f);a.threeDManager.message(f.type,l);h._dispatchEvent(f)}if(1==d.isSelectable()){d={viewportRuntimeId:a.threeDManager.runtimeId,clientX:b.event.clientX,clientY:b.event.clientY};if(a.highlightingHandler.toggleSelected(b.object)){if(d.type=module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SELECT_ON,
   "single"===a.interactionGroupManager.getGroup(b.object.interactionGroup).getSelectionMode()){f=a.highlightingHandler.getSelected();l=0;for(var m=f.length;l<m;l++)if(f[l].interactionGroup==b.object.interactionGroup&&f[l]!=b.object){m=void 0===f[l].interactionPath||!0===f[l].parent.meshHelper&&"sub"===f[l].parent.interactionType?f[l].parent:c.getPathObject(g,f[l].interactionPath+"");a.highlightingHandler.removeSelected(f[l]);f={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SELECT_OFF,
   obj:m,scenePath:c.getObjectPath(m),clientX:b.event.clientX,clientY:b.event.clientY};l=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,f);a.threeDManager.message(f.type,l);h._dispatchEvent(f);break}}}else d.type=module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SELECT_OFF;d.obj=e;d.scenePath=c.getObjectPath(e);d.type===module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SELECT_ON&&
   (d.selectPos=b.point);b=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,d);a.threeDManager.message(d.type,b);h._dispatchEvent(d);a.renderingHandler.render()}}}};p.prototype._interactionEvent=function(b){if(b.object.interactionGroup){var d=a.interactionGroupManager.getGroup(b.object.interactionGroup);d&&0!=d.isDraggable()&&b.position&&(d=void 0===b.object.interactionPath||!0===b.object.parent.meshHelper&&
   "sub"===b.object.parent.interactionType?b.object.parent:c.getPathObject(g,b.object.interactionPath+""),d.position.add(b.position.clone().sub(q)),q.copy(b.position),b={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_DRAG_MOVE,viewportRuntimeId:a.threeDManager.runtimeId,obj:d,scenePath:c.getObjectPath(d),dragPosStart:n.clone(),dragPosAbs:q.clone(),clientX:b.event.clientX,clientY:b.event.clientY},b.dragPosRel=b.dragPosAbs.clone().sub(b.dragPosStart),d=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,
   b),a.threeDManager.message(b.type,d),h._dispatchEvent(b),a.renderingHandler.updateShadowMap())}};p.prototype._interactionEndEvent=function(b){if(b.object.interactionGroup){var d=a.interactionGroupManager.getGroup(b.object.interactionGroup);if(d&&0!=d.isDraggable()){a.highlightingHandler.removeDragged();d={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_DRAG_END,viewportRuntimeId:a.threeDManager.runtimeId,clientX:b.event.clientX,clientY:b.event.clientY};var e=a.highlightingHandler.getHovered();
   e&&(e=void 0===e.interactionPath||!0===e.parent.meshHelper&&"sub"===e.parent.interactionType?e.parent:c.getPathObject(g,e.interactionPath+""),d.hovered={obj:e,scenePath:c.getObjectPath(e)});b=void 0===b.object.interactionPath||!0===b.object.parent.meshHelper&&"sub"===b.object.parent.interactionType?b.object.parent:c.getPathObject(g,b.object.interactionPath+"");d.obj=b;d.scenePath=c.getObjectPath(b);d.dragPosStart=n.clone();d.dragPosAbs=q.clone();d.dragPosRel=d.dragPosAbs.clone().sub(d.dragPosStart);
   b=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,d);a.threeDManager.message(d.type,b);a.threeDManager.updateSetting("camera.enableCameraControls",!0);a.renderingHandler.unregisterForContinuousRendering("interactionInProcess");h._dispatchEvent(d)}}};p.prototype._interactionEmptyClickEvent=function(){for(var b=a.highlightingHandler.getSelected(),d=!1,e=b.length;e--;)if("single"===a.interactionGroupManager.getGroup(b[e].interactionGroup).getSelectionMode()){d=
   void 0===b[e].interactionPath||!0===b[e].parent.meshHelper&&"sub"===b[e].parent.interactionType?b[e].parent:c.getPathObject(g,b[e].interactionPath+"");a.highlightingHandler.removeSelected(b[e]);d={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SELECT_OFF,obj:d,scenePath:c.getObjectPath(d)};var f=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,d);a.threeDManager.message(d.type,
   f);h._dispatchEvent(d);d=!0}1==d&&a.renderingHandler.render()};p.prototype._hoverStartEvent=function(b){if((!0!==l||a.highlightingHandler.getDragged())&&b.object.interactionGroup){var d=a.interactionGroupManager.getGroup(b.object.interactionGroup);d&&0!=d.isHoverable()&&(d=void 0===b.object.interactionPath||!0===b.object.parent.meshHelper&&"sub"===b.object.parent.interactionType?b.object.parent:c.getPathObject(g,b.object.interactionPath+""),a.highlightingHandler.setHovered(b.object),a.renderingHandler.registerForContinuousRendering("hoverInProcess"),
   b={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_HOVER_ON,viewportRuntimeId:a.threeDManager.runtimeId,obj:d,scenePath:c.getObjectPath(d),hoverPos:b.point,clientX:b.event.clientX,clientY:b.event.clientY},d=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,b),a.threeDManager.message(b.type,d),h._dispatchEvent(b))}};p.prototype._hoverEvent=function(b){if((!0!==l||a.highlightingHandler.getDragged())&&
   b.object.interactionGroup){var d=a.interactionGroupManager.getGroup(b.object.interactionGroup);if(d&&0!=d.isHoverable()){d=void 0===b.object.interactionPath||!0===b.object.parent.meshHelper&&"sub"===b.object.parent.interactionType?b.object.parent:c.getPathObject(g,b.object.interactionPath+"");if(a.highlightingHandler.getHovered()!==b.object){a.highlightingHandler.setHovered(b.object);a.renderingHandler.registerForContinuousRendering("hoverInProcess");var e={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_HOVER_ON,
   viewportRuntimeId:a.threeDManager.runtimeId,obj:d,scenePath:c.getObjectPath(d),hoverPos:b.point,clientX:b.event.clientX,clientY:b.event.clientY},f=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,e);a.threeDManager.message(e.type,f);h._dispatchEvent(e)}b={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_HOVER_OVER,viewportRuntimeId:a.threeDManager.runtimeId,obj:d,scenePath:c.getObjectPath(d),
   hoverPos:b.point,clientX:b.event.clientX,clientY:b.event.clientY};d=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,b);a.threeDManager.message(b.type,d);h._dispatchEvent(b)}}};p.prototype._hoverEndEvent=function(b){if(a.highlightingHandler.getHovered()&&b.object.interactionGroup){var d=a.interactionGroupManager.getGroup(b.object.interactionGroup);d&&0!=d.isHoverable()&&(d=void 0===b.object.interactionPath||
   !0===b.object.parent.meshHelper&&"sub"===b.object.parent.interactionType?b.object.parent:c.getPathObject(g,b.object.interactionPath+""),a.highlightingHandler.removeHovered(),b={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_HOVER_OFF,viewportRuntimeId:a.threeDManager.runtimeId,obj:d,scenePath:c.getObjectPath(d),clientX:b.event.clientX,clientY:b.event.clientY},d=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,
   b),a.threeDManager.message(b.type,d),a.renderingHandler.unregisterForContinuousRendering("hoverInProcess"),h._dispatchEvent(b))}};p.prototype.addToInteractionGroup=function(b,d,e,l){var k=c.getPathObject(g,b+"");if(!k)return a.threeDManager.warn("InteractionHandler.addToInteractionGroup","No valid path provided, interactivity was not set."),!1;if(!d||!a.interactionGroupManager.isInteractionGroup(d))return a.threeDManager.warn("InteractionHandler.addToInteractionGroup","No valid group provided, interactivity was not set."),
   !1;var n=a.interactionGroupManager.getGroup(d);if(!n)return!1;if(module$src$shared$util$GlobalUtils.default.typeCheck(e,"notnegative")){k=c.getPathsAtDepth(k,e);n=!0;for(var u=0;u<k.length;u++)n=n&&this.addToInteractionGroup(k[u],d,"global",l);return n}"global"===e&&(k.interactionGroup=d);var t=n.isSelectable(d)||n.isDraggable(d)||n.isHoverable(d);k.traverse(function(a){"Mesh"==a.type&&(a.interactionGroup=d,!0===a.parent.meshHelper&&(a.parent.interactionGroup=d,a.interactionPath=c.getObjectPath(a.parent.parent),
   a.parent.interactionType=e),"global"===e&&(a.interactionPath=b+""),t&&f.push(a))});l?h.setInteractionPlaneNormal(b,l):h.removeInteractionPlaneNormal(b);m.setObjects(f);a.highlightingHandler.setInteractable(f);return!0};p.prototype.removeFromInteractions=function(b){b=c.getPathObject(g,b+"");if(!b)return a.threeDManager.warn("InteractionHandler.removeFromInteractionGroup","No valid path provided, interactivity was not removed."),!1;b.traverse(function(b){for(var d=a.highlightingHandler.getSelected(),
   e=-1,g=0;g<d.length;g++)void 0!==b.interactionPath?b.interactionPath===d[g].interactionPath&&(e=g):d[g]==b&&(e=g);-1!==e&&(a.highlightingHandler.removeObject(b),d={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SELECT_OFF,obj:b,scenePath:c.getObjectPath(b)},e=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,d),a.threeDManager.message(d.type,e),h._dispatchEvent(d));b===
   a.highlightingHandler.getHovered()&&(a.highlightingHandler.removeHovered(),a.highlightingHandler.removeObject(b),d={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_HOVER_OFF,viewportRuntimeId:a.threeDManager.runtimeId,obj:b,scenePath:c.getObjectPath(b)},e=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,d),a.threeDManager.message(d.type,e),a.renderingHandler.unregisterForContinuousRendering("hoverInProcess"),
   h._dispatchEvent(d));b===a.highlightingHandler.getDragged()&&(a.highlightingHandler.removeDragged(),a.highlightingHandler.removeObject(b),d=void 0!==b.interactionPath?q:b.position,d={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_DRAG_END,viewportRuntimeId:a.threeDManager.runtimeId,obj:b,scenePath:c.getObjectPath(b),dragPosStart:n.clone(),dragPosAbs:d.clone()},d.dragPosRel=d.dragPosAbs.clone().sub(d.dragPosStart),e=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,
   d),a.threeDManager.message(d.type,e),a.threeDManager.updateSetting("camera.enableCameraControls",!0),a.renderingHandler.unregisterForContinuousRendering("interactionInProcess"),h._dispatchEvent(d));"Mesh"==b.type&&(delete b.interactionGroup,delete b.interactionPath,b=f.indexOf(b),-1<b&&f.splice(b,1))});m.setObjects(f);a.highlightingHandler.setInteractable(f);return!0};p.prototype.removeAllInteractivity=function(){for(var b=0,c=f.length;b<c;b++)a.highlightingHandler.removeObject(f[b]),delete f[b].interactionGroup,
   delete f[b].interactionPath;f=[];m.setObjects(f);a.highlightingHandler.setInteractable(f);return!0};p.prototype.setSelectedPaths=function(b,d){b=b||[];d=d||[];for(var e=h.getSelectedPaths(),l=[],m=[],k=0,n=f.length;k<n;k++)void 0!==f[k].interactionPath?(l.push(f[k].interactionPath),m.push("global")):(l.push(c.getObjectPath(f[k])),m.push("sub"));m=0;for(n=b.length;m<n;m++){if(!0!==module$src$shared$util$GlobalUtils.default.typeCheck(b[m],"string"))return a.threeDManager.warn("InteractionHandler.setSelectedPaths",
   "At least one path is not a string."),!1;if(!l.includes(b[m]))return a.threeDManager.warn("InteractionHandler.setSelectedPaths","At least one path is not interactable."),!1}m=0;for(n=d.length;m<n;m++){if(!0!==module$src$shared$util$GlobalUtils.default.typeCheck(d[m],"string"))return a.threeDManager.warn("InteractionHandler.setSelectedPaths","At least one path is not a string."),!1;if(!l.includes(d[m]))return a.threeDManager.warn("InteractionHandler.setSelectedPaths","At least one path is not interactable."),
   !1}l=0;for(n=d.length;l<n;l++)e.includes(d[l])&&c.getPathObject(g,d[l]+"").traverse(function(b){"Mesh"==b.type&&a.highlightingHandler.removeSelected(b)});e=h.getSelectedPaths();d=0;for(n=b.length;d<n;d++)e.includes(b[d])||c.getPathObject(g,b[d]+"").traverse(function(b){if("Mesh"==b.type){if("single"===a.interactionGroupManager.getGroup(b.interactionGroup).getSelectionMode())for(var c=a.highlightingHandler.getSelected(),d=0,e=c.length;d<e;d++)if(c[d].interactionGroup==b.interactionGroup){a.highlightingHandler.removeSelected(c[d]);
   break}a.highlightingHandler.setSelected(b)}});a.renderingHandler.render();return!0};p.prototype.getSelectedPaths=function(){for(var b=a.highlightingHandler.getSelected(),d=[],e=0,f=b.length;e<f;e++)void 0!==b[e].interactionPath?d.push(b[e].interactionPath+""):d.push(c.getObjectPath(b[e]));return d};p.prototype.setInteractionPlaneNormal=function(b,d){b=c.getPathObject(g,b);if(!b)return a.threeDManager.warn("InteractionHandler.setInteractionPlaneNormal","No valid path provided, interaction plane was not set."),
   !1;b.traverse(function(a){"Mesh"==a.type&&(a.interactionPlaneNormal=d)});return!0};p.prototype.removeInteractionPlaneNormal=function(b){b=c.getPathObject(g,b);if(!b)return a.threeDManager.warn("InteractionHandler.removeInteractionPlaneNormal","No valid path provided, interaction plane was not removed."),!1;b.traverse(function(a){"Mesh"==a.type&&a.hasOwnProperty("interactionPlaneNormal")&&delete a.interactionPlaneNormal});return!0};p.prototype.startExternalDragEvent=function(b,d){var e;"mouse"!==d&&
   "touch"!==d&&(d="mouse");var f=e=function(e){a.threeDManager.viewerApi.scene.toggleGeometry([b],[]);var l=c.getPathObject(g,b),k;l.traverse(function(a){"Mesh"==a.type&&(k=a)});"mouse"===d?(m.onDocumentMouseDownFake({selected:k,point:l.position.clone(),event:{clientX:e.clientX,clientY:e.clientY}}),m.onDocumentMouseMove(e),h()):(m.onDocumentTouchStartFake({changedTouch:e.changedTouches[0],selected:k,point:l.position.clone(),event:{clientX:e.clientX,clientY:e.clientY}}),m.onDocumentTouchMove(e),f=m.onDocumentTouchMove,
   a.threeDManager.viewerApi.scene.addEventListener(a.threeDManager.viewerApi.scene.EVENTTYPE.DRAG_END,h))};mobileDragWrapper=function(a){k===document.elementFromPoint(a.changedTouches[0].clientX,a.changedTouches[0].clientY)&&f(a)};var h=function(){"mouse"===d?document.removeEventListener("mouseup",h):document.removeEventListener("touchend",h);"mouse"===d?k.removeEventListener("mousemove",e):document.removeEventListener("touchmove",mobileDragWrapper)};"mouse"===d?document.addEventListener("mouseup",
   h):document.addEventListener("touchend",h);"mouse"===d?k.addEventListener("mousemove",e):document.addEventListener("touchmove",mobileDragWrapper)};p.prototype.updateCamera=function(){m.updateCamera(a.cameraHandler.camera)};return new p(b)}};var module$src$3d$viewport$ThreeDManager={default:function(b,a){var c=a.pathUtils,d=a.settings,e=a.scene,g=a.geometryNode,h=a.container,f=a.interactionGroupManager,k=a.viewportManager,l={},m=[],n,q,p,u,t,r=0,v=h.offsetWidth,w=h.offsetHeight,y={},x=!0,A=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean"))return!1;h&&(h.style.opacity=a?1:0);return!0},z=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"string"))return!1;h&&(h.style.transition=0<a.length?
   "opacity "+a:"none");return!0},B=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",n.warn,"ThreeDManager.Hook->fullscreen"))return!1;var b=h;if("true"!=h.getAttribute("sdv-fullscreen"))for(var c=h.parentElement,d=!1;!d&&null!==c;)"true"==c.getAttribute("sdv-fullscreen")?(d=!0,b=c):c=c.parentElement;return a&&!n._isInFullScreen()?(b.requestFullscreen?b.requestFullscreen():b.webkitRequestFullscreen?b.webkitRequestFullscreen():b.msRequestFullscreen?b.msRequestFullscreen():
   b.mozRequestFullScreen&&b.mozRequestFullScreen(),y.left=b.style.left,y.top=b.style.top,y.backgroundColor=b.style.backgroundColor,b.style.left="0%",b.style.top="0%",b.style.backgroundColor=b.style.backgroundColor||"rgba(255,255,255,1)",l.renderingHandler.render(),!0):!a&&n._isInFullScreen()?(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen&&document.mozCancelFullScreen(),
   module$src$shared$util$GlobalUtils.default.typeCheck(y.left,"string")&&(b.style.left=y.left,delete y.left),module$src$shared$util$GlobalUtils.default.typeCheck(y.top,"string")&&(b.style.top=y.top,delete y.top),module$src$shared$util$GlobalUtils.default.typeCheck(y.backgroundColor,"string")&&""!==y.backgroundColor&&(b.style.backgroundColor=y.backgroundColor,delete y.backgroundColor),l.renderingHandler.render(),!0):n._isInFullScreen()===a?!0:!1},J=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,
   "boolean",n.warn,"ThreeDManager.Hook->groundPlaneVisibility"))return!1;u&&(u.visible=a);l.renderingHandler.render();return!0},F=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",n.warn,"ThreeDManager.Hook->groundPlaneReflectionVisibility"))return!1;t&&(t.visible=a);a&&(n.warn("ThreeDManager.Hook->groundPlaneReflectionVisibility","The ground plane reflection and the environment as background do not work together right now."),n.updateSetting("material.environmentMapAsBackground",
   !1),l.materialHandler.setSceneBackground(null));l.renderingHandler.render();return!0},E=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"number",n.warn,"ThreeDManager.Hook->groundPlaneReflectionThreshold"))return!1;t&&(t.threshold=a);l.renderingHandler.render();return!0},G=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",n.warn,"ThreeDManager.Hook->gridVisibility"))return!1;p&&(p.visible=a);l.renderingHandler.render();return!0},H=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,
   "number",n.warn,"ThreeDManager.Hook->duration"))return!1;r=a;return!0},C=function(a,b){module$src$3d$interfaces$ThreeDManagerInterface.default.call(this,b,module$src$shared$util$GlobalUtils.default);n=this;n.constants=module$src$3d$viewport$ThreeDManagerConstants.default;l.threeDManager=n;n.viewerApi=a;q=new module$src$3d$viewport$helpers$ThreeDManagerHelpers.default({scene:e,geometryNode:g,pathUtils:c},l);l.threeDManager.helpers=q;h.style.padding="0";a=(new module$node_modules$shapedivernodemodule_viewersettings$bundle.default.Settings_2_0).toJSON().viewer.scene;
   a.camera=Object.assign(module$src$3d$viewport$ThreeDManagerConstants.default.cameraLegacyDefaultSettings.camera,a.camera);module$src$shared$mixins$SettingsMixin.default.call(n,d,a,b.runtimeId);document.addEventListener("webkitfullscreenchange",function(){n.updateSetting("fullscreen",n._isInFullScreen())},!1);document.addEventListener("mozfullscreenchange",function(){n.updateSetting("fullscreen",n._isInFullScreen())},!1);document.addEventListener("fullscreenchange",function(){n.updateSetting("fullscreen",
   n._isInFullScreen())},!1);this.renderingHandler=new module$src$3d$viewport$handlers$RenderingHandler.default({settings:n.getSection("render"),scene:e,geometryNode:g,container:h,pathUtils:c},l);l.renderingHandler=this.renderingHandler;!1!==n.success&&(this.materialHandler=new module$src$3d$viewport$handlers$MaterialHandler.default.MaterialHandler({settings:n.getSection("material"),scene:e,geometryNode:g,pathUtils:c},l),l.materialHandler=this.materialHandler,!1!==n.success&&(this.cameraHandler=new module$src$3d$viewport$handlers$camera$ProxyCameraHandler.default.ProxyCameraHandler({settings:n.getSection("camera"),
   scene:e,geometryNode:g,container:h},l),l.cameraHandler=this.cameraHandler,!1!==n.success&&(this.lightHandler=new module$src$3d$viewport$handlers$LightHandler.default({settings:n.getSection("lights"),shadows:n.getSettingShallow("render.shadows"),scene:e,geometryNode:g},l),l.lightHandler=this.lightHandler,!1!==n.success&&(l.interactionGroupManager=f,l.threeDManager.interactionGroupManager=f,this.interactionHandler=new module$src$3d$viewport$handlers$InteractionHandler.default({settings:n.getSection("interaction"),
   scene:e,geometryNode:g,pathUtils:c},l),l.interactionHandler=this.interactionHandler,!1!==n.success&&(this.registerHook("show",A),this.registerHook("showSceneTransition",z),this.registerHook("fullscreen",B),this.registerHook("groundPlaneVisibility",J),this.registerHook("groundPlaneReflectionVisibility",F),this.registerHook("groundPlaneReflectionThreshold",E),this.registerHook("gridVisibility",G),this.registerHook("duration",H))))))};$jscomp.inherits(C,module$src$3d$interfaces$ThreeDManagerInterface.default);
   C.prototype._isInFullScreen=function(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement||document.mozFullScreenElement)};C.prototype._getExchangeMeshMaterialObjects=function(){return m};C.prototype.init=function(a){l.renderingHandler.start();var b=a.min.distanceTo(a.max);if(1<b){var c=parseInt(b);c=c.toString();c=c.length;c=Math.pow(10,c-1);b=Math.max(Math.ceil(b/c)*c,1);c=b/(c/10)}else{c=1-Math.floor(Math.log(b)/Math.log(10))-2;b=b.toFixed(c+1);
   var d=parseInt(b.substr(b.length-1))+1;b="0.";for(var e=0;e<c;++e)b+="0";b=parseFloat(b+d);c=10*d}p=new module$src$externals$three.default.GridHelper(2*b,c);p.material.opacity=.15;p.material.transparent=!0;p.isSelectable=!1;p.rotateX(Math.PI/2);p.visible=n.getSetting("gridVisibility");c=new module$src$externals$three.default.Object3D;c.SDLocalPath="grid";c.add(p);d=new module$src$externals$three.default.PlaneGeometry(2*b,2*b,2,2);e={color:13882323,side:module$src$externals$three.default.FrontSide,
   roughness:1,metalness:0};u=new module$src$externals$three.default.Mesh(d,l.materialHandler.getMaterial(e));u.receiveShadow=!0;u.visible=n.getSetting("groundPlaneVisibility");b=new module$src$externals$three.default.Object3D;b.SDLocalPath="groundplane";b.add(u);n.addMesh(u,u.material,e);t=new module$src$externals$three.default.Reflector(d,{clipBias:.003,textureWidth:v*window.devicePixelRatio,textureHeight:w*window.devicePixelRatio,color:7829367,recursion:1});t.receiveShadow=!0;t.transparent=!0;t.visible=
   n.getSetting("groundPlaneReflectionVisibility");t.visible&&n.updateSetting("material.environmentMapAsBackground",!1);b.add(t);d=a.getBoundingSphere();p.position.set(d.center.x,d.center.y,a.min.z-.005);u.position.set(d.center.x,d.center.y,a.min.z-.005);t.scale.set(d.radius,d.radius,d.radius);t.position.set(d.center.x,d.center.y,a.min.z-.005);q.addSceneObject(c);q.addSceneObject(b);q.initialize();n.adjustScene()};C.prototype.adjustScene=function(){if(q.isInitialized()){var a=g.computeSceneBoundingBox(),
   b=new module$src$externals$three.default.Sphere;a.getBoundingSphere(b);p.position.set(p.position.x,p.position.y,a.min.z-.005);u.position.set(u.position.x,u.position.y,a.min.z-.005);t.position.set(t.position.x,t.position.y,a.min.z-.005);l.materialHandler.adjustToBoundingSphere(b);l.lightHandler.adjustToBoundingSphere(b);l.cameraHandler.adjustToBoundingSphere(b);l.materialHandler.compile();l.renderingHandler.updateShadowMap();l.renderingHandler.render()}};C.prototype.computeBoundingBox=function(a){return g.computeBoundingBox(a)};
   C.prototype.pause=function(){x=!1;l.renderingHandler.pause();l.cameraHandler.pause();l.lightHandler.pause();l.materialHandler.pause()};C.prototype.resume=function(){x=!0;l.renderingHandler.resume();l.cameraHandler.resume();l.lightHandler.resume();l.materialHandler.resume();l.renderingHandler.render()};C.prototype.destroy=function(){delete l.threeDManager;q.destroyViewport();l.renderingHandler&&l.renderingHandler.destroy();l.cameraHandler&&l.cameraHandler.destroy();l.lightHandler&&l.lightHandler.destroy();
   l.materialHandler&&l.materialHandler.destroy();n.deregisterAllHooks();for(n.deregisterAllNotifiers();h.firstChild;)h.removeChild(h.firstChild);for(var a in l)delete l[a]};C.prototype.reload=function(){return k.reloadThreeDManager(n.runtimeId)};C.prototype.addMesh=function(a,b,c){q.addMesh(a,b,c)};C.prototype.removeMesh=function(a){for(var b=0,c=m.length;b<c;b++)if(a===m[b].mesh){m.splice(b,1);break}q.removeMesh(a)};C.prototype.addAnchor=function(a,b){q.addAnchor(a,b)};C.prototype.removeAnchor=function(a){q.removeAnchor(a)};
   C.prototype.fadeIn=function(a,b){var d=c.getPathObject(g,a);if(null==d)return Promise.reject(Error("Could not fade in geometry, path not found"));x?module$src$shared$util$GlobalUtils.default.typeCheck(b,"number")||(b=r):b=0;return new Promise(function(c){q.toggleMeshes(!0);d.traverseVisible(function(a){a.SDMaterialDefinition&&a.material&&(a.material.transparent=!0,a.material.opacity=0)});q.toggleMeshes(!1);var e={opacity:0},f=(new module$node_modules$$tweenjs$tween_js$src$Tween.default.Tween(e)).to({opacity:1},
   b).onUpdate(function(){q.toggleMeshes(!0);d.traverseVisible(function(a){a.SDMaterialDefinition&&a.material&&(a.material.opacity="gem"===a.SDMaterialDefinition.materialType?a.material.side===module$src$externals$three.default.FrontSide?e.opacity*(a.SDMaterialDefinition.transparent?a.SDMaterialDefinition.opacityFront:1):e.opacity*(a.SDMaterialDefinition.transparent?a.SDMaterialDefinition.opacityBack:1):e.opacity*(a.SDMaterialDefinition.transparent?a.SDMaterialDefinition.opacity:1))});q.toggleMeshes(!1)}).onComplete(function(){q.toggleMeshes(!0);
   d.traverseVisible(function(a){a.SDMaterialDefinition&&a.material&&(a.material.opacity="gem"===a.SDMaterialDefinition.materialType?a.material.side===module$src$externals$three.default.FrontSide?a.SDMaterialDefinition.opacityFront:a.SDMaterialDefinition.opacityBack:a.SDMaterialDefinition.opacity,a.material.transparent=a.SDMaterialDefinition.transparent)});q.toggleMeshes(!1);l.renderingHandler.unregisterForContinuousRendering("FADE_IN_"+a);c()});l.renderingHandler.registerForContinuousRendering("FADE_IN_"+
   a);f.start()})};C.prototype.fadeOut=function(a,b){var d=c.getPathObject(g,a);if(null==d)return Promise.reject(Error("Could not fade out, geometry, path not found."));x?module$src$shared$util$GlobalUtils.default.typeCheck(b,"number")||(b=r):b=0;return new Promise(function(c){q.toggleMeshes(!0);d.traverseVisible(function(a){a.hasOwnProperty("material")&&(a.material.transparent=!0)});q.toggleMeshes(!1);var e={opacity:1},f=(new module$node_modules$$tweenjs$tween_js$src$Tween.default.Tween(e)).to({opacity:0},
   b).onUpdate(function(){q.toggleMeshes(!0);d.traverseVisible(function(a){a.SDMaterialDefinition&&a.material&&(a.material.opacity="gem"===a.SDMaterialDefinition.materialType?a.material.side===module$src$externals$three.default.FrontSide?e.opacity*a.SDMaterialDefinition.opacityFront:e.opacity*a.SDMaterialDefinition.opacityBack:e.opacity*a.SDMaterialDefinition.opacity)});q.toggleMeshes(!1)}).onComplete(function(){q.toggleMeshes(!0);d.traverseVisible(function(a){a.SDMaterialDefinition&&a.material&&(a.material.opacity=
   0)});q.toggleMeshes(!1);l.renderingHandler.unregisterForContinuousRendering("FADE_OUT_"+a);c()});l.renderingHandler.registerForContinuousRendering("FADE_OUT_"+a);f.start()})};C.prototype.setLiveTransformation=function(a,b,c,d,e){return q.setLiveTransformation(a,b,c,d,e)};C.prototype.updateInteractions=function(a,b){if(b&&module$src$shared$util$GlobalUtils.default.typeCheck(b.interactionGroup,"string")){l.highlightingHandler.setToggleHighlights(!1);var c=b.interactionGroup,d="sub";module$src$shared$util$GlobalUtils.default.typeCheck(b.interactionMode,
   "string")?"global"===b.interactionMode&&(d="global"):module$src$shared$util$GlobalUtils.default.typeCheck(b.interactionMode,"notnegative")&&(d=b.interactionMode);b=module$src$shared$util$GlobalUtils.default.typeCheck(b.dragPlaneNormal,"vector3any")?module$src$shared$util$GlobalUtils.default.toVector3(b.dragPlaneNormal):void 0;l.interactionHandler.addToInteractionGroup(a,c,d,b);l.highlightingHandler.setToggleHighlights(!0)}};C.prototype.removeFromInteractions=function(a){l.interactionHandler.removeFromInteractions(a)};
   C.prototype.toggleGeometry=function(a,b){q.toggleGeometry(a,b)};return new C(b,a)}};var module$src$3d$interfaces$api$ViewportApiInterface={default:function(){this.lights=this.camera=null}};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.getViewportRuntimeId=function(){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.getContainer=function(){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.getScreenshot=function(){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.getScreenshotAsync=function(){};
   module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.render=function(){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.updateShadowMap=function(){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.startContinuousRendering=function(){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.stopContinuousRendering=function(){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.convertTo2D=function(b){};
   module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.pause=function(){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.resume=function(){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.addEventListener=function(b,a){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.removeEventListener=function(b){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.getSettingDefinitions=function(){};
   module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.getSettings=function(b){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.getSetting=function(b){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.updateSettingAsync=function(b,a){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.updateSettingsAsync=function(b){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.setTransformation=function(b){};
   module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.getTransformation=function(){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.applyTransformation=function(b){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.resetTransformation=function(){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.setLiveTransformation=function(b,a){};
   module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.updateSelected=function(b,a){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.getSelected=function(){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.startExternalDragEvent=function(b,a){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.toggleGeometry=function(){};var module$src$3d$viewport$api$CameraApi={default:{}},__awaiter$$module$src$3d$viewport$api$CameraApi=this&&module$src$3d$viewport$api$CameraApi.default.__awaiter||function(b,a,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,h){function f(a){try{l(d.next(a))}catch(n){h(n)}}function g(a){try{l(d["throw"](a))}catch(n){h(n)}}function l(a){a.done?c(a.value):e(a.value).then(f,g)}l((d=d.apply(b,a||[])).next())})},__generator$$module$src$3d$viewport$api$CameraApi=
   this&&module$src$3d$viewport$api$CameraApi.default.__generator||function(b,a){function c(a){return function(b){return d([a,b])}}function d(c){if(g)throw new TypeError("Generator is already executing.");for(;e;)try{if(g=1,h&&(f=c[0]&2?h["return"]:c[0]?h["throw"]||((f=h["return"])&&f.call(h),0):h.next)&&!(f=f.call(h,c[1])).done)return f;if(h=0,f)c=[c[0]&2,f.value];switch(c[0]){case 0:case 1:f=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++;h=c[1];c=[0];continue;case 7:c=e.ops.pop();
   e.trys.pop();continue;default:if(!(f=e.trys,f=0<f.length&&f[f.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!f||c[1]>f[0]&&c[1]<f[3]))e.label=c[1];else if(6===c[0]&&e.label<f[1])e.label=f[1],f=c;else if(f&&e.label<f[2])e.label=f[2],e.ops.push(c);else{f[2]&&e.ops.pop();e.trys.pop();continue}}c=a.call(b,e)}catch(m){c=[6,m],h=0}finally{g=f=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},g,h,
   f,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k},__importDefault$$module$src$3d$viewport$api$CameraApi=this&&module$src$3d$viewport$api$CameraApi.default.__importDefault||function(b){return b&&b.__esModule?b:{"default":b}};Object.defineProperty(module$src$3d$viewport$api$CameraApi.default,"__esModule",{value:!0});
   var MessagingConstants_1$$module$src$3d$viewport$api$CameraApi=__importDefault$$module$src$3d$viewport$api$CameraApi(module$src$shared$constants$MessagingConstants.default),ApiResponse_1$$module$src$3d$viewport$api$CameraApi=__importDefault$$module$src$3d$viewport$api$CameraApi(module$src$api$v2$ApiResponse.default),ICameraHandler_1$$module$src$3d$viewport$api$CameraApi=module$src$3d$viewport$interfaces$ICameraHandler.default;
   module$src$3d$viewport$api$CameraApi.default.CameraApi=function(){function b(a,b){this._api=a;this._threeDManager=b}b.prototype.addEventListener=function(a,b){if(!Object.values(module$src$3d$viewport$interfaces$ICameraHandler.default.CameraEventType).includes(a))return ApiResponse_1$$module$src$3d$viewport$api$CameraApi.default("Unsupported event type");var c=this._api.subscribeToMessageStream(MessagingConstants_1$$module$src$3d$viewport$api$CameraApi.default.messageTopics.SCENE_CAMERA+"."+a,function(c,
   d){c=new CustomEvent(a);c.api=d.api;d.token&&(c.token=d.token);var e={};e[MessagingConstants_1$$module$src$3d$viewport$api$CameraApi.default.messageDataTypes.GENERIC]=null;e[MessagingConstants_1$$module$src$3d$viewport$api$CameraApi.default.messageDataTypes.SCENE_CAMERA]=null;for(var f in e){var g=d.getUniquePartByType(f);if(g){g.data&&(g=g.data);var l=e[f]?e[f]:g,m;for(m in l)c[m]=g[m]}}b(c)});c&&this._threeDManager.cameraHandler.increaseEventListenerCounter();return ApiResponse_1$$module$src$3d$viewport$api$CameraApi.default(null,
   c)};b.prototype.animateAsync=function(a,b){return __awaiter$$module$src$3d$viewport$api$CameraApi(this,void 0,void 0,function(){var c;return __generator$$module$src$3d$viewport$api$CameraApi(this,function(d){switch(d.label){case 0:return[4,this._threeDManager.cameraHandler.setCameraPath(a,b)];case 1:return c=d.sent(),[2,ApiResponse_1$$module$src$3d$viewport$api$CameraApi.default(c?null:"Camera path animation failed",this._threeDManager.cameraHandler.getPositionAndTarget())]}})})};b.prototype.get=
   function(){return ApiResponse_1$$module$src$3d$viewport$api$CameraApi.default(null,this._threeDManager.cameraHandler.getPositionAndTarget())};b.prototype.removeEventListener=function(a){(a=this._api.unsubscribeFromMessageStream(a))&&this._threeDManager.cameraHandler.decreaseEventListenerCounter();return ApiResponse_1$$module$src$3d$viewport$api$CameraApi.default(null,a)};b.prototype.resetAsync=function(a){return __awaiter$$module$src$3d$viewport$api$CameraApi(this,void 0,void 0,function(){var b;return __generator$$module$src$3d$viewport$api$CameraApi(this,
   function(c){switch(c.label){case 0:return[4,this._threeDManager.cameraHandler.resetPositionAndTarget(a)];case 1:return b=c.sent(),[2,ApiResponse_1$$module$src$3d$viewport$api$CameraApi.default(b?null:"Resetting camera position or target failed",this._threeDManager.cameraHandler.getPositionAndTarget())]}})})};b.prototype.updateAsync=function(a,b){return __awaiter$$module$src$3d$viewport$api$CameraApi(this,void 0,void 0,function(){var c;return __generator$$module$src$3d$viewport$api$CameraApi(this,
   function(d){switch(d.label){case 0:return[4,this._threeDManager.cameraHandler.setPositionAndTarget(a.position,a.target,b)];case 1:return c=d.sent(),[2,ApiResponse_1$$module$src$3d$viewport$api$CameraApi.default(c?null:"Setting new camera target and position failed",this._threeDManager.cameraHandler.getPositionAndTarget())]}})})};b.prototype.updateMatrices=function(a,b){this._threeDManager.cameraHandler.setViewAndProjectionMatrix(a,b)};b.prototype.zoomAsync=function(a,b){return __awaiter$$module$src$3d$viewport$api$CameraApi(this,
   void 0,void 0,function(){var c;return __generator$$module$src$3d$viewport$api$CameraApi(this,function(d){switch(d.label){case 0:return[4,this._threeDManager.cameraHandler.zoomExtents(b,a)];case 1:return c=d.sent(),[2,ApiResponse_1$$module$src$3d$viewport$api$CameraApi.default(c?null:"Zooming to extents failed",this._threeDManager.cameraHandler.getPositionAndTarget())]}})})};return b}();var module$src$3d$viewport$api$LightApi={default:function(b,a){var c=a.threeDManager;a=function(){module$src$3d$interfaces$api$LightApiInterface.default.call(this);this.utils=b.utils;this.LIGHTTYPE={AMBIENT:"ambient",DIRECTIONAL:"directional",HEMISPHERE:"hemisphere",POINT:"point",SPOT:"spot",FLASH:"flash"};this.LIGHTSCENE={DEFAULT:"default",LEGACY:"legacy"};this.updateLight=this.updateLight.bind(this);this.getLight=this.getLight.bind(this);this.removeLight=this.removeLight.bind(this);this.setLightSceneFromID=
   this.setLightSceneFromID.bind(this);this.setLightSceneFromDefinition=this.setLightSceneFromDefinition.bind(this);this.getLightScene=this.getLightScene.bind(this);this.getAllLightScenes=this.getAllLightScenes.bind(this);this.saveLightScene=this.saveLightScene.bind(this)};$jscomp.inherits(a,module$src$3d$interfaces$api$LightApiInterface.default);a.prototype.updateLight=function(a){return(0,module$src$api$v2$ApiResponse.default)(null,c.lightHandler.updateLight(a))};a.prototype.getLight=function(a){return(0,module$src$api$v2$ApiResponse.default)(null,
   c.lightHandler.getLight(a))};a.prototype.removeLight=function(a){return(0,module$src$api$v2$ApiResponse.default)(null,c.lightHandler.removeLight(a))};a.prototype.setLightSceneFromID=function(a){return(0,module$src$api$v2$ApiResponse.default)(null,c.lightHandler.setLightSceneFromID(a))};a.prototype.setLightSceneFromDefinition=function(a){return(0,module$src$api$v2$ApiResponse.default)(null,c.lightHandler.setLightSceneFromDefinition(a))};a.prototype.getLightScene=function(a){return(0,module$src$api$v2$ApiResponse.default)(null,
   c.lightHandler.getLightScene(a))};a.prototype.getAllLightScenes=function(){return(0,module$src$api$v2$ApiResponse.default)(null,c.lightHandler.getAllLightScenes())};a.prototype.saveLightScene=function(a){return(0,module$src$api$v2$ApiResponse.default)(null,c.lightHandler.saveLightScene(a))};return new a}};var module$src$3d$viewport$api$ViewportApi={default:function(b,a){var c=function(a){return function(b){return[b.slice(0,a),b.slice(a+1)]}},d,e=a.threeDManager,g,h=new module$src$externals$three.default.Matrix4,f=new module$src$externals$three.default.Matrix4,k=[],l=new module$node_modules$shapedivernodemodule_viewersettings$bundle.default.Settings_2_0;a=function(){module$src$3d$interfaces$api$ViewportApiInterface.default.call(this);d=this;d.utils=b.utils;d.EVENTTYPE=b.scene.EVENTTYPE;g=function(a,
   b){if(-1!==b.indexOf(".")){var d=$jscomp.makeIterator(c(b.indexOf("."))(b));b=d.next().value;d=d.next().value;if(a=a[b])return a.value&&(a=a.value),g(a,d)}else return a[b]};d.camera=new module$src$3d$viewport$api$CameraApi.default.CameraApi(b,e);d.lights=new module$src$3d$viewport$api$LightApi.default(b,{threeDManager:e});d.getViewportRuntimeId=d.getViewportRuntimeId.bind(d);d.getContainer=d.getContainer.bind(d);d.getScreenshot=d.getScreenshot.bind(d);d.getScreenshotAsync=d.getScreenshotAsync.bind(d);
   d.render=d.render.bind(d);d.convertTo2D=d.convertTo2D.bind(d);d.pause=d.pause.bind(d);d.resume=d.resume.bind(d);d.addEventListener=d.addEventListener.bind(d);d.removeEventListener=d.removeEventListener.bind(d);d.getSettingDefinitions=d.getSettingDefinitions.bind(d);d.getSettings=d.getSettings.bind(d);d.getSetting=d.getSetting.bind(d);d.updateSettingAsync=d.updateSettingAsync.bind(d);d.updateSettingsAsync=d.updateSettingsAsync.bind(d);d.setTransformation=d.setTransformation.bind(d);d.getTransformation=
   d.getTransformation.bind(d);d.applyTransformation=d.applyTransformation.bind(d);d.resetTransformation=d.resetTransformation.bind(d);d.setLiveTransformation=d.setLiveTransformation.bind(d);d.updateSelected=d.updateSelected.bind(d);d.getSelected=d.getSelected.bind(d)};$jscomp.inherits(a,module$src$3d$interfaces$api$ViewportApiInterface.default);a.prototype.getViewportRuntimeId=function(){return e.runtimeId};a.prototype.getContainer=function(){return e.container};a.prototype.getScreenshot=function(){return e.renderingHandler.getScreenshot()};
   a.prototype.getScreenshotAsync=function(){return new Promise(function(a){var b=new Image;b.onload=function(){a((0,module$src$api$v2$ApiResponse.default)(null,b.src))};b.src=e.renderingHandler.getScreenshot()})};a.prototype.render=function(){e.renderingHandler.render();return(0,module$src$api$v2$ApiResponse.default)(null,!0)};a.prototype.updateShadowMap=function(){e.renderingHandler.updateShadowMap();return(0,module$src$api$v2$ApiResponse.default)(null,!0)};a.prototype.startContinuousRendering=function(){e.renderingHandler.containsContinuousRendering("api_render")||
   e.renderingHandler.registerForContinuousRendering("api_render");return(0,module$src$api$v2$ApiResponse.default)(null,!0)};a.prototype.stopContinuousRendering=function(){e.renderingHandler.unregisterForContinuousRendering("api_render");return(0,module$src$api$v2$ApiResponse.default)(null,!0)};a.prototype.convertTo2D=function(a){var b=new module$src$externals$three.default.Object3D,c=new module$src$externals$three.default.Vector3,d=e.renderingHandler.getDomElement(),f=d.getBoundingClientRect(),g=d.width;
   d=d.height;b.position.set(a.x,a.y,a.z);b.updateMatrixWorld();c.setFromMatrixPosition(b.matrixWorld);c.project(e.cameraHandler.camera);c.x=g/2*c.x+g/2;c.y=-(d/2*c.y)+d/2;c.xPixel=c.x/devicePixelRatio;c.yPixel=c.y/devicePixelRatio;return(0,module$src$api$v2$ApiResponse.default)(null,[{containerX:c.xPixel,containerY:c.yPixel,clientX:c.xPixel+f.left,clientY:c.yPixel+f.top,pageX:c.xPixel+f.left+window.pageXOffset,pageY:c.yPixel+f.top+window.pageYOffset}])};a.prototype.pause=function(){e.pause();return(0,module$src$api$v2$ApiResponse.default)(null,
   !0)};a.prototype.resume=function(){e.resume();return(0,module$src$api$v2$ApiResponse.default)(null,!0)};a.prototype.addEventListener=function(a,c){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")||0>=a.length)return(0,module$src$api$v2$ApiResponse.default)("Event type must be a string");if(!Object.keys(d.EVENTTYPE).find(function(b){return d.EVENTTYPE[b]===a}))return(0,module$src$api$v2$ApiResponse.default)("Unsupported event type");var e=b.subscribeToMessageStream(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE+
   "."+a,function(b,e){b=new CustomEvent(a);b.api=d;e.token&&(b.token=e.token);var f={};f[module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION]=null;f[module$src$shared$constants$MessagingConstants.default.messageDataTypes.GENERIC]=null;f[module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_ANCHORDATA]=null;f[module$src$shared$constants$MessagingConstants.default.messageDataTypes.SUBSCENE_UPDATE]={assets:1};for(var g in f){var h=e.getUniquePartByType(g);
   if(h){h.data&&(h=h.data);var l=f[g]?f[g]:h,m;for(m in l)b[m]=h[m]}}b.viewportRuntimeId&&b.viewportRuntimeId!==b.api.getViewportRuntimeId()||c(b)});return(0,module$src$api$v2$ApiResponse.default)(null,e)};a.prototype.removeEventListener=function(a){return(0,module$src$api$v2$ApiResponse.default)(null,b.unsubscribeFromMessageStream(a))};a.prototype.getSettingDefinitions=function(){var a=l.getSettingDefinitions(),b={},c;for(c in a)c.startsWith("viewer.scene.")&&(b[c.replace("viewer.scene.","")]=a[c]);
   return b};a.prototype.getSettings=function(a){Array.isArray(a)||(a=Object.keys(d.getSettingDefinitions()));var b={};a.forEach(function(a){if(e.hasSetting(a)){var c=e.getSetting(a);module$src$shared$util$GlobalUtils.default.forceAtPath(b,a,c)}});return b};a.prototype.getSetting=function(a){if(e.hasSetting(a))return e.getSetting(a)};a.prototype.updateSettingAsync=function(a,b){var c=l.getSettingObject("viewer.scene."+a);if(void 0===c&&(c=g(module$src$3d$viewport$ThreeDManagerConstants.default.cameraLegacyDefinition,
   a),void 0===c))return Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Setting does not exist",!1));if(void 0!==c.type&&null!==c.type)if(module$src$shared$util$GlobalUtils.default.typeCheck(c.type,"string")){if(!module$src$shared$util$GlobalUtils.default.typeCheck(b,c.type))return Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Setting has wrong value type",!1))}else if("function"===typeof c.type&&!c.type(b))return Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Setting has wrong value type",
   !1));return e.updateSettingAsync(a,b).then(function(a){return a?Promise.resolve((0,module$src$api$v2$ApiResponse.default)(null,!0)):Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Update of setting failed",!1))},function(){return Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Update of setting failed",!1))})};a.prototype.updateSettingsAsync=function(a){var b=[];module$src$shared$util$GlobalUtils.default.getPaths(a,b);var c={},e=Promise.resolve(),f={};b=$jscomp.makeIterator(b);
   for(var g=b.next();!g.done;f={path:f.path},g=b.next())f.path=g.value,e=e.then(function(b){return function(){return d.updateSettingAsync(b.path,module$src$shared$util$GlobalUtils.default.getAtPath(a,b.path))}}(f)),e=e.then(function(a){return function(b){b.err?module$src$shared$util$GlobalUtils.default.forceAtPath(c,a.path,!1):module$src$shared$util$GlobalUtils.default.forceAtPath(c,a.path,!0)}}(f),function(a){return function(){module$src$shared$util$GlobalUtils.default.forceAtPath(c,a.path,!1)}}(f));
   return e.then(function(){return(0,module$src$api$v2$ApiResponse.default)(null,c)})};a.prototype.setTransformation=function(a){e.transformationMatrices||(e.transformationMatrices=[]);if("number"===typeof a[0]||a.isMatrix4)a=[a];h.identity();for(var b=0,c=a.length>e.transformationMatrices.length?a.length:e.transformationMatrices.length;b<c;b++){if(a[b]){var d;e.transformationMatrices[b]=a[b].isMatrix4?a[b]:(d=f.clone()).set.apply(d,$jscomp.arrayFromIterable(a[b]))}else e.transformationMatrices[b]||
   (e.transformationMatrices[b]=f.clone());h.premultiply(e.transformationMatrices[b])}e.transformationMatrix.identity();e.transformationMatrix.multiply(h);e.renderingHandler.updateShadowMap();e.renderingHandler.render();return(0,module$src$api$v2$ApiResponse.default)(null,!0)};a.prototype.getTransformation=function(){if(e.transformationMatrices&&0<e.transformationMatrices.length){for(var a=[],b=0,c=e.transformationMatrices.length;b<c;b++)a[b]=e.transformationMatrices[b].clone();return a}return[e.transformationMatrix.clone()]};
   a.prototype.applyTransformation=function(a){e.transformationMatrices||(e.transformationMatrices=[]);if("number"===typeof a[0]||a.isMatrix4)a=[a];h.identity();for(var b=0,c=a.length>e.transformationMatrices.length?a.length:e.transformationMatrices.length;b<c;b++){if(null!=a[b]){var d;k[b]=a[b].isMatrix4?a[b]:(d=f.clone()).set.apply(d,$jscomp.arrayFromIterable(a[b]))}e.transformationMatrices[b]?a[b]&&e.transformationMatrices[b].multiply(k[b]):e.transformationMatrices[b]=a[b]?k[b]:f.clone();h.premultiply(e.transformationMatrices[b])}e.transformationMatrix.identity();
   e.transformationMatrix.premultiply(h);e.renderingHandler.updateShadowMap();e.renderingHandler.render();return(0,module$src$api$v2$ApiResponse.default)(null,!0)};a.prototype.resetTransformation=function(){e.transformationMatrix=f.clone();e.transformationMatrices=[];e.renderingHandler.updateShadowMap();e.renderingHandler.render();return(0,module$src$api$v2$ApiResponse.default)(null,!0)};a.prototype.setLiveTransformation=function(a,b){for(var c=new module$node_modules$$tweenjs$tween_js$src$Tween.default.Group,
   d=[],f=0,g=a.length;f<g;f++)d.push(e.setLiveTransformation(c,a[f].scenePaths,a[f].transformations,a[f].reset,b));a=0;for(g=d.length;a<g;a++)d[a].start();return d};a.prototype.updateSelected=function(a,b){return e.interactionHandler.setSelectedPaths(a,b)};a.prototype.getSelected=function(){return e.interactionHandler.getSelectedPaths()};a.prototype.startExternalDragEvent=function(a,b){return e.interactionHandler.startExternalDragEvent(a,b)};a.prototype.toggleGeometry=function(a,b){module$src$shared$util$GlobalUtils.default.typeCheck(a,
   "string")&&(a=[a]);module$src$shared$util$GlobalUtils.default.typeCheck(b,"string")&&(b=[b]);if(!(Array.isArray(a)&&Array.isArray(b)&&a.every(function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")})&&b.every(function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")})))return(0,module$src$api$v2$ApiResponse.default)("The provided input is not valid");e.toggleGeometry(a,b);e.renderingHandler.render();return(0,module$src$api$v2$ApiResponse.default)(null,
   !0)};return new a}};var module$src$3d$viewportManager$ViewportManager={default:function(b,a){var c=[],d,e=!1,g,h,f,k,l=function(a,b){d=this;h=a;k=b;module$src$shared$util$GlobalUtils.default.inject({message:h.message,subscribeToMessageStream:h.subscribeToMessageStream,unsubscribeFromMessageStream:h.unsubscribeFromMessageStream},d);var f=d.subscribeToMessageStream(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_VISIBILITY_ON,function(){d.unsubscribeFromMessageStream(f);g=h.sceneGeometryManager.getGeometryNode().computeSceneBoundingBox();
   e=!0;for(var a=0,b=c.length;a<b;a++)h.settingsHandler.restoreSettings(c[a]),c[a].threeDManager.init(g),!0===h.getSetting("show")&&c[a].updateSettingAsync("show",!0)});(0,module$src$3d$viewportManager$ViewportManagerThreeDManager.default)(d,c);(0,module$src$3d$viewportManager$ViewportManagerApi.default)(d,c)};l.prototype._convertInputObject=function(a){if(a.container){if(a.container instanceof Element)var b=a.container;else return;if(a=a.runtimeId){for(var d=!1,e=0,f=c.length;e<f;e++)c[e].getViewportRuntimeId()===
   a&&(d=!0);a=d?module$src$shared$util$GlobalUtils.default.createRandomId():a}else a=module$src$shared$util$GlobalUtils.default.createRandomId()}else if(a instanceof Element)b=a,a=module$src$shared$util$GlobalUtils.default.createRandomId();else return;return{container:b,runtimeId:a}};l.prototype._createThreeDManager=function(a){f||(f=h.api({version:2}));if(!a)return null;var b=new module$src$3d$viewport$ThreeDManager.default(f,{scene:h.sceneGeometryManager.getScene(),geometryNode:h.sceneGeometryManager.getGeometryNode(),
   pathUtils:h.sceneGeometryManager.getPathUtils(),container:a.container,runtimeId:a.runtimeId,loggingHandler:k,messagingHandler:{message:h.message,subscribeToMessageStream:h.subscribeToMessageStream,unsubscribeFromMessageStream:h.unsubscribeFromMessageStream},interactionGroupManager:h.interactionGroupManager,viewportManager:d});var c=new module$src$3d$viewport$api$ViewportApi.default(f,{threeDManager:b,viewportManager:d});f.camera||f.lights||(f.camera=c.camera,f.lights=c.lights);c.threeDManager=b;b.runtimeId=
   a.runtimeId;b.container=a.container;b.api=c;b.startUpObject=a;b.transformationMatrix=new module$src$externals$three.default.Matrix4;b.transformationGroups=[];return c};l.prototype.createThreeDManager=function(a){if(!a)return null;Array.isArray(a)||(a=[a]);for(var b=[],f=0,l=a.length;f<l;f++){var k=d._convertInputObject(a[f]);k=d._createThreeDManager(k);c.push(k);if(!1===k.threeDManager.success)d.removeThreeDManager(k.getViewportRuntimeId());else{k.updateSettingAsync("show",!1);k.updateSettingAsync("showSceneTransition",
   h.getSetting("showSceneTransition"));for(var m=h.sceneGeometryManager.getMeshMaterialObjects(),r,v,w,y,x,A=0,z=m.length;A<z;A++)x=m[A],r=x.mesh,v=x.properties,w=x.hasTextureCoordinates,y=x.overrideColor,x=x.vertexColors,y=k.threeDManager.materialHandler.getMaterial(v,y,x),null===y||void 0===y?k.threeDManager.warn("The creation of a material failed."):(w||(y.map=null,y.alphaMap=null,y.aoMap=null,y.bumpMap=null,y.displacementMap=null,y.emissiveMap=null,y.normalMap=null,y.metalnessMap=null,y.roughnessMap=
   null),k.threeDManager.addMesh(r,y,v));k&&(m=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.GENERIC,{viewportApi:k,viewportRuntimeId:k.threeDManager.runtimeId}),d.message(module$src$shared$constants$MessagingConstants.default.messageTopics.VIEWPORTS_CREATED,m),b.push(k),e&&(h.settingsHandler.restoreSettings(k),k.threeDManager.init(g),!0===h.getSetting("show")&&k.updateSettingAsync("show",!0)))}}return b};l.prototype.removeThreeDManager=
   function(a){for(var b=0,e=c.length;b<e;b++)if(c[b].getViewportRuntimeId()===a){e=c[b];e.threeDManager.destroy();for(var f in e)delete e[f];c.splice(b,1);a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.GENERIC,{viewportRuntimeId:a});d.message(module$src$shared$constants$MessagingConstants.default.messageTopics.VIEWPORTS_DESTROYED,a);return!0}return!1};l.prototype.reloadThreeDManager=function(a){for(var b=0,e=c.length;b<
   e;b++)if(c[b].getViewportRuntimeId()===a){a=c[b];e=Object.assign({},a.threeDManager.startUpObject);d.removeThreeDManager(a.getViewportRuntimeId());c.splice(b,1);d.createThreeDManager(e);break}};l.prototype.getContainers=function(){for(var a=[],b=0,d=c.length;b<d;b++)a.push(c[b].getContainer());return a};l.prototype.getApi=function(a){for(var b=0,d=c.length;b<d;b++)if(a===c[b].getViewportRuntimeId())return c[b]};l.prototype.getApis=function(){return c};return new l(b,a)}};var module$src$shared$util$PathUtils={default:function(){var b,a=null,c={},d=function(){b=this};d.prototype.setScene=function(b){a=b;a._sdIndexObj=c;c.obj=a};d.prototype.getChildByName=function(a,b){a=a._sdIndexObj;return null==a?null:module$src$shared$util$GlobalUtils.default.getAtPath(a,b+".obj")};d.prototype.getOrCreateChild=function(a,c){var d=a._sdIndexObj;if(null==d)return null;var e=b.getChildByName(a,c);null==e&&(e=new module$src$externals$three.default.Object3D,e.SDLocalPath=c,a.add(e),d[c]=
   {obj:e},e._sdIndexObj=d[c]);return e};d.prototype.getPathObject=function(b,c){b=b||a;b=b._sdIndexObj;return null==b?null:module$src$shared$util$GlobalUtils.default.getAtPath(b,c+".obj")};d.prototype.ensurePath=function(a,c){c=c.split(".");c=$jscomp.makeIterator(c);for(var d=c.next();!d.done;d=c.next())a=b.getOrCreateChild(a,d.value);return a};d.prototype.deletePath=function(a,c){a=b.getPathObject(a,c);if(null==a)return!0;c=a.SDLocalPath;if(null==c||!module$src$shared$util$GlobalUtils.default.typeCheck(c,
   "string")||""==c)return!1;var d=a.parent;if(null==d)return!1;var e=d._sdIndexObj;if(null==e)return!1;d.remove(a);delete e[c];return!0};d.prototype.getObjectPath=function(a){if(!a)return null;for(;a&&!a.hasOwnProperty("SDLocalPath");)a=a.parent;for(var b=[];a&&a.hasOwnProperty("SDLocalPath");)b.push(a.SDLocalPath),a=a.parent;b.reverse();a=b.join(".");return""===a?null:a};d.prototype.getPathsAtDepth=function(a,c){if(0===c)return[b.getObjectPath(a)];for(var d=[],e=0;e<a.children.length;e++)d=d.concat(b.getPathsAtDepth(a.children[e],
   c-1));return d};return new d}};var module$src$3d$controls$DragControls={default:{}},THREE$$module$src$3d$controls$DragControls=module$src$externals$three.default,DETECT_IT$$module$src$3d$controls$DragControls=module$node_modules$detect_it$lib$index.default.default;
   module$src$externals$three.default.DragControls=function(b,a,c){function d(){var a=!1;!0===module$node_modules$detect_it$lib$index.default.default.passiveEvents&&(a={capture:!1,passive:!1});c.addEventListener("mousemove",g,a);c.addEventListener("mousedown",h,a);c.addEventListener("mouseup",f,a);c.addEventListener("mouseleave",f,a);c.addEventListener("touchmove",k,a);c.addEventListener("touchstart",l,a);c.addEventListener("touchend",m,a)}function e(){c.removeEventListener("mousemove",g,!1);c.removeEventListener("mousedown",
   h,!1);c.removeEventListener("mouseup",f,!1);c.removeEventListener("mouseleave",f,!1);c.removeEventListener("touchmove",k,!1);c.removeEventListener("touchstart",l,!1);c.removeEventListener("touchend",m,!1)}function g(d){d.preventDefault();var e=c.getBoundingClientRect();u.x=(d.clientX-e.left)/e.width*2-1;u.y=2*-((d.clientY-e.top)/e.height)+1;if(v&&x.enabled){var f;p.setFromCamera(u,a);p.ray.intersectPlane(q,r)&&(f=r.sub(t));x.dispatchEvent({type:"drag",object:v,position:f,event:d})}p.setFromCamera(u,
   a);var g=b.indexOf(v);f=p.intersectObjects(b.filter(function(a,b){return g!==b}).filter(function(a,b){return v?a.parent.interactionGroup!==v.parent.interactionGroup:!0}));0<f.length?(e=f[0].object,f=f[0].point,w!==e?(null!==w&&x.dispatchEvent({type:"hoveroff",object:w,event:d}),x.dispatchEvent({type:"hoveron",object:e,point:f,event:d}),c.style.cursor="pointer",w=e):x.dispatchEvent({type:"hover",object:e,point:f,event:d})):null!==w&&(x.dispatchEvent({type:"hoveroff",object:w,event:d}),c.style.cursor=
   "auto",w=null)}function h(d){d.preventDefault();if(0===d.button){x.dispatchEvent({type:"mousedowncustom",event:d});p.setFromCamera(u,a);var e=p.intersectObjects(b);0<e.length?(v=e[0].object,e=e[0].point,v.hasOwnProperty("interactionPlaneNormal")?q.setFromNormalAndCoplanarPoint(v.interactionPlaneNormal,v.position):q.setFromNormalAndCoplanarPoint(a.getWorldDirection(q.normal),v.position),p.ray.intersectPlane(q,r)&&t.copy(r).sub(v.position),c.style.cursor="move",x.dispatchEvent({type:"dragstart",object:v,
   event:d,point:e})):x.dispatchEvent({type:"emptyclick",event:d})}}function f(a){a.preventDefault();x.dispatchEvent({type:"mouseupcustom",event:a});v&&(x.dispatchEvent({type:"dragend",object:v,event:a}),v=null);c.style.cursor="auto"}function k(d){if(null!==y){!1===d.passive&&d.preventDefault();for(var e=null,f,g=0;g<d.changedTouches.length;g++)if(f=d.changedTouches[g],f.identifier===y){e=f;break}if(e){d=e;e=c.getBoundingClientRect();u.x=(d.clientX-e.left)/e.width*2-1;u.y=2*-((d.clientY-e.top)/e.height)+
   1;if(v&&x.enabled){var h;p.setFromCamera(u,a);p.ray.intersectPlane(q,r)&&(h=r.sub(t));x.dispatchEvent({type:"drag",object:v,position:h,event:d})}p.setFromCamera(u,a);var l=b.indexOf(v);e=p.intersectObjects(b.filter(function(a,b){return l!==b}).filter(function(a,b){return v?a.parent.interactionGroup!==v.parent.interactionGroup:!0}));0<e.length?(h=e[0].object,e=e[0].point,h.hasOwnProperty("interactionPlaneNormal")?q.setFromNormalAndCoplanarPoint(h.interactionPlaneNormal,h.position):q.setFromNormalAndCoplanarPoint(a.getWorldDirection(q.normal),
   h.position),w!==h?(null!==w&&x.dispatchEvent({type:"hoveroff",object:w,event:d}),x.dispatchEvent({type:"hoveron",object:h,point:e,event:d}),w=h):x.dispatchEvent({type:"hover",object:h,point:e,event:d})):null!==w&&(x.dispatchEvent({type:"hoveroff",object:w,event:d}),w=null)}}}function l(d){d.preventDefault();if(!(1<d.touches.length)){d=d.changedTouches[0];y=d.identifier;var e=c.getBoundingClientRect();u.x=(d.clientX-e.left)/e.width*2-1;u.y=2*-((d.clientY-e.top)/e.height)+1;p.setFromCamera(u,a);e=p.intersectObjects(b);
   0<e.length?(v=e[0].object,e=e[0].point,v.hasOwnProperty("interactionPlaneNormal")?q.setFromNormalAndCoplanarPoint(v.interactionPlaneNormal,v.position):q.setFromNormalAndCoplanarPoint(a.getWorldDirection(q.normal),v.position),p.ray.intersectPlane(q,r)&&t.copy(r).sub(v.position),c.style.cursor="move",x.dispatchEvent({type:"dragstart",object:v,event:d,point:e})):x.dispatchEvent({type:"emptyclick",event:d})}}function m(a){if(null!==y){a.preventDefault();for(var b=null,d,e=0;e<a.changedTouches.length;e++)if(d=
   a.changedTouches[e],d.identifier===y){b=d;break}b&&(a=b,y=null,v&&(x.dispatchEvent({type:"dragend",object:v,event:a}),v=null),null!==w&&(x.dispatchEvent({type:"hoveroff",object:w,event:a}),w=null),c.style.cursor="auto")}}if(b instanceof module$src$externals$three.default.Camera){console.warn("THREE.DragControls: Constructor now expects ( objects, camera, domElement )");var n=b;b=a;a=n}var q=new module$src$externals$three.default.Plane,p=new module$src$externals$three.default.Raycaster,u=new module$src$externals$three.default.Vector2,
   t=new module$src$externals$three.default.Vector3,r=new module$src$externals$three.default.Vector3,v=null,w=null,y=null,x=this;d();this.enabled=!0;this.activate=d;this.deactivate=e;this.dispose=function(){e()};this.onDocumentMouseDownFake=function(b){x.dispatchEvent({type:"mousedowncustom",event:b});v=b.selected;var d=b.point;v.hasOwnProperty("interactionPlaneNormal")?q.setFromNormalAndCoplanarPoint(v.interactionPlaneNormal,v.position):q.setFromNormalAndCoplanarPoint(a.getWorldDirection(q.normal),
   v.position);t=new module$src$externals$three.default.Vector3;c.style.cursor="move";x.dispatchEvent({type:"dragstart",object:v,event:b,point:d})};this.onDocumentTouchStartFake=function(b){event=b.changedTouch;y=event.identifier;var d=c.getBoundingClientRect();u.x=(event.clientX-d.left)/d.width*2-1;u.y=2*-((event.clientY-d.top)/d.height)+1;v=b.selected;b=b.point;v.hasOwnProperty("interactionPlaneNormal")?q.setFromNormalAndCoplanarPoint(v.interactionPlaneNormal,v.position):q.setFromNormalAndCoplanarPoint(a.getWorldDirection(q.normal),
   v.position);c.style.cursor="move";x.dispatchEvent({type:"dragstart",object:v,event:event,point:b})};this.onDocumentMouseMove=g;this.onDocumentTouchMove=k;this.updateCamera=function(b){a=b};this.setObjects=function(a){b=a};this.on=function(a,b){console.warn("THREE.DragControls: on() has been deprecated. Use addEventListener() instead.");x.addEventListener(a,b)};this.off=function(a,b){console.warn("THREE.DragControls: off() has been deprecated. Use removeEventListener() instead.");x.removeEventListener(a,
   b)};this.notify=function(a){console.error("THREE.DragControls: notify() has been deprecated. Use dispatchEvent() instead.");x.dispatchEvent({type:a})}};module$src$externals$three.default.DragControls.prototype=Object.create(module$src$externals$three.default.EventDispatcher.prototype);module$src$externals$three.default.DragControls.prototype.constructor=module$src$externals$three.default.DragControls;var module$src$3d$viewport$materials$ShapeDiverStandardMaterial={default:{}},THREE$$module$src$3d$viewport$materials$ShapeDiverStandardMaterial=module$src$externals$three.default,Shaders$$module$src$3d$viewport$materials$ShapeDiverStandardMaterial=module$src$3d$viewport$shaders$ShaderFile.default;
   module$src$externals$three.default.ShapeDiverStandardMaterial=function(b){module$src$externals$three.default.MeshStandardMaterial.call(this);this.defines={STANDARD:""};b&&0<b.threeDNoiseOpacity&&(this.defines.USE_3D_NOISE="",b.threeDNoiseID||(b.threeDNoiseID=0),0<=b.threeDNoiseID&&3>b.threeDNoiseID||999==b.threeDNoiseID)&&(this.defines["USE_3D_NOISE_F"+b.threeDNoiseID]="");this.uniforms=module$src$externals$three.default.UniformsUtils.merge([module$src$externals$three.default.UniformsLib.common,module$src$externals$three.default.UniformsLib.envmap,
   module$src$externals$three.default.UniformsLib.aomap,module$src$externals$three.default.UniformsLib.lightmap,module$src$externals$three.default.UniformsLib.bumpmap,module$src$externals$three.default.UniformsLib.normalmap,module$src$externals$three.default.UniformsLib.displacementmap,module$src$externals$three.default.UniformsLib.roughnessmap,module$src$externals$three.default.UniformsLib.metalnessmap,module$src$externals$three.default.UniformsLib.lights,{emissive:{value:new module$src$externals$three.default.Color(0)},
   roughness:{value:.5},metalness:{value:0},envMapIntensity:{value:1}},{lightWorldSize:{value:.005},lightFrustum:{value:6.5}},{shadowOpacity:{value:1}},{lightReflectivity:{value:1}},{threeDNoiseOpacity:{value:0},threeDNoiseID:{value:0},threeDNoiseScale:{value:1},threeDNoiseDistanceFade:{value:0}},{uvTransformMap:{type:"m3",value:(new module$src$externals$three.default.Matrix3).identity()},uvTransformBumpMap:{type:"m3",value:(new module$src$externals$three.default.Matrix3).identity()},uvTransformNormalMap:{type:"m3",
   value:(new module$src$externals$three.default.Matrix3).identity()},uvTransformSpecularMap:{type:"m3",value:(new module$src$externals$three.default.Matrix3).identity()},uvTransformAlphaMap:{type:"m3",value:(new module$src$externals$three.default.Matrix3).identity()},uvTransformEmissiveMap:{type:"m3",value:(new module$src$externals$three.default.Matrix3).identity()},uvTransformRoughnessMap:{type:"m3",value:(new module$src$externals$three.default.Matrix3).identity()},uvTransformMetalnessMap:{type:"m3",
   value:(new module$src$externals$three.default.Matrix3).identity()}},{rgbMap:{type:"t",value:null}},{mapsSize:{type:"i",value:0},additionalMaps0:{type:"t",value:null},additionalMaps1:{type:"t",value:null},additionalMaps2:{type:"t",value:null},additionalMaps3:{type:"t",value:null},additionalMaps4:{type:"t",value:null},mapPropertyType:{type:"iv1",value:[-1,-1,-1,-1,-1]},mapPropertyColor:{type:"v3v",value:[new module$src$externals$three.default.Color(0),new module$src$externals$three.default.Color(0),
   new module$src$externals$three.default.Color(0),new module$src$externals$three.default.Color(0),new module$src$externals$three.default.Color(0)]},uvTransformAddMap:{type:"m3v",value:[(new module$src$externals$three.default.Matrix3).identity(),(new module$src$externals$three.default.Matrix3).identity(),(new module$src$externals$three.default.Matrix3).identity(),(new module$src$externals$three.default.Matrix3).identity(),(new module$src$externals$three.default.Matrix3).identity()]}}]);this.lightWorldSize=
   this.uniforms.lightWorldSize.value;this.lightFrustum=this.uniforms.lightFrustum.value;this.shadowOpacity=this.uniforms.shadowOpacity.value;this.lightReflectivity=this.uniforms.lightReflectivity.value;this.threeDNoiseID=this.uniforms.threeDNoiseID.value;this.threeDNoiseScale=this.uniforms.threeDNoiseScale.value;this.threeDNoiseDistanceFade=this.uniforms.threeDNoiseDistanceFade.value;this.threeDNoiseOpacity=this.uniforms.threeDNoiseOpacity.value;this.mapsSize=this.uniforms.mapsSize.value;this.rgbMap=
   this.uniforms.rgbMap.value;var a=0;if(b){b.map&&(this.uvTransformMap=b.map.uvTransform,b.map.matrix.identity(),a++);b.specularMap&&(this.uvTransformSpecularMap=b.specularMap.uvTransform,b.specularMap.matrix.identity(),a++);b.normalMap&&(this.uvTransformNormalMap=b.normalMap.uvTransform,b.normalMap.matrix.identity(),a++);b.bumpMap&&(this.uvTransformBumpMap=b.bumpMap.uvTransform,b.bumpMap.matrix.identity(),a++);b.roughnessMap&&(this.uvTransformRoughnessMap=b.roughnessMap.uvTransform,b.roughnessMap.matrix.identity(),
   a++);b.metalnessMap&&(this.uvTransformMetalnessMap=b.metalnessMap.uvTransform,b.metalnessMap.matrix.identity(),a++);b.alphaMap&&(this.uvTransformAlphaMap=b.alphaMap.uvTransform,b.alphaMap.matrix.identity(),a++);b.emissiveMap&&(this.uvTransformEmissiveMap=b.emissiveMap.uvTransform,b.emissiveMap.matrix.identity(),a++);b.alphaMode&&(this.blending=b.alphaMap);b.alphaTest&&(this.alphaTest=b.alphaTest);b&&b.roughnessMap&&b.metalnessMap&&b.roughnessMap.image===b.metalnessMap.image&&(this.rgbMap=b.roughnessMap,
   b.roughnessMap={uvTransform:b.roughnessMap.uvTransform,isTexture:!1},b.metalnessMap={uvTransform:b.metalnessMap.uvTransform,isTexture:!1},this.defines.USE_RGBMAP="",a--);if(b&&b.additionalMaps){for(this.mapsSize=b.additionalMaps.length;5>b.mapPropertyType.length;)b.mapPropertyType.push(-1);for(;5>b.mapPropertyColor.length;)b.mapPropertyColor.push(new module$src$externals$three.default.Color(0));for(;5>b.uvTransformAddMap.length;)b.uvTransformAddMap.push((new module$src$externals$three.default.Matrix3).identity());
   this.mapPropertyType=b.mapPropertyType;this.mapPropertyColor=b.mapPropertyColor;this.uvTransformAddMap=b.uvTransformAddMap;for(var c=0,d=b.additionalMaps.length;c<d;c++)0==c&&(this.additionalMaps0=b.additionalMaps[c]),1==c&&(this.additionalMaps1=b.additionalMaps[c]),2==c&&(this.additionalMaps2=b.additionalMaps[c]),3==c&&(this.additionalMaps3=b.additionalMaps[c]),4==c&&(this.additionalMaps4=b.additionalMaps[c]);delete b.additionalMaps}a+=this.mapsSize;this.defines.NUM_ADD_MAPS=this.mapsSize;for(b.envMap&&
   a++;a>=b.textureUnitCount;)if(b.envMap)delete b.envMap,this.envMap=null,a--;else if(b.emissiveMap&&b.emissiveMap.image)delete b.emissiveMap,this.uvTransformEmissiveMap=this.uniforms.uvTransformEmissiveMap.value,a--;else if(b.alphaMap&&b.alphaMap.image)delete b.alphaMap,this.uvTransformAlphaMap=this.uniforms.uvTransformAlphaMap.value,a--;else if(b.metalnessMap&&b.metalnessMap.image)delete b.metalnessMap,this.uvTransformMetalnessMap=this.uniforms.uvTransformMetalnessMap.value,a--;else if(b.roughnessMap&&
   b.roughnessMap.image)delete b.roughnessMap,this.uvTransformRoughnessMap=this.uniforms.uvTransformRoughnessMap.value,a--;else if(this.rgbMap)this.rgbMap=null,delete this.defines.USE_RGBMAP,this.uvTransformMetalnessMap=this.uniforms.uvTransformMetalnessMap.value,this.uvTransformRoughnessMap=this.uniforms.uvTransformRoughnessMap.value,a--;else if(b.bumpMap&&b.bumpMap.image)delete b.bumpMap,this.uvTransformBumpMap=this.uniforms.uvTransformBumpMap.value,a--;else if(b.normalMap&&b.normalMap.image)delete b.normalMap,
   this.uvTransformNormalMap=this.uniforms.uvTransformNormalMap.value,a--;else if(b.specularMap&&b.specularMap.image)delete b.specularMap,this.uvTransformSpecularMap=this.uniforms.uvTransformSpecularMap.value,a--;else break;this.availableTextures=b.textureUnitCount-1-a;delete b.textureUnitCount;this.renderAO=b.renderAO;delete b.line;delete b._json}this.vertexShader=module$src$3d$viewport$shaders$ShaderFile.default.standard_vert;this.fragmentShader=module$src$3d$viewport$shaders$ShaderFile.default.standard_frag;
   this.type="ShapeDiverStandardMaterial";this.softShadow=!1;this.attributes=["position","normal"];0<a&&this.attributes.push("uv");delete b.line;delete b._json;this.needsUpdate=!1;this.setValues(b)};module$src$externals$three.default.ShapeDiverStandardMaterial.prototype=Object.create(module$src$externals$three.default.MeshStandardMaterial.prototype);module$src$externals$three.default.ShapeDiverStandardMaterial.prototype.constructor=module$src$externals$three.default.ShapeDiverStandardMaterial;
   module$src$externals$three.default.ShapeDiverStandardMaterial.prototype.isMeshStandardMaterial=!0;module$src$externals$three.default.ShapeDiverStandardMaterial.prototype.copy=function(b){module$src$externals$three.default.MeshStandardMaterial.prototype.copy.call(this,b);this.defines=b.defines;this.uniforms=module$src$externals$three.default.UniformsUtils.clone(b.uniforms);this.type=b.type;this.softShadow=b.softShadow;this.renderAO=b.renderAO;return this};
   module$src$externals$three.default.ShapeDiverStandardMaterial.prototype.deepCopy=function(b){module$src$externals$three.default.MeshStandardMaterial.prototype.copy.call(this,b);this.defines=Object.assign({},b.defines);this.uniforms=module$src$externals$three.default.UniformsUtils.clone(b.uniforms);this.type=b.type;this.softShadow=b.softShadow;this.renderAO=b.renderAO;return this};var module$src$3d$viewport$materials$ShapeDiverGemMaterial={default:{}},THREE$$module$src$3d$viewport$materials$ShapeDiverGemMaterial=module$src$externals$three.default,Shaders$$module$src$3d$viewport$materials$ShapeDiverGemMaterial=module$src$3d$viewport$shaders$ShaderFile.default;
   module$src$externals$three.default.ShapeDiverGemMaterial=function(b){module$src$externals$three.default.MeshStandardMaterial.call(this);this.defines={STANDARD:"",DEPTH:5};this.uniforms=module$src$externals$three.default.UniformsUtils.merge([module$src$externals$three.default.UniformsLib.common,module$src$externals$three.default.UniformsLib.envmap,module$src$externals$three.default.UniformsLib.aomap,module$src$externals$three.default.UniformsLib.lightmap,module$src$externals$three.default.UniformsLib.bumpmap,
   module$src$externals$three.default.UniformsLib.normalmap,module$src$externals$three.default.UniformsLib.displacementmap,module$src$externals$three.default.UniformsLib.roughnessmap,module$src$externals$three.default.UniformsLib.metalnessmap,module$src$externals$three.default.UniformsLib.lights,{emissive:{value:new module$src$externals$three.default.Color(0)},roughness:{value:0},metalness:{value:1},envMapIntensity:{value:1}},{refractionIndex:{value:2.4},impurityMap:{value:null},impurityScale:{value:1},
   colorTransferBegin:{value:new module$src$externals$three.default.Color(16777215)},colorTransferEnd:{value:new module$src$externals$three.default.Color(16777215)},center:{value:new module$src$externals$three.default.Vector3(0,0,0)},radius:{value:1},sphericalNormalMap:{value:null},gamma:{value:1},contrast:{value:1},brightness:{value:0},dispersion:{value:0},tracingOpacity:{value:0},inverseModelMatrix:{value:new module$src$externals$three.default.Matrix4},inverseTransposeModelMatrix:{value:new module$src$externals$three.default.Matrix4}}]);
   b&&(this.customEnvMap=b.customEnvMap,delete b.customEnvMap,delete b.materialType,delete b.environmentMap,this.depth=b.depth,this.defines.DEPTH=this.depth,0!=b.dispersion&&(this.defines.DISPERSION=""),this.roughness=0,this.metalness=1,this.transparent=!0,b.impurityMap&&(this.defines.USE_IMPURITY_MAP=""),this.inverseModelMatrix=this.uniforms.inverseModelMatrix.value=b.inverseModelMatrix,this.inverseTransposeModelMatrix=this.uniforms.inverseTransposeModelMatrix.value=b.inverseTransposeModelMatrix,this.refractionIndex=
   this.uniforms.refractionIndex.value=b.refractionIndex,this.dispersion=this.uniforms.dispersion.value=b.dispersion,this.center=this.uniforms.center.value=b.center,this.radius=this.uniforms.radius.value=b.radius,this.sphericalNormalMap=this.uniforms.sphericalNormalMap.value=b.sphericalNormalMap,this.impurityMap=this.uniforms.impurityMap.value=b.impurityMap,this.impurityScale=this.uniforms.impurityScale.value=b.impurityScale,this.colorTransferBegin=this.uniforms.colorTransferBegin.value=b.colorTransferBegin,
   this.colorTransferEnd=this.uniforms.colorTransferEnd.value=b.colorTransferEnd,this.gamma=this.uniforms.gamma.value=b.gamma,this.contrast=this.uniforms.contrast.value=b.contrast,this.brightness=this.uniforms.brightness.value=b.brightness,this.tracingOpacity=this.uniforms.tracingOpacity.value=b.tracingOpacity);this.vertexShader=module$src$3d$viewport$shaders$ShaderFile.default.gem_vert;this.fragmentShader=module$src$3d$viewport$shaders$ShaderFile.default.gem_frag;this.type="ShapeDiverGemMaterial";delete b.resolution;
   delete b.line;delete b._json;this.needsUpdate=!1;this.setValues(b)};module$src$externals$three.default.ShapeDiverGemMaterial.prototype=Object.create(module$src$externals$three.default.MeshStandardMaterial.prototype);module$src$externals$three.default.ShapeDiverGemMaterial.prototype.constructor=module$src$externals$three.default.ShapeDiverGemMaterial;module$src$externals$three.default.ShapeDiverGemMaterial.prototype.isMeshStandardMaterial=!0;
   module$src$externals$three.default.ShapeDiverGemMaterial.prototype.copy=function(b){module$src$externals$three.default.MeshStandardMaterial.prototype.copy.call(this,b);this.defines=b.defines;this.uniforms=module$src$externals$three.default.UniformsUtils.clone(b.uniforms);this.type=b.type;return this};
   module$src$externals$three.default.ShapeDiverGemMaterial.prototype.deepCopy=function(b){module$src$externals$three.default.MeshStandardMaterial.prototype.copy.call(this,b);this.defines=Object.assign({},b.defines);this.uniforms=module$src$externals$three.default.UniformsUtils.clone(b.uniforms);this.type=b.type;return this};var module$src$3d$SceneGeometryManager={default:function(b,a){var c,d,e,g,h=[],f=[],k=[],l=new module$src$externals$three.default.Matrix4,m=new module$src$externals$three.default.Matrix4,n=[],q=new module$src$shared$util$PathUtils.default,p=function(a,b){c=this;d=a;module$src$externals$three.default.Cache.enabled=!0;e=new module$src$externals$three.default.Scene;g=new module$src$externals$three.default.Object3D;g.computeSceneBoundingBox=function(){var a=new module$src$externals$three.default.Box3;
   this.traverse(function(b){var c=q.getObjectPath(b);c&&!c.includes("lightHelper")&&a.union((new module$src$externals$three.default.Box3).setFromObject(b))});0==a.min.distanceTo(a.max)&&(a=new module$src$externals$three.default.Box3(new module$src$externals$three.default.Vector3(-1,-1,-1),new module$src$externals$three.default.Vector3(1,1,1)));return a};g.computeBoundingBox=function(a){var b=new module$src$externals$three.default.Box3;if(!Array.isArray(a)||0===a.length)return this.computeSceneBoundingBox();
   for(var c=0,d=a.length;c<d;c++){var e=q.getPathObject(this,a[c]+"");e&&b.union((new module$src$externals$three.default.Box3).setFromObject(e))}0==b.min.distanceTo(b.max)&&(b=this.computeSceneBoundingBox());return b};e.add(g);q.setScene(g);module$src$shared$mixins$GlobalMixin.default.call(c);b&&b.loggingHandler?module$src$shared$util$GlobalUtils.default.inject(b.loggingHandler,c):module$src$shared$mixins$LoggingMixin.default.call(c);module$src$shared$mixins$SettingsMixin.default.call(c,b.settings,
   {});b&&b.messagingHandler&&module$src$shared$util$GlobalUtils.default.inject(b.messagingHandler,c)};p.prototype._getMaterials=function(a,b,e,f,g,h){a=d.threeDManager.materialHandler.getMaterial(a,b,e,f,g);(a.includes(null)||a.includes(void 0))&&c.warn("The creation of a material for at least one viewport failed.");if(!h)for(h=0,b=a.length;h<b;h++)a[h].map=null,a[h].alphaMap=null,a[h].aoMap=null,a[h].bumpMap=null,a[h].displacementMap=null,a[h].emissiveMap=null,a[h].normalMap=null,a[h].metalnessMap=
   null,a[h].roughnessMap=null;return a};p.prototype._setMeshMaterialCombo=function(a,b,c,e,f,g){d.threeDManager.addMesh(a,b,c);h.push({mesh:a,properties:c,hasTextureCoordinates:e,overrideColor:f,vertexColors:g})};p.prototype._addMesh=function(a,b,d,e,f,g){if(a.transparentMeshHelper){b.renderAO=!1;b.side=module$src$externals$three.default.BackSide;var h=c._getMaterials(b,a.children[0],d,f,g,e);a.children[0].castShadow=!0;b.opacity&&.5<b.opacity&&(a.children[0].receiveShadow=!0);c._setMeshMaterialCombo(a.children[0],
   h,b,e,f,g);b.side=module$src$externals$three.default.FrontSide;h=c._getMaterials(b,a.children[1],d,f,g,e);a.children[1].castShadow=!0;b.opacity&&.5<b.opacity&&(a.children[1].receiveShadow=!0);c._setMeshMaterialCombo(a.children[1],h,b,e,f,g);b.side=module$src$externals$three.default.DoubleSide}else a.meshHelper?(d=c._getMaterials(b,a.children[0],d,f,g,e),a.children[0].castShadow=!0,a.children[0].receiveShadow=!0,c._setMeshMaterialCombo(a.children[0],d,b,e,f,g)):(d=c._getMaterials(b,a,d,f,g,e),a.castShadow=
   !0,a.receiveShadow=!0,c._setMeshMaterialCombo(a,d,b,e,f,g))};p.prototype._removeMesh=function(a){d.threeDManager.removeMesh(a);for(var b=0,c=h.length;b<c;b++)if(h[b].mesh===a){h.splice(b,1);break}};p.prototype._addAnchor=function(a,b){f.push({object:a,properties:b});d.threeDManager.addAnchor(a,b)};p.prototype._removeAnchor=function(a){d.threeDManager.removeAnchor(a);for(var b=0,c=f.length;b<c;b++)if(f[b].object===a){f.splice(b,1);break}};p.prototype.getScene=function(){return e};p.prototype.getGeometryNode=
   function(){return g};p.prototype.getPathUtils=function(){return q};p.prototype.getMeshMaterialObjects=function(){return h};p.prototype.addGeometry=function(a,b,e,f){d.threeDManager.renderingHandler.registerForContinuousRendering("geomAddEvent");e=e||{};if(null!=q.getPathObject(g,a))return d.threeDManager.renderingHandler.unregisterForContinuousRendering("geomAddEvent"),Promise.reject(Error("Geometry already exists at that path: "+a));var h=q.ensurePath(g,a);module$src$shared$util$GlobalUtils.default.typeCheck(e.name,
   "string")&&(h.SDName=e.name);module$src$shared$util$GlobalUtils.default.typeCheck(e.visible,"boolean")?h.visible=e.visible:h.visible=!0;var l=e.hasOwnProperty("boundingBox");l&&(h.SDBoundingBox=e.boundingBox);var k={};b=$jscomp.makeIterator(b);for(var m=b.next();!m.done;k={g:k.g},m=b.next()){k.g=m.value;["geometry","path","type","material"].forEach(function(a){return function(b){if(!a.g.hasOwnProperty(b))return d.threeDManager.renderingHandler.unregisterForContinuousRendering("geomAddEvent"),Promise.reject(Error("GeometryData object is missing property "+
   b))}}(k));var n=q.ensurePath(h,k.g.path),u=void 0;u=k.g.material.color?new module$src$externals$three.default.Color(k.g.material.color):new module$src$externals$three.default.Color;k.g.color&&u.set(k.g.color.toRgbString());m=null;var p=!1;try{switch(k.g.type){case "mesh":k.g.geometry instanceof module$src$externals$three.default.BufferGeometry?k.g.geometry.hasOwnProperty("attributes")&&k.g.geometry.attributes.hasOwnProperty("uv")&&(p=!0):k.g.geometry instanceof module$src$externals$three.default.Geometry&&
   0<k.g.geometry.faceVertexUvs.length&&(p=!0);if(k.g.geometry instanceof module$src$externals$three.default.BufferGeometry)k.g.geometry.attributes.hasOwnProperty("normal")&&null!=k.g.geometry.attributes.normal||k.g.geometry.computeVertexNormals();else if(k.g.geometry instanceof module$src$externals$three.default.Geometry&&0<k.g.geometry.faces.length){var t=k.g.geometry.faces[0];if(null==t.vertexNormals||0==t.vertexNormals.length)k.g.geometry.computeFaceNormals(),k.g.geometry.computeVertexNormals()}m=
   new module$src$externals$three.default.Object3D;m.meshHelper=!0;k.g.geometry.boundingSphere||(k.g.geometry.computeBoundingSphere(),k.g.geometry.boundingSphere.realCenter=k.g.geometry.boundingSphere.center.clone(),k.g.geometry.translate(-k.g.geometry.boundingSphere.center.x,-k.g.geometry.boundingSphere.center.y,-k.g.geometry.boundingSphere.center.z));if(k.g.material&&!0===k.g.material.transparent&&k.g.material.side===module$src$externals$three.default.DoubleSide&&"gem"!==k.g.material.materialType){m.transparentMeshHelper=
   !0;var E=new module$src$externals$three.default.Mesh(k.g.geometry,new module$src$externals$three.default.MeshBasicMaterial);E.position.set(k.g.geometry.boundingSphere.realCenter.x,k.g.geometry.boundingSphere.realCenter.y,k.g.geometry.boundingSphere.realCenter.z);var r=new module$src$externals$three.default.Mesh(k.g.geometry,new module$src$externals$three.default.MeshBasicMaterial);r.position.set(k.g.geometry.boundingSphere.realCenter.x,k.g.geometry.boundingSphere.realCenter.y,k.g.geometry.boundingSphere.realCenter.z);
   m.add(E);m.add(r)}else{var v=new module$src$externals$three.default.Mesh(k.g.geometry,new module$src$externals$three.default.MeshBasicMaterial);v.position.set(k.g.geometry.boundingSphere.realCenter.x,k.g.geometry.boundingSphere.realCenter.y,k.g.geometry.boundingSphere.realCenter.z);m.add(v)}break;case "points":m=new module$src$externals$three.default.Points(k.g.geometry,new module$src$externals$three.default.PointsMaterial({color:u,size:1}));break;case "line":m=new module$src$externals$three.default.Line(k.g.geometry,
   "dashed"===k.g.material.line.type?new module$src$externals$three.default.LineDashedMaterial({color:u,linewidth:k.g.material.line.lineWidth,dashSize:k.g.material.line.dashSize,gapSize:k.g.material.line.gapSize,scale:k.g.material.line.scale}):new module$src$externals$three.default.LineBasicMaterial({color:u,linewidth:k.g.material.line.lineWidth}));"dashed"===k.g.material.line.type&&m.computeLineDistances();break;case "linesegments":m=new module$src$externals$three.default.LineSegments(k.g.geometry,
   "dashed"===k.g.material.line.type?new module$src$externals$three.default.LineDashedMaterial({color:u,linewidth:k.g.material.line.lineWidth,dashSize:k.g.material.line.dashSize,gapSize:k.g.material.line.gapSize,scale:k.g.material.line.scale}):new module$src$externals$three.default.LineBasicMaterial({color:u,linewidth:k.g.material.line.lineWidth}));"dashed"===k.g.material.line.type&&m.computeLineDistances();break;case "lineloop":m=new module$src$externals$three.default.LineLoop(k.g.geometry,"dashed"===
   k.g.material.line.type?new module$src$externals$three.default.LineDashedMaterial({color:u,linewidth:k.g.material.line.lineWidth,dashSize:k.g.material.line.dashSize,gapSize:k.g.material.line.gapSize,scale:k.g.material.line.scale}):new module$src$externals$three.default.LineBasicMaterial({color:u,linewidth:k.g.material.line.lineWidth}));"dashed"===k.g.material.line.type&&m.computeLineDistances();break;case "anchor":m=new module$src$externals$three.default.Object3D,m.position.set(k.g.geometry.position.x,
   k.g.geometry.position.y,k.g.geometry.position.z),m.type="Anchor",m.material={}}}catch(I){return d.threeDManager.renderingHandler.unregisterForContinuousRendering("geomAddEvent"),Promise.reject(I)}if(m){k.g.hasOwnProperty("initialMatrix")&&m.applyMatrix(k.g.initialMatrix);var C=0;for(u=m.children.length;C<u;C++)m.children[C].SDMaterialDefinition=k.g.material;n.add(m);m.meshHelper?c._addMesh(m,k.g.material,f,p,k.g.color,k.g.geometry.attributes&&k.g.geometry.attributes.hasOwnProperty("color")):"Anchor"===
   m.type&&c._addAnchor(m,Object.assign({path:a+n.SDLocalPath},k.g.geometry));if("number"===typeof e.duration&&0<e.duration)for(n=0,u=m.children.length;n<u;n++)m.children[n].material.transparent=!0,m.children[n].material.opacity=0}}d.threeDManager.updateInteractions(a,e);c.evaluateGeometryVisibility();l||(f=new module$src$externals$three.default.Box3,f.setFromObject(h),h.SDBoundingBox=f);d.threeDManager.adjustScene();if("number"===typeof e.duration&&0<e.duration)return d.threeDManager.fadeIn(a,e.duration).then(function(){d.threeDManager.renderingHandler.unregisterForContinuousRendering("geomAddEvent")});
   d.threeDManager.renderingHandler.unregisterForContinuousRendering("geomAddEvent");return Promise.resolve()};p.prototype.removeGeometry=function(a,b){b=b||{};var e=q.getPathObject(g,a);if(null==e)return Promise.resolve();d.threeDManager.renderingHandler.registerForContinuousRendering("geomRemoveEvent");var f=function(){d.threeDManager.removeFromInteractions(a);d.threeDManager.adjustScene();d.threeDManager.renderingHandler.unregisterForContinuousRendering("geomRemoveEvent");e.traverse(function(a){"Mesh"===
   a.type?(c._removeMesh(a),a.material.dispose(),a.geometry.dispose()):"Anchor"===a.type&&c._removeAnchor(a)});if(!q.deletePath(g,a)){var b="Could not delete scene path "+a;c.error("ThreeDManager.removeGeometry",b);return Promise.reject(Error(b))}return Promise.resolve()};return"number"===typeof b.duration&&0<b.duration?d.threeDManager.fadeOut(a,b.duration).then(function(){return f()}).catch(function(b){c.error("ThreeDManager.removeGeometry","Exception when removing geometry at path "+a,b);return Promise.reject(b)}):
   f()};p.prototype.replaceGeometry=function(a,b,e,f){e=e||{};d.threeDManager.renderingHandler.registerForContinuousRendering("geomReplaceEvent");for(var h=d.getApis(),l={},k=0,m=h.length;k<m;k++){var n=h[k].getSelected(),u=[];if(n.includes(a))u.push(a);else{var p=q.getPathObject(g,a);if(null!==p)for(var t=0,E=n.length;t<E;t++){var r=n[t];null!==q.getPathObject(p,r)&&u.push(r)}}l[h[k].getViewportRuntimeId()]=u}var v={};"number"===typeof e.duration&&0<e.duration&&(v={duration:.5*e.duration});["interactionGroup",
   "interactionMode","dragPlaneNormal","visible"].forEach(function(a){e.hasOwnProperty(a)&&(v[a]=e[a])});return c.removeGeometry(a,v).catch(function(a){d.threeDManager.renderingHandler.unregisterForContinuousRendering("geomReplaceEvent");return Promise.reject(a)}).then(function(){c.addGeometry(a,b,v,f)}).catch(function(a){d.threeDManager.renderingHandler.unregisterForContinuousRendering("geomReplaceEvent");return Promise.reject(a)}).then(function(){for(var a=d.getApis(),b=0,c=a.length;b<c;b++){var e=
   a[b],f=l[e.runtimeId];f&&0!=f.length&&e.api.updateSelected(e.api.getSelected().concat(f))}d.threeDManager.renderingHandler.unregisterForContinuousRendering("geomReplaceEvent")})};p.prototype.setToggleCastShadow=function(a,b){a=q.getPathObject(g,a);if(null==a)return!1;a.castShadow=b;a.traverse(function(a){a.castShadow=b});d.threeDManager.renderingHandler.updateShadowMap();d.api.render();return!0};p.prototype.getObjectPath=function(a){return q.getObjectPath(a)};p.prototype.getPathObject=function(a,
   b){return q.getPathObject(a,b)};p.prototype.getBoundingBox=function(a){if(a=a?q.getPathObject(g,a):g){var b=new module$src$externals$three.default.Box3;a.traverseVisible(function(a){var c=q.getObjectPath(a);c&&!c.includes("lightHelpers")&&b.union((new module$src$externals$three.default.Box3).setFromObject(a))});return{min:b.min,max:b.max}}return null};p.prototype.setPluginTransformation=function(a,b,c){a=q.getPathObject(g,a);if(!a)return!1;a.originalMatrix||(a.originalMatrix=a.matrix.clone());a.transformationMatrices||
   (a.transformationMatrices=[]);if(!Array.isArray(b[0])&&null!==b[0]||b.isMatrix4)b=[b];l.identity();for(var e=0,f=b.length>a.transformationMatrices.length?b.length:a.transformationMatrices.length;e<f;e++){if(b[e]){var h;a.transformationMatrices[e]=b[e].isMatrix4?b[e]:(h=m.clone()).set.apply(h,$jscomp.arrayFromIterable(b[e]))}else a.transformationMatrices[e]||(a.transformationMatrices[e]=m.clone());l.premultiply(a.transformationMatrices[e])}a.matrix.identity();a.applyMatrix(l);c||d.threeDManager.adjustScene();
   d.api.render();return!0};p.prototype.getPluginTransformation=function(a){a=q.getPathObject(g,a);if(!a)return[new module$src$externals$three.default.Matrix4];if(a.transformationMatrices&&0<a.transformationMatrices.length){for(var b=[],c=0,d=a.transformationMatrices.length;c<d;c++)b[c]=a.transformationMatrices[c].clone();return b}return[a.matrix.clone()]};p.prototype.applyPluginTransformation=function(a,b,c){a=q.getPathObject(g,a);a.originalMatrix||(a.originalMatrix=a.matrix.clone());a.transformationMatrices||
   (a.transformationMatrices=[]);if(!Array.isArray(b[0])&&null!==b[0]||b.isMatrix4)b=[b];l.identity();for(var e=0,f=b.length>a.transformationMatrices.length?b.length:a.transformationMatrices.length;e<f;e++){if(b[e]){var h;n[e]=b[e].isMatrix4?b[e]:(h=m.clone()).set.apply(h,$jscomp.arrayFromIterable(b[e]))}a.transformationMatrices[e]?b[e]&&a.transformationMatrices[e].multiply(n[e]):a.transformationMatrices[e]=b[e]?n[e]:m.clone();l.premultiply(a.transformationMatrices[e])}a.matrix.identity();a.applyMatrix(l);
   c||d.threeDManager.adjustScene();d.api.render();return!0};p.prototype.resetPluginTransformation=function(a,b){a=q.getPathObject(g,a);a.originalMatrix&&(a.matrix.identity(),a.applyMatrix(a.originalMatrix),a.transformationMatrices=[]);b||d.threeDManager.adjustScene();d.api.render();return!0};p.prototype.toggleGeometry=function(a,b){for(var d=0;d<a.length;d++)if(module$src$shared$util$GlobalUtils.default.typeCheck(a[d],"string")){var e=q.getPathObject(g,a[d]);e&&(e.visible=!0,e.hiddenObject=!1);e=k.indexOf(a[d]);
   -1<e&&k.splice(e,1)}for(a=0;a<b.length;a++)module$src$shared$util$GlobalUtils.default.typeCheck(b[a],"string")&&(k.includes(b[a])||k.push(b[a]));c.evaluateGeometryVisibility()};p.prototype.evaluateGeometryVisibility=function(){for(var a=0;a<k.length;a++){var b=q.getPathObject(g,k[a]);b&&(b.visible=!1,b.hiddenObject=!0)}d.threeDManager.renderingHandler.updateShadowMap();d.api.render()};return new p(b,a)}};var module$src$app$handlers$ViewportVisibilityHandler={},viewerAppConstants$$module$src$app$handlers$ViewportVisibilityHandler=module$src$app$ViewerAppConstants.default,MessagePrototype$$module$src$app$handlers$ViewportVisibilityHandler=module$src$shared$messages$MessagePrototype.default,GlobalUtils$$module$src$app$handlers$ViewportVisibilityHandler=module$src$shared$util$GlobalUtils.default,StateDashboardLibrary$$module$src$app$handlers$ViewportVisibilityHandler=module$src$modules$shapediver_state_dashboard$StateDashboard.default.StateDashboardLibrary,
   THREE$$module$src$app$handlers$ViewportVisibilityHandler=module$src$externals$three.default;
   module$src$app$handlers$ViewportVisibilityHandler.default=function(b){var a=this,c,d=b.viewerApp,e=b.viewportManager,g=b.sceneGeometryManager,h=!1,f={isVisible:function(){return a.getSettingShallow("show")},showScene:function(b){if(!1===b)e.api.updateSettingAsync("show",!1),f.isVisible()&&(b=new module$src$shared$messages$MessagePrototype.default(module$src$app$ViewerAppConstants.default.messageDataTypes.GENERIC,{shownBefore:h}),a.message(module$src$app$ViewerAppConstants.default.messageTopics.SCENE_VISIBILITY_OFF,
   b));else{e.api.updateSettingAsync("show",!0);c||(c=d.api({version:2}));if(!h&&!a.getSetting("hasRestoredSettings")){b=e.getApis();for(var g={},l=0;l<b.length;g={api:g.api},l++){g.api=b[l];var k=g.api.getSetting("camera.defaults.perspective");0!==k.position.x||0!==k.position.y||0!==k.position.z||0!==k.target.x||0!==k.target.y||0!==k.target.z?g.api.camera.resetAsync({duration:0}):g.api.camera.updateAsync({position:{x:0,y:-7.5,z:5},target:{x:0,y:0,z:0}},{duration:0}).then(function(a){return function(){var b=
   c.scene.getBoundingBox().data;b=new module$src$externals$three.default.Box3(new module$src$externals$three.default.Vector3(b.min.x,b.min.y,b.min.z),new module$src$externals$three.default.Vector3(b.max.x,b.max.y,b.max.z));b.expandByVector(b.getSize().multiplyScalar(.25));a.api.camera.zoomAsync(b,{duration:0,default:!0})}}(g))}}h||module$src$modules$shapediver_state_dashboard$StateDashboard.default.StateDashboardLibrary.getInstance(c.getSetting("viewerRuntimeId")).firstTimeVisible.resolve(!0);f.isVisible()||
   (b=new module$src$shared$messages$MessagePrototype.default(module$src$app$ViewerAppConstants.default.messageDataTypes.GENERIC,{shownBefore:h}),a.message(module$src$app$ViewerAppConstants.default.messageTopics.SCENE_VISIBILITY_ON,b));h=!0}},hideScene:function(){a.updateSetting("show",!1)}};this.registerHook("showSceneTransition",function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"string"))return!1;e.api.updateSettingAsync("showSceneTransition",a);return!0});this.registerHook("show",
   function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean")||0===g.getGeometryNode().children.length)return!1;f.showScene(a);return!0});var k={};f.messageReceiver=function(b,c,d){if(!h)if(c=c||{},d===module$src$app$ViewerAppConstants.default.messageDataTypes.PROCESS_STATUS&&0===c.progress)k[b.id]=b;else if(d===module$src$app$ViewerAppConstants.default.messageDataTypes.PROCESS_SUCCESS)k.hasOwnProperty(b.id)&&(delete k[b.id],b=a.getSettingShallow("showSceneMode"),(b===module$src$app$ViewerAppConstants.default.showSceneModes.ON_FIRST_PLUGIN||
   0===Object.keys(k).length&&b===module$src$app$ViewerAppConstants.default.showSceneModes.ON_ALL_PLUGINS)&&a.updateSetting("show",!0));else if(d===module$src$app$ViewerAppConstants.default.messageDataTypes.PROCESS_ERROR)a.debug("ViewportVisibilityHandler.messageReceiver","Received PROCESS_ERROR for initial geometry loading process, not yet showing 3D scene",b);else if(d===module$src$app$ViewerAppConstants.default.messageDataTypes.PROCESS_FORK&&k.hasOwnProperty(b.id)){d=k[b.id];for(var e in c)c=module$src$shared$util$GlobalUtils.default.deepCopy(d),
   c.id=e,k[e]=c;delete k[b.id]}};f.init=function(){a.getSetting("showSceneMode")===module$src$app$ViewerAppConstants.default.showSceneModes.INSTANT?a.updateSetting("show",!0):a.updateSetting("show",!1);setTimeout(function(){a.updateSetting("showSceneTransition",a.getSetting("showSceneTransition"))},0)};return f};var module$src$shared$scene$OutputVersion={},GlobalUtils$$module$src$shared$scene$OutputVersion=module$src$shared$util$GlobalUtils.default;
   module$src$shared$scene$OutputVersion.default=function(b){var a=this,c={},d={};this.addOutputVersion=function(a){if(!a.hasOwnProperty("id")||c.hasOwnProperty(a.id))return!1;c[a.id]=a;a.hasOwnProperty("name")&&(d[a.name]=d[a.name]||[],d[a.name].push(a.id));return!0};this.removeOutputVersion=function(a){if(module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")){c[a]&&delete c[a];var b=Object.keys(d);b=$jscomp.makeIterator(b);for(var e=b.next();!e.done;e=b.next()){e=e.value;var g=d[e].indexOf(a);
   -1!==g&&d[e].splice(g,1)}}};this.getOutputVersion=function(a){return c[a]};this.getOutputVersionIdByName=function(a){return d[a]};this.outputIds=Object.defineProperty(this,"outputIds",{enumerable:!0,configurable:!1,readable:!0,get:function(){return Object.keys(c)}});this.outputNames=Object.defineProperty(this,"outputNames",{enumerable:!0,configurable:!1,readable:!0,get:function(){return Object.keys(d)}});this.getCompiledOutputVersion=function(b,c){if("string"!==typeof b||!c)return null;var d=a.getOutputVersion(b);
   if(!d||!Array.isArray(d.geometry)||0===d.geometry.length)return null;var e={geometry:[]};"id version name bbmin bbmax interactionGroup interactionMode duration dragPlaneNormal visible".split(" ").forEach(function(a){d.hasOwnProperty(a)&&(e[a]=d[a])});b=null;if(d.hasOwnProperty("materialId")){var g=this.getOutputVersion(d.materialId);g&&g.material&&(b=g.material)}g={};for(var h=$jscomp.makeIterator(d.geometry),n=h.next();!n.done;g={geom:g.geom,g:g.g},n=h.next()){g.geom=n.value;g.g={};"path type geometry texcoord initialMatrix material color".split(" ").forEach(function(a){return function(b){a.geom.hasOwnProperty(b)&&
   (a.g[b]=a.geom[b])}}(g));["path","type"].forEach(function(a){return function(b){if(!a.g.hasOwnProperty(b))return null}}(g));if(!g.g.hasOwnProperty("material")){n=null;n=b?b:d.hasOwnProperty("material")?d.material:[c];var q=g.g.path.split(".");if(0<q.length){var p=null;q=$jscomp.makeIterator(q);for(var u=q.next();!u.done;u=q.next())if(u=u.value,u.includes("content_")){p=u;break}null!==p&&(p=p.split("_"),"content"===p[0]&&2===p.length&&(p=parseInt(p[1]),isNaN(p)||(g.g.material=n[p%n.length].clone(),
   g.geom.hasOwnProperty("flatShade")&&!1===g.g.material.flatShading&&(g.g.material.flatShading=g.geom.flatShade))))}g.g.hasOwnProperty("material")||(g.g.material=n[0])}g.g.material.bumpScale=c.bumpScale;e.geometry.push(g.g)}return e};if(null!==b&&Array.isArray(b)){b=$jscomp.makeIterator(b);for(var e=b.next();!e.done;e=b.next())a.addOutputVersion(e.value)}};var module$src$shared$materials$MaterialPropertiesStandard={default:{}},__importStar$$module$src$shared$materials$MaterialPropertiesStandard=this&&module$src$shared$materials$MaterialPropertiesStandard.default.__importStar||function(b){if(b&&b.__esModule)return b;var a={};if(null!=b)for(var c in b)Object.hasOwnProperty.call(b,c)&&(a[c]=b[c]);a["default"]=b;return a};Object.defineProperty(module$src$shared$materials$MaterialPropertiesStandard.default,"__esModule",{value:!0});
   var THREE$$module$src$shared$materials$MaterialPropertiesStandard=__importStar$$module$src$shared$materials$MaterialPropertiesStandard(module$src$externals$three.default),TinyColorUtil_1$$module$src$shared$materials$MaterialPropertiesStandard=module$src$shared$util$TinyColorUtil.default;
   module$src$shared$materials$MaterialPropertiesStandard.default.MaterialPropertiesStandard=function(){function b(){this.additionalMaps=[];this.bumpMap=this.alphaMap=null;this.bumpScale=1;this.color=module$src$shared$util$TinyColorUtil.default.TinyColorUtilInstance.toTinyColor("ffffffff").toThreeColor();this.flatShading=!1;this.lightReflectivity=1;this.line={type:"basic",lineWidth:1,dashSize:3,gapSize:1,scale:1};this.map=null;this.mapPropertyColor=[];this.mapPropertyType=[];this.metalness=0;this.normalMap=
   this.metalnessMap=null;this.opacity=1;this.roughness=.5;this.roughnessMap=null;this.shadowOpacity=1;this.side=THREE$$module$src$shared$materials$MaterialPropertiesStandard.DoubleSide;this.threeDNoiseOpacity=this.threeDNoiseID=this.threeDNoiseDistanceFade=0;this.threeDNoiseScale=1;this.transparent=!1;this.uvTransformAddMap=[]}b.prototype.clone=function(){return Object.assign({},this)};return b}();var module$src$externals$verb_nurbs={};try{module$src$externals$verb_nurbs.default=eval("verb")}catch(b){"function"===typeof require&&(module$src$externals$verb_nurbs.default=eval("require('verb-nurbs')"))};var module$src$shared$util$verbToThreeConversion={default:{}},verb$$module$src$shared$util$verbToThreeConversion;try{verb$$module$src$shared$util$verbToThreeConversion=module$src$externals$verb_nurbs.default}catch(b){verb$$module$src$shared$util$verbToThreeConversion=null}
   if(verb$$module$src$shared$util$verbToThreeConversion){var THREE$258=module$src$externals$three.default,asVector3=function(b){return b.map(function(a){return new module$src$externals$three.default.Vector3(a[0],a[1],a[2])})},tessellateCurve=function(b){var a=new module$src$externals$three.default.Geometry;a.vertices=asVector3(b.tessellate());return a},tessellateSurface=function(b){var a=b.tessellate();b=new module$src$externals$three.default.Geometry;b.vertices=asVector3(a.points);b.faces=a.faces.map(function(b){var c=
   b.map(function(b){b=a.normals[b];return new module$src$externals$three.default.Vector3(b[0],b[1],b[2])});return new module$src$externals$three.default.Face3(b[0],b[1],b[2],c)});return b};verb$$module$src$shared$util$verbToThreeConversion.geom.NurbsCurve.prototype.toThreeGeometry=function(){return tessellateCurve(this)};verb$$module$src$shared$util$verbToThreeConversion.geom.NurbsSurface.prototype.toThreeGeometry=function(){return tessellateSurface(this)}};var module$src$shared$singletons$GLBLoader={},AXIOS$$module$src$shared$singletons$GLBLoader=module$src$externals$axios.default,THREE$$module$src$shared$singletons$GLBLoader=module$src$externals$three.default,TO_TINY_COLOR$$module$src$shared$singletons$GLBLoader=module$src$shared$util$toTinyColor.default,GLOBAL_UTILS$$module$src$shared$singletons$GLBLoader=module$src$shared$util$GlobalUtils.default,MATERIAL_PROPERTIES_STANDARD$$module$src$shared$singletons$GLBLoader=module$src$shared$materials$MaterialPropertiesStandard.default.MaterialPropertiesStandard,
   verb$$module$src$shared$singletons$GLBLoader,verb_util$$module$src$shared$singletons$GLBLoader;try{verb$$module$src$shared$singletons$GLBLoader=module$src$externals$verb_nurbs.default,null!==verb$$module$src$shared$singletons$GLBLoader&&(verb_util$$module$src$shared$singletons$GLBLoader=module$src$shared$util$verbToThreeConversion)}catch(b){verb$$module$src$shared$singletons$GLBLoader=null}
   var GLBLoader$$module$src$shared$singletons$GLBLoader=function(){this.log=function(){};this.warn=function(){};this.error=function(){};this.loadGeometry=function(a,c,d,e){d=d||.001;e=e||{};a={method:"GET",url:a,responseType:"arraybuffer",headers:{}};e.authorization&&(a.headers.Authorization=e.authorization);return(0,module$src$externals$axios.default)(a).catch(function(a){return a.response?Promise.reject(Error("Loading glb failed with status "+a.response.status+".")):a.request?Promise.reject(Error("No response to glb download AJAX request.")):
   Promise.reject(Error("Error setting up the glb download AJAX request."))}).then(function(a){return b(a.data,c,d)})};var b=function(a,b,d){return new Promise(function(c,g){for(var e=new DataView(a),f="",k=0;4>k;++k)f+=String.fromCharCode(e.getUint8(k));if("glTF"!=f)g(Error("ShapeDiverGLBLoader got invalid data: glTF magic wrong."));else{f=e.getUint32(8,!0);k=e.getUint32(12,!0);for(var l="",m=0;m<k;++m)l+=String.fromCharCode(e.getUint8(20+m));var n=JSON.parse(l),q=20+k;if(n.hasOwnProperty("meshes")&&
   n.hasOwnProperty("bufferViews")&&n.hasOwnProperty("accessors")){var p={};Object.keys(n.accessors).forEach(function(b){var c=n.accessors[b],d=c.bufferView;if(n.bufferViews.hasOwnProperty(d)){var e=n.bufferViews[d];d={};if(c.hasOwnProperty("type")&&c.hasOwnProperty("count")&&c.hasOwnProperty("componentType")){switch(c.type){case "SCALAR":d.itemSize=1;break;case "VEC2":d.itemSize=2;break;case "VEC3":d.itemSize=3;break;case "VEC4":d.itemSize=4;break;case "MAT2":d.itemSize=4;break;case "MAT3":d.itemSize=
   9;break;case "MAT4":d.itemSize=16;break;default:d.itemSize=1}var f=q+parseInt(e.byteOffset)+parseInt(c.byteOffset);if(a.length<f+c.count*d.itemSize)g(Error("Error: buffer length exceeded"));else{var h=c.count*d.itemSize;switch(c.componentType){case 5120:d.typedArray=new Int8Array(a,f,h);break;case 5121:d.typedArray=new Uint8Array(a,f,h);break;case 5122:if(0==f%2)d.typedArray=new Int16Array(a,f,h);else{console.warn("glb 1.0 loader: encountered unaligned data (componentType 5122)");e=new ArrayBuffer(2*
   h);var l=new Int8Array(e);var k=new Int8Array(a,f,2*h);f=0;for(var m=2*h;f<m;++f)l[f]=k[f];d.typedArray=new Int16Array(e,0,c.count*d.itemSize)}break;case 5123:if(0==f%2)d.typedArray=new Uint16Array(a,f,h);else{console.warn("glb 1.0 loader: encountered unaligned data (componentType 5123)");e=new ArrayBuffer(2*h);l=new Int8Array(e);k=new Int8Array(a,f,2*h);c=0;for(m=2*h;c<m;++c)l[c]=k[c];d.typedArray=new Uint16Array(e,0,h)}break;case 5124:console.warn("glb 1.0 loader: Encountered 32 bit integer componentType (5124) for array buffer. This is not allowed according to the glTF 1.0 spec, trying it anyway.");
   if(0==f%2)d.typedArray=new Uint32Array(a,f,h);else{console.warn("glb 1.0 loader: encountered unaligned data (componentType 5124)");e=new ArrayBuffer(4*h);l=new Int8Array(e);k=new Int8Array(a,f,4*h);c=0;for(m=4*h;c<m;++c)l[c]=k[c];d.typedArray=new Uint32Array(e,0,h)}break;case 5125:if(0==f%2)d.typedArray=new Int32Array(a,f,h);else{console.warn("glb 1.0 loader: encountered unaligned data (componentType 5125)");e=new ArrayBuffer(4*h);l=new Int8Array(e);k=new Int8Array(a,f,4*h);c=0;for(m=4*h;c<m;++c)l[c]=
   k[c];d.typedArray=new Int32Array(e,0,h)}if(0==f%2)d.typedArray=new Uint32Array(a,f,h);else{console.warn("glb 1.0 loader: encountered unaligned data (componentType 5125)");e=new ArrayBuffer(4*h);l=new Int8Array(e);k=new Int8Array(a,f,4*h);c=0;for(m=4*h;c<m;++c)l[c]=k[c];d.typedArray=new Uint32Array(e,0,h)}break;case 5126:if(0==f%4)d.typedArray=new Float32Array(a,f,h);else{console.warn("glb 1.0 loader: encountered unaligned data (componentType 5126)");e=new ArrayBuffer(4*h);l=new Int8Array(e);k=new Int8Array(a,
   f,4*h);c=0;for(m=4*h;c<m;++c)l[c]=k[c];d.typedArray=new Float32Array(e,0,h)}break;default:d.typedArray=new Float32Array(a,f,h)}p[b]=d}}else g(Error("Invalid JSON format in glTF file. Accessor is missing required property."))}});var u={};n.hasOwnProperty("materials")&&Object.keys(n.materials).forEach(function(a){var b=n.materials[a];if(b.hasOwnProperty("extensions"))if(b.extensions.hasOwnProperty("KHR_materials_common"))if(b.extensions.KHR_materials_common.hasOwnProperty("technique"))if("BLINN"!=b.extensions.KHR_materials_common.technique)g(Error("ShapeDiverGLBLoader got invalid data: only BLINN material technique is supported, we got "+
   b.extensions.KHR_materials_common.technique));else if(b.extensions.KHR_materials_common.hasOwnProperty("values")){var c=new module$src$shared$materials$MaterialPropertiesStandard.default.MaterialPropertiesStandard;b=b.extensions.KHR_materials_common.values;b.hasOwnProperty("doubleSided")&&(c.side=b.doubleSided?module$src$externals$three.default.DoubleSide:module$src$externals$three.default.FrontSide);if(b.hasOwnProperty("diffuse")){for(var d=b.diffuse.slice(0,3),e=0;3>e;++e)d[e]*=255;c.color=(0,module$src$shared$util$toTinyColor.default)(d).toThreeColor();
   d=Math.max(0,Math.min(b.diffuse[3],1));c.opacity=d;c.transparent=1>d}b.hasOwnProperty("shininess")&&(c.metalness=Math.min(1,b.shininess),c.roughness=1-Math.min(1,b.shininess));b.hasOwnProperty("transparency")&&(d=Math.max(0,Math.min(b.transparency,1)),c.opacity=d,c.transparent=1>d);b.hasOwnProperty("transparent")&&(d=module$src$shared$util$GlobalUtils.default.toBoolean(b.transparent),c.transparent=d,d||(c.opacity=1));b.hasOwnProperty("_roughness")&&(c.roughness=Math.min(1,Math.max(0,b.roughness)));
   b.hasOwnProperty("_metalness")&&(c.metalness=Math.min(1,Math.max(0,b.metalness)));u[a]=c}else g(Error("ShapeDiverGLBLoader got invalid data: material definition did not contain values member."));else g(Error("ShapeDiverGLBLoader got invalid data: material definition did not contain technique member."));else g(Error("ShapeDiverGLBLoader got invalid data: material definition did not contain KHR_materials_common member."));else g(Error("ShapeDiverGLBLoader got invalid data: material definition did not contain extensions member."))});
   var t={};Object.keys(n.meshes).forEach(function(a){var b=[],c=n.meshes[a];if(c.hasOwnProperty("primitives")){c=$jscomp.makeIterator(c.primitives);for(var d=c.next();!d.done;d=c.next()){var e=d.value;if(!e.hasOwnProperty("indices")||!e.hasOwnProperty("attributes")){g(Error("ShapeDiverGLBLoader got invalid data: mesh definition primitive misses indices or attributes."));return}if(!e.attributes.hasOwnProperty("POSITION")){g(Error("ShapeDiverGLBLoader got invalid data: mesh definition primitive is missing POSITION"));
   return}d=new module$src$externals$three.default.BufferGeometry;if(!p.hasOwnProperty(e.indices)){g(Error("ShapeDiverGLBLoader got invalid data: accessor for mesh primitives not found."));return}var f=p[e.indices];d.setIndex(new module$src$externals$three.default.BufferAttribute(f.typedArray,f.itemSize));if(!p.hasOwnProperty(e.attributes.POSITION)){g(Error("ShapeDiverGLBLoader got invalid data: accessor for mesh positions not found"));return}f=p[e.attributes.POSITION];d.addAttribute("position",new module$src$externals$three.default.BufferAttribute(f.typedArray,
   f.itemSize));f=!1;if(e.attributes.hasOwnProperty("NORMAL")){if(p.hasOwnProperty(e.attributes.NORMAL)){for(var h=p[e.attributes.NORMAL],l=!1,k=0;10>k;++k){if(.001<Math.abs(h.typedArray[3*k])){l=!0;break}if(.001<Math.abs(h.typedArray[3*k+1])){l=!0;break}if(.001<Math.abs(h.typedArray[3*k+2])){l=!0;break}}l?d.addAttribute("normal",new module$src$externals$three.default.BufferAttribute(h.typedArray,h.itemSize)):d.computeVertexNormals()}}else f=!0;h=!1;e.attributes.hasOwnProperty("COLOR")&&p.hasOwnProperty(e.attributes.COLOR)&&
   (h=p[e.attributes.COLOR],d.addAttribute("color",new module$src$externals$three.default.BufferAttribute(h.typedArray,h.itemSize,!0)),h=!0);k=!1;e.attributes.hasOwnProperty("TEXCOORD_0")&&p.hasOwnProperty(e.attributes.TEXCOORD_0)&&(l=p[e.attributes.TEXCOORD_0],d.addAttribute("uv",new module$src$externals$three.default.BufferAttribute(l.typedArray,l.itemSize)),k=!0);l=null;e.hasOwnProperty("material")&&(e=e.material,u.hasOwnProperty(e)&&(l=u[e]));d={geometry:d,hasTexCoord:k,hasVertexColors:h,flatShading:f};
   null!=l&&(d.material=l);b.push(d)}t[a]=b}else g(Error("ShapeDiverGLBLoader got invalid data: primitives property missing."))});var r=[];Array.isArray(b)&&0!=b.length&&b.every(function(a){return a&&a.isMatrix4})||(b=[new module$src$externals$three.default.Matrix4]);Object.keys(n.nodes).forEach(function(a){var c=n.nodes[a],d=new module$src$externals$three.default.Matrix4;c.hasOwnProperty("matrix")&&d.fromArray(c.matrix);if(c.hasOwnProperty("meshes"))for(var e={transformIndex:0};e.transformIndex<b.length;e=
   {transformIndex:e.transformIndex,matrixFinal:e.matrixFinal},++e.transformIndex){var f=b[e.transformIndex];e.matrixFinal=new module$src$externals$three.default.Matrix4;e.matrixFinal.multiplyMatrices(f,d);c.meshes.forEach(function(b){return function(c){if(t.hasOwnProperty(c))for(var d=0,e=t[c].length;d<e;++d){var f={path:"transformation_"+b.transformIndex+"."+a+"."+c+".primitive_"+d,geometry:t[c][d].geometry,texCoord:t[c][d].hasTexCoord,vertexColors:t[c][d].hasVertexColors,initialMatrix:b.matrixFinal,
   type:"mesh"};t[c][d].hasOwnProperty("material")?(t[c][d].flatShading&&!1===t[c][d].material.flatShading&&(t[c][d].material.flatShading=t[c][d].flatShading),f.material=t[c][d].material):f.flatShade=t[c][d].flatShading;r.push(f)}}}(e))}});f>=e.byteLength&&c(r);k="";for(l=0;5>l;++l)k+=String.fromCharCode(e.getUint8(f+l));if("sdgTF"!=k)console.warn("sdgtfloader: sdgTF magic wrong : "+k);else{e=e.getUint32(f+13,!0);k="";l=Math.ceil(e/1024);for(m=0;m<l;++m){var v=1024;1024>e-1024*m&&(v=e-1024*m);k+=String.fromCharCode.apply(null,
   new Uint8Array(a,f+21+1024*m,v))}var w=JSON.parse(k),y=f+21+e;if(w.hasOwnProperty("accessors")){p={};Object.keys(w.accessors).forEach(function(b){var d=w.accessors[b],e={};if(d.hasOwnProperty("type")&&d.hasOwnProperty("count")&&d.hasOwnProperty("componentType")){switch(d.type){case "SCALAR":e.itemSize=1;break;case "VEC2":e.itemSize=2;break;case "VEC3":e.itemSize=3;break;case "VEC4":e.itemSize=4;break;case "VEC7":e.itemSize=7;break;case "VEC10":e.itemSize=10;break;case "VEC12":e.itemSize=12;break;
   case "MAT2":e.itemSize=4;break;case "MAT3":e.itemSize=9;break;case "MAT4":e.itemSize=16;break;default:e.itemSize=1}var f=y+parseInt(d.byteOffset);a.length<f+d.count*d.itemSize&&console.warn("glb 1.0 loader: Error: buffer length exceeded");switch(d.componentType){case 5120:e.typedArray=new Int8Array(a,f,d.count*e.itemSize);break;case 5121:e.typedArray=new Uint8Array(a,f,d.count*e.itemSize);break;case 5122:e.typedArray=new Int16Array(a,f,d.count*e.itemSize);break;case 5123:e.typedArray=new Uint16Array(a,
   f,d.count*e.itemSize);break;case 5126:e.typedArray=new Float32Array(a,f,d.count*e.itemSize);break;default:e.typedArray=new Float32Array(a,f,d.count*e.itemSize)}e.count=d.count;p[b]=e}else console.warn("sdgtfloader: got invalid data for ShapeDiver formats. Returning pure glTF-based object only."),c(r)});if(w.hasOwnProperty("spheres")&&(f=w.spheres,f.hasOwnProperty("attributes")&&(f=f.attributes,f.hasOwnProperty("SPHERES"))))for(e=p[f.SPHERES],l=0,f=e.count;l<f;++l)k=new module$src$externals$three.default.SphereBufferGeometry(e.typedArray[4*
   l+3],20,20),k.translate(e.typedArray[4*l],e.typedArray[4*l+1],e.typedArray[4*l+2]),r.push({path:"sdgtf_sphere_"+(l+1).toString(),geometry:k,texCoord:!1,type:"mesh"});if(w.hasOwnProperty("circles")&&(f=w.circles,f.hasOwnProperty("attributes")&&(f=f.attributes,f.hasOwnProperty("CIRCLES"))))for(e=p[f.CIRCLES],k=0,f=e.count;k<f;++k){l=new module$src$externals$three.default.Vector3(e.typedArray[10*k],e.typedArray[10*k+1],e.typedArray[10*k+2]);m=new module$src$externals$three.default.Vector3(e.typedArray[10*
   k+3],e.typedArray[10*k+4],e.typedArray[10*k+5]);v=new module$src$externals$three.default.Vector3(e.typedArray[10*k+6],e.typedArray[10*k+7],e.typedArray[10*k+8]);var x=e.typedArray[10*k+9],A=new module$src$externals$three.default.Vector3;A.crossVectors(m,v);if(0<x){x=new module$src$externals$three.default.ArcCurve(0,0,x,0,2*Math.PI,!1);x=(new module$src$externals$three.default.Geometry).setFromPoints(x.getPoints(50));var z=new module$src$externals$three.default.Matrix4;z.set(m.x,v.x,A.x,0,m.y,v.y,
   A.y,0,m.z,v.z,A.z,0,0,0,0,1);x.applyMatrix(z);x.translate(l.x,l.y,l.z);x.sdgtfType="circle";r.push({path:"sdgtf_circle_"+(k+1).toString(),geometry:x,type:"line"})}}if(w.hasOwnProperty("cylinders")&&(f=w.cylinders,f.hasOwnProperty("attributes")&&(f=f.attributes,f.hasOwnProperty("CYLINDERS"))))for(e=p[f.CYLINDERS],k=0,f=e.count;k<f;++k){A=new module$src$externals$three.default.Vector3(e.typedArray[7*k],e.typedArray[7*k+1],e.typedArray[7*k+2]);l=new module$src$externals$three.default.Vector3(e.typedArray[7*
   k+3],e.typedArray[7*k+4],e.typedArray[7*k+5]);x=e.typedArray[7*k+6];m=new module$src$externals$three.default.Vector3;m.subVectors(A,l);z=Math.abs(m.dot(new module$src$externals$three.default.Vector3(1,0,0)));var B=Math.abs(m.dot(new module$src$externals$three.default.Vector3(0,1,0)));v=new module$src$externals$three.default.Vector3;z<B?v.crossVectors(m,new module$src$externals$three.default.Vector3(1,0,0)):v.crossVectors(m,new module$src$externals$three.default.Vector3(0,1,0));z=new module$src$externals$three.default.Vector3;
   z.crossVectors(m,v);m.normalize();v.normalize();z.normalize();x=new module$src$externals$three.default.CylinderBufferGeometry(x,x,A.distanceTo(l),50,1,!0);x.rotateX(.5*Math.PI);x.translate(0,0,.5*A.distanceTo(l));A=new module$src$externals$three.default.Matrix4;A.set(v.x,z.x,m.x,0,v.y,z.y,m.y,0,v.z,z.z,m.z,0,0,0,0,1);x.applyMatrix(A);x.translate(l.x,l.y,l.z);r.push({path:"sdgtf_cylinder_"+(k+1).toString(),geometry:x,texCoord:!1,type:"mesh"})}if(w.hasOwnProperty("arcs")&&(f=w.arcs,f.hasOwnProperty("attributes")&&
   (f=f.attributes,f.hasOwnProperty("ARCS"))))for(e=p[f.ARCS],k=0,f=e.count;k<f;++k)l=new module$src$externals$three.default.Vector3(e.typedArray[12*k],e.typedArray[12*k+1],e.typedArray[12*k+2]),m=new module$src$externals$three.default.Vector3(e.typedArray[12*k+3],e.typedArray[12*k+4],e.typedArray[12*k+5]),v=new module$src$externals$three.default.Vector3(e.typedArray[12*k+6],e.typedArray[12*k+7],e.typedArray[12*k+8]),B=e.typedArray[12*k+9],x=e.typedArray[12*k+10],z=e.typedArray[12*k+11],A=new module$src$externals$three.default.Vector3,
   A.crossVectors(m,v),0<B&&(B=new module$src$externals$three.default.ArcCurve(0,0,B,x,z,!1),x=(new module$src$externals$three.default.Geometry).setFromPoints(B.getPoints(Math.max(3,Math.round((z-x)/2*50*Math.PI)))),z=new module$src$externals$three.default.Matrix4,z.set(m.x,v.x,A.x,0,m.y,v.y,A.y,0,m.z,v.z,A.z,0,0,0,0,1),x.applyMatrix(z),x.translate(l.x,l.y,l.z),x.sdgtfType="arc",r.push({path:"sdgtf_arc_"+(k+1).toString(),geometry:x,type:"line"}));if(verb$$module$src$shared$singletons$GLBLoader&&w.hasOwnProperty("beziercurves")){var J=
   w.beziercurves,F=0;Object.keys(J).forEach(function(a){var b=J[a];if(b.hasOwnProperty("attributes")&&b.hasOwnProperty("degree")){var c=b.attributes;if(c.hasOwnProperty("KNOTS")&&c.hasOwnProperty("CONTROLPOINTS")){var e=p[c.KNOTS];a=[];for(var f=0,g=e.typedArray.length;f<g;++f)a.push(e.typedArray[f]),0!=f&&f!=e.typedArray.length-1||a.push(e.typedArray[f]);e=p[c.CONTROLPOINTS];c=[];f=0;for(g=e.typedArray.length/3;f<g;++f)c.push([e.typedArray[3*f],e.typedArray[3*f+1],e.typedArray[3*f+2]]);b=b.degree;
   try{var h=verb$$module$src$shared$singletons$GLBLoader.geom.NurbsCurve.byKnotsControlPointsWeights(b,a,c)}catch(P){console.warn("sdgtfloader: verb nurbs curve creation failed with error "+P);return}h=h.toThreeGeometry(d);h.sdgtfType="beziercurve";r.push({path:"sdgtf_curve_"+(F+1).toString(),geometry:h,type:"line"});++F}}})}if(verb$$module$src$shared$singletons$GLBLoader&&w.hasOwnProperty("surfacepatches")){var E=w.surfacepatches,G=0;Object.keys(E).forEach(function(a){var b=E[a];if(b.hasOwnProperty("attributes")&&
   b.hasOwnProperty("degreeU")&&b.hasOwnProperty("degreeV")&&b.hasOwnProperty("controlPointCountU")&&b.hasOwnProperty("controlPointCountV")){var c=b.attributes;if(c.hasOwnProperty("KNOTSU")&&c.hasOwnProperty("KNOTSV")&&c.hasOwnProperty("CONTROLPOINTS")){var e=p[c.KNOTSU];a=[];for(var f=0,g=e.typedArray.length;f<g;++f)a.push(e.typedArray[f]),0!=f&&f!=e.typedArray.length-1||a.push(e.typedArray[f]);f=p[c.KNOTSV];e=[];var h=0;for(g=f.typedArray.length;h<g;++h)e.push(f.typedArray[h]),0!=h&&h!=f.typedArray.length-
   1||e.push(f.typedArray[h]);g=b.controlPointCountU;f=b.controlPointCountV;h=p[c.CONTROLPOINTS];c=[];for(var l=0,k=0;k<g;++k){for(var m=[],n=0;n<f;++n)m.push([h.typedArray[3*l],h.typedArray[3*l+1],h.typedArray[3*l+2]]),++l;c.push(m)}g=b.degreeU;b=b.degreeV;try{var q=verb$$module$src$shared$singletons$GLBLoader.geom.NurbsSurface.byKnotsControlPointsWeights(g,b,a,e,c)}catch(R){console.warn("sdgtfloader: verb surface curve creation failed with error "+R.message);return}q=q.toThreeGeometry(d);q.computeFaceNormals();
   q.computeVertexNormals();r.push({path:"sdgtf_surface_"+(G+1).toString(),geometry:q,texCoord:!1,type:"mesh"});++G}}})}if(w.hasOwnProperty("polylines")){var H=w.polylines,C=0;Object.keys(H).forEach(function(a){a=H[a];if(a.hasOwnProperty("attributes")&&(a=a.attributes,a.hasOwnProperty("VERTICES"))){a=p[a.VERTICES];var b=new module$src$externals$three.default.BufferGeometry;b.addAttribute("position",new module$src$externals$three.default.BufferAttribute(a.typedArray,3));b.sdgtfType="polyline";r.push({path:"sdgtf_polyline_"+
   (C+1).toString(),geometry:b,type:"line"});++C}})}if(w.hasOwnProperty("points")){var I=w.points,K=0;Object.keys(I).forEach(function(a){a=I[a];if(a.hasOwnProperty("attributes")&&(a=a.attributes,a.hasOwnProperty("POINTS"))){a=p[a.POINTS];for(var b=new module$src$externals$three.default.Geometry,c=0,d=a.typedArray.length/3;c<d;++c){var e=new module$src$externals$three.default.Vector3(a.typedArray[3*c],a.typedArray[3*c+1],a.typedArray[3*c+2]);b.vertices.push(e)}r.push({path:"sdgtf_pointcloud_"+(K+1).toString(),
   geometry:b,type:"points"});++K}})}}else console.warn("sdgtfloader: got invalid data for ShapeDiver formats. Returning pure glTF-based object only.")}c(r)}else g(Error("Invalid JSON format in glTF file. Main object is missing required property."))}})}};module$src$shared$singletons$GLBLoader.default=new GLBLoader$$module$src$shared$singletons$GLBLoader;var module$src$modules$http_client$interfaces={default:{}};Object.defineProperty(module$src$modules$http_client$interfaces.default,"__esModule",{value:!0});var ResponseType$$module$src$modules$http_client$interfaces;
   (function(b){b.Empty="";b.ArrayBuffer="arraybuffer";b.Text="text";b.Blob="blob";b.Document="document";b.JSON="json"})(ResponseType$$module$src$modules$http_client$interfaces=module$src$modules$http_client$interfaces.default.ResponseType||(module$src$modules$http_client$interfaces.default.ResponseType={}));var module$src$modules$http_client$HttpClient={default:{}},__awaiter$$module$src$modules$http_client$HttpClient=this&&module$src$modules$http_client$HttpClient.default.__awaiter||function(b,a,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,h){function f(a){try{l(d.next(a))}catch(n){h(n)}}function g(a){try{l(d["throw"](a))}catch(n){h(n)}}function l(a){a.done?c(a.value):e(a.value).then(f,g)}l((d=d.apply(b,a||[])).next())})},__generator$$module$src$modules$http_client$HttpClient=
   this&&module$src$modules$http_client$HttpClient.default.__generator||function(b,a){function c(a){return function(b){return d([a,b])}}function d(c){if(g)throw new TypeError("Generator is already executing.");for(;e;)try{if(g=1,h&&(f=c[0]&2?h["return"]:c[0]?h["throw"]||((f=h["return"])&&f.call(h),0):h.next)&&!(f=f.call(h,c[1])).done)return f;if(h=0,f)c=[c[0]&2,f.value];switch(c[0]){case 0:case 1:f=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++;h=c[1];c=[0];continue;case 7:c=e.ops.pop();
   e.trys.pop();continue;default:if(!(f=e.trys,f=0<f.length&&f[f.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!f||c[1]>f[0]&&c[1]<f[3]))e.label=c[1];else if(6===c[0]&&e.label<f[1])e.label=f[1],f=c;else if(f&&e.label<f[2])e.label=f[2],e.ops.push(c);else{f[2]&&e.ops.pop();e.trys.pop();continue}}c=a.call(b,e)}catch(m){c=[6,m],h=0}finally{g=f=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},g,h,
   f,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k},__importDefault$$module$src$modules$http_client$HttpClient=this&&module$src$modules$http_client$HttpClient.default.__importDefault||function(b){return b&&b.__esModule?b:{"default":b}};Object.defineProperty(module$src$modules$http_client$HttpClient.default,"__esModule",{value:!0});
   var axios_1$$module$src$modules$http_client$HttpClient=__importDefault$$module$src$modules$http_client$HttpClient(module$src$externals$axios.default),interfaces_1$$module$src$modules$http_client$HttpClient=module$src$modules$http_client$interfaces.default,HttpClient$$module$src$modules$http_client$HttpClient=function(){function b(){this._cache={}}Object.defineProperty(b.prototype,"responseType",{get:function(){return module$src$modules$http_client$interfaces.default.ResponseType},enumerable:!0,configurable:!0});
   b.prototype.getAsync=function(a,b){void 0===b&&(b={});return __awaiter$$module$src$modules$http_client$HttpClient(this,void 0,void 0,function(){var c;return __generator$$module$src$modules$http_client$HttpClient(this,function(d){c={method:"GET",url:a};b.timeout&&(c.timeout=b.timeout);b.responseType&&(c.responseType=b.responseType);return[2,axios_1$$module$src$modules$http_client$HttpClient.default(c)]})})};b.prototype.getCacheAsync=function(a,b){void 0===b&&(b={});return __awaiter$$module$src$modules$http_client$HttpClient(this,
   void 0,void 0,function(){var c;return __generator$$module$src$modules$http_client$HttpClient(this,function(d){this._cache[a]||(c={method:"GET",url:a},b.timeout&&(c.timeout=b.timeout),b.responseType&&(c.responseType=b.responseType),this._cache[a]=axios_1$$module$src$modules$http_client$HttpClient.default(c));return[2,this._cache[a]]})})};return b}();module$src$modules$http_client$HttpClient.default.HttpClientInstance=new HttpClient$$module$src$modules$http_client$HttpClient;var module$src$shared$singletons$GLTFHelpers$GltfLoaderTexture={default:{}},__awaiter$$module$src$shared$singletons$GLTFHelpers$GltfLoaderTexture=this&&module$src$shared$singletons$GLTFHelpers$GltfLoaderTexture.default.__awaiter||function(b,a,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,h){function f(a){try{l(d.next(a))}catch(n){h(n)}}function g(a){try{l(d["throw"](a))}catch(n){h(n)}}function l(a){a.done?c(a.value):e(a.value).then(f,g)}
   l((d=d.apply(b,a||[])).next())})},__generator$$module$src$shared$singletons$GLTFHelpers$GltfLoaderTexture=this&&module$src$shared$singletons$GLTFHelpers$GltfLoaderTexture.default.__generator||function(b,a){function c(a){return function(b){return d([a,b])}}function d(c){if(g)throw new TypeError("Generator is already executing.");for(;e;)try{if(g=1,h&&(f=c[0]&2?h["return"]:c[0]?h["throw"]||((f=h["return"])&&f.call(h),0):h.next)&&!(f=f.call(h,c[1])).done)return f;if(h=0,f)c=[c[0]&2,f.value];switch(c[0]){case 0:case 1:f=
   c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++;h=c[1];c=[0];continue;case 7:c=e.ops.pop();e.trys.pop();continue;default:if(!(f=e.trys,f=0<f.length&&f[f.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!f||c[1]>f[0]&&c[1]<f[3]))e.label=c[1];else if(6===c[0]&&e.label<f[1])e.label=f[1],f=c;else if(f&&e.label<f[2])e.label=f[2],e.ops.push(c);else{f[2]&&e.ops.pop();e.trys.pop();continue}}c=a.call(b,e)}catch(m){c=[6,m],h=0}finally{g=f=0}if(c[0]&5)throw c[1];return{value:c[0]?
   c[1]:void 0,done:!0}}var e={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},g,h,f,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k};Object.defineProperty(module$src$shared$singletons$GLTFHelpers$GltfLoaderTexture.default,"__esModule",{value:!0});
   var TextureLoader$$module$src$shared$singletons$GLTFHelpers$GltfLoaderTexture=module$src$shared$singletons$TextureLoader.default,DATA_URI_REGEX$$module$src$shared$singletons$GLTFHelpers$GltfLoaderTexture=/^data:(.*?)(;base64)?,(.*)$/,HTTPS_URI_REGEX$$module$src$shared$singletons$GLTFHelpers$GltfLoaderTexture=/^https:\/\//;
   module$src$shared$singletons$GLTFHelpers$GltfLoaderTexture.default.GltfLoaderTexture=function(){function b(a,b,d){var c=this;this.id=a;this._texture=null;this.id=a;this.textureRef=b.textures[this.id];this.imageRef=b.images[this.textureRef.source];this.imageRef.uri?this._onLoad=new Promise(function(a,d){return __awaiter$$module$src$shared$singletons$GLTFHelpers$GltfLoaderTexture(c,void 0,void 0,function(){var c,e,g;return __generator$$module$src$shared$singletons$GLTFHelpers$GltfLoaderTexture(this,
   function(f){switch(f.label){case 0:c=DATA_URI_REGEX$$module$src$shared$singletons$GLTFHelpers$GltfLoaderTexture.test(this.imageRef.uri)||HTTPS_URI_REGEX$$module$src$shared$singletons$GLTFHelpers$GltfLoaderTexture.test(this.imageRef.uri)?this.imageRef.uri:b.baseUrl+"/"+this.imageRef.uri,f.label=1;case 1:return f.trys.push([1,3,,4]),[4,module$src$shared$singletons$TextureLoader.default.loadTexture(c)];case 2:return e=f.sent(),e.flipY=!1,this._texture=e,a(),[3,4];case 3:return g=f.sent(),console.error(g),
   d(g),[3,4];case 4:return[2]}})})}):this.imageRef.bufferView&&(this._onLoad=new Promise(function(a,e){return __awaiter$$module$src$shared$singletons$GLTFHelpers$GltfLoaderTexture(c,void 0,void 0,function(){var c,g,h,m,n,q,p,u,t,r;return __generator$$module$src$shared$singletons$GLTFHelpers$GltfLoaderTexture(this,function(f){switch(f.label){case 0:f.trys.push([0,2,,3]);c=this.imageRef.bufferView;g=b.bufferViews[c];h=d.find(function(a){return a.id==g.buffer});m=h.bufferViews.find(function(a){return a.id==
   c}).dataView;n=[];for(q=0;q<m.byteLength;q+=1)n[q]=m.getUint8(q);p=new Blob([new Uint8Array(n)],{type:this.imageRef.mimeType});u=window.URL.createObjectURL(p);window.open(u);return[4,module$src$shared$singletons$TextureLoader.default.loadTexture(u)];case 1:return t=f.sent(),t.flipY=!1,this._texture=t,a(),[3,3];case 2:return r=f.sent(),console.error(r),e(r),[3,3];case 3:return[2]}})})}))}Object.defineProperty(b.prototype,"onLoad",{get:function(){return this._onLoad},enumerable:!0,configurable:!0});
   Object.defineProperty(b.prototype,"texture",{get:function(){return this._texture},enumerable:!0,configurable:!0});b.prototype.toJSONTexture=function(){return{href:this.href}};b.prototype.encodeBase64DataUri=function(a){var b=[];a=new Uint8Array(a);for(var d=0;d<a.length;d++)b.push(String.fromCharCode(a[d]));return"data:application/octet-stream;base64,"+btoa(b.join(""))};return b}();var module$src$shared$singletons$GLTFHelpers$Node={default:{}},__read$$module$src$shared$singletons$GLTFHelpers$Node=this&&module$src$shared$singletons$GLTFHelpers$Node.default.__read||function(b,a){var c="function"===typeof Symbol&&b[Symbol.iterator];if(!c)return b;b=c.call(b);var d,e=[];try{for(;(void 0===a||0<a--)&&!(d=b.next()).done;)e.push(d.value)}catch(h){var g={error:h}}finally{try{d&&!d.done&&(c=b["return"])&&c.call(b)}finally{if(g)throw g.error;}}return e},__spread$$module$src$shared$singletons$GLTFHelpers$Node=
   this&&module$src$shared$singletons$GLTFHelpers$Node.default.__spread||function(){for(var b=[],a=0;a<arguments.length;a++)b=b.concat(__read$$module$src$shared$singletons$GLTFHelpers$Node(arguments[a]));return b};Object.defineProperty(module$src$shared$singletons$GLTFHelpers$Node.default,"__esModule",{value:!0});var THREE$$module$src$shared$singletons$GLTFHelpers$Node=module$src$externals$three.default;
   module$src$shared$singletons$GLTFHelpers$Node.default.Node=function(){function b(a,b,d,e,g){var c;void 0===d&&(d=null);void 0===g&&(g=!1);this.id=a;this.gltf=b;this.parent=d;this.allNodes=e;this.rootNode=g;this.nodes=[];this.transformationsOrder=[];this.materials=[];this.nodeRef=b.nodes[a];this.mesh=isNaN(this.nodeRef.mesh)?null:b.meshes[this.nodeRef.mesh];this.camera=isNaN(this.nodeRef.camera)?null:b.cameras[this.nodeRef.camera];this.matrix=new module$src$externals$three.default.Matrix4;this.matrix.multiply(b.rotationMatrix);
   this.transformedMatrix=new module$src$externals$three.default.Matrix4;this.nodeRef.matrix?this.transformedMatrix.fromArray(this.nodeRef.matrix):(this.nodeRef.translation&&(a=new module$src$externals$three.default.Matrix4,a.makeTranslation.apply(a,__spread$$module$src$shared$singletons$GLTFHelpers$Node(this.nodeRef.translation)),this.transformedMatrix.multiply(a)),this.nodeRef.rotation&&(d=new ((c=module$src$externals$three.default.Quaternion).bind.apply(c,__spread$$module$src$shared$singletons$GLTFHelpers$Node([void 0],
   this.nodeRef.rotation))),a=new module$src$externals$three.default.Matrix4,a.makeRotationFromQuaternion(d),this.transformedMatrix.multiply(a)),this.nodeRef.scale&&(a=new module$src$externals$three.default.Matrix4,a.makeScale.apply(a,__spread$$module$src$shared$singletons$GLTFHelpers$Node(this.nodeRef.scale)),this.transformedMatrix.multiply(a)));this.setTransformationOrder();this.createChildNodes(b,e);this.resolveFinalMatrix();this.createMaterials(b);e.push(this)}Object.defineProperty(b.prototype,"name",
   {get:function(){return this.nodeRef.name},enumerable:!0,configurable:!0});b.prototype.createChildNodes=function(a,c){var d=this;this.nodeRef.children&&0<this.nodeRef.children.length&&this.nodeRef.children.forEach(function(e){return d.nodes.push(new b(e,a,d,c))})};b.prototype.createMaterials=function(a){var b=this;this.mesh&&this.mesh.primitives.forEach(function(c){c.hasOwnProperty("material")&&b.materials.push(a.materials[c.material])})};b.prototype.resolveFinalMatrix=function(){for(var a=this.transformationsOrder[0],
   b=1;b<this.transformationsOrder.length;b++)a.multiply(this.transformationsOrder[b]);this.matrix.multiply(a)};b.prototype.setTransformationOrder=function(){var a=this.parent;for(this.transformationsOrder.push(this.transformedMatrix.clone());a;)a.transformedMatrix&&this.transformationsOrder.length&&this.transformationsOrder.push(a.transformedMatrix.clone()),a=a.parent;this.transformationsOrder.reverse()};return b}();var module$src$shared$singletons$GLTFHelpers$SceneHierarchy={default:{}};Object.defineProperty(module$src$shared$singletons$GLTFHelpers$SceneHierarchy.default,"__esModule",{value:!0});var Node_1$$module$src$shared$singletons$GLTFHelpers$SceneHierarchy=module$src$shared$singletons$GLTFHelpers$Node.default,THREE$$module$src$shared$singletons$GLTFHelpers$SceneHierarchy=module$src$externals$three.default;
   module$src$shared$singletons$GLTFHelpers$SceneHierarchy.default.SceneHierarchy=function(){return function(b){var a=this;this.nodes=[];this.allNodes=[];this.sceneId=b.scene||0;this.sceneRef=b.scenes[this.sceneId];this.rotationMatrix=new module$src$externals$three.default.Matrix4;this.rotationMatrix.makeRotationAxis(new module$src$externals$three.default.Vector3(1,0,0),.5*Math.PI);b.rotationMatrix=this.rotationMatrix;this.sceneRef.nodes.forEach(function(c){return a.nodes.push(new module$src$shared$singletons$GLTFHelpers$Node.default.Node(c,
   b,null,a.allNodes,!0))})}}();var module$src$schema$gltf2schema={default:{}};Object.defineProperty(module$src$schema$gltf2schema.default,"__esModule",{value:!0});var WebGLBufferType$$module$src$schema$gltf2schema;(function(b){b[b.ARRAY_BUFFER=34962]="ARRAY_BUFFER";b[b.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER"})(WebGLBufferType$$module$src$schema$gltf2schema=module$src$schema$gltf2schema.default.WebGLBufferType||(module$src$schema$gltf2schema.default.WebGLBufferType={}));var GLTF2AccessorType$$module$src$schema$gltf2schema;
   (function(b){b.SCALAR="SCALAR";b.VEC2="VEC2";b.VEC3="VEC3";b.VEC4="VEC4";b.MAT2="MAT2";b.MAT3="MAT3";b.MAT4="MAT4"})(GLTF2AccessorType$$module$src$schema$gltf2schema=module$src$schema$gltf2schema.default.GLTF2AccessorType||(module$src$schema$gltf2schema.default.GLTF2AccessorType={}));var GLTF2ComponentType$$module$src$schema$gltf2schema;
   (function(b){b[b.BYTE=5120]="BYTE";b[b.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE";b[b.SHORT=5122]="SHORT";b[b.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT";b[b.UNSIGNED_INT=5125]="UNSIGNED_INT";b[b.FLOAT=5126]="FLOAT"})(GLTF2ComponentType$$module$src$schema$gltf2schema=module$src$schema$gltf2schema.default.GLTF2ComponentType||(module$src$schema$gltf2schema.default.GLTF2ComponentType={}));var GLTF2AlphaMode$$module$src$schema$gltf2schema;
   (function(b){b.OPAQUE="OPAQUE";b.MASK="MASK";b.BLEND="BLEND"})(GLTF2AlphaMode$$module$src$schema$gltf2schema=module$src$schema$gltf2schema.default.GLTF2AlphaMode||(module$src$schema$gltf2schema.default.GLTF2AlphaMode={}));var module$src$shared$singletons$GLTFHelpers$Accessor={default:{}},_a$$module$src$shared$singletons$GLTFHelpers$Accessor,_b$$module$src$shared$singletons$GLTFHelpers$Accessor;Object.defineProperty(module$src$shared$singletons$GLTFHelpers$Accessor.default,"__esModule",{value:!0});
   var gltf2schema_1$$module$src$shared$singletons$GLTFHelpers$Accessor=module$src$schema$gltf2schema.default,ELEM_IN_TYPE$$module$src$shared$singletons$GLTFHelpers$Accessor=(_a$$module$src$shared$singletons$GLTFHelpers$Accessor={},_a$$module$src$shared$singletons$GLTFHelpers$Accessor[module$src$schema$gltf2schema.default.GLTF2AccessorType.SCALAR]=1,_a$$module$src$shared$singletons$GLTFHelpers$Accessor[module$src$schema$gltf2schema.default.GLTF2AccessorType.VEC2]=2,_a$$module$src$shared$singletons$GLTFHelpers$Accessor[module$src$schema$gltf2schema.default.GLTF2AccessorType.VEC3]=
   3,_a$$module$src$shared$singletons$GLTFHelpers$Accessor[module$src$schema$gltf2schema.default.GLTF2AccessorType.VEC4]=4,_a$$module$src$shared$singletons$GLTFHelpers$Accessor),SIZE_OF_ELEM_IN_BYTES$$module$src$shared$singletons$GLTFHelpers$Accessor=(_b$$module$src$shared$singletons$GLTFHelpers$Accessor={},_b$$module$src$shared$singletons$GLTFHelpers$Accessor[module$src$schema$gltf2schema.default.GLTF2ComponentType.UNSIGNED_BYTE]=1,_b$$module$src$shared$singletons$GLTFHelpers$Accessor[module$src$schema$gltf2schema.default.GLTF2ComponentType.UNSIGNED_SHORT]=
   2,_b$$module$src$shared$singletons$GLTFHelpers$Accessor[module$src$schema$gltf2schema.default.GLTF2ComponentType.UNSIGNED_INT]=4,_b$$module$src$shared$singletons$GLTFHelpers$Accessor[module$src$schema$gltf2schema.default.GLTF2ComponentType.FLOAT]=4,_b$$module$src$shared$singletons$GLTFHelpers$Accessor);
   module$src$shared$singletons$GLTFHelpers$Accessor.default.Accessor=function(){function b(a,b,d,e){this.id=a;this.buffer=d;this.bufferView=e;this.accessorRef=b.accessors[a];this.type=this.accessorRef.type;this.componentType=this.accessorRef.componentType;this.offsetForInterleaved=this.bufferView.numOfTypeArrayElementsPerVertex;this.byteOffset=this.accessorRef.byteOffset||0;this.min=this.accessorRef.min;this.max=this.accessorRef.max;this.elementComponentsSize=ELEM_IN_TYPE$$module$src$shared$singletons$GLTFHelpers$Accessor[this.type];
   this.bytesPerElement=SIZE_OF_ELEM_IN_BYTES$$module$src$shared$singletons$GLTFHelpers$Accessor[this.componentType];a=this.componentType===module$src$schema$gltf2schema.default.GLTF2ComponentType.FLOAT;this.count=this.accessorRef.count;this.byteLength=this.count*this.elementComponentsSize*this.bytesPerElement;b=this.bufferView.dataView;this.bufferArray=null;d=[];this.bufferView.isInterleaved?null==this.bufferView.interleavedBuffer&&(d=this.processInterleavedBufferArray(b,a)):d=this.processBufferArray(b,
   a);switch(this.bytesPerElement){case 1:this.bufferArray=new Uint8Array(d);break;case 2:this.bufferArray=new Uint16Array(d);break;case 4:this.bufferArray=a?new Float32Array(d):new Uint32Array(d)}this.array=d;this.bufferView.isInterleaved&&(this.bufferView.interleavedBuffer=this.bufferArray)}b.prototype.processBufferArray=function(a,b){for(var c=[],e=0,g=this.byteOffset;g<this.byteOffset+this.byteLength;g+=this.bytesPerElement){var h=0;switch(this.bytesPerElement){case 1:h=a.getUint8(g);break;case 2:h=
   a.getUint16(g,!0);break;case 4:b?(h=a.getFloat32(g,!0),this.min&&h<this.min[e]&&(h=this.min[e]),this.max&&h>this.max[e]&&(h=this.max[e]),e++,e>=this.elementComponentsSize&&(e=0)):h=a.getUint32(g,!0)}c.push(h)}return c};b.prototype.processInterleavedBufferArray=function(a,b){for(var c=[],e=0,g=0;g<this.bufferView.byteLength;g+=this.bytesPerElement){var h=0;switch(this.bytesPerElement){case 1:h=a.getUint8(g);break;case 2:h=a.getUint16(g,!0);break;case 4:b?(h=a.getFloat32(g,!0),this.min&&h<this.min[e]&&
   (h=this.min[e]),this.max&&h>this.max[e]&&(h=this.max[e]),e++,e>=this.elementComponentsSize&&(e=0)):h=a.getUint32(g,!0)}c.push(h)}return c};return b}();var module$src$shared$singletons$GLTFHelpers$BufferView={default:{}};Object.defineProperty(module$src$shared$singletons$GLTFHelpers$BufferView.default,"__esModule",{value:!0});var Accessor_1$$module$src$shared$singletons$GLTFHelpers$BufferView=module$src$shared$singletons$GLTFHelpers$Accessor.default;
   module$src$shared$singletons$GLTFHelpers$BufferView.default.BufferView=function(){return function(b,a,c){var d=this;this.id=b;this.buffer=c;this.accessors=[];this.interleavedBuffer=null;this.isInterleaved=!1;this.numOfTypeArrayElementsPerVertex=0;this.bufferViewRef=a.bufferViews[b];this.byteOffset=this.bufferViewRef.byteOffset;this.byteLength=this.bufferViewRef.byteLength;this.byteStride=this.bufferViewRef.byteStride||0;c=a.accessors?a.accessors.filter(function(a){return a.bufferView==d.id}):[];0<
   c.length&&(this.isInterleaved=c[0].count*this.byteStride===this.byteLength);this.numOfTypeArrayElementsPerVertex=0;this.dataView=new DataView(this.buffer.buffer,this.byteOffset,this.byteLength);for(var e in a.accessors)a.accessors[e].bufferView==b&&(c=new module$src$shared$singletons$GLTFHelpers$Accessor.default.Accessor(e,a,this.buffer,this),this.numOfTypeArrayElementsPerVertex+=c.elementComponentsSize,this.accessors.push(c))}}();var module$src$shared$singletons$GLTFHelpers$GltfLoaderBuffer={default:{}};Object.defineProperty(module$src$shared$singletons$GLTFHelpers$GltfLoaderBuffer.default,"__esModule",{value:!0});
   var interfaces_1$$module$src$shared$singletons$GLTFHelpers$GltfLoaderBuffer=module$src$modules$http_client$interfaces.default,BufferView_1$$module$src$shared$singletons$GLTFHelpers$GltfLoaderBuffer=module$src$shared$singletons$GLTFHelpers$BufferView.default,DATA_URI_REGEX$$module$src$shared$singletons$GLTFHelpers$GltfLoaderBuffer=/^data:(.*?)(;base64)?,(.*)$/;
   module$src$shared$singletons$GLTFHelpers$GltfLoaderBuffer.default.GltfLoaderBuffer=function(){function b(a,b){var c=this;this.id=a;this._buffer=null;this.bufferViews=[];this.bufferRef=b.buffers[a];this.byteLength=this.bufferRef.byteLength;this._onLoad=new Promise(function(d,g){if(DATA_URI_REGEX$$module$src$shared$singletons$GLTFHelpers$GltfLoaderBuffer.test(c.bufferRef.uri)){var e=DATA_URI_REGEX$$module$src$shared$singletons$GLTFHelpers$GltfLoaderBuffer.exec(c.bufferRef.uri);c.buffer=c.decodeDataUri(e,
   module$src$modules$http_client$interfaces.default.ResponseType.ArrayBuffer);c.createBufferViews(b);d()}else if(0!=a||c.bufferRef.uri)c.loadArrayBuffer(b.baseUrl+"/"+c.bufferRef.uri,function(a){c.buffer=a;c.createBufferViews(b);d()},function(a){console.error(a);g(a)});else{e=new ArrayBuffer(b.dataView.byteLength);for(var f=new Uint8Array(e),k=0;k<b.dataView.byteLength;k++)f[k]=b.dataView.getUint8(k);c.buffer=e;c.createBufferViews(b);d()}})}Object.defineProperty(b.prototype,"buffer",{get:function(){return this._buffer},
   set:function(a){this._buffer=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"onLoad",{get:function(){return this._onLoad},enumerable:!0,configurable:!0});b.prototype.createBufferViews=function(a){for(var b in a.bufferViews)a.bufferViews[b].buffer==this.id&&this.bufferViews.push(new module$src$shared$singletons$GLTFHelpers$BufferView.default.BufferView(Number.parseInt(b),a,this))};b.prototype.decodeDataUri=function(a,b){b="undefined"!==typeof b?b:module$src$modules$http_client$interfaces.default.ResponseType.Empty;
   var c=a[1],e=!!a[2];a=a[3];switch(b){case module$src$modules$http_client$interfaces.default.ResponseType.Empty:case module$src$modules$http_client$interfaces.default.ResponseType.Text:return this.decodeDataUriText(e,a);case module$src$modules$http_client$interfaces.default.ResponseType.ArrayBuffer:return this.decodeDataUriArrayBuffer(e,a);case module$src$modules$http_client$interfaces.default.ResponseType.Blob:return b=this.decodeDataUriArrayBuffer(e,a),new Blob([b],{type:c});case module$src$modules$http_client$interfaces.default.ResponseType.Document:return(new DOMParser).parseFromString(this.decodeDataUriText(e,
   a),c);case module$src$modules$http_client$interfaces.default.ResponseType.JSON:return JSON.parse(this.decodeDataUriText(e,a));default:throw"Unhandled responseType: "+b;}};b.prototype.decodeDataUriArrayBuffer=function(a,b){a=this.decodeDataUriText(a,b);b=new ArrayBuffer(a.length);for(var c=new Uint8Array(b),e=0;e<a.length;e++)c[e]=a.charCodeAt(e);return b};b.prototype.decodeDataUriText=function(a,b){b=decodeURIComponent(b);return a?atob(b):b};b.prototype.loadArrayBuffer=function(a,b,d){this.loadWithXhr(a,
   "arraybuffer",b,d)};b.prototype.loadWithXhr=function(a,b,d,e){var c=DATA_URI_REGEX$$module$src$shared$singletons$GLTFHelpers$GltfLoaderBuffer.exec(a);if(null!==c)d(this.decodeDataUri(c,b));else{var h=new XMLHttpRequest;h.open("GET",a,!0);"undefined"!==typeof b&&(h.responseType=b);h.onload=function(a){200===h.status?d(h.response):e(a)};h.onerror=function(a){e(a)};h.send()}};return b}();var module$src$shared$materials$PbrMaterialConverter={default:{}},__read$$module$src$shared$materials$PbrMaterialConverter=this&&module$src$shared$materials$PbrMaterialConverter.default.__read||function(b,a){var c="function"===typeof Symbol&&b[Symbol.iterator];if(!c)return b;b=c.call(b);var d,e=[];try{for(;(void 0===a||0<a--)&&!(d=b.next()).done;)e.push(d.value)}catch(h){var g={error:h}}finally{try{d&&!d.done&&(c=b["return"])&&c.call(b)}finally{if(g)throw g.error;}}return e},__spread$$module$src$shared$materials$PbrMaterialConverter=
   this&&module$src$shared$materials$PbrMaterialConverter.default.__spread||function(){for(var b=[],a=0;a<arguments.length;a++)b=b.concat(__read$$module$src$shared$materials$PbrMaterialConverter(arguments[a]));return b};Object.defineProperty(module$src$shared$materials$PbrMaterialConverter.default,"__esModule",{value:!0});
   module$src$shared$materials$PbrMaterialConverter.default.PbrMaterialConverter=function(){function b(){this._dielectricSpecular=[.04,.04,.04];this._epsilon=1E-6}b.prototype.convertToMetallicRoughness=function(a){var b=this,d=a.diffuseFactor,e=a.specularFactor;a=a.glosinessFactor;var g=1-this.getMaxComponent(e),h=this.solveMetallic(this.getPerceivedBrightness(d),this.getPerceivedBrightness(e),g);d=d.map(function(a){return g/(1-b._dielectricSpecular[0])/Math.max(1-h,b._epsilon)*a});e=this.subtract(e,
   this._dielectricSpecular.map(function(a){return a*(1-h)}).map(function(a){return 1/Math.max(h,b._epsilon)*a}));return{baseColor:this.lerp(d,e,h*h).map(function(a){return b.clamp(a)}),metallic:h,roughness:1-a}};b.prototype.clamp=function(a,b,d){void 0===b&&(b=0);void 0===d&&(d=1);return a>d?d:a<b?b:a};b.prototype.getMaxComponent=function(a){return Math.max.apply(Math,__spread$$module$src$shared$materials$PbrMaterialConverter(a))};b.prototype.getPerceivedBrightness=function(a){var b=a[0],d=a[1];a=a[2];
   return Math.sqrt(.299*b*b+.587*d*d+.114*a*a)};b.prototype.lerp=function(a,b,d){d=0>d?0:d;d=1<d?1:d;if(Array.isArray(a)){for(var c=[],g=0;g<a.length;g++)c.push(this.lerp(a[g],b[g],d));return c}return a+(b-a)*d};b.prototype.solveMetallic=function(a,b,d){if(b<this._dielectricSpecular[0])return 0;var c=this._dielectricSpecular[0];a=a*d/(1-this._dielectricSpecular[0])+b-2*this._dielectricSpecular[0];return this.clamp((-a+Math.sqrt(Math.max(a*a-4*c*(this._dielectricSpecular[0]-b),0)))/(2*c),0,1)};b.prototype.subtract=
   function(a,b){for(var c=[],e=0;e<a.length;e++)c.push(a[e]-b[e]);return c};return b}();var module$src$shared$singletons$GLTFLoader={default:{}},__awaiter$$module$src$shared$singletons$GLTFLoader=this&&module$src$shared$singletons$GLTFLoader.default.__awaiter||function(b,a,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,h){function f(a){try{l(d.next(a))}catch(n){h(n)}}function g(a){try{l(d["throw"](a))}catch(n){h(n)}}function l(a){a.done?c(a.value):e(a.value).then(f,g)}l((d=d.apply(b,a||[])).next())})},__generator$$module$src$shared$singletons$GLTFLoader=
   this&&module$src$shared$singletons$GLTFLoader.default.__generator||function(b,a){function c(a){return function(b){return d([a,b])}}function d(c){if(g)throw new TypeError("Generator is already executing.");for(;e;)try{if(g=1,h&&(f=c[0]&2?h["return"]:c[0]?h["throw"]||((f=h["return"])&&f.call(h),0):h.next)&&!(f=f.call(h,c[1])).done)return f;if(h=0,f)c=[c[0]&2,f.value];switch(c[0]){case 0:case 1:f=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++;h=c[1];c=[0];continue;case 7:c=e.ops.pop();
   e.trys.pop();continue;default:if(!(f=e.trys,f=0<f.length&&f[f.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!f||c[1]>f[0]&&c[1]<f[3]))e.label=c[1];else if(6===c[0]&&e.label<f[1])e.label=f[1],f=c;else if(f&&e.label<f[2])e.label=f[2],e.ops.push(c);else{f[2]&&e.ops.pop();e.trys.pop();continue}}c=a.call(b,e)}catch(m){c=[6,m],h=0}finally{g=f=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},g,h,
   f,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k},__read$$module$src$shared$singletons$GLTFLoader=this&&module$src$shared$singletons$GLTFLoader.default.__read||function(b,a){var c="function"===typeof Symbol&&b[Symbol.iterator];if(!c)return b;b=c.call(b);var d,e=[];try{for(;(void 0===a||0<a--)&&!(d=b.next()).done;)e.push(d.value)}catch(h){var g={error:h}}finally{try{d&&!d.done&&(c=b["return"])&&c.call(b)}finally{if(g)throw g.error;
   }}return e},__spread$$module$src$shared$singletons$GLTFLoader=this&&module$src$shared$singletons$GLTFLoader.default.__spread||function(){for(var b=[],a=0;a<arguments.length;a++)b=b.concat(__read$$module$src$shared$singletons$GLTFLoader(arguments[a]));return b};Object.defineProperty(module$src$shared$singletons$GLTFLoader.default,"__esModule",{value:!0});
   var HttpClient_1$$module$src$shared$singletons$GLTFLoader=module$src$modules$http_client$HttpClient.default,GltfLoaderTexture_1$$module$src$shared$singletons$GLTFLoader=module$src$shared$singletons$GLTFHelpers$GltfLoaderTexture.default,MaterialPropertiesStandard_1$$module$src$shared$singletons$GLTFLoader=module$src$shared$materials$MaterialPropertiesStandard.default,SceneHierarchy_1$$module$src$shared$singletons$GLTFLoader=module$src$shared$singletons$GLTFHelpers$SceneHierarchy.default,GltfLoaderBuffer_1$$module$src$shared$singletons$GLTFLoader=
   module$src$shared$singletons$GLTFHelpers$GltfLoaderBuffer.default,THREE$$module$src$shared$singletons$GLTFLoader=module$src$externals$three.default,GLBLoaderSingleton$$module$src$shared$singletons$GLTFLoader=module$src$shared$singletons$GLBLoader.default,PbrMaterialConverter_1$$module$src$shared$singletons$GLTFLoader=module$src$shared$materials$PbrMaterialConverter.default,SUPPORTED_EXTENSIONS$$module$src$shared$singletons$GLTFLoader=["KHR_materials_pbrSpecularGlossiness"],THREE_BLENDING$$module$src$shared$singletons$GLTFLoader=
   module$src$externals$three.default,THREE_SIDE$$module$src$shared$singletons$GLTFLoader=module$src$externals$three.default,GLTFLoader$$module$src$shared$singletons$GLTFLoader=function(){function b(){}b.prototype.error=function(){};b.prototype.loadGeometry=function(a,b,d,e){return __awaiter$$module$src$shared$singletons$GLTFLoader(this,void 0,void 0,function(){var c,e,f,k,l,m,n,q,p,u,t,r,v,w;return __generator$$module$src$shared$singletons$GLTFLoader(this,function(g){switch(g.label){case 0:return g.trys.push([0,
   2,,3]),[4,module$src$modules$http_client$HttpClient.default.HttpClientInstance.getAsync(a,{timeout:3E4,responseType:module$src$modules$http_client$HttpClient.default.HttpClientInstance.responseType.ArrayBuffer})];case 1:c=g.sent();e=c.headers;f=e.hasOwnProperty("content-type")?e["content-type"]:"";k=f.includes("model/gltf-binary")||f.includes("application/octet-stream")||f.includes("model/gltf.binary");if(!k&&!f.includes("model/gltf+json")&&!f.includes("application/json"))throw Error("Unexpected Content-Type "+
   f+" for glTF 2.0");l=k?c.data:JSON.parse(String.fromCharCode.apply(null,new Uint8Array(c.data)));if(k){m=new DataView(c.data);n="";for(q=0;4>q;++q)n+=String.fromCharCode(m.getUint8(q));if("glTF"!=n)throw Error("ShapeDiverGLtfLoader got invalid data: glTF magic wrong.");p=m.getUint32(4,!0);if(2!=p)return[2,module$src$shared$singletons$GLBLoader.default.loadGeometry(a,b,d,e)];u=m.getUint32(12,!0);t="";for(r=0;r<u;++r)t+=String.fromCharCode(m.getUint8(20+r));l=JSON.parse(t);l.glTFBinaryDataByteOffset=
   28+u;l.dataView=new DataView(c.data,l.glTFBinaryDataByteOffset)}else if("2.0"!=l.asset.version)return[2,module$src$shared$singletons$GLBLoader.default.loadGeometry(a,b,d,e)];l.baseUrl=this.removeLastDirectoryPartOf(a);!l.baseUrl&&window&&window.location&&window.location.href&&(l.baseUrl=this.removeLastDirectoryPartOf(window.location.href));return[2,this.processGltfAsync(l,b)];case 2:return v=g.sent(),w="",v.response?w="Loading gltf failed with status "+v.response.status+".":v.request&&(w="No response to gltf download AJAX request."),
   [2,Promise.reject(Error(w))];case 3:return[2]}})})};b.prototype.log=function(){};b.prototype.warn=function(a){console.warn(a)};b.prototype.createDefaultMaterialForGLtfDef=function(){var a=new module$src$shared$materials$MaterialPropertiesStandard.default.MaterialPropertiesStandard;a.side=module$src$externals$three.default.DoubleSide;a.metalness=1;a.roughness=1;return a};b.prototype.createGeometries=function(a,b,d){var c={POSITION:"position",JOINTS_0:"joint",WEIGHTS_0:"weight",NORMAL:"normal",TEXCOORD_0:"uv",
   COLOR_0:"color",TANGENT:"tangent"},g={POSITION:!1,NORMAL:!1,TEXCOORD_0:!1,COLOR_0:!0,TANGENT:!1,JOINTS_0:!1,WEIGHTS_0:!1},h=[];b.mesh.primitives.forEach(function(a){var b=new module$src$externals$three.default.BufferGeometry,e=new module$src$externals$three.default.Box3;b.boundingSphere=e.getBoundingSphere();b.boundingSphere.realCenter=b.boundingSphere.center.clone();var f=a.attributes||{},n=null;a.hasOwnProperty("indices")&&(n=a.indices);var q=null;a=function(a){var e=d.find(function(b){return b.id==
   f[a]});if(e){var h=e.bufferView;h.isInterleaved?(null==q&&(q=new module$src$externals$three.default.InterleavedBuffer(h.interleavedBuffer,h.numOfTypeArrayElementsPerVertex)),b.addAttribute(c[a],new module$src$externals$three.default.InterleavedBufferAttribute(q,e.elementComponentsSize,e.offsetForInterleaved))):b.addAttribute(c[a],new module$src$externals$three.default.BufferAttribute(e.bufferArray,e.elementComponentsSize,g[a]))}};for(var p in f)a(p);null!=n&&(p=d.find(function(a){return a.id==n}),
   b.setIndex(p.array));h.push(b)});return h};b.prototype.createMaterials=function(a,b){var c=this,e=[],g={OPAQUE:THREE_BLENDING$$module$src$shared$singletons$GLTFLoader.NormalBlending,BLEND:THREE_BLENDING$$module$src$shared$singletons$GLTFLoader.AdditiveBlending,MASK:THREE_BLENDING$$module$src$shared$singletons$GLTFLoader.MultiplyBlending};a.materials.forEach(function(a){var d,h,l,m,n,q=c.createDefaultMaterialForGLtfDef(),p=(l=a.pbrMetallicRoughness,null!==l&&void 0!==l?l:{});if(p.doubleSided||a.doubleSided)q.side=
   module$src$externals$three.default.DoubleSide;else if(!1===p.doubleSided||!1===a.doubleSided)q.side=module$src$externals$three.default.FrontSide;p.hasOwnProperty("baseColorFactor")&&(l=p.baseColorFactor,q.color=new ((d=module$src$externals$three.default.Color).bind.apply(d,__spread$$module$src$shared$singletons$GLTFLoader([void 0],l))));p.hasOwnProperty("baseColorTexture")&&(q.map=b[p.baseColorTexture.index].texture);p.hasOwnProperty("metallicFactor")&&(q.metalness=p.metallicFactor);p.hasOwnProperty("roughnessFactor")&&
   (q.roughness=p.roughnessFactor);p.hasOwnProperty("metallicRoughnessTexture")&&(q.metalnessMap=b[p.metallicRoughnessTexture.index].texture,q.roughnessMap=b[p.metallicRoughnessTexture.index].texture);a.hasOwnProperty("normalTexture")&&(q.normalMap=b[a.normalTexture.index].texture);a.hasOwnProperty("alphaMode")?(q.blending=g[a.alphaMode],q.blending==THREE_BLENDING$$module$src$shared$singletons$GLTFLoader.MultiplyBlending&&(q.alphaTest=.5)):q.blending=module$src$externals$three.default.NoBlending;a.hasOwnProperty("alphaCutoff")&&
   (q.alphaTest=a.alphaCutoff);a.hasOwnProperty("extensions")&&a.extensions.hasOwnProperty("KHR_materials_pbrSpecularGlossiness")&&(d=new module$src$shared$materials$PbrMaterialConverter.default.PbrMaterialConverter,a=a.extensions.KHR_materials_pbrSpecularGlossiness,d=d.convertToMetallicRoughness({diffuseFactor:(m=a.diffuseFactor,null!==m&&void 0!==m?m:[1,1,1,1]),specularFactor:(n=a.specularFactor,null!==n&&void 0!==n?n:[1,1,1]),glosinessFactor:a.glossinessFactor||1}),q.color=new ((h=module$src$externals$three.default.Color).bind.apply(h,
   __spread$$module$src$shared$singletons$GLTFLoader([void 0],d.baseColor))),q.roughness=d.roughness,q.metalness=d.metallic,a.hasOwnProperty("baseColorTexture")&&(q.map=b[a.diffuseTexture.index].texture));e.push(q)});return e};b.prototype.processGltfAsync=function(a,b){return __awaiter$$module$src$shared$singletons$GLTFLoader(this,void 0,void 0,function(){var c,e,g,h,f,k,l,m=this;return __generator$$module$src$shared$singletons$GLTFLoader(this,function(d){switch(d.label){case 0:a.extensionsUsed&&a.extensionsUsed.forEach(function(a){SUPPORTED_EXTENSIONS$$module$src$shared$singletons$GLTFLoader.some(function(b){return b===
   a})||m.warn("Extension "+a+" not supported.")}),c=new module$src$shared$singletons$GLTFHelpers$SceneHierarchy.default.SceneHierarchy(a),e=[],g=[],h=[],d.label=1;case 1:d.trys.push([1,4,,5]);for(f in a.buffers)e.push(new module$src$shared$singletons$GLTFHelpers$GltfLoaderBuffer.default.GltfLoaderBuffer(Number.parseInt(f),a));return[4,Promise.all(e.map(function(a){return a.onLoad}))];case 2:d.sent();e.forEach(function(a){a.bufferViews.forEach(function(a){a.accessors.forEach(function(a){return h.push(a)})})});
   for(f in a.textures)g.push(new module$src$shared$singletons$GLTFHelpers$GltfLoaderTexture.default.GltfLoaderTexture(Number.parseInt(f),a,e));return[4,Promise.all(g.map(function(a){return a.onLoad}))];case 3:return d.sent(),k=[],c.allNodes.forEach(function(c){b&&Array.isArray(b)&&0!==b.length||(b=[new module$src$externals$three.default.Matrix4]);for(var d=function(d){if(c.mesh){var e=0;m.createGeometries(a,c,h).forEach(function(a){if(c.mesh&&0===c.materials.length){var f={path:"transformation_"+d+
   "."+c.name+"."+c.mesh.name+"."+e++,geometry:a,initialMatrix:c.matrix.clone().multiply(b[d]),type:"mesh"};k.push(f)}else c.mesh&&m.createMaterials(c,g).forEach(function(e){e={path:"transformation_"+d+"."+c.name+"."+c.mesh.name,geometry:a,material:e,initialMatrix:c.matrix.clone().multiply(b[d]),type:"mesh"};k.push(e)})})}},e=0;e<b.length;e++)d(e)}),[2,Promise.resolve(k)];case 4:return l=d.sent(),console.error(l),[2,Promise.reject(l)];case 5:return[2]}})})};b.prototype.removeLastDirectoryPartOf=function(a){a=
   a.split("/");a.pop();return a.join("/")};return b}();module$src$shared$singletons$GLTFLoader.default.GLTFLoaderInstance=new GLTFLoader$$module$src$shared$singletons$GLTFLoader;var module$src$3d$loaders$MTLLoader={default:{}},THREE$$module$src$3d$loaders$MTLLoader=module$src$externals$three.default;module$src$externals$three.default.MTLLoader=function(b){this.manager=void 0!==b?b:module$src$externals$three.default.DefaultLoadingManager};
   module$src$externals$three.default.MTLLoader.prototype={constructor:module$src$externals$three.default.MTLLoader,load:function(b,a,c,d){var e=this,g=new module$src$externals$three.default.FileLoader(this.manager);g.setPath(this.path);g.load(b,function(b){a(e.parse(b))},c,d)},setPath:function(b){this.path=b;return this},setTexturePath:function(b){this.texturePath=b;return this},setBaseUrl:function(b){console.warn("THREE.MTLLoader: .setBaseUrl() is deprecated. Use .setTexturePath( path ) for texture path or .setPath( path ) for general base path instead.");
   return this.setTexturePath(b)},setCrossOrigin:function(b){this.crossOrigin=b;return this},setMaterialOptions:function(b){this.materialOptions=b;return this},parse:function(b){var a=b.split("\n"),c={},d=/\s+/;b={};for(var e=0;e<a.length;e++){var g=a[e];g=g.trim();if(0!==g.length&&"#"!==g.charAt(0)){var h=g.indexOf(" "),f=0<=h?g.substring(0,h):g;f=f.toLowerCase();g=0<=h?g.substring(h+1):"";g=g.trim();"newmtl"===f?(c={name:g},b[g]=c):c&&("ka"===f||"kd"===f||"ks"===f?(g=g.split(d,3),c[f]=[parseFloat(g[0]),
   parseFloat(g[1]),parseFloat(g[2])]):c[f]=g)}}a=new module$src$externals$three.default.MTLLoader.MaterialCreator(this.texturePath||this.path,this.materialOptions);a.setCrossOrigin(this.crossOrigin);a.setManager(this.manager);a.setMaterials(b);return a}};
   module$src$externals$three.default.MTLLoader.MaterialCreator=function(b,a){this.baseUrl=b||"";this.options=a;this.materialsInfo={};this.materials={};this.materialsArray=[];this.nameLookup={};this.side=this.options&&this.options.side?this.options.side:module$src$externals$three.default.FrontSide;this.wrap=this.options&&this.options.wrap?this.options.wrap:module$src$externals$three.default.RepeatWrapping};
   module$src$externals$three.default.MTLLoader.MaterialCreator.prototype={constructor:module$src$externals$three.default.MTLLoader.MaterialCreator,crossOrigin:"anonymous",setCrossOrigin:function(b){this.crossOrigin=b;return this},setManager:function(b){this.manager=b},setMaterials:function(b){this.materialsInfo=this.convert(b);this.materials={};this.materialsArray=[];this.nameLookup={}},convert:function(b){if(!this.options)return b;var a={},c;for(c in b){var d=b[c],e={};a[c]=e;for(var g in d){var h=
   !0,f=d[g],k=g.toLowerCase();switch(k){case "kd":case "ka":case "ks":this.options&&this.options.normalizeRGB&&(f=[f[0]/255,f[1]/255,f[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===f[0]&&0===f[1]&&0===f[2]&&(h=!1)}h&&(e[k]=f)}}return a},preload:function(){for(var b in this.materialsInfo)this.create(b)},getIndex:function(b){return this.nameLookup[b]},getAsArray:function(){var b=0,a;for(a in this.materialsInfo)this.materialsArray[b]=this.create(a),this.nameLookup[a]=b,b++;return this.materialsArray},
   create:function(b){void 0===this.materials[b]&&this.createMaterial_(b);return this.materials[b]},createMaterial_:function(b){function a(a,b){return"string"!==typeof b||""===b?"":/^https?:\/\//i.test(b)?b:a+b}function c(b,c){if(!g[b]){c=d.getTextureParams(c,g);var e=d.loadTexture(a(d.baseUrl,c.url));e.repeat.copy(c.scale);e.offset.copy(c.offset);e.wrapS=d.wrap;e.wrapT=d.wrap;g[b]=e}}var d=this,e=this.materialsInfo[b],g={name:b,side:this.side},h;for(h in e){var f=e[h];if(""!==f)switch(h.toLowerCase()){case "kd":g.color=
   (new module$src$externals$three.default.Color).fromArray(f);break;case "ks":g.specular=(new module$src$externals$three.default.Color).fromArray(f);break;case "map_kd":c("map",f);break;case "map_ks":c("specularMap",f);break;case "norm":c("normalMap",f);break;case "map_bump":case "bump":c("bumpMap",f);break;case "ns":g.shininess=parseFloat(f);break;case "d":f=parseFloat(f);1>f&&(g.opacity=f,g.transparent=!0);break;case "tr":f=parseFloat(f),this.options&&this.options.invertTrProperty&&(f=1-f),0<f&&(g.opacity=
   1-f,g.transparent=!0)}}this.materials[b]=new module$src$externals$three.default.MeshPhongMaterial(g);return this.materials[b]},getTextureParams:function(b,a){var c={scale:new module$src$externals$three.default.Vector2(1,1),offset:new module$src$externals$three.default.Vector2(0,0)};b=b.split(/\s+/);var d=b.indexOf("-bm");0<=d&&(a.bumpScale=parseFloat(b[d+1]),b.splice(d,2));d=b.indexOf("-s");0<=d&&(c.scale.set(parseFloat(b[d+1]),parseFloat(b[d+2])),b.splice(d,4));d=b.indexOf("-o");0<=d&&(c.offset.set(parseFloat(b[d+
   1]),parseFloat(b[d+2])),b.splice(d,4));c.url=b.join(" ").trim();return c},loadTexture:function(b,a,c,d,e){var g=module$src$externals$three.default.Loader.Handlers.get(b),h=void 0!==this.manager?this.manager:module$src$externals$three.default.DefaultLoadingManager;null===g&&(g=new module$src$externals$three.default.TextureLoader(h));g.setCrossOrigin&&g.setCrossOrigin(this.crossOrigin);b=g.load(b,c,d,e);void 0!==a&&(b.mapping=a);return b}};var module$src$3d$loaders$OBJLoader={default:{}},THREE$$module$src$3d$loaders$OBJLoader=module$src$externals$three.default;
   module$src$externals$three.default.OBJLoader=function(){function b(){var a={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materialLibraries:[],startObject:function(a,b){if(this.object&&!1===this.object.fromDeclaration)this.object.name=a,this.object.fromDeclaration=!1!==b;else{var c=this.object&&"function"===typeof this.object.currentMaterial?this.object.currentMaterial():void 0;this.object&&"function"===typeof this.object._finalize&&this.object._finalize(!0);this.object={name:a||"",
   fromDeclaration:!1!==b,geometry:{vertices:[],normals:[],colors:[],uvs:[]},materials:[],smooth:!0,startMaterial:function(a,b){var c=this._finalize(!1);c&&(c.inherited||0>=c.groupCount)&&this.materials.splice(c.index,1);a={index:this.materials.length,name:a||"",mtllib:Array.isArray(b)&&0<b.length?b[b.length-1]:"",smooth:void 0!==c?c.smooth:this.smooth,groupStart:void 0!==c?c.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(a){a={index:"number"===typeof a?a:this.index,name:this.name,
   mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};a.clone=this.clone.bind(a);return a}};this.materials.push(a);return a},currentMaterial:function(){if(0<this.materials.length)return this.materials[this.materials.length-1]},_finalize:function(a){var b=this.currentMaterial();b&&-1===b.groupEnd&&(b.groupEnd=this.geometry.vertices.length/3,b.groupCount=b.groupEnd-b.groupStart,b.inherited=!1);if(a&&1<this.materials.length)for(var c=this.materials.length-1;0<=c;c--)0>=
   this.materials[c].groupCount&&this.materials.splice(c,1);a&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth});return b}};c&&c.name&&"function"===typeof c.clone&&(a=c.clone(0),a.inherited=!0,this.object.materials.push(a));this.objects.push(this.object)}},finalize:function(){this.object&&"function"===typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(a,b){a=parseInt(a,10);return 3*(0<=a?a-1:a+b/3)},parseNormalIndex:function(a,b){a=parseInt(a,
   10);return 3*(0<=a?a-1:a+b/3)},parseUVIndex:function(a,b){a=parseInt(a,10);return 2*(0<=a?a-1:a+b/2)},addVertex:function(a,b,c){var d=this.vertices,e=this.object.geometry.vertices;e.push(d[a+0],d[a+1],d[a+2]);e.push(d[b+0],d[b+1],d[b+2]);e.push(d[c+0],d[c+1],d[c+2])},addVertexPoint:function(a){var b=this.vertices;this.object.geometry.vertices.push(b[a+0],b[a+1],b[a+2])},addVertexLine:function(a){var b=this.vertices;this.object.geometry.vertices.push(b[a+0],b[a+1],b[a+2])},addNormal:function(a,b,c){var d=
   this.normals,e=this.object.geometry.normals;e.push(d[a+0],d[a+1],d[a+2]);e.push(d[b+0],d[b+1],d[b+2]);e.push(d[c+0],d[c+1],d[c+2])},addColor:function(a,b,c){var d=this.colors,e=this.object.geometry.colors;e.push(d[a+0],d[a+1],d[a+2]);e.push(d[b+0],d[b+1],d[b+2]);e.push(d[c+0],d[c+1],d[c+2])},addUV:function(a,b,c){var d=this.uvs,e=this.object.geometry.uvs;e.push(d[a+0],d[a+1]);e.push(d[b+0],d[b+1]);e.push(d[c+0],d[c+1])},addUVLine:function(a){var b=this.uvs;this.object.geometry.uvs.push(b[a+0],b[a+
   1])},addFace:function(a,b,c,d,e,g,q,p,u){var f=this.vertices.length;a=this.parseVertexIndex(a,f);b=this.parseVertexIndex(b,f);c=this.parseVertexIndex(c,f);this.addVertex(a,b,c);void 0!==d&&""!==d&&(c=this.uvs.length,a=this.parseUVIndex(d,c),b=this.parseUVIndex(e,c),c=this.parseUVIndex(g,c),this.addUV(a,b,c));void 0!==q&&""!==q&&(d=this.normals.length,a=this.parseNormalIndex(q,d),b=q===p?a:this.parseNormalIndex(p,d),c=q===u?a:this.parseNormalIndex(u,d),this.addNormal(a,b,c));0<this.colors.length&&
   this.addColor(a,b,c)},addPointGeometry:function(a){this.object.geometry.type="Points";for(var b=this.vertices.length,c=0,d=a.length;c<d;c++)this.addVertexPoint(this.parseVertexIndex(a[c],b))},addLineGeometry:function(a,b){this.object.geometry.type="Line";for(var c=this.vertices.length,d=this.uvs.length,e=0,f=a.length;e<f;e++)this.addVertexLine(this.parseVertexIndex(a[e],c));a=0;for(f=b.length;a<f;a++)this.addUVLine(this.parseUVIndex(b[a],d))}};a.startObject("",!1);return a}function a(a){this.manager=
   void 0!==a?a:module$src$externals$three.default.DefaultLoadingManager;this.materials=null}var c=/^[og]\s*(.+)?/,d=/^mtllib /,e=/^usemtl /;a.prototype={constructor:a,load:function(a,b,c,d){var e=this,f=new module$src$externals$three.default.FileLoader(e.manager);f.setPath(this.path);f.load(a,function(a){b(e.parse(a))},c,d)},setPath:function(a){this.path=a;return this},setMaterials:function(a){this.materials=a;return this},parse:function(a){console.time("OBJLoader");var g=new b;-1!==a.indexOf("\r\n")&&
   (a=a.replace(/\r\n/g,"\n"));-1!==a.indexOf("\\\n")&&(a=a.replace(/\\\n/g,""));var f=a.split("\n"),k,l="function"===typeof"".trimLeft;a=0;for(var m=f.length;a<m;a++){var n=f[a];n=l?n.trimLeft():n.trim();var q=n.length;if(0!==q&&(q=n.charAt(0),"#"!==q))if("v"===q)switch(n=n.split(/\s+/),n[0]){case "v":g.vertices.push(parseFloat(n[1]),parseFloat(n[2]),parseFloat(n[3]));8===n.length&&g.colors.push(parseFloat(n[4]),parseFloat(n[5]),parseFloat(n[6]));break;case "vn":g.normals.push(parseFloat(n[1]),parseFloat(n[2]),
   parseFloat(n[3]));break;case "vt":g.uvs.push(parseFloat(n[1]),parseFloat(n[2]))}else if("f"===q){n=n.substr(1).trim();var p=n.split(/\s+/);n=[];q=0;for(k=p.length;q<k;q++){var u=p[q];0<u.length&&(u=u.split("/"),n.push(u))}p=n[0];q=1;for(k=n.length-1;q<k;q++){u=n[q];var t=n[q+1];g.addFace(p[0],u[0],t[0],p[1],u[1],t[1],p[2],u[2],t[2])}}else if("l"===q){q=n.substring(1).trim().split(" ");k=[];p=[];if(-1===n.indexOf("/"))k=q;else for(n=0,u=q.length;n<u;n++)t=q[n].split("/"),""!==t[0]&&k.push(t[0]),""!==
   t[1]&&p.push(t[1]);g.addLineGeometry(k,p)}else if("p"===q)n=n.substr(1).trim(),n=n.split(" "),g.addPointGeometry(n);else if(null!==(k=c.exec(n)))n=(" "+k[0].substr(1).trim()).substr(1),g.startObject(n);else if(e.test(n))g.object.startMaterial(n.substring(7).trim(),g.materialLibraries);else if(d.test(n))g.materialLibraries.push(n.substring(7).trim());else if("s"===q){if(k=n.split(" "),1<k.length?(n=k[1].trim().toLowerCase(),g.object.smooth="0"!==n&&"off"!==n):g.object.smooth=!0,n=g.object.currentMaterial())n.smooth=
   g.object.smooth}else if("\x00"!==n)throw Error('THREE.OBJLoader: Unexpected line: "'+n+'"');}g.finalize();f=new module$src$externals$three.default.Group;f.materialLibraries=[].concat(g.materialLibraries);a=0;for(m=g.objects.length;a<m;a++)if(l=g.objects[a],n=l.geometry,q=l.materials,k="Line"===n.type,p="Points"===n.type,u=!1,0!==n.vertices.length){t=new module$src$externals$three.default.BufferGeometry;t.addAttribute("position",new module$src$externals$three.default.Float32BufferAttribute(n.vertices,
   3));0<n.normals.length?t.addAttribute("normal",new module$src$externals$three.default.Float32BufferAttribute(n.normals,3)):t.computeVertexNormals();0<n.colors.length&&(u=!0,t.addAttribute("color",new module$src$externals$three.default.Float32BufferAttribute(n.colors,3)));0<n.uvs.length&&t.addAttribute("uv",new module$src$externals$three.default.Float32BufferAttribute(n.uvs,2));for(var r=[],v=0,w=q.length;v<w;v++){var y=q[v];n=void 0;if(null!==this.materials)if(n=this.materials.create(y.name),k&&n&&
   !(n instanceof module$src$externals$three.default.LineBasicMaterial)){var x=new module$src$externals$three.default.LineBasicMaterial;x.copy(n);x.lights=!1;n=x}else if(p&&n&&!(n instanceof module$src$externals$three.default.PointsMaterial)){var A=new module$src$externals$three.default.PointsMaterial({size:10,sizeAttenuation:!1});x.copy(n);n=A}n||(n=k?new module$src$externals$three.default.LineBasicMaterial:p?new module$src$externals$three.default.PointsMaterial({size:1,sizeAttenuation:!1}):new module$src$externals$three.default.MeshPhongMaterial,
   n.name=y.name);!1===n.flatShading&&(n.flatShading=y.smooth?!1:!0);n.vertexColors=u?module$src$externals$three.default.VertexColors:module$src$externals$three.default.NoColors;r.push(n)}if(1<r.length){v=0;for(w=q.length;v<w;v++)y=q[v],t.addGroup(y.groupStart,y.groupCount,v);n=k?new module$src$externals$three.default.LineSegments(t,r):p?new module$src$externals$three.default.Points(t,r):new module$src$externals$three.default.Mesh(t,r)}else n=k?new module$src$externals$three.default.LineSegments(t,r[0]):
   p?new module$src$externals$three.default.Points(t,r[0]):new module$src$externals$three.default.Mesh(t,r[0]);n.name=l.name;f.add(n)}console.timeEnd("OBJLoader");return f}};return a}();var module$src$3d$loaders$DDSLoader={default:{}},THREE$$module$src$3d$loaders$DDSLoader=module$src$externals$three.default;module$src$externals$three.default.DDSLoader=function(b){module$src$externals$three.default.CompressedTextureLoader.call(this,b);this._parser=module$src$externals$three.default.DDSLoader.parse};module$src$externals$three.default.DDSLoader.prototype=Object.create(module$src$externals$three.default.CompressedTextureLoader.prototype);
   module$src$externals$three.default.DDSLoader.prototype.constructor=module$src$externals$three.default.DDSLoader;
   module$src$externals$three.default.DDSLoader.parse=function(b,a){function c(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}function d(a,b,c,d){var e=c*d*4;a=new Uint8Array(a,b,e);e=new Uint8Array(e);for(var f=b=0,g=0;g<d;g++)for(var h=0;h<c;h++){var k=a[f];f++;var l=a[f];f++;var m=a[f];f++;var n=a[f];f++;e[b]=m;b++;e[b]=l;b++;e[b]=k;b++;e[b]=n;b++}return e}var e={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},g=c("DXT1"),h=c("DXT3"),f=c("DXT5"),
   k=c("ETC1"),l=new Int32Array(b,0,31);if(542327876!==l[0])return console.error("THREE.DDSLoader.parse: Invalid magic number in DDS header."),e;if(!l[20]&4)return console.error("THREE.DDSLoader.parse: Unsupported format, must contain a FourCC code."),e;var m=l[21],n=!1;switch(m){case g:g=8;e.format=module$src$externals$three.default.RGB_S3TC_DXT1_Format;break;case h:g=16;e.format=module$src$externals$three.default.RGBA_S3TC_DXT3_Format;break;case f:g=16;e.format=module$src$externals$three.default.RGBA_S3TC_DXT5_Format;
   break;case k:g=8;e.format=module$src$externals$three.default.RGB_ETC1_Format;break;default:if(32===l[22]&&l[23]&16711680&&l[24]&65280&&l[25]&255&&l[26]&4278190080)n=!0,g=64,e.format=module$src$externals$three.default.RGBAFormat;else return console.error("THREE.DDSLoader.parse: Unsupported FourCC code ",String.fromCharCode(m&255,m>>8&255,m>>16&255,m>>24&255)),e}e.mipmapCount=1;l[2]&131072&&!1!==a&&(e.mipmapCount=Math.max(1,l[7]));a=l[28];e.isCubemap=a&512?!0:!1;if(e.isCubemap&&!(a&1024&&a&2048&&a&
   4096&&a&8192&&a&16384&&a&32768))return console.error("THREE.DDSLoader.parse: Incomplete cubemap faces"),e;e.width=l[4];e.height=l[3];l=l[1]+4;a=e.isCubemap?6:1;for(h=0;h<a;h++)for(f=e.width,k=e.height,m=0;m<e.mipmapCount;m++){if(n)var q=d(b,l,f,k),p=q.length;else p=Math.max(4,f)/4*Math.max(4,k)/4*g,q=new Uint8Array(b,l,p);e.mipmaps.push({data:q,width:f,height:k});l+=p;f=Math.max(f>>1,1);k=Math.max(k>>1,1)}return e};var module$src$shared$singletons$OBJLoader={},THREE$$module$src$shared$singletons$OBJLoader=module$src$externals$three.default,MaterialPropertiesStandard$$module$src$shared$singletons$OBJLoader=module$src$shared$materials$MaterialPropertiesStandard.default.MaterialPropertiesStandard,OBJLoader$$module$src$shared$singletons$OBJLoader=function(){this.log=function(){};this.warn=function(){};this.error=function(){};module$src$externals$three.default.Loader.Handlers.add(/\.dds$/i,new module$src$externals$three.default.DDSLoader);
   this.loadGeometry=function(b,a,c,d,e,g){var h=function(){var b=new module$src$externals$three.default.LoadingManager,g=new module$src$externals$three.default.MTLLoader(b);g.setCrossOrigin(!0);null!=c&&g.setPath(c);null!=d&&g.setTexturePath(d);var h=module$src$externals$three.default.DoubleSide;"front"===e?h=module$src$externals$three.default.FrontSide:"back"===e&&(h=module$src$externals$three.default.BackSide);var n={};n.wrap=module$src$externals$three.default.ClampToEdgeWrapping;n.side=h;g.setMaterialOptions(n);
   return new Promise(function(){var c=null;b.onLoad=function(){return c.hasOwnProperty("materialsInfo")&&0<Object.keys(c.materialsInfo).length?f(c):f()};g.load(a,function(a){a.preload();c=a},function(){},function(){f()})})},f=function(a){return new Promise(function(d,e){var f=new module$src$externals$three.default.OBJLoader;null!=a&&f.setMaterials(a);null!=c&&f.setPath(c);f.load(b,function(b){Array.isArray(g)&&0!=g.length&&g.every(function(a){return a&&a.isMatrix4})||(g=[new module$src$externals$three.default.Matrix4]);
   var c=[];b.traverse(function(b){if(null!=b.geometry){var d=!1;b.geometry instanceof module$src$externals$three.default.BufferGeometry?b.geometry.hasOwnProperty("attributes")&&b.geometry.attributes.hasOwnProperty("uv")&&(d=!0):b.geometry instanceof module$src$externals$three.default.Geometry&&0<b.geometry.faceVertexUvs.length&&(d=!0);var e=null;if(null!=a&&b.hasOwnProperty("material")){e=new module$src$shared$materials$MaterialPropertiesStandard.default.MaterialPropertiesStandard;e.side=b.material.side;
   e.color=b.material.color;e.opacity=b.material.opacity;e.transparent=b.material.transparent;b.material.hasOwnProperty("shininess")&&(e.metalness=Math.min(1,b.material.shininess),e.roughness=1-Math.min(1,b.material.shininess));if(null!=b.material.map){var f=b.material.map.clone();f.needsUpdate=!0;e.map=f}["alpha","normal","bump"].forEach(function(a){if(null!=b.material[a+"Map"]){var c=b.material[a+"Map"].clone();c.needsUpdate=!0;e[a+"Map"]=c}})}f=0;for(var h=$jscomp.makeIterator(g),k=h.next();!k.done;k=
   h.next())k={path:"transformation_"+f,geometry:b.geometry,texCoord:d,initialMatrix:k.value,type:"mesh"},null!=e&&(k.material=e),c.push(k),++f}});d(c)},function(){},function(a){e(a)})})};return null!=a&&0<a.length?h:f()}};module$src$shared$singletons$OBJLoader.default=new OBJLoader$$module$src$shared$singletons$OBJLoader;var module$src$shared$singletons$THREELoader={},THREE$$module$src$shared$singletons$THREELoader=module$src$externals$three.default,THREELoader$$module$src$shared$singletons$THREELoader=function(){this.loadGeometry=function(b,a){var c=[];if(b.isMesh)var d="mesh";else if(b.isLineLoop)d="lineloop";else if(b.isLineSegments)d="linesegments";else if(b.isLine)d="line";else if(b.isPoints)d="points";else return Promise.reject(Error("Unsupported type of THREE.Object3D"));Array.isArray(a)&&0!=a.length&&a.every(function(a){return a&&
   a.isMatrix4})||(a=[new module$src$externals$three.default.Matrix4]);var e=b.geometry;"Geometry"===b.geometry.type&&(e=(new module$src$externals$three.default.Geometry).copy(b.geometry));"BufferGeometry"===b.geometry.type&&(e=(new module$src$externals$three.default.BufferGeometry).copy(b.geometry));b=0;a=$jscomp.makeIterator(a);for(var g=a.next();!g.done;g=a.next())c.push({path:"transformation_"+b,geometry:e,texCoord:!1,initialMatrix:g.value,type:d}),++b;return Promise.resolve(c)}};
   module$src$shared$singletons$THREELoader.default=new THREELoader$$module$src$shared$singletons$THREELoader;var module$src$shared$singletons$Tag3DLoader={default:{}},THREE$$module$src$shared$singletons$Tag3DLoader=module$src$externals$three.default,toTinyColor$$module$src$shared$singletons$Tag3DLoader=module$src$shared$util$toTinyColor.default,_font3d$$module$src$shared$singletons$Tag3DLoader=null;
   module$src$shared$singletons$Tag3DLoader.default.load3DTags=function(b){return(new Promise(function(a){null==_font3d$$module$src$shared$singletons$Tag3DLoader?(new module$src$externals$three.default.FontLoader).load("https://viewer.shapediver.com/graphik_regular.typeface.json",function(b){_font3d$$module$src$shared$singletons$Tag3DLoader=b;a()}.bind(this)):a()})).then(function(){var a=[],c={},d;for(d in b){var e=b[d];e=e||{};e.size=e.size||1;e.text=e.text||"";for(var g={size:e.size,height:e.size/
   10,font:_font3d$$module$src$shared$singletons$Tag3DLoader},h=e.text.split(/\r\n|\r|\n/g),f="tag3d_"+d,k=[],l=0;l<h.length;++l){var m=f+".line_"+l;g.justification=e.justification;var n=new module$src$externals$three.default.TextBufferGeometry(h[l],g);m={path:m,geometry:n,texCoord:!1,type:"mesh"};"default"!=e.color&&(m.color=(0,module$src$shared$util$toTinyColor.default)(e.color));k.push(m)}g=new module$src$externals$three.default.Object3D;f=$jscomp.makeIterator(k);for(h=f.next();!h.done;h=f.next())g.add(new module$src$externals$three.default.Mesh(h.value.geometry,
   new module$src$externals$three.default.MeshPhongMaterial));f=h=f=void 0;c.lineHeight=void 0;c.lineHeight=0;h=$jscomp.makeIterator(g.children);for(f=h.next();!f.done;f=h.next())f=f.value,f=(new module$src$externals$three.default.Box3).setFromObject(f),f=f.max.y-f.min.y,c.lineHeight=Math.max(c.lineHeight,f);c.lineHeight*=1.15;k.forEach(function(a){return function(b,c){b.geometry.translate(0,(-c-1)*a.lineHeight,0)}}(c));f=(new module$src$externals$three.default.Box3).setFromObject(g);h=f.max.x-f.min.x;
   f=f.max.y-f.min.y;g=new module$src$externals$three.default.Vector3(0,0,0);switch(e.justification){case "TC":g.x=.5*-h;break;case "TR":g.x=-h;break;case "ML":g.y=.5*f;break;case "MC":g.x=.5*-h;g.y=.5*f;break;case "MR":g.x=-h;g.y=.5*f;break;case "BL":g.y=f;break;case "BC":g.x=.5*-h;g.y=f;break;case "BR":g.x=-h,g.y=f}f=$jscomp.makeIterator(k);for(h=f.next();!h.done;h=f.next())h.value.geometry.translate(g.x,g.y,g.z);if(e.location.hasOwnProperty("xAxis"))for(g=new module$src$externals$three.default.Matrix4,
   g.set(e.location.xAxis.X,e.location.yAxis.X,e.location.normal.X,0,e.location.xAxis.Y,e.location.yAxis.Y,e.location.normal.Y,0,e.location.xAxis.Z,e.location.yAxis.Z,e.location.normal.Z,0,0,0,0,1),f=$jscomp.makeIterator(k),h=f.next();!h.done;h=f.next())h=h.value,h.geometry.applyMatrix(g),h.geometry.translate(e.location.origin.X,e.location.origin.Y,e.location.origin.Z);Array.prototype.push.apply(a,k);c={lineHeight:c.lineHeight}}return a})};var module$src$shared$materials$MaterialPresetsDbFallback={default:{}};module$src$shared$materials$MaterialPresetsDbFallback.default["00"]={"00":{name:"Default material",color:[211,211,211,255],metalness:0,roughness:1},properties:{name:"Default materials"}};module$src$shared$materials$MaterialPresetsDbFallback.default["01"]={"01":{name:"Default groundplane material",color:[211,211,211,255],metalness:0,roughness:1},properties:{name:"Groundplane materials"}};
   module$src$shared$materials$MaterialPresetsDbFallback.default["02"]={"00":{name:"Default plastic material",color:[211,211,211,255],metalness:0,roughness:1,normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},properties:{name:"Plastic materials"}};
   module$src$shared$materials$MaterialPresetsDbFallback.default["03"]={10:{name:"Gold material",color:[230,207,92,255],roughness:0},11:{name:"Used gold material",color:[230,207,92,255],roughness:0,roughnesstexture:"roughnessMap.jpg"},21:{name:"Hammered metal material",color:[205,205,205,255],roughness:1,normaltexture:"normalMap.jpg"},"00":{name:"Default metal material",color:[205,205,205,255],roughness:.25},"01":{name:"Used metal material 1",color:[205,205,205,255],roughness:1,roughnesstexture:"roughnessMap.jpg"},
   "02":{name:"Used metal material 2",color:[205,205,205,255],roughness:1,roughnesstexture:"roughnessMap.jpg"},"03":{name:"Used metal material 3",color:[205,205,205,255],roughness:1,roughnesstexture:"roughnessMap.jpg"},properties:{name:"Metal materials",metalness:1}};module$src$shared$materials$MaterialPresetsDbFallback.default["04"]={"00":{name:"Default glass material",color:[211,211,211,255],metalness:1,roughness:0,transparency:.75},properties:{name:"Glass materials"}};
   module$src$shared$materials$MaterialPresetsDbFallback.default["05"]={10:{bitmaptexture:"map.jpg",name:"Natural oak material",normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},11:{bitmaptexture:"map.jpg",name:"Premium oak material",roughnesstexture:"roughnessMap.jpg"},"00":{bitmaptexture:"map.jpg",name:"Default wood material",metalnesstexture:"metalnessMap.jpg",normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},"01":{bitmaptexture:"map.jpg",name:"Wood floor material",
   metalnesstexture:"metalnessMap.jpg",normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},properties:{name:"Wood materials",color:[211,211,211,255],metalness:0,roughness:1}};
   module$src$shared$materials$MaterialPresetsDbFallback.default["06"]={10:{bitmaptexture:"map.jpg",name:"Worn leather material",metalnesstexture:"metalnessMap.jpg",normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},"00":{bitmaptexture:"map.jpg",name:"Default leather material",metalnesstexture:"metalnessMap.jpg",normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},"01":{bitmaptexture:"map.jpg",name:"Dark brown leather material",metalnesstexture:"metalnessMap.jpg",normaltexture:"normalMap.jpg",
   roughnesstexture:"roughnessMap.jpg"},"02":{bitmaptexture:"map.jpg",name:"Black leather material",metalnesstexture:"metalnessMap.jpg",normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},properties:{name:"Leather materials",metalness:0,roughness:1}};
   module$src$shared$materials$MaterialPresetsDbFallback.default["07"]={"00":{bitmaptexture:"map.jpg",name:"Default fabric material",metalnesstexture:"metalnessMap.jpg",normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},"01":{bitmaptexture:"map.jpg",name:"Grey fabric material",metalnesstexture:"metalnessMap.jpg",normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},properties:{name:"Fabric materials",metalness:1,roughness:1}};var module$src$shared$materials$MaterialPresets={default:{}},__awaiter$$module$src$shared$materials$MaterialPresets=this&&module$src$shared$materials$MaterialPresets.default.__awaiter||function(b,a,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,h){function f(a){try{l(d.next(a))}catch(n){h(n)}}function g(a){try{l(d["throw"](a))}catch(n){h(n)}}function l(a){a.done?c(a.value):e(a.value).then(f,g)}l((d=d.apply(b,a||[])).next())})},__generator$$module$src$shared$materials$MaterialPresets=
   this&&module$src$shared$materials$MaterialPresets.default.__generator||function(b,a){function c(a){return function(b){return d([a,b])}}function d(c){if(g)throw new TypeError("Generator is already executing.");for(;e;)try{if(g=1,h&&(f=c[0]&2?h["return"]:c[0]?h["throw"]||((f=h["return"])&&f.call(h),0):h.next)&&!(f=f.call(h,c[1])).done)return f;if(h=0,f)c=[c[0]&2,f.value];switch(c[0]){case 0:case 1:f=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++;h=c[1];c=[0];continue;case 7:c=
   e.ops.pop();e.trys.pop();continue;default:if(!(f=e.trys,f=0<f.length&&f[f.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!f||c[1]>f[0]&&c[1]<f[3]))e.label=c[1];else if(6===c[0]&&e.label<f[1])e.label=f[1],f=c;else if(f&&e.label<f[2])e.label=f[2],e.ops.push(c);else{f[2]&&e.ops.pop();e.trys.pop();continue}}c=a.call(b,e)}catch(m){c=[6,m],h=0}finally{g=f=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],
   ops:[]},g,h,f,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k},__importDefault$$module$src$shared$materials$MaterialPresets=this&&module$src$shared$materials$MaterialPresets.default.__importDefault||function(b){return b&&b.__esModule?b:{"default":b}};Object.defineProperty(module$src$shared$materials$MaterialPresets.default,"__esModule",{value:!0});
   var GlobalUtils_1$$module$src$shared$materials$MaterialPresets=__importDefault$$module$src$shared$materials$MaterialPresets(module$src$shared$util$GlobalUtils.default),ViewerAppConstants_1$$module$src$shared$materials$MaterialPresets=__importDefault$$module$src$shared$materials$MaterialPresets(module$src$app$ViewerAppConstants.default),TEXTURE_PATH$$module$src$shared$materials$MaterialPresets="https://viewer.shapediver.com/v2/materials/",MATERIAL_PRESETS_URL$$module$src$shared$materials$MaterialPresets=
   "https://viewer.shapediver.com/v2/materials/db.json",MaterialPresetsDbFallback_1$$module$src$shared$materials$MaterialPresets=__importDefault$$module$src$shared$materials$MaterialPresets(module$src$shared$materials$MaterialPresetsDbFallback.default),HttpClient_1$$module$src$shared$materials$MaterialPresets=module$src$modules$http_client$HttpClient.default,RESOLUTIONS$$module$src$shared$materials$MaterialPresets=["256","512","1024","2048"],DEFAULTRESOLUTION$$module$src$shared$materials$MaterialPresets=
   "1024",MaterialPresets$$module$src$shared$materials$MaterialPresets=function(){function b(){var a=this;this._materials={};this._materialsPromise=module$src$modules$http_client$HttpClient.default.HttpClientInstance.getCacheAsync(MATERIAL_PRESETS_URL$$module$src$shared$materials$MaterialPresets).then(function(b){a.parseMaterialDatabase(b.data)},function(){return a.parseMaterialDatabase(MaterialPresetsDbFallback_1$$module$src$shared$materials$MaterialPresets.default)})}b.prototype.fromId=function(a){return __awaiter$$module$src$shared$materials$MaterialPresets(this,
   void 0,void 0,function(){var b=this;return __generator$$module$src$shared$materials$MaterialPresets(this,function(c){return[2,new Promise(function(c,d){b._materialsPromise.then(function(){var d;if("string"===typeof a){var e=a.split("@");a=e[0];1<e.length&&(d=e[1])}RESOLUTIONS$$module$src$shared$materials$MaterialPresets.includes(d)||(d=DEFAULTRESOLUTION$$module$src$shared$materials$MaterialPresets);a=Number(a);100>a&&0==a%10&&(a/=10);10>a&&(a*=100);e=Math.floor(a/100);var g=a-100*e;b.hasMaterial(e,
   g)?c(b.getMaterial(e,g,d)):b.hasMaterial(e,0)?c(b.getMaterial(e,0,d)):b.hasMaterial(0,0)?c(b.getMaterial(0,0,d)):c(ViewerAppConstants_1$$module$src$shared$materials$MaterialPresets.default.defaultSettings.defaultMaterial)},function(a){return d(a)})})]})})};b.prototype.getMaterial=function(a,b,d){a=this.castId(a);b=this.castId(b);d=d||DEFAULTRESOLUTION$$module$src$shared$materials$MaterialPresets;var c=GlobalUtils_1$$module$src$shared$materials$MaterialPresets.default.deepCopy(this._materials[a][b].mat),
   g=TEXTURE_PATH$$module$src$shared$materials$MaterialPresets+d+"/"+a+"/"+b+"/";"bitmap metalness roughness bump normal transparency".split(" ").forEach(function(a){a+="texture";c.hasOwnProperty(a)&&(c[a]=g+c[a])});return c};b.prototype.hasMaterial=function(a,b){a=this.castId(a);b=this.castId(b);return this._materials.hasOwnProperty(a)&&this._materials[a].hasOwnProperty(b)?!0:!1};b.prototype.addMaterial=function(a,b,d,e){a=this.castId(a);b=this.castId(b);var c={version:null,name:null};Object.keys(d.properties).forEach(function(a){return c[a]=
   d.properties[a]});Object.keys(e).forEach(function(a){return c[a]=e[a]});c.version=c.version||"2.0";this._materials.hasOwnProperty(a)||(this._materials[a]={});this._materials[a][b]={name:c.name,mat:c}};b.prototype.castId=function(a){"string"!==typeof a&&(a=String(a));return a.padStart(2,"0").slice(0,2)};b.prototype.parseMaterialDatabase=function(a){var b=this,d=/^\d+$/;Object.keys(a).forEach(function(c){Object.keys(a[c]).forEach(function(e){d.test(c)&&d.test(e)&&b.addMaterial(c,e,a[c],a[c][e])})})};
   return b}();module$src$shared$materials$MaterialPresets.default.MaterialPresetsInstance=new MaterialPresets$$module$src$shared$materials$MaterialPresets;var module$src$shared$materials$MaterialPropertiesGem={},toTinyColor$$module$src$shared$materials$MaterialPropertiesGem=module$src$shared$util$toTinyColor.default;
   module$src$shared$materials$MaterialPropertiesGem.default=function(){var b=this;b.materialType="gem";b.colorTransferBegin=(0,module$src$shared$util$toTinyColor.default)("ffffffff").toThreeColor();b.colorTransferEnd=(0,module$src$shared$util$toTinyColor.default)("ffffffff").toThreeColor();b.environmentMap=null;b.impurityMap=null;b.impurityScale=1;b.opacity=1;b.tracingOpacity=1;b.depth=8;b.refractionIndex=2.4;b.dispersion=0;b.gamma=1;b.contrast=1;b.brightness=0;b.resolution=1024;b.clone=function(){var a=
   new module$src$shared$materials$MaterialPropertiesGem.default;a.materialType="gem";a.colorTransferBegin=b.colorTransferBegin;a.colorTransferEnd=b.colorTransferEnd;a.environmentMap=b.environmentMap;a.impurityMap=b.impurityMap;a.impurityScale=b.impurityScale;a.opacity=b.opacity;a.tracingOpacity=b.tracingOpacity;a.depth=b.depth;a.refractionIndex=b.refractionIndex;a.dispersion=b.dispersion;a.gamma=b.gamma;a.contrast=b.contrast;a.brightness=b.brightness;a.resolution=b.resolution;return a}};var module$src$shared$materials$MaterialParser={default:{}},__extends$$module$src$shared$materials$MaterialParser=this&&module$src$shared$materials$MaterialParser.default.__extends||function(){var b=function(a,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return b(a,c)};return function(a,c){function d(){this.constructor=a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,
   new d)}}(),__awaiter$$module$src$shared$materials$MaterialParser=this&&module$src$shared$materials$MaterialParser.default.__awaiter||function(b,a,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,h){function f(a){try{l(d.next(a))}catch(n){h(n)}}function g(a){try{l(d["throw"](a))}catch(n){h(n)}}function l(a){a.done?c(a.value):e(a.value).then(f,g)}l((d=d.apply(b,a||[])).next())})},__generator$$module$src$shared$materials$MaterialParser=this&&
   module$src$shared$materials$MaterialParser.default.__generator||function(b,a){function c(a){return function(b){return d([a,b])}}function d(c){if(g)throw new TypeError("Generator is already executing.");for(;e;)try{if(g=1,h&&(f=c[0]&2?h["return"]:c[0]?h["throw"]||((f=h["return"])&&f.call(h),0):h.next)&&!(f=f.call(h,c[1])).done)return f;if(h=0,f)c=[c[0]&2,f.value];switch(c[0]){case 0:case 1:f=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++;h=c[1];c=[0];continue;case 7:c=e.ops.pop();
   e.trys.pop();continue;default:if(!(f=e.trys,f=0<f.length&&f[f.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!f||c[1]>f[0]&&c[1]<f[3]))e.label=c[1];else if(6===c[0]&&e.label<f[1])e.label=f[1],f=c;else if(f&&e.label<f[2])e.label=f[2],e.ops.push(c);else{f[2]&&e.ops.pop();e.trys.pop();continue}}c=a.call(b,e)}catch(m){c=[6,m],h=0}finally{g=f=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},g,h,
   f,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k},__values$$module$src$shared$materials$MaterialParser=this&&module$src$shared$materials$MaterialParser.default.__values||function(b){var a="function"===typeof Symbol&&Symbol.iterator,c=a&&b[a],d=0;if(c)return c.call(b);if(b&&"number"===typeof b.length)return{next:function(){b&&d>=b.length&&(b=void 0);return{value:b&&b[d++],done:!b}}};throw new TypeError(a?"Object is not iterable.":
   "Symbol.iterator is not defined.");},__importStar$$module$src$shared$materials$MaterialParser=this&&module$src$shared$materials$MaterialParser.default.__importStar||function(b){if(b&&b.__esModule)return b;var a={};if(null!=b)for(var c in b)Object.hasOwnProperty.call(b,c)&&(a[c]=b[c]);a["default"]=b;return a},__importDefault$$module$src$shared$materials$MaterialParser=this&&module$src$shared$materials$MaterialParser.default.__importDefault||function(b){return b&&b.__esModule?b:{"default":b}};
   Object.defineProperty(module$src$shared$materials$MaterialParser.default,"__esModule",{value:!0});
   var THREE$$module$src$shared$materials$MaterialParser=__importStar$$module$src$shared$materials$MaterialParser(module$src$externals$three.default),MaterialPresets_1$$module$src$shared$materials$MaterialParser=module$src$shared$materials$MaterialPresets.default,toTinyColor_1$$module$src$shared$materials$MaterialParser=__importDefault$$module$src$shared$materials$MaterialParser(module$src$shared$util$toTinyColor.default),TextureLoader_1$$module$src$shared$materials$MaterialParser=__importDefault$$module$src$shared$materials$MaterialParser(module$src$shared$singletons$TextureLoader.default),
   loadTexture$$module$src$shared$materials$MaterialParser=TextureLoader_1$$module$src$shared$materials$MaterialParser.default.loadTexture,GlobalUtils_1$$module$src$shared$materials$MaterialParser=__importDefault$$module$src$shared$materials$MaterialParser(module$src$shared$util$GlobalUtils.default),MaterialPropertiesStandard_1$$module$src$shared$materials$MaterialParser=module$src$shared$materials$MaterialPropertiesStandard.default,MaterialPropertiesGem_1$$module$src$shared$materials$MaterialParser=
   __importDefault$$module$src$shared$materials$MaterialParser(module$src$shared$materials$MaterialPropertiesGem.default),LoadCubeTextureFromJSONError$$module$src$shared$materials$MaterialParser=function(b){function a(a){void 0===a&&(a="Input object is not a valid JSON cube texture definition.");return b.call(this,a)||this}__extends$$module$src$shared$materials$MaterialParser(a,b);return a}(Error);
   module$src$shared$materials$MaterialParser.default.MaterialParser=function(){function b(a){this._materialPresets=module$src$shared$materials$MaterialPresets.default.MaterialPresetsInstance;this.requestHeaders=a}b.prototype.fromJSONMaterialObject=function(a){var b=this,d="standard";a.hasOwnProperty("materialType")&&(d=a.materialType);return"gem"===d?(a.hasOwnProperty("version")||(a.version="1.0"),this.processGemMaterial(a)):a.hasOwnProperty("version")?a.hasOwnProperty("materialpreset")?new Promise(function(c,
   d){b._materialPresets.fromId(a.materialpreset).then(function(d){d=GlobalUtils_1$$module$src$shared$materials$MaterialParser.default.deepCopy(d);!a.hasOwnProperty("color")||255===parseInt(a.color[0])&&255===parseInt(a.color[1])&&255===parseInt(a.color[2])||(d.color=a.color);a.hasOwnProperty("bitmaptexture")&&(d.bitmaptexture=a.bitmaptexture);a.hasOwnProperty("bumptexture")&&(d.bumptexture=a.bumptexture);c(b.processStandardMaterial(d,"2.0"))},function(a){return d(a)})}):this.processStandardMaterial(a,
   a.version):Promise.reject(Error("Material definition did not have version number defined"))};b.prototype.loadCubeTextureFromJSON=function(a){return __awaiter$$module$src$shared$materials$MaterialParser(this,void 0,void 0,function(){var c,d,e,g;return __generator$$module$src$shared$materials$MaterialParser(this,function(h){if(void 0===a)return[2,Promise.reject(new LoadCubeTextureFromJSONError$$module$src$shared$materials$MaterialParser)];if("string"===typeof a||Array.isArray(a))a={href:a};d="px nx pz nz py ny".split(" ");
   if(GlobalUtils_1$$module$src$shared$materials$MaterialParser.default.typeCheck(a.href,"string")&&a.href.startsWith('["https')&&a.href.endsWith('"]')){e=a.href;try{a.href=JSON.parse(e)}catch(f){a.href=e}}if(Array.isArray(a.href)&&(c=a.href,6!==c.length))return[2,Promise.reject(new LoadCubeTextureFromJSONError$$module$src$shared$materials$MaterialParser)];if(void 0===c)if(c=[],g=void 0,a.href.startsWith("https://")||a.href.startsWith("http://"))for(a.href.endsWith("/")||(a.href+="/"),g=0;g<d.length;g++)c.push(a.href+
   d[g]+".jpg");else return[2,Promise.reject(Error())];return[2,new Promise(function(a,d){return b.cubeTextureLoader.load(c,function(b){return a(b)},null,function(){return d(new LoadCubeTextureFromJSONError$$module$src$shared$materials$MaterialParser)})})]})})};b.prototype.loadTextureFromJSON=function(a){"string"===typeof a&&(a={href:a});if(!a.hasOwnProperty("href")&&!a.hasOwnProperty("canvas"))return Promise.reject(Error("Input object is not a valid JSON texture definition."));var b={wrapS:[0,1,2].includes(a.wrapS)?
   a.wrapS:0,wrapT:[0,1,2].includes(a.wrapT)?a.wrapT:0,offset:a.offset||[0,0],repeat:a.repeat||[1,1],rotation:a.rotation||0,center:a.center||[0,0],color:a.color||null};return loadTexture$$module$src$shared$materials$MaterialParser(a.href||a.canvas,b,this.requestHeaders).then(function(a){if(b.color){var c=toTinyColor_1$$module$src$shared$materials$MaterialParser.default(b.color);c&&c.isValid()&&(a.SDColor=c)}return a},function(a){return Promise.reject(a)})};b.prototype.processGemMaterial=function(a){var b=
   this,d=new MaterialPropertiesGem_1$$module$src$shared$materials$MaterialParser.default;["depth","resolution"].forEach(function(b){if(a.hasOwnProperty(b)){var c=parseInt(a[b]);!isNaN(c)&&isFinite(c)&&("resolution"===b?c&c-1||(d[b]=c):d[b]=c)}});"impurityScale tracingTransparency transparency dispersion refractionIndex gamma contrast brightness".split(" ").forEach(function(b){if(a.hasOwnProperty(b)){var c=parseFloat(a[b]);if(!isNaN(c)&&isFinite(c))switch(b){case "tracingTransparency":d.tracingOpacity=
   1-c;break;case "transparency":d.opacity=1-c;break;default:d[b]=c}}});["colorTransferBegin","colorTransferEnd"].forEach(function(b){if(a.hasOwnProperty(b)){var c=toTinyColor_1$$module$src$shared$materials$MaterialParser.default(a[b]);c&&c.isValid()&&(d[b]=c.toThreeColor())}});var e=[];["impurity","environment"].forEach(function(c){var g=c+"texture",f=a[g];a.hasOwnProperty(g)&&f&&e.push(b.loadCubeTextureFromJSON(f).then(function(a){return d[c+"Map"]=a}))});return Promise.all(e).then(function(){d._json=
   a;return d})};b.prototype.processStandardMaterial=function(a,b){var c,e=this;if(-1==["1.0","2.0","3.0"].indexOf(b))return Promise.reject(Error("Material definition has unknown version."));var g=new module$src$shared$materials$MaterialPropertiesStandard.default.MaterialPropertiesStandard;"1.0"===b&&(null!=a.shine&&(a.metalness=Math.min(1,a.shine)),null!=a.shine&&(a.roughness=1-Math.min(1,a.shine)),a.hasOwnProperty("diffuse")&&!a.hasOwnProperty("color")&&(a.color=a.diffuse));"metalness roughness alphaThreshold shadowOpacity lightReflectivity transparency bumpAmplitude".split(" ").forEach(function(b){if(a.hasOwnProperty(b)){var c=
   parseFloat(a[b]);if(!isNaN(c)&&isFinite(c))switch(b){case "transparency":g.opacity=1-c;g.transparent=0<c;break;case "bumpAmplitude":g.bumpScale=c;break;default:g[b]=c}}});["color"].forEach(function(b){if(a.hasOwnProperty(b)){var c=toTinyColor_1$$module$src$shared$materials$MaterialParser.default(a[b]);c&&c.isValid()&&(g[b]=c.toThreeColor())}});a.hasOwnProperty("threeDNoise")&&(g.threeDNoiseOpacity=a.threeDNoise.opacity||0,g.threeDNoiseID=a.threeDNoise.noiseID||0,g.threeDNoiseScale=a.threeDNoise.scale||
   1,g.threeDNoiseDistanceFade=a.threeDNoise.distance||0);a.hasOwnProperty("line")&&(g.line.type=GlobalUtils_1$$module$src$shared$materials$MaterialParser.default.typeCheck(a.line.type,"string")?a.line.type:"basic",g.line.lineWidth=GlobalUtils_1$$module$src$shared$materials$MaterialParser.default.typeCheck(a.line.lineWidth,"notnegative")?a.line.lineWidth:1,g.line.dashSize=GlobalUtils_1$$module$src$shared$materials$MaterialParser.default.typeCheck(a.line.dashSize,"notnegative")?a.line.dashSize:3,g.line.gapSize=
   GlobalUtils_1$$module$src$shared$materials$MaterialParser.default.typeCheck(a.line.gapSize,"notnegative")?a.line.gapSize:1,g.line.scale=GlobalUtils_1$$module$src$shared$materials$MaterialParser.default.typeCheck(a.line.scale,"notnegative")?a.line.scale:1);var h=[];if(a.hasOwnProperty("bitmaptexture"))if(Array.isArray(a.bitmaptexture)){if(0===a.bitmaptexture.length)return Promise.resolve(null);b=[];try{for(var f=__values$$module$src$shared$materials$MaterialParser(a.bitmaptexture),k=f.next();!k.done;k=
   f.next())b.push(this.loadTextureFromJSON(k.value))}catch(m){var l={error:m}}finally{try{k&&!k.done&&(c=f.return)&&c.call(f)}finally{if(l)throw l.error;}}h.push(Promise.all(b).then(function(a){if(1<a.length){g.additionalMaps=[];g.mapPropertyType=[];g.mapPropertyColor=[];g.uvTransformAddMap=[];for(var b=1,c=a.length;b<c;++b){var d=a[b];g.additionalMaps.push(d);g.mapPropertyType.push(d.hasOwnProperty("SDColor")?1:0);var e=d.hasOwnProperty("SDColor")&&d.SDColor?d.SDColor.toThreeColor():new THREE$$module$src$shared$materials$MaterialParser.Color;
   g.mapPropertyColor.push(e);g.uvTransformAddMap.push(d.uvTransform)}}return g.map=a[0]}))}else h.push(this.loadTextureFromJSON(a.bitmaptexture).then(function(a){return g.map=a}));["metalness","roughness","bump","normal","transparency"].forEach(function(b){a.hasOwnProperty(b+"texture")&&h.push(e.loadTextureFromJSON(a[b+"texture"]).then(function(a){"transparency"===b?(g.alphaMap=a,g.transparent=!0):g[b+"Map"]=a}))});return Promise.all(h).then(function(){g._json=a;return g})};b.cubeTextureLoader=new THREE$$module$src$shared$materials$MaterialParser.CubeTextureLoader;
   return b}();var module$src$app$partials$ViewerAppSceneManager={},THREE$$module$src$app$partials$ViewerAppSceneManager=module$src$externals$three.default,toTinyColor$$module$src$app$partials$ViewerAppSceneManager=module$src$shared$util$toTinyColor.default,messagingConstants$$module$src$app$partials$ViewerAppSceneManager=module$src$shared$constants$MessagingConstants.default,MessagePrototype$$module$src$app$partials$ViewerAppSceneManager=module$src$shared$messages$MessagePrototype.default,SubScene$$module$src$app$partials$ViewerAppSceneManager=
   module$src$shared$scene$OutputVersion.default,GlobalUtils$$module$src$app$partials$ViewerAppSceneManager=module$src$shared$util$GlobalUtils.default,GLBLoader$$module$src$app$partials$ViewerAppSceneManager=module$src$shared$singletons$GLBLoader.default,GLTFLoader$$module$src$app$partials$ViewerAppSceneManager=module$src$shared$singletons$GLTFLoader.default.GLTFLoaderInstance,OBJLoader$$module$src$app$partials$ViewerAppSceneManager=module$src$shared$singletons$OBJLoader.default,THREELoader$$module$src$app$partials$ViewerAppSceneManager=
   module$src$shared$singletons$THREELoader.default,Tag3DLoader$$module$src$app$partials$ViewerAppSceneManager=module$src$shared$singletons$Tag3DLoader.default,MaterialParser$$module$src$app$partials$ViewerAppSceneManager=module$src$shared$materials$MaterialParser.default.MaterialParser;
   module$src$app$partials$ViewerAppSceneManager.default=function(b){var a=this,c=b.sceneGeometryManager,d={},e={},g={},h=["canvas","threeObject","transformations"],f={},k={},l={},m={},n=Promise.resolve(),q={},p={},u={},t=["interactionGroup","interactionMode","duration","dragPlaneNormal","visible"],r={authorization:a.getSettingShallow("authorization")};a.registerHook("authorization",function(a){r.authorization=a});var v=function(a,b,c){b=Error(b);b.scope=a;b.data=c;return Promise.reject(b)},w=function(a,
   b){var c;var d=function(a,b){return v("SceneManager._addOutputVersion",a,b)};var e=a.id;var k=l[e];var m=k.creatorId;var n=b.id;var p=!1;if(g[m]&&g[m][n]&&(n=g[m][n],n.ov))for(c in p=!0,n=n.ov,n)"_json"===c?(b._json_scene=module$src$shared$util$GlobalUtils.default.deepCopy(b[c],h),module$src$shared$util$GlobalUtils.default.defaults(b._json_scene,n._json,!0)):"_json_scene"!==c&&(b[c]=n[c]);p||delete b._json_scene;if(!f[m][e].subScene.addOutputVersion(b))return d("could not add output version to subscene");
   ++k.finishedOutputVersions;return k.finishedOutputVersions<k.totalOutputVersions?Promise.resolve(!0):x(a)},y=function(b,f,g,h){var k=function(a,b){return v("SceneManager._publishSubScene",a,b)};var l=g.id;h=h||{};var E="boolean"===typeof h.forceUpdate||"string"===typeof h.forceUpdate?h.forceUpdate:!1;if(!a.hasSetting("defaultMaterial"))return k("no default material configured");var p=u[f+"."+l],x=q[f];return x&&x.serial>p?Promise.resolve(!1):n=x=n.then(function(){var n=null;return(new module$src$shared$materials$MaterialParser.default.MaterialParser(r)).fromJSONMaterialObject(a.getSetting("defaultMaterial")).then(function(a){n=
   a},function(a){return k("could not create default material",a)}).then(function(){for(var u=b.outputIds,r=e.hasOwnProperty(f)?e[f]._subSceneObject:null,G=null!==r?r.outputIds:[],v=$jscomp.makeIterator(G),x=v.next();!x.done;x=v.next())x=x.value,-1===u.indexOf(x)&&(b.addOutputVersion(r.getOutputVersion(x)),u.push(x));v=[];var H={},w={},B={assets:{add:{},replace:{},remove:{}}};x={};for(var J=u.length-1;-1<J;x={compiledOutputVersion:x.compiledOutputVersion,options:x.options,options$313:x.options$313},
   --J){var z=u[J],C=b.getOutputVersion(z),y=d.getJSONOutputVersion(z,f,!0);if(C.hasOwnProperty("geometry")){x.compiledOutputVersion=b.getCompiledOutputVersion(z,n);if(!x.compiledOutputVersion||!Array.isArray(x.compiledOutputVersion.geometry))return k("could not compile output version "+z);w[z]={};for(var A={},K=$jscomp.makeIterator(x.compiledOutputVersion.geometry),I=K.next();!I.done;A={g:A.g,o:A.o},I=K.next()){A.g=I.value;A.o=w[z];I=A.g.path.split(".");I=$jscomp.makeIterator(I);for(var F=I.next();!F.done;F=
   I.next())F=F.value,A.o[F]=A.o[F]||{},A.o=A.o[F];["type","geometry","material","initialMatrix"].forEach(function(a){return function(b){a.g.hasOwnProperty(b)&&(a.o[b]=a.g[b])}}(A));A.o._isSDGeometry=!0}if(-1===G.indexOf(z)){x.options={};x.compiledOutputVersion.hasOwnProperty("name")&&(x.options.name=x.compiledOutputVersion.name);if(x.compiledOutputVersion.hasOwnProperty("bbmin")&&x.compiledOutputVersion.hasOwnProperty("bbmax"))try{var L=new module$src$externals$three.default.Box3(module$src$shared$util$GlobalUtils.default.toVector3(x.compiledOutputVersion.bbmin),
   module$src$shared$util$GlobalUtils.default.toVector3(x.compiledOutputVersion.bbmax));if(0<L.min.lengthSq()||0<L.max.lengthSq())x.options.boundingBox=L}catch(ca){a.debug("SceneManager._publishSubScene","invalid bounding box for output version "+z,ca)}t.forEach(function(a){return function(b){a.compiledOutputVersion.hasOwnProperty(b)&&(a.options[b]=a.compiledOutputVersion[b])}}(x));v.push(c.addGeometry(f+"."+z,x.compiledOutputVersion.geometry,x.options,C.version));B.assets.add[z]=y}else(A=!0===E||E===
   z)||(A=r.getOutputVersion(z).version!==C.version),!A&&C.materialId&&(K=b.getOutputVersion(C.materialId),(I=r.getOutputVersion(C.materialId))&&K.version===I.version&&C.materialId!==E||(A=!0)),A&&(x.options$313={},t.forEach(function(a){return function(b){a.compiledOutputVersion.hasOwnProperty(b)&&(a.options$313[b]=a.compiledOutputVersion[b])}}(x)),"number"===typeof h.duration&&0<=h.duration&&(x.options$313.duration=h.duration),v.push(c.replaceGeometry(f+"."+z,x.compiledOutputVersion.geometry,x.options$313,
   C.version)),B.assets.replace[z]=y)}else r&&(A=r.getOutputVersion(z))&&A.geometry&&(v.push(c.removeGeometry(f+"."+z)),B.assets.remove[z]=y);C.hasOwnProperty("data")&&(H[z]=C.data)}return Promise.all(v).then(function(){e[f]=w;e[f]._subSceneObject=b;m[f]=H;q[f]={serial:p,id:l};Object.keys(B.assets.add).forEach(function(a){B.assets.add[a]=d.getJSONOutputVersion(a,f,!0)});var c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SUBSCENE_UPDATE,
   B,g);a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SUBSCENE_PUBLISHED,c);0<Object.keys(H).length&&(c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.DATA,H,g),a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.DATA,c));return B})})})},x=function(b){var d=function(a,b){return v("SceneManager._finishProcess",a,b)};var g=b.id;var h=l[g];var m=h.creatorId;
   k[m]=k[m]||{};k[m][g]=f[m][g];delete f[m][g];0===Object.keys(f[m]).length&&delete f[m];var n=k[m][g].subScene,p=e[m]?e[m]._subSceneObject:null,q=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_STATUS,{state:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SUBSCENE_READY,progress:.75},b);a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,q);return y(n,
   m,b,h.options).then(function(a){delete k[m][g];0===Object.keys(k[m]).length&&delete k[m];return a},function(a){if(null!==p)return y(p,m,b).then(function(){return d("publishing of subscene failed, restored previous state",a)});e.hasOwnProperty(m)&&delete e[m];return c.removeGeometry(m).then(function(){return d("publishing of subscene failed, restored previous state",a)})}).catch(function(a){return d("publishing of subscene failed",a)})},A=function(a,b){var c=function(a,b){return v("SceneManager._convertOutputVersion",
   a,b)};void 0===b&&(b=!1);a=a||{};if(!b){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a.version,"string"))return c("version missing");if(!Array.isArray(a.content))return c("content array missing")}var d={id:a.id};["version","name"].concat($jscomp.arrayFromIterable(t)).forEach(function(b){void 0!==a[b]&&null!==a[b]&&(d[b]=a[b])});module$src$shared$util$GlobalUtils.default.typeCheck(a.material,"string")&&(d.materialId=a.material);module$src$shared$util$GlobalUtils.default.typeCheck(a.bbmin,
   "vector3any")&&(d.bbmin=module$src$shared$util$GlobalUtils.default.toVector3(a.bbmin));module$src$shared$util$GlobalUtils.default.typeCheck(a.bbmax,"vector3any")&&(d.bbmax=module$src$shared$util$GlobalUtils.default.toVector3(a.bbmax));var e=(d.bbmin&&d.bbmax?d.bbmin.distanceTo(d.bbmax):1)/1E4,f=[],g=[];b=[];if(Array.isArray(a.content))for(var k=$jscomp.makeIterator(a.content),l=k.next();!l.done;l=k.next()){l=l.value;if(!module$src$shared$util$GlobalUtils.default.typeCheck(l.format,"string"))return c("format of content item missing");
   switch(l.format){case "material":if(!l.data)return c("data of material content item missing");l=module$src$shared$util$GlobalUtils.default.deepCopy(l.data,h);f.push(l);break;case "gltf":case "glb":case "obj":case "tag2d":case "tag3d":case "anchor":case "three":g.push(module$src$shared$util$GlobalUtils.default.deepCopy(l,h));break;default:b.push(module$src$shared$util$GlobalUtils.default.deepCopy(l))}}k=[];f=$jscomp.makeIterator(f);for(l=f.next();!l.done;l=f.next()){l=l.value;var m=new module$src$shared$materials$MaterialParser.default.MaterialParser(r);
   k.push(m.fromJSONMaterialObject(l))}f=[];l={};g=$jscomp.makeIterator(g);for(m=g.next();!m.done;l={gj:l.gj,anchorArray:l.anchorArray},m=g.next()){l.gj=m.value;m=[];if(Array.isArray(l.gj.transformations))for(var n=$jscomp.makeIterator(l.gj.transformations),p=n.next();!p.done;p=n.next())if(p=p.value,p.isMatrix4)m.push(p.clone());else{var q=new module$src$externals$three.default.Matrix4;q.fromArray(p);m.push(q)}!l.gj.hasOwnProperty("href")||"gltf"!==l.gj.format&&"glb"!==l.gj.format?"obj"===l.gj.format?
   l.gj.data&&l.gj.data.objUrl&&f.push(module$src$shared$singletons$OBJLoader.default.loadGeometry(l.gj.data.objUrl,l.gj.data.mtlUrl,l.gj.data.path,l.gj.data.texturePath,l.gj.data.side,m)):"three"===l.gj.format?l.gj.data&&l.gj.data.threeObject&&f.push(module$src$shared$singletons$THREELoader.default.loadGeometry(l.gj.data.threeObject,m)):"tag3d"===l.gj.format&&l.gj.hasOwnProperty("data")&&Array.isArray(l.gj.data)?f.push(module$src$shared$singletons$Tag3DLoader.default.load3DTags(l.gj.data)):("tag2d"===
   l.gj.format||"anchor"===l.gj.format)&&l.gj.hasOwnProperty("data")&&Array.isArray(l.gj.data)&&(l.anchorArray=[],l.gj.data.forEach(function(a){return function(b,c){if(b.location){var d=b.location;d=void 0!==d.x?new module$src$externals$three.default.Vector3(d.x,d.y,d.z):new module$src$externals$three.default.Vector3(d.X,d.Y,d.Z);b.data&&!b.data.color&&(b.data.color="black");var e=null;void 0!==b.intersectionTarget&&null!==b.intersectionTarget&&(b.intersectionTarget.min&&b.intersectionTarget.max&&module$src$shared$util$GlobalUtils.default.typeCheck(b.intersectionTarget.min,
   "vector3any")&&module$src$shared$util$GlobalUtils.default.typeCheck(b.intersectionTarget.max,"vector3any")?e=new module$src$externals$three.default.Box3(module$src$shared$util$GlobalUtils.default.toVector3(b.intersectionTarget.min),module$src$shared$util$GlobalUtils.default.toVector3(b.intersectionTarget.max)):b.intersectionTarget&&(module$src$shared$util$GlobalUtils.default.typeCheck(b.intersectionTarget,"string")||module$src$shared$util$GlobalUtils.default.isArrayOfType(b.intersectionTarget,"string"))&&
   (e=b.intersectionTarget));b={path:"Anchor_"+c,type:"anchor",geometry:{position:d,viewports:b.viewports,format:"tag2d"===a.gj.format?a.gj.format:b.format,data:"tag2d"===a.gj.format?{color:b.color||"black",text:b.text}:b.data,hideable:void 0!==b.hideable&&null!==b.hideable?module$src$shared$util$GlobalUtils.default.typeCheck(b.hideable,"boolean")?b.hideable:!0:!0,intersectionTarget:e||null}};a.anchorArray.push(b)}}}(l)),f.push(Promise.resolve(l.anchorArray))):f.push(module$src$shared$singletons$GLTFLoader.default.GLTFLoaderInstance.loadGeometry(l.gj.href,
   m,e,r))}e=Promise.all(f).then(function(a){a.forEach(function(a,b){a=$jscomp.makeIterator(a);for(var c=a.next();!c.done;c=a.next())c=c.value,c.path="content_"+b+"."+c.path});return a}).catch(function(a){console.error("loading of geometry failed",a);return c("loading of geometry failed",a)});k=Promise.all(k).catch(function(a){console.error("loading of material failed",a);return c("loading of material failed",a)});b=Promise.resolve(b);return Promise.all([e,k,b]).then(function(b){if(0<b[0].length){d.geometry=
   [];for(var c=$jscomp.makeIterator(b[0]),e=c.next();!e.done;e=c.next()){e=$jscomp.makeIterator(e.value);for(var f=e.next();!f.done;f=e.next())d.geometry.push(f.value)}}0<b[1].length&&(d.material=b[1]);0<b[2].length&&(d.data=b[2]);d._json=a;return d})},z=function(a){for(var b in f)delete f[b][a],delete u[b+"."+a];delete l[a]};d.initSubScene=function(b,c,d,e){var g=function(b,c){c instanceof Error?b=c:(b=Error(b),b.scope="SceneManager.initSubScene",b.data=c);h&&(c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR,
   b,d),a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,c));a.error(b.scope,b.message,b);return!1};if(!d||!d.id)return g("invalid token");var h=d.id;var k=d.serial?d.serial:Date.now();"number"!==typeof k&&(k=parseInt(k),isNaN(k)&&(k=Date.now()));if(p.hasOwnProperty(c)&&p[c].serial>k||q.hasOwnProperty(c)&&q[c].serial>k)return b=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT,
   "Subscene obsolete because of newer request",d),a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,b),!1;if(l.hasOwnProperty(h))return g("attempt to register duplicate process "+h);p[c]={serial:k,id:h};u[c+"."+h]=k;l[h]={initTime:Date.now(),creatorId:c,processId:h,totalOutputVersions:b,finishedOutputVersions:0,options:e};f[c]=f[c]||{};f[c][h]={creatorId:c,processId:h,subScene:new module$src$shared$scene$OutputVersion.default};return!0};d.addJSONOutputVersionToSubScene=
   function(b,c,e){var f=function(b,c){c instanceof Error?b=c:(b=Error(b),b.scope="SceneManager.addJSONOutputVersionToSubScene",b.data=c);g&&(c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR,b,e),a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,c),z(g));a.error(b.scope,b.message,b);return Promise.reject(b)};if(!e||!e.id)return f("invalid token");var g=e.id;return A(b).then(function(a){return d.addOutputVersionToSubScene(a,
   c,e)},function(a){return f("conversion of output version failed",a)})};d.addOutputVersionToSubScene=function(b,c,d){var e=function(b,c,e){c instanceof Error?b=c:(b=e?{message:b}:Error(b),b.scope="SceneManager.addOutputVersionToSubScene",b.data=c);g&&(c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR,b,d),a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,c),z(g));if(e)return a.warn(b.scope,
   b.message,b),Promise.resolve(!1);a.error(b.scope,b.message,b);return Promise.reject(b)};if(!b.id)return e("output version without id");if(!d||!d.id)return e("invalid token");var g=d.id;if(!l[g])return e("unknown process id "+g+", probably process was superseded",void 0,!0);var h=l[g];if(h.creatorId!==c)return e("unexpected creatorId");if(!f[c]||!f[c][g])return e("no partial subscene for creatorId/processId, probably process was superseded",void 0,!0);var k=p[c];return k?a.getSettingShallow("ignoreSuperseded")&&
   k.id!==g?(z(g),b=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT,"Subscene obsolete because of newer request",d),a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,b),Promise.resolve(!1)):w(d,b).then(function(b){if(!1===b){var c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT,
   "Subscene superseded, not published",d);z(d.id)}else!0===b?c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_STATUS,{state:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SUBSCENE_OUTPUTVERSION,progress:.25+h.finishedOutputVersions/h.totalOutputVersions*.5},d):(c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS,
   "Subscene published",d),c.addPart(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SUBSCENE_UPDATE,b),z(d.id));a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,c);return b},function(a){return e("adding output version failed",a)}):e("could not find latest serial for creator id "+c+", probably process was superseded",void 0,!0)};d.numberOfPartialSubScenes=function(){return Object.keys(f).length};d.numberOfCompleteSubScenes=function(){return Object.keys(k).length};
   d.getModelData=function(a){var b=[];a=a||{};var c=a.creatorId?[a.creatorId]:Object.keys(m);c=$jscomp.makeIterator(c);for(var d=c.next();!d.done;d=c.next())if(d=d.value,m.hasOwnProperty(d)){var e=Object.keys(m[d]);e=$jscomp.makeIterator(e);for(var f=e.next();!f.done;f=e.next())if(f=f.value,null==a.id||f==a.id)for(var g=$jscomp.makeIterator(m[d][f]),h=g.next();!h.done;h=g.next())if(h=h.value,null==a.name||h.name==a.name)h=module$src$shared$util$GlobalUtils.default.deepCopy(h),delete h.format,h.plugin=
   d,h.id=f,b.push(h)}return b};d.getGeometryNames=function(a){var b={};(null==a?Object.keys(e):[a]).forEach(function(a){if(e.hasOwnProperty(a)&&e[a].hasOwnProperty("_subSceneObject")){b[a]={};for(var c=$jscomp.makeIterator(e[a]._subSceneObject.outputNames),d=c.next();!d.done;d=c.next()){d=d.value;b[a][d]=[];var f=e[a]._subSceneObject.getOutputVersionIdByName(d);f=$jscomp.makeIterator(f);for(var g=f.next();!g.done;g=f.next()){g=g.value;var h=e[a]._subSceneObject.getOutputVersion(g);h&&h.hasOwnProperty("geometry")&&
   b[a][d].push(g)}}}});return b};d.getGeometryPathsByName=function(a,b){var c=[];(null==b?Object.keys(e):[b]).forEach(function(b){if(e.hasOwnProperty(b)&&e[b].hasOwnProperty("_subSceneObject")){var d=e[b]._subSceneObject.getOutputVersionIdByName(a);d=$jscomp.makeIterator(d);for(var f=d.next();!f.done;f=d.next()){f=f.value;var g=e[b]._subSceneObject.getOutputVersion(f);g&&g.hasOwnProperty("geometry")&&c.push(b+"."+f)}}});return c};d.getJSONOutputVersion=function(a,b,c){if(!e.hasOwnProperty(b))return null;
   var d=e[b]._subSceneObject.getOutputVersion(a);if(!d)return null;var f="_json";if(!d.hasOwnProperty(f))return null;c&&d.hasOwnProperty("_json_scene")&&(f="_json_scene");d=module$src$shared$util$GlobalUtils.default.deepCopy(d[f],h);d.scenePath=b+"."+a;if(!d.format){a=null;if(Array.isArray(d.content))if(0===d.content.length)a="unknown";else{b=0;for(c=d.content.length;b<c;b++)if(f=d.content[b],f.format)if(!a)a=f.format;else if(a!==f.format){a=null;break}a||(a="mixed")}a&&(d.format=a)}return d};d.getOutputIds=
   function(a){return e.hasOwnProperty(a)?e[a]._subSceneObject.outputIds:[]};d.removeOutputIds=function(a,b){Array.isArray(b)||(b=[b]);var d=Promise.resolve();if(e[a]){var f=e[a],g={};b=$jscomp.makeIterator(b);for(var h=b.next();!h.done;g={id:g.id},h=b.next())g.id=h.value,f[g.id]&&(f._subSceneObject.removeOutputVersion(g.id),delete f[g.id],d=d.then(function(b){return function(){return c.removeGeometry(a+"."+b.id)}}(g)))}return d};d.setPersistentAttributes=function(b,c,f){var k;var l=function(a,b){return v("SceneManager.setPersistentAttributes",
   a,b)};g[c]=g[c]||{};g[c][b]=g[c][b]||{};g[c][b].json=g[c][b].json||{};var m=-1;f.hasOwnProperty("duration")&&(m=f.duration,delete f.duration);var n=module$src$shared$util$GlobalUtils.default.deepCopy(g[c][b].json,h);f=module$src$shared$util$GlobalUtils.default.deepCopy(f,h);for(k in f)null===f[k]?delete n[k]:n[k]=f[k];n.id=b;return A(n,!0).then(function(f){g[c][b].json=n;g[c][b].ov=f;if(!e.hasOwnProperty(c))return n;f=e[c]._subSceneObject.getOutputVersion(b);if(!f)return n;var h={id:module$src$shared$util$GlobalUtils.default.createRandomId(),
   serial:Date.now()};var k=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_STATUS,{busy:!1,progress:0,creator:"SceneManager.setPersistentAttributes"},h);a.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,k);k={forceUpdate:b};0<=m&&(k.duration=m);return d.initSubScene(1,c,h,k)?d.addOutputVersionToSubScene(f,c,h).then(function(){return n}):l("ViewerApp.initSubScene failed")})};d.getPersistentAttributes=
   function(a,b){return g[b]&&g[b][a]?g[b][a].json:null};d.getCreatorIds=function(){return Object.keys(e)};return d};var module$src$app$handlers$ProcessStatusHandler={},GlobalUtils$$module$src$app$handlers$ProcessStatusHandler=module$src$shared$util$GlobalUtils.default,MessagePrototype$$module$src$app$handlers$ProcessStatusHandler=module$src$shared$messages$MessagePrototype.default,viewerAppConstants$$module$src$app$handlers$ProcessStatusHandler=module$src$app$ViewerAppConstants.default;
   module$src$app$handlers$ProcessStatusHandler.default=function(b){var a=this;if(b&&b.viewportManager)var c=b.viewportManager;var d={},e={busy:!1,progress:1,processes:module$src$shared$util$GlobalUtils.default.deepCopy(d)},g={getSummary:function(){return module$src$shared$util$GlobalUtils.default.deepCopy(e)},updateViewerStatus:function(){var b=e.busy,f={busy:!1,progress:1,processes:module$src$shared$util$GlobalUtils.default.deepCopy(d)};for(l in d){var g=d[l];g.busy&&(f.busy=!0);void 0!==g.progress&&
   "number"===typeof g.progress&&g.progress<f.progress&&0<=g.progress&&(f.progress=g.progress)}e=module$src$shared$util$GlobalUtils.default.deepCopy(f);if(e.busy){var l=new module$src$shared$messages$MessagePrototype.default(module$src$app$ViewerAppConstants.default.messageDataTypes.APP_STATUS,f);a.message(module$src$app$ViewerAppConstants.default.messageTopics.STATUS_BUSY,l);b||(a.debug("ProcessStatusHandler.updateViewerStatus","Entering busy mode, progress "+100*e.progress+"%",f),c&&a.getSettingShallow("blurSceneWhenBusy")&&
   c.threeDManager.renderingHandler.setBlur(e.busy,100))}else!e.busy&&b?(a.debug("ProcessStatusHandler.updateViewerStatus","Entering idle mode",f),b=new module$src$shared$messages$MessagePrototype.default(module$src$app$ViewerAppConstants.default.messageDataTypes.APP_STATUS,f),a.message(module$src$app$ViewerAppConstants.default.messageTopics.STATUS_IDLE,b),c&&a.getSettingShallow("blurSceneWhenBusy")&&c.threeDManager.renderingHandler.setBlur(e.busy,100)):e.busy&&a.debug("ProcessStatusHandler.updateViewerStatus",
   "Updating busy mode",f)},updateProcessStatus:function(b,c){var e=b;e&&"object"===typeof e&&module$src$shared$util$GlobalUtils.default.typeCheck(b.id,"string")&&(e=b.id);if(!module$src$shared$util$GlobalUtils.default.typeCheck(e,"string"))return!1;c=c||{};if(d.hasOwnProperty(e))module$src$shared$util$GlobalUtils.default.inject(c,d[e],!0);else if(0===c.progress)d[e]={initTime:Date.now()},module$src$shared$util$GlobalUtils.default.inject(c,d[e],!0);else return a.debug("ProcessStatusHandler.updateProcessStatus",
   "Ignoring status message for unknown process "+e,c),!1;g.updateViewerStatus();return!0},forkProcessStatus:function(a,b){var c=a;c&&"object"===typeof c&&module$src$shared$util$GlobalUtils.default.typeCheck(a.id,"string")&&(c=a.id);if(!(module$src$shared$util$GlobalUtils.default.typeCheck(c,"string")&&d.hasOwnProperty(c)&&Array.isArray(b)&&b.every(function(a){return a.startsWith(c+".")})))return!1;var e=d[c];b.forEach(function(a){d[a]=module$src$shared$util$GlobalUtils.default.deepCopy(e)});delete d[c];
   return!0},unregisterProcess:function(b){var c=b;c&&"object"===typeof c&&module$src$shared$util$GlobalUtils.default.typeCheck(b.id,"string")&&(c=b.id);if(!module$src$shared$util$GlobalUtils.default.typeCheck(c,"string"))return!1;if(!d.hasOwnProperty(c))return a.debug("ProcessStatusHandler.unregisterProcess","Unregistering unknown process "+c),!1;delete d[c];g.updateViewerStatus();return!0}};return g};var module$src$ar$ArApiInterface={default:function(){}};module$src$ar$ArApiInterface.default.prototype.hitTest=function(){};module$src$ar$ArApiInterface.default.prototype.registerAnchor=function(){};module$src$ar$ArApiInterface.default.prototype.removeAnchor=function(){};module$src$ar$ArApiInterface.default.prototype.pauseSession=function(){};module$src$ar$ArApiInterface.default.prototype.runSession=function(){};module$src$ar$ArApiInterface.default.prototype.getStatus=function(){};
   module$src$ar$ArApiInterface.default.prototype.addEventListener=function(){};module$src$ar$ArApiInterface.default.prototype.removeEventListener=function(){};module$src$ar$ArApiInterface.default.prototype.getPlacementAnchor=function(){};module$src$ar$ArApiInterface.default.prototype.resetPlacementAnchor=function(){};module$src$ar$ArApiInterface.default.prototype.setPlacementAnchor=function(){};
   module$src$ar$ArApiInterface.default.prototype.EVENTTYPE={ANCHOR_CREATE_IMAGE:"anchor.create.image",ANCHOR_UPDATE:"anchor.update",OBJECT_PLACEMENT:"object.placement",STATUS_TRACKING:"status.tracking",STATUS_MAPPING:"status.mapping"};var module$src$ar$diagnostics$ArStatusType={default:function(b,a,c,d,e){this.framework=b;this.anchors=a;this.tracking=c;this.trackingReason=d;this.worldMapping=e}};var module$src$ar$ArSettingsHooks={},GLOBAL_UTILS$$module$src$ar$ArSettingsHooks=module$src$shared$util$GlobalUtils.default;
   module$src$ar$ArSettingsHooks.default=function(b){var a=this;this._settings=b.settings;this._loggingHandler=b.loggingHandler;this._viewportManager=b.viewportManager;this._container=b.container;this.getDefaultHitTestTypeVal=this.getEnableAutomaticPlacementVal=this.getEnableTouchControlRotationVal=this.getEnableTouchControlsVal=this.getEnableLightingEstimationVal=this.getEnableCameraSyncVal=this.onSettingChange=null;b=this._settings.getSettings();var c=function(b,c){var d=a[b](c);if(a.onSettingChange&&
   d)a.onSettingChange(b,c);return d};this.enableCameraSync(b.enableCameraSync);this._settings.registerHook("enableCameraSync",function(a){return c("enableCameraSync",a)});this.enableLightingEstimation(b.enableLightingEstimation);this._settings.registerHook("enableLightingEstimation",function(a){return c("enableLightingEstimation",a)});this.enableTouchControls(b.enableTouchControls);this._settings.registerHook("enableTouchControls",function(a){return c("enableTouchControls",a)});this.enableTouchControlRotation(b.enableTouchControlRotation);
   this._settings.registerHook("enableTouchControlRotation",function(a){return c("enableTouchControlRotation",a)});this.enableAutomaticPlacement(b.enableAutomaticPlacement);this._settings.registerHook("enableAutomaticPlacement",function(a){return c("enableAutomaticPlacement",a)});this.defaultHitTestType(b.defaultHitTestType);this._settings.registerHook("defaultHitTestType",function(a){return c("defaultHitTestType",a)})};
   module$src$ar$ArSettingsHooks.default.prototype.enableCameraSync=function(b){if(!module$src$shared$util$GlobalUtils.default.typeCheck(b,"boolean",this._loggingHandler.warn,"ArHandler.Hook->enableCameraSync"))return!1;this.getEnableCameraSyncVal=b;return!0};
   module$src$ar$ArSettingsHooks.default.prototype.enableLightingEstimation=function(b){if(!module$src$shared$util$GlobalUtils.default.typeCheck(b,"boolean",this._loggingHandler.warn,"ArHandler.Hook->enableLightingEstimation"))return!1;this.getEnableLightingEstimationVal=b;return!0};
   module$src$ar$ArSettingsHooks.default.prototype.enableTouchControls=function(b){if(!module$src$shared$util$GlobalUtils.default.typeCheck(b,"boolean",this._loggingHandler.warn,"ArHandler.Hook->enableTouchControls"))return!1;this.getEnableTouchControlsVal=b;return!0};
   module$src$ar$ArSettingsHooks.default.prototype.enableTouchControlRotation=function(b){if(!module$src$shared$util$GlobalUtils.default.typeCheck(b,"boolean",this._loggingHandler.warn,"ArHandler.Hook->enableTouchControlRotation"))return!1;this.getEnableTouchControlRotationVal=b;return!0};
   module$src$ar$ArSettingsHooks.default.prototype.enableAutomaticPlacement=function(b){if(!module$src$shared$util$GlobalUtils.default.typeCheck(b,"boolean",this._loggingHandler.warn,"ArHandler.Hook->enableAutomaticPlacement"))return!1;this.getEnableAutomaticPlacementVal=b;return!0};
   module$src$ar$ArSettingsHooks.default.prototype.defaultHitTestType=function(b){if(!module$src$shared$util$GlobalUtils.default.typeCheck(b,"string",this._loggingHandler.warn,"ArHandler.Hook->defaultHitTestType"))return!1;this.getDefaultHitTestTypeVal=b;return!0};var module$src$ar$ArEvent={default:function(b,a,c){this.type=b;this.api=a;c&&(c.image&&(this.image=c.image),c.anchors&&(this.anchors=c.anchors),c.tracking&&(this.tracking=c.tracking),c.trackingReason&&(this.trackingReason=c.trackingReason),c.worldMapping&&(this.worldMapping=c.worldMapping),c.runtimeId&&(this.runtimeId=c.runtimeId),c.anchorId&&(this.anchorId=c.anchorId))}};var module$src$ar$utils$ArApi_utils={default:{}};
   module$src$ar$utils$ArApi_utils.default.temp2rgb=function(b){var a=b/100;var c=[];6504>=b?(c[0]=255,c[1]=a,c[1]=99.4708025861*Math.log(c[1])-161.1195681661):(c[0]=a-60,c[0]=329.698727446*Math.pow(c[0],-.1332047592),0>c[0]&&(c[0]=0),255<c[0]&&(c[0]=255),c[1]=a-60,c[1]=288.1221695283*Math.pow(c[1],-.0755148492));0>c[1]&&(c[1]=0);255<c[1]&&(c[1]=255);6504<=b?c[2]=255:19>=a?c[2]=0:(c[2]=a-10,c[2]=138.5177312231*Math.log(c[2])-305.0447927307,0>c[2]&&(c[2]=0),255<c[2]&&(c[2]=255));return c};var module$src$ar$ArApiARKit={},THREE$$module$src$ar$ArApiARKit=module$src$externals$three.default,GLOBAL_UTILS$$module$src$ar$ArApiARKit=module$src$shared$util$GlobalUtils.default,COMMPLUGIN_ID$$module$src$ar$ArApiARKit="CommPlugin_1",ArApiFactory$$module$src$ar$ArApiARKit=function(b){var a=new module$src$ar$ArApiInterface.default,c={events:[],listen:function(a,b,c){this.events[a]||(this.events[a]=[]);this.events[a].push({token:b,cb:c})},raise:function(a,b){this.events[a]&&this.events[a].forEach(function(a){a.cb(b)})},
   remove:function(a){var b=a.split(":");a=b[0];b=b[1];if(this.events[a])for(var c=0;c<this.events[a].length;c++)if(this.events[a][c].token==b){this.events[a].splice(c,1);break}}},d=b.viewportManager,e=Array.isArray(b.container)&&0<b.container.length?b.container[0]:b.container,g=b.apiResponse,h=b.sceneGeometryManager,f={},k=null,l=new module$src$externals$three.default.Matrix4,m=new module$src$externals$three.default.Matrix4,n=null,q=new module$src$ar$ArSettingsHooks.default({viewportManager:b.viewportManager,
   loggingHandler:b.loggingHandler,settings:b.settings}),p=function(){return function(){n||(n=d.getApis()[0]);return n}}(),u=function(){var a;return function(){a||(a=p().camera);return a}}();b={};var t=new module$src$externals$three.default.Matrix4,r=new module$src$externals$three.default.Matrix4,v={};t.makeRotationAxis(new module$src$externals$three.default.Vector3(1,0,0),-.5*Math.PI);r.getInverse(t);window.SDVARKitBridge=b;var w=function(a){return a.includes("'")||a.includes('"')?JSON.parse(a):a.replace(/["'\[\]]/g,
   "").split(",").map(function(a){return parseFloat(a)})};b.viewProjectionMatrixUpdate=function(b,d,e,g,h){if(f.worldMappingStatus!==e){var k=new module$src$ar$ArEvent.default(a.EVENTTYPE.STATUS_MAPPING,{},{worldMapping:e,tracking:g,trackingReason:h});c.raise(a.EVENTTYPE.STATUS_MAPPING,k)}f.trackingStatus!==g&&(k=new module$src$ar$ArEvent.default(a.EVENTTYPE.STATUS_TRACKING,{},{worldMapping:e,tracking:g,trackingReason:h}),c.raise(a.EVENTTYPE.STATUS_TRACKING,k));f.worldMappingStatus=e;f.trackingStatus=
   g;f.trackingStatusReason=h;"string"===typeof b&&(b=w(b));"string"===typeof d&&(d=w(d));l.identity();m.identity();l.fromArray(b);l.multiply(t);m.fromArray(d);q.getEnableCameraSyncVal&&u().updateMatrices(l,m);q.getEnableCameraSyncVal&&q.getEnableTouchControlsVal&&Y()};b.lightingEstimateUpdate=function(){};var y=function(a){var b=new module$src$externals$three.default.Matrix4,c=a.plane;b.fromArray(a.transform);b.multiply(t);b.premultiply(r);a.transform=b;c&&(a=new module$src$externals$three.default.Vector3,
   b=new module$src$externals$three.default.Vector3,a.fromArray(c.center),a.applyMatrix4(r),c.center=a,b.fromArray(c.extent),b.applyMatrix4(r),c.extent=b)};b.anchorTransformUpdate=function(a,b){k="string"===typeof a?JSON.parse(a):a;Object.keys(k).forEach(function(a){y(k[a])});A(k,b)};b.imageAnchorCreated=function(b){b="string"===typeof b?JSON.parse(b):b;y(b);b=new module$src$ar$ArEvent.default(a.EVENTTYPE.ANCHOR_CREATE_IMAGE,{},{image:b});c.raise(a.EVENTTYPE.ANCHOR_CREATE_IMAGE,b)};b.hitTestResponse=
   function(a,b){var c=v[a];c&&(delete v[a],b?(a="string"===typeof b?JSON.parse(b):b,a.forEach(function(a){var b=new module$src$externals$three.default.Matrix4,c=new module$src$externals$three.default.Matrix4,d=a.anchor;b.fromArray(a.worldTransform);b.multiply(t);b.premultiply(r);a.worldTransform=b;c.fromArray(a.localTransform);c.multiply(t);c.premultiply(r);a.localTransform=c;d&&y(d)}),c.resolve(a)):c.resolve([]))};b.registerAnchorResponse=function(a,b){var c=v[a];c&&(delete v[a],c.resolve(b))};b.removeAnchorResponse=
   function(a,b){var c=v[a];c&&(delete v[a],c.resolve(b))};b.pauseSessionResponse=function(a){var b=v[a];b&&(delete v[a],b.resolve())};b.runSessionResponse=function(a){var b=v[a];b&&(delete v[a],b.resolve())};var x=new module$src$ar$ArEvent.default(a.EVENTTYPE.ANCHOR_UPDATE,{}),A=function(b){if(q.getEnableCameraSyncVal){var d=D?D:"";d&&b[d]&&""===K&&h.setPluginTransformation(COMMPLUGIN_ID$$module$src$ar$ArApiARKit,[null,null,b[d].transform],!0)}x.anchors=b;c.raise(a.EVENTTYPE.ANCHOR_UPDATE,x)},z=0;var B=
   window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.runSession?"arkit":"none";var J=function(a,b){return new Promise(function(c,d){if(window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers[a]){var e="id"+z++;b=b||{};b.requestId=e;v[e]={resolve:c,reject:d};window.webkit.messageHandlers[a].postMessage(b)}else d("Handler "+a+" does not exist")})},F=function(a,b,c){if(0>a||1<a||0>b||1<b)return Promise.reject("Expects normalized screen coordinates");"string"===
   typeof c?c=[c]:Array.isArray(c)||(c=[]);return J("hitTest",{screenX:a+"",screenY:b+"",types:c.join(";")})},E=function(a,b){if(!a||!a.isMatrix4)return Promise.reject("Provide a THREE.Matrix4");"string"!==typeof b&&(b="");var c=new module$src$externals$three.default.Matrix4;c.copy(a);c.multiply(r);c.premultiply(t);return J("registerAnchor",{transform:JSON.stringify(c.toArray(),null,0),name:b})},G=function(a){return"string"!==typeof a?Promise.reject("Anchor uuid must be a string"):a?J("removeAnchor",
   {uuid:a}):Promise.resolve(!1)},H=0,C=0,I=0,K="",L=[],Q=new module$src$externals$three.default.Matrix4,S=new module$src$externals$three.default.Matrix4,D="",N,M,V,P={},Y=function(){""!==K&&R(L[0],L[1]).then(function(a){a&&(N=a)})},U=function(b,d){b=b||"";d=d||COMMPLUGIN_ID$$module$src$ar$ArApiARKit;var e=D?D:"";D=b;b=new module$src$ar$ArEvent.default(a.EVENTTYPE.OBJECT_PLACEMENT,{},{runtimeId:d,anchorId:b});c.raise(a.EVENTTYPE.OBJECT_PLACEMENT,b);q.getEnableCameraSyncVal&&h.toggleGeometry([COMMPLUGIN_ID$$module$src$ar$ArApiARKit],
   []);return e},T=function(a,b){b=b||COMMPLUGIN_ID$$module$src$ar$ArApiARKit;return E(a).then(function(a){var c=U(a,b);c&&G(c);return a})},O=function(a){a=a||COMMPLUGIN_ID$$module$src$ar$ArApiARKit;if(!P[a]&&q.getEnableCameraSyncVal&&q.getEnableAutomaticPlacementVal&&(!D||!D)){P[a]=!0;var b=function(){P[a]=setTimeout(function(){P[a]=!1;O(a)},250)};if(""!==K)b();else return R(.5,.5).then(function(c){if(c)return T(c.worldTransform).then(function(){P[a]=!1});b()})}},R=function(a,b,c,d){c=c||q.getDefaultHitTestTypeVal;
   d=d||COMMPLUGIN_ID$$module$src$ar$ArApiARKit;return F(a,b,c).then(function(a){if(Array.isArray(a)&&0<a.length)return a=a[0],h.setPluginTransformation(d,[null,null,a.worldTransform],!0),a})},W=function(a){if(2>a.length)return[0,0];for(var b=[],c=0,d=a.length;c<d;c++)b.push(a.item(c));b.sort(function(a,b){return a.identifier<b.identifier});return new module$src$externals$three.default.Vector2(b[1].screenX-b[0].screenX,b[1].screenY-b[0].screenY)},ba=function(a){a.preventDefault();if(2===a.touches.length)H=
   W(a.touches).angle();else if(!(1<a.touches.length)){a=a.changedTouches.item(0);var b=a.screenX/window.innerWidth,c=a.screenY/window.innerHeight;K=a.identifier;L=[b,c];R(b,c).then(function(a){a&&(N=a)})}},Z=function(a){a.preventDefault();var b=a.changedTouches;a=a.touches;2===a.length&&(a=W(a),C=H-a.angle()+I,Q.makeRotationZ(C),q.getEnableTouchControlRotationVal&&h.setPluginTransformation(COMMPLUGIN_ID$$module$src$ar$ArApiARKit,[null,Q],!0));a=0;for(var c=b.length;a<c;a++)if(b.item(a).identifier===
   K){a=b.item(a);b=a.screenX/window.innerWidth;a=a.screenY/window.innerHeight;L=[b,a];R(b,a).then(function(a){a&&(N=a)});break}},X=function(a){a.preventDefault();a=a.changedTouches;I=C;for(var b=!1,c=0,e=a.length;c<e;c++)if(a.item(c).identifier===K){b=!0;break}b?(d.threeDManager.adjustScene(),T(N.worldTransform).then(function(){K=""})):b&&(K="")};if(e){var aa=!1;q.onSettingChange=function(a,b){"enableCameraSync"===a?b?(M&&V&&h.setPluginTransformation(COMMPLUGIN_ID$$module$src$ar$ArApiARKit,[null,M,
   V]),d.threeDManager.renderingHandler.registerForContinuousRendering("AR"),b&&p().updateSettingAsync("camera.enableCameraControls",!b),D&&D||(h.toggleGeometry([],[COMMPLUGIN_ID$$module$src$ar$ArApiARKit]),q.getEnableAutomaticPlacementVal&&O(COMMPLUGIN_ID$$module$src$ar$ArApiARKit))):(a=h.getPluginTransformation(COMMPLUGIN_ID$$module$src$ar$ArApiARKit),Array.isArray(a)&&3<=a.length&&(M=a[1],V=a[2]),h.setPluginTransformation(COMMPLUGIN_ID$$module$src$ar$ArApiARKit,[null,S,S]),d.threeDManager.renderingHandler.unregisterForContinuousRendering("AR"),
   D&&D||h.toggleGeometry([COMMPLUGIN_ID$$module$src$ar$ArApiARKit],[])):"enableAutomaticPlacement"===a&&b&&O(COMMPLUGIN_ID$$module$src$ar$ArApiARKit);q.getEnableCameraSyncVal&&q.getEnableTouchControlsVal&&!aa?(e.addEventListener("touchstart",ba,!1),e.addEventListener("touchmove",Z,!1),e.addEventListener("touchend",X,!1),e.addEventListener("touchcancel",X,!1),aa=!0):(e.removeEventListener("touchstart",ba,!1),e.removeEventListener("touchmove",Z,!1),e.removeEventListener("touchend",X,!1),e.removeEventListener("touchcancel",
   X,!1),K="",aa=!1)};setTimeout(function(){if(p())q.onSettingChange("enableCameraSync",q.getEnableCameraSyncVal)},0)}b=function(){module$src$ar$ArApiInterface.default.call(this)};$jscomp.inherits(b,module$src$ar$ArApiInterface.default);b.prototype.hitTest=function(a,b,c){return F(a,b,c)};b.prototype.registerAnchor=function(a,b){return E(a,b)};b.prototype.removeAnchor=function(a){return G(a)};b.prototype.pauseSession=function(){return J("pauseSession")};b.prototype.runSession=function(a,b){"string"===
   typeof a?a=[a]:Array.isArray(a)||(a=[]);"string"===typeof b?b=[b]:Array.isArray(b)||(b=[]);return J("runSession",{planeDetection:a.join(";"),options:b.join(";")})};b.prototype.getStatus=function(){return g(null,new module$src$ar$diagnostics$ArStatusType.default(B,k,f.trackingStatus,f.trackingStatusReason,f.worldMappingStatus))};b.prototype.addEventListener=function(b,d){if(!Object.keys(a.EVENTTYPE).find(function(c){return a.EVENTTYPE[c]===b}))return g("Unsupported event type");var e=module$src$shared$util$GlobalUtils.default.createRandomId();
   c.listen(b,e,d);return g(null,{token:b+":"+e})};b.prototype.removeEventListener=function(a){return g(null,c.remove(a))};b.prototype.getPlacementAnchor=function(a){return g(null,D?D:"")};b.prototype.resetPlacementAnchor=function(b){var d=b||COMMPLUGIN_ID$$module$src$ar$ArApiARKit;b=D?D:"";D="";d=new module$src$ar$ArEvent.default(a.EVENTTYPE.OBJECT_PLACEMENT,{},{runtimeId:d,anchorId:""});c.raise(a.EVENTTYPE.OBJECT_PLACEMENT,d);q.getEnableCameraSyncVal&&(h.toggleGeometry([],[COMMPLUGIN_ID$$module$src$ar$ArApiARKit]),
   q.getEnableAutomaticPlacementVal&&O(COMMPLUGIN_ID$$module$src$ar$ArApiARKit));return g(null,b)};b.prototype.setPlacementAnchor=function(a,b){return g(null,U(a,b))};return new b},_ArApiInstance$$module$src$ar$ArApiARKit;module$src$ar$ArApiARKit.default=function(b){_ArApiInstance$$module$src$ar$ArApiARKit||(_ArApiInstance$$module$src$ar$ArApiARKit=ArApiFactory$$module$src$ar$ArApiARKit(b));return _ArApiInstance$$module$src$ar$ArApiARKit};var module$src$api$v2$interface$ApiParameterInterfaceV2_1={default:function(){this.EVENTTYPE={REGISTERED:"registered",UPDATE:"update",VALUE_UPDATE:"value.update"};this.RESULT={PARAM_NOT_FOUND:"param_not_found",NO_VALUE:"no_value",VALUE_REJECT:"value_reject",VALUE_EXISTS:"value_exists",VALUE_OK:"value_ok",PLUGIN_NOT_FOUND:"plugin_not_found",ERROR:"error",LIVE:"live",CACHE:"cache",LOAD:"load",ABORT:"abort"};this.TYPE={FLOAT:"Float",INT:"Int",EVEN:"Even",ODD:"Odd",STRING:"String",COLOR:"Color",STRINGLIST:"StringList",
   BOOL:"Bool",TIME:"Time",FILE:"File"};this.VISUALIZATION={SLIDER:"slider",SEQUENCE:"sequence",CYCLE:"cycle",DROPDOWN:"dropdown",CHECKLIST:"checklist",CLOCK:"clock",CALENDAR:"calendar"};this.get=function(){};this.updateAsync=function(){};this.canGoBackInHistory=function(){};this.canGoForwardInHistory=function(){};this.goBackInHistoryAsync=function(){};this.goForwardInHistoryAsync=function(){};this.updateProperties=function(){};this.addEventListener=function(){};this.removeEventListener=function(){}}};var module$src$api$v2$interface$ApiExportInterfaceV2_1={default:function(){this.RESULT={EXPORT_NOT_FOUND:"export_not_found",PLUGIN_NOT_FOUND:"plugin_not_found",ERROR:"error",CACHE:"cache",LOAD:"load"};this.EVENTTYPE={AVAILABLE:"available",REGISTERED:"registered",UPDATE:"update",STATUS:"status"};this.get=function(){};this.requestAsync=function(){};this.updateProperties=function(){};this.addEventListener=function(){};this.removeEventListener=function(){}}};var module$src$api$v2$interface$ApiPluginInterfaceV2_1={default:function(){this.STATUS={NONE:"none",READY:"ready",FAILED:"failed",LOADED:"loaded",ACTIVE:"active",UNLOADED:"unloaded"};this.get=function(){};this.registerPluginAsync=function(){};this.registerCommPluginAsync=function(){};this.refreshPluginAsync=function(){};this.saveDefaultParameterValuesAsync=function(){};this.deregisterPluginAsync=function(){}}};var module$src$api$v2$interface$ApiStateInterfaceV2_1={default:function(){this.EVENTTYPE={BUSY:"busy",IDLE:"idle",MESSAGE:"message",FAILED:"failed"};this.get=function(){};this.setBusy=function(){};this.addEventListener=function(){};this.removeEventListener=function(){}}};var module$src$api$v2$interface$ApiViewportsInterfaceV2_1={default:function(){this.EVENTTYPE={CREATED:"created",DESTROYED:"destroyed"};this.get=function(){};this.create=function(){};this.destroy=function(){}}};var module$src$api$v2$interface$ApiSceneInterfaceV2_1={default:function(){this.FORMAT={GLB:"glb",GLTF:"gltf",OBJ:"obj",THREE:"three",DATA:"data",MATERIAL:"material",TAG2D:"tag2d",TAG3D:"tag3d",ANCHOR:"anchor"};this.EVENTTYPE={ANCHOR_ADD:"anchor.add",ANCHOR_REMOVE:"anchor.remove",DRAG_START:"drag.start",DRAG_MOVE:"drag.move",DRAG_END:"drag.end",FRAMERATE:"framerate",HOVER_ON:"hover.on",HOVER_OVER:"hover.over",HOVER_OFF:"hover.off",RENDER_BEAUTY_START:"render.beauty.start",RENDER_BEAUTY_CANCEL:"render.beauty.cancel",
   RENDER_BEAUTY_END:"render.beauty.end",SELECT_ON:"select.on",SELECT_OFF:"select.off",SUBSCENE_PUBLISHED:"subscene.published",VISIBILITY_ON:"visibility.on",VISIBILITY_OFF:"visibility.off"};this.MATERIALTYPE={STANDARD:"standard",GEM:"gem"};this.INTERACTIONMODETYPE={GLOBAL:"global",SUB:"sub"};this.SELECTIONMODETYPE={SINGLE:"single",MULTIPLE:"multiple"};this.TRANSFORMATIONTYPE={PLUGIN:"plugin",VIEWPORT:"viewport"};this.LIVETRANSFORMATIONTYPE={ROTATION:"rotation",TRANSLATION:"translation",SCALING:"scaling"};
   this.updateAsync=function(){};this.get=function(){};this.getData=function(){};this.convertTo2D=function(){};this.getBoundingBox=function(){};this.setTransformation=function(){};this.getTransformation=function(){};this.applyTransformation=function(){};this.resetTransformation=function(){};this.setLiveTransformation=function(){};this.getScreenshot=function(){};this.getScreenshotAsync=function(){};this.updateSelected=function(){};this.getSelected=function(){};this.startExternalDragEvent=function(b,a){};
   this.removeAsync=function(){};this.render=function(){};this.updateShadowMap=function(){};this.startContinuousRendering=function(){};this.stopContinuousRendering=function(){};this.pause=function(){};this.resume=function(){};this.updatePersistentAsync=function(){};this.getPersistent=function(){};this.updateInteractionGroups=function(){};this.getInteractionGroups=function(){};this.addEventListener=function(){};this.removeEventListener=function(){};this.toggleGeometry=function(){};this.getViewportRuntimeId=
   function(){};this.getContainer=function(){}}};var module$src$api$v2$ApiInterfaceV2_1={},ARAPIINTERFACE$$module$src$api$v2$ApiInterfaceV2_1=module$src$ar$ArApiInterface.default,ApiParameterInterface$$module$src$api$v2$ApiInterfaceV2_1=module$src$api$v2$interface$ApiParameterInterfaceV2_1.default,ApiExportInterface$$module$src$api$v2$ApiInterfaceV2_1=module$src$api$v2$interface$ApiExportInterfaceV2_1.default,ApiPluginInterface$$module$src$api$v2$ApiInterfaceV2_1=module$src$api$v2$interface$ApiPluginInterfaceV2_1.default,ApiStateInterface$$module$src$api$v2$ApiInterfaceV2_1=
   module$src$api$v2$interface$ApiStateInterfaceV2_1.default,ApiViewportsInterface$$module$src$api$v2$ApiInterfaceV2_1=module$src$api$v2$interface$ApiViewportsInterfaceV2_1.default,ApiSceneInterface$$module$src$api$v2$ApiInterfaceV2_1=module$src$api$v2$interface$ApiSceneInterfaceV2_1.default;
   module$src$api$v2$ApiInterfaceV2_1.default=function(){this.EVENTTYPE={SETTINGS_UPDATE:"settings.update",SETTINGS_REGISTERED:"settings.registered"};this.state=new module$src$api$v2$interface$ApiStateInterfaceV2_1.default;this.parameters=new module$src$api$v2$interface$ApiParameterInterfaceV2_1.default;this.exports=new module$src$api$v2$interface$ApiExportInterfaceV2_1.default;this.plugins=new module$src$api$v2$interface$ApiPluginInterfaceV2_1.default;this.viewports=new module$src$api$v2$interface$ApiViewportsInterfaceV2_1.default;
   this.scene=new module$src$api$v2$interface$ApiSceneInterfaceV2_1.default;this.ar=new module$src$ar$ArApiInterface.default;this.addEventListener=function(){};this.removeEventListener=function(){};this.getSettingDefinitions=function(){};this.getSettings=function(){};this.getSetting=function(){};this.updateSettingAsync=function(){};this.updateSettingsAsync=function(){};this.saveSettingsAsync=function(){};this.createAsynchronousFunctions=function(){};this.getRuntimeId=function(){}};
   module$src$api$v2$ApiInterfaceV2_1.default.utils={};var module$src$api$v2$implementation$ApiExportImplementationV2_1={},messagingConstants$$module$src$api$v2$implementation$ApiExportImplementationV2_1=module$src$shared$constants$MessagingConstants.default,pluginConstantsGlobal$$module$src$api$v2$implementation$ApiExportImplementationV2_1=module$src$shared$constants$PluginConstantsGlobal.default,GlobalUtils$$module$src$api$v2$implementation$ApiExportImplementationV2_1=module$src$shared$util$GlobalUtils.default,ApiInterfaceV2$$module$src$api$v2$implementation$ApiExportImplementationV2_1=
   new module$src$api$v2$ApiInterfaceV2_1.default,APIResponse$$module$src$api$v2$implementation$ApiExportImplementationV2_1=module$src$api$v2$ApiResponse.default;
   module$src$api$v2$implementation$ApiExportImplementationV2_1.default=function(b,a){var c=this;this.RESULT=ApiInterfaceV2$$module$src$api$v2$implementation$ApiExportImplementationV2_1.exports.RESULT;this.EVENTTYPE=ApiInterfaceV2$$module$src$api$v2$implementation$ApiExportImplementationV2_1.exports.EVENTTYPE;var d=a.exportHandler;this.get=function(){return(0,module$src$api$v2$ApiResponse.default)(null,d.getExportDefinitions())};var e=function(a){return!a||"object"!==typeof a||!module$src$shared$util$GlobalUtils.default.typeCheck(a.id,
   "string")&&!module$src$shared$util$GlobalUtils.default.typeCheck(a.idOrName,"string")&&!module$src$shared$util$GlobalUtils.default.typeCheck(a.name,"string")||a.plugin&&"string"!==typeof a.plugin?!1:!0};this.requestAsync=function(a,c){if(!e(a))return Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Invalid input, expecting an ExportRequestObject.",null,c));var f=d.getUniqueExportByRequestObject(a);if(void 0===f)return Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Invalid input, ExportRequestObject did not match a unique export definition.",
   null,c));a.parameters&&(f.parameters=a.parameters);var g=module$src$shared$constants$MessagingConstants.default.makeMessageToken();g.payload=c;a.silent&&(g.attributes={silent:!0});return new Promise(function(a){var e=b.setProcessCallback(g.id,function(d,g){if(g.hasOwnProperty("parts"))for(d=$jscomp.makeIterator(g.parts),g=d.next();!g.done;g=d.next()){g=g.value;if(g.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_RESULT){module$src$shared$util$GlobalUtils.default.defaults(f,
   g.data,!0);b.clearProcessCallback(e);a((0,module$src$api$v2$ApiResponse.default)(null,f,c));break}if(g.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT){b.clearProcessCallback(e);a((0,module$src$api$v2$ApiResponse.default)(g.data,null,c));break}if(g.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR){b.clearProcessCallback(e);a((0,module$src$api$v2$ApiResponse.default)(g.data,null,c));break}}}),h=d.requestExport(f,
   g);f.resultcode=h;h!==module$src$shared$constants$PluginConstantsGlobal.default.requestExportResults.CACHE&&h!==module$src$shared$constants$PluginConstantsGlobal.default.requestExportResults.LOAD&&(b.error("ApiImplementationV2.ExportApi.requestAsync","_exportHandler.requestExport returned error",h),b.clearProcessCallback(e),a((0,module$src$api$v2$ApiResponse.default)({m:"Failed to request export",d:h},f,c)))})};this.updateProperties=function(a){return(0,module$src$api$v2$ApiResponse.default)(null,
   d.updateMultipleExports(a))};this.addEventListener=function(a,d){if(!Object.keys(c.EVENTTYPE).find(function(b){return c.EVENTTYPE[b]===a}))return(0,module$src$api$v2$ApiResponse.default)("Unsupported event type");var e=b.subscribeToMessageStream(module$src$shared$constants$MessagingConstants.default.messageTopics.EXPORT+"."+a,function(b,c){b=new CustomEvent(a);b.api=c.api;c.token&&(b.token=c.token);b.export={};var e={};e[module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_DEFINITION]=
   null;e[module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_RESULT]=null;e[module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_STATUS]=null;for(var f in e){var g=c.getUniquePartByType(f);if(g){g.data&&(g=g.data);var h=e[f]?e[f]:g,k;for(k in h)b.export[k]=g[k]}}d(b)});return(0,module$src$api$v2$ApiResponse.default)(null,e)};this.removeEventListener=function(a){return(0,module$src$api$v2$ApiResponse.default)(null,b.unsubscribeFromMessageStream(a))}};var module$src$api$v2$implementation$ApiParameterImplementationV2_1={},messagingConstants$$module$src$api$v2$implementation$ApiParameterImplementationV2_1=module$src$shared$constants$MessagingConstants.default,GlobalUtils$$module$src$api$v2$implementation$ApiParameterImplementationV2_1=module$src$shared$util$GlobalUtils.default,ApiInterfaceV2$$module$src$api$v2$implementation$ApiParameterImplementationV2_1=new module$src$api$v2$ApiInterfaceV2_1.default,APIResponse$$module$src$api$v2$implementation$ApiParameterImplementationV2_1=
   module$src$api$v2$ApiResponse.default;
   module$src$api$v2$implementation$ApiParameterImplementationV2_1.default=function(b,a){var c=this;this.RESULT=ApiInterfaceV2$$module$src$api$v2$implementation$ApiParameterImplementationV2_1.parameters.RESULT;this.TYPE=ApiInterfaceV2$$module$src$api$v2$implementation$ApiParameterImplementationV2_1.parameters.TYPE;this.VISUALIZATION=ApiInterfaceV2$$module$src$api$v2$implementation$ApiParameterImplementationV2_1.parameters.VISUALIZATION;this.EVENTTYPE=ApiInterfaceV2$$module$src$api$v2$implementation$ApiParameterImplementationV2_1.parameters.EVENTTYPE;var d=
   a.parameterHandler;this.get=function(a){return(a=d.getParameterDefinitionsAndValues(a))?(0,module$src$api$v2$ApiResponse.default)(null,a):(0,module$src$api$v2$ApiResponse.default)("Failed to get parameter definitions")};var e=function(a){return!a||"object"!==typeof a||!module$src$shared$util$GlobalUtils.default.typeCheck(a.id,"string")&&!module$src$shared$util$GlobalUtils.default.typeCheck(a.idOrName,"string")&&!module$src$shared$util$GlobalUtils.default.typeCheck(a.name,"string")||a.plugin&&!module$src$shared$util$GlobalUtils.default.typeCheck(a.plugin,
   "string")||void 0===a.value?!1:!0};this.updateAsync=function(a,c){Array.isArray(a)||(a=[a]);for(var f=$jscomp.makeIterator(a),g=f.next();!g.done;g=f.next())if(!e(g.value))return Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Invalid input, expecting array of ParameterUpdateObject.",null,c));var h=module$src$shared$util$GlobalUtils.default.deepCopy(a);f=0;for(g=a.length;f<g;f++)a[f].value instanceof Blob&&(h[f].value=a[f].value);var m=module$src$shared$constants$MessagingConstants.default.makeMessageToken();
   m.payload=c;return new Promise(function(a){var e=function(){var e=b.setProcessCallback(m.id,function(d,f){if(f.hasOwnProperty("parts"))for(d=$jscomp.makeIterator(f.parts),f=d.next();!f.done;f=d.next()){f=f.value;if(f.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS){b.clearProcessCallback(e);a((0,module$src$api$v2$ApiResponse.default)(null,h,c));break}if(f.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT){b.clearProcessCallback(e);
   a((0,module$src$api$v2$ApiResponse.default)(f.data,null,c));break}if(f.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR){b.clearProcessCallback(e);a((0,module$src$api$v2$ApiResponse.default)(f.data,null,c));break}}}),f=d.setMultipleParameterValues(h,m);if(f.err)b.error("ApiImplementationV2.ParameterApi.updateAsync","_parameterHandler.setMultipleParameterValues returned error",f),b.clearProcessCallback(e),a((0,module$src$api$v2$ApiResponse.default)({m:"Failed to set parameter values",
   d:f},null,c));else{f.warn&&b.warn("ApiImplementationV2.ParameterApi.updateAsync","_parameterHandler.setMultipleParameterValues returned warning",f);var g={};f=$jscomp.makeIterator(f.params);for(var k=f.next();!k.done;g={p:g.p},k=f.next())g.p=k.value,h.find(function(a){return function(b){return b.id===a.p.id&&b.plugin===a.p.plugin}}(g)).result=g.p.result}},f=d.updateRequiresPriorUpload(h);void 0===f?a((0,module$src$api$v2$ApiResponse.default)("Parameter not found",null,c)):!1===f?e():d.priorUpload(h).then(function(d){d.err?
   (b.error("ApiImplementationV2.ParameterApi.updateAsync","_parameterHandler.priorUpload returned error",d),a((0,module$src$api$v2$ApiResponse.default)({m:"Failed to upload blobs",d:d},null,c))):e()},function(d){b.error("ApiImplementationV2.ParameterApi.updateAsync","_parameterHandler.priorUpload failed",d);a((0,module$src$api$v2$ApiResponse.default)({m:"Failed to upload blobs",d:d},null,c))})})};this.canGoBackInHistory=function(){return d.canGoBackInHistory()};this.canGoForwardInHistory=function(){return d.canGoForwardInHistory()};
   this.goBackInHistoryAsync=function(a){var c=module$src$shared$constants$MessagingConstants.default.makeMessageToken();c.payload=a;return new Promise(function(e){var f=b.setProcessCallback(c.id,function(c,g){if(g.hasOwnProperty("parts"))for(c=$jscomp.makeIterator(g.parts),g=c.next();!g.done;g=c.next()){g=g.value;if(g.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS){b.clearProcessCallback(f);e((0,module$src$api$v2$ApiResponse.default)(null,d.getParameterState(),
   a));break}if(g.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT){b.clearProcessCallback(f);e((0,module$src$api$v2$ApiResponse.default)(g.data,null,a));break}if(g.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR){b.clearProcessCallback(f);e((0,module$src$api$v2$ApiResponse.default)(g.data,null,a));break}}});d.goBackInHistory(c)||(b.error("ApiImplementationV2.goBackInHistoryAsync","_parameterHandler.goBackInHistory returned false"),
   b.clearProcessCallback(f),e((0,module$src$api$v2$ApiResponse.default)("Failed to go back in history",null,a)))})};this.goForwardInHistoryAsync=function(a){var c=module$src$shared$constants$MessagingConstants.default.makeMessageToken();c.payload=a;return new Promise(function(e){var f=b.setProcessCallback(c.id,function(c,g){if(g.hasOwnProperty("parts"))for(c=$jscomp.makeIterator(g.parts),g=c.next();!g.done;g=c.next()){g=g.value;if(g.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS){b.clearProcessCallback(f);
   e((0,module$src$api$v2$ApiResponse.default)(null,d.getParameterState(),a));break}if(g.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT){b.clearProcessCallback(f);e((0,module$src$api$v2$ApiResponse.default)(g.data,null,a));break}if(g.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR){b.clearProcessCallback(f);e((0,module$src$api$v2$ApiResponse.default)(g.data,null,a));break}}});d.goForwardInHistory(c)||(b.error("ApiImplementationV2.goForwardInHistoryAsync",
   "_parameterHandler.goForwardInHistory returned false"),b.clearProcessCallback(f),e((0,module$src$api$v2$ApiResponse.default)("Failed to go forward in history",null,a)))})};this.updateProperties=function(a){return(0,module$src$api$v2$ApiResponse.default)(null,d.updateMultipleParameters(a))};this.addEventListener=function(a,d){if(!Object.keys(c.EVENTTYPE).find(function(b){return c.EVENTTYPE[b]===a}))return(0,module$src$api$v2$ApiResponse.default)("Unsupported event type");var e=b.subscribeToMessageStream(module$src$shared$constants$MessagingConstants.default.messageTopics.PARAMETER+
   "."+a,function(b,c){b=new CustomEvent(a);b.api=c.api;c.token&&(b.token=c.token);b.parameter={};var e={};e[module$src$shared$constants$MessagingConstants.default.messageDataTypes.PARAMETER_DEFINITION]=null;e[module$src$shared$constants$MessagingConstants.default.messageDataTypes.PARAMETER_UPDATE]=null;for(var f in e){var g=c.getUniquePartByType(f);if(g){g.data&&(g=g.data);var h=e[f]?e[f]:g,k;for(k in h)b.parameter[k]=g[k]}}d(b)});return(0,module$src$api$v2$ApiResponse.default)(null,e)};this.removeEventListener=
   function(a){return(0,module$src$api$v2$ApiResponse.default)(null,b.unsubscribeFromMessageStream(a))}};var module$src$api$v2$implementation$ApiPluginImplementationV2_1={},COMM_PLUGIN$$module$src$api$v2$implementation$ApiPluginImplementationV2_1=module$src$plugins$comm$CommPlugin.default,messagingConstants$$module$src$api$v2$implementation$ApiPluginImplementationV2_1=module$src$shared$constants$MessagingConstants.default,pluginConstantsGlobal$$module$src$api$v2$implementation$ApiPluginImplementationV2_1=module$src$shared$constants$PluginConstantsGlobal.default,ApiInterfaceV2$$module$src$api$v2$implementation$ApiPluginImplementationV2_1=
   new module$src$api$v2$ApiInterfaceV2_1.default,APIResponse$$module$src$api$v2$implementation$ApiPluginImplementationV2_1=module$src$api$v2$ApiResponse.default;
   module$src$api$v2$implementation$ApiPluginImplementationV2_1.default=function(b,a){var c=this;this.STATUS=ApiInterfaceV2$$module$src$api$v2$implementation$ApiPluginImplementationV2_1.plugins.STATUS;var d=a.pluginHandler,e=a.messagingHandler,g=a.parameterHandler;this.get=function(){return(0,module$src$api$v2$ApiResponse.default)(null,d.getStatusDescription())};this.registerPluginAsync=function(a){return new Promise(function(b){try{var c=a.getRuntimeId(),f=[],g=function(d,g){(d=g.getUniquePartByType(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PLUGIN_RUNTIME_ID))&&
   d.data===c&&(f.forEach(function(a){e.unsubscribeFromMessageStream(a)}),b((0,module$src$api$v2$ApiResponse.default)(null,a.getStatusDescription())))};f.push(e.subscribeToMessageStream(module$src$shared$constants$MessagingConstants.default.messageTopics.PLUGIN_ACTIVE,g));f.push(e.subscribeToMessageStream(module$src$shared$constants$MessagingConstants.default.messageTopics.PLUGIN_FAILED,g));void 0===d.registerPlugin(a)&&(f.forEach(function(a){e.unsubscribeFromMessageStream(a)}),b((0,module$src$api$v2$ApiResponse.default)("Failed to register plugin.",
   a.getStatusDescription())))}catch(n){b((0,module$src$api$v2$ApiResponse.default)(n))}})};this.registerCommPluginAsync=function(a){a=new module$src$plugins$comm$CommPlugin.default(a);return c.registerPluginAsync(a)};this.refreshPluginAsync=function(a,c){var d=module$src$shared$constants$MessagingConstants.default.makeMessageToken();d.payload=c;return new Promise(function(e){var f=b.setProcessCallback(d.id,function(a,d){if(d.hasOwnProperty("parts"))for(a=$jscomp.makeIterator(d.parts),d=a.next();!d.done;d=
   a.next()){d=d.value;if(d.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS){b.clearProcessCallback(f);e((0,module$src$api$v2$ApiResponse.default)(null,g.getParameterState(),c));break}if(d.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT){b.clearProcessCallback(f);e((0,module$src$api$v2$ApiResponse.default)(d.data,null,c));break}if(d.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR){b.clearProcessCallback(f);
   e((0,module$src$api$v2$ApiResponse.default)(d.data,null,c));break}}});g.refreshPlugin(a,d).err&&(b.error("ApiImplementationV2.refreshPluginAsync","_parameterHandler.refreshPlugin failed"),b.clearProcessCallback(f),e((0,module$src$api$v2$ApiResponse.default)("Failed to refresh plugin "+a,null,c)))})};this.saveDefaultParameterValuesAsync=function(a){a||(a=d.getRuntimeIds());Array.isArray(a)||(a=[a]);for(var b=[],c=0,e=a.length;c<e;c++){var h=a[c],n=d.getPluginByRuntimeId(h);n?n.getCapabilities().includes(module$src$shared$constants$PluginConstantsGlobal.default.pluginCapabilities.DEFAULTPARAM)?
   (h=g.getParameterValuesForPlugin(h,!0),b.push(n.saveDefaultParameterValues(h))):b.push(Promise.resolve(!1)):b.push(Promise.resolve(!1))}return Promise.all(b).then(function(a){return(0,module$src$api$v2$ApiResponse.default)(null,a.every(function(a){return a}))},function(a){return(0,module$src$api$v2$ApiResponse.default)(a,!1)})};this.deregisterPluginAsync=function(){return Promise.reject("not implemented yet")}};var module$src$api$v2$implementation$ApiSceneImplementationV2_1={},messagingConstants$$module$src$api$v2$implementation$ApiSceneImplementationV2_1=module$src$shared$constants$MessagingConstants.default,GlobalUtils$$module$src$api$v2$implementation$ApiSceneImplementationV2_1=module$src$shared$util$GlobalUtils.default,MessagePrototype$$module$src$api$v2$implementation$ApiSceneImplementationV2_1=module$src$shared$messages$MessagePrototype.default,ApiInterfaceV2$$module$src$api$v2$implementation$ApiSceneImplementationV2_1=
   new module$src$api$v2$ApiInterfaceV2_1.default,TWEEN$$module$src$api$v2$implementation$ApiSceneImplementationV2_1=module$node_modules$$tweenjs$tween_js$src$Tween.default,APIResponse$$module$src$api$v2$implementation$ApiSceneImplementationV2_1=module$src$api$v2$ApiResponse.default;
   module$src$api$v2$implementation$ApiSceneImplementationV2_1.default=function(b,a){var c=this;this.FORMAT=ApiInterfaceV2$$module$src$api$v2$implementation$ApiSceneImplementationV2_1.scene.FORMAT;this.EVENTTYPE=ApiInterfaceV2$$module$src$api$v2$implementation$ApiSceneImplementationV2_1.scene.EVENTTYPE;this.INTERACTIONMODETYPE=ApiInterfaceV2$$module$src$api$v2$implementation$ApiSceneImplementationV2_1.scene.INTERACTIONMODETYPE;this.SELECTIONMODETYPE=ApiInterfaceV2$$module$src$api$v2$implementation$ApiSceneImplementationV2_1.scene.SELECTIONMODETYPE;
   this.TRANSFORMATIONTYPE=ApiInterfaceV2$$module$src$api$v2$implementation$ApiSceneImplementationV2_1.scene.TRANSFORMATIONTYPE;this.LIVETRANSFORMATIONTYPE=ApiInterfaceV2$$module$src$api$v2$implementation$ApiSceneImplementationV2_1.scene.LIVETRANSFORMATIONTYPE;var d=a.sceneManager,e=a.viewportManager,g=a.sceneGeometryManager,h=a.interactionGroupManager,f=a.messagingHandler;c.lights=e.api.lights;c.camera=e.api.camera;this.updateAsync=function(a,e,g,h){Array.isArray(a)||(a=[a]);var k=e||b.getRuntimeId(),
   l=[],m=[];a=$jscomp.makeIterator(a);for(e=a.next();!e.done;e=a.next()){var n=e.value;if(!n||!n.id)return Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Asset without id property",null,g));m.push(n.id);e=module$src$shared$util$GlobalUtils.default.deepCopy(n,["canvas","threeObject","transformations"]);if(n=d.getJSONOutputVersion(n.id,k,!1)){var r=Object.keys(n);r=$jscomp.makeIterator(r);for(var v=r.next();!v.done;v=r.next())v=v.value,e.hasOwnProperty(v)||"version"===v||(e[v]=n[v])}e.hasOwnProperty("version")||
   (e.version=module$src$shared$util$GlobalUtils.default.createRandomId());l.push(e)}var w=module$src$shared$constants$MessagingConstants.default.makeMessageToken();w.payload=g;return(new Promise(function(a,b){h||(h={});h.busy||(h.busy=!1);var e=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_STATUS,{busy:h.busy,progress:0},w);f.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,
   e);if(d.initSubScene(l.length,k,w)){e=[];for(var g=$jscomp.makeIterator(l),n=g.next();!n.done;n=g.next())e.push(d.addJSONOutputVersionToSubScene(n.value,k,w));return Promise.all(e).then(function(){for(var e=[],f={},g=$jscomp.makeIterator(m),h=g.next();!h.done;f={asset$319:f.asset$319},h=g.next())f.asset$319=d.getJSONOutputVersion(h.value,k,!0),f.asset$319&&(f.asset$319.addEventListener=function(a){return function(b,d){if(!module$src$shared$util$GlobalUtils.default.typeCheck(b,"string")||0>=b.length)return(0,module$src$api$v2$ApiResponse.default)("Event type must be a string");
   var e=b;b.endsWith(a.asset$319.scenePath)||(e=b+"."+a.asset$319.scenePath);return c.addEventListener(e,d)}}(f),e.push(f.asset$319));e.length==m.length?a(e):b("Failed to publish all assets, unknown error.")},function(a){b(a)})}b(Error("Could not initialize subscene."))})).then(function(a){return(0,module$src$api$v2$ApiResponse.default)(null,a,g)},function(a){return Promise.resolve((0,module$src$api$v2$ApiResponse.default)(a,null,g))})};this.get=function(a,c,e){a=a||{};"object"!==typeof a&&(a={});var f=
   [];f=module$src$shared$util$GlobalUtils.default.typeCheck(c,"string")?[c]:[b.getRuntimeId()];c=[];f=$jscomp.makeIterator(f);for(var g=f.next();!g.done;g=f.next()){g=g.value;var h=a.hasOwnProperty("id")?[a.id]:d.getOutputIds(g);h=$jscomp.makeIterator(h);for(var k=h.next();!k.done;k=h.next()){k=d.getJSONOutputVersion(k.value,g,e);if(null===k)return(0,module$src$api$v2$ApiResponse.default)(void 0,[]);c.push(k)}}f=Object.keys(a);e={};f=$jscomp.makeIterator(f);for(g=f.next();!g.done;e={f:e.f},g=f.next())e.f=
   g.value,c=c.filter(function(b){return function(c){return c[b.f]===a[b.f]}}(e));return(0,module$src$api$v2$ApiResponse.default)(null,c)};this.getData=function(a,b){a=module$src$shared$util$GlobalUtils.default.deepCopy(a);module$src$shared$util$GlobalUtils.default.typeCheck(b,"string")&&(a.plugin=b);b=d.getModelData(a);return(0,module$src$api$v2$ApiResponse.default)(null,b)};this.convertTo2D=function(a){return e.api.convertTo2D(a)};this.getBoundingBox=function(a){return a&&!module$src$shared$util$GlobalUtils.default.typeCheck(a,
   "string")?(0,module$src$api$v2$ApiResponse.default)("Path must be a string."):(a=g.getBoundingBox(a))?(0,module$src$api$v2$ApiResponse.default)(null,a):(0,module$src$api$v2$ApiResponse.default)("No Object was found at this path.")};this.setTransformation=function(a,c,d){if("number"===typeof d[0]||d.isMatrix4){if(!module$src$shared$util$GlobalUtils.default.typeCheck(d,"matrix4x4arr")&&!d.isMatrix4)return(0,module$src$api$v2$ApiResponse.default)("The provided matrix is not valid.")}else for(var f=0,
   h=d.length;f<h;f++)if(null!==d[f]&&!module$src$shared$util$GlobalUtils.default.typeCheck(d[f],"matrix4x4arr")&&!d[f].isMatrix4)return(0,module$src$api$v2$ApiResponse.default)("At least one provided matrix is not valid.");if(a===this.TRANSFORMATIONTYPE.PLUGIN){a=b.plugins.get().data;if(c){f=!1;var k=0;for(h=a.length;k<h;k++)a[k].id===c&&(g.setPluginTransformation(c,d),f=!0);if(!f)return(0,module$src$api$v2$ApiResponse.default)("Plugin with id "+c+" does not exist.")}else for(c=0,h=a.length;c<h;c++)g.setPluginTransformation(a[c].id,
   d);e.api.updateShadowMap();e.api.render()}else if(a===this.TRANSFORMATIONTYPE.VIEWPORT)e.api.setTransformation(c,d);else return(0,module$src$api$v2$ApiResponse.default)('Invalid transformation type. Types: "plugin", "viewport"');return(0,module$src$api$v2$ApiResponse.default)(null,!0)};this.getTransformation=function(a,c){if(a===this.TRANSFORMATIONTYPE.PLUGIN){a=b.plugins.get().data;if(c){for(var d=0,f=a.length;d<f;d++)if(a[d].id===c){a=g.getPluginTransformation(c);f=[];d=0;for(c=a.length;d<c;d++)f[d]=
   a[d].transpose().elements;return(0,module$src$api$v2$ApiResponse.default)(null,1===f.length?f[0]:f)}return(0,module$src$api$v2$ApiResponse.default)("Plugin with id "+c+" does not exist.")}if(1==a.length){a=g.getPluginTransformation(a[0].id);f=[];d=0;for(c=a.length;d<c;d++)f[d]=a[d].transpose().elements;return(0,module$src$api$v2$ApiResponse.default)(null,1===f.length?f[0]:f)}d=0;for(f=a.length;d<f;d++){var h=g.getPluginTransformation(a[d].id),k=0;for(c=h.length;k<c;k++)h[k].transpose()}return(0,module$src$api$v2$ApiResponse.default)(null,
   void 0)}return a===this.TRANSFORMATIONTYPE.VIEWPORT?(0,module$src$api$v2$ApiResponse.default)(null,e.api.getTransformation(c)):(0,module$src$api$v2$ApiResponse.default)('Invalid transformation type. Types: "plugin", "viewport"')};this.applyTransformation=function(a,c,d){if("number"===typeof d[0]||d.isMatrix4){if(!module$src$shared$util$GlobalUtils.default.typeCheck(d,"matrix4x4arr")&&!d.isMatrix4)return(0,module$src$api$v2$ApiResponse.default)("The provided matrix is not valid.")}else for(var f=0,
   h=d.length;f<h;f++)if(null!==d[f]&&!module$src$shared$util$GlobalUtils.default.typeCheck(d[f],"matrix4x4arr")&&!d[f].isMatrix4)return(0,module$src$api$v2$ApiResponse.default)("At least one provided matrix is not valid.");if(a===this.TRANSFORMATIONTYPE.PLUGIN){a=b.plugins.get().data;if(c){f=!1;var k=0;for(h=a.length;k<h;k++)a[k].id===c&&(g.applyPluginTransformation(c,d),f=!0);if(!f)return(0,module$src$api$v2$ApiResponse.default)("Plugin with id "+c+" does not exist.")}else for(c=0,h=a.length;c<h;c++)g.applyPluginTransformation(a[c].id,
   d);e.api.updateShadowMap();e.api.render()}else if(a===this.TRANSFORMATIONTYPE.VIEWPORT)e.api.applyTransformation(c,d);else return(0,module$src$api$v2$ApiResponse.default)('Invalid transformation type. Types: "plugin", "viewport"');return(0,module$src$api$v2$ApiResponse.default)(null,!0)};this.resetTransformation=function(a,c){if(a===this.TRANSFORMATIONTYPE.PLUGIN){a=b.plugins.get().data;if(c){for(var d=!1,f=0,h=a.length;f<h;f++)a[f].id===c&&(g.resetPluginTransformation(c),d=!0);if(!d)return(0,module$src$api$v2$ApiResponse.default)("Plugin with id "+
   c+" does not exist.")}else for(c=0,h=a.length;c<h;c++)g.resetPluginTransformation(a[c].id);e.api.updateShadowMap();e.api.render()}else if(a===this.TRANSFORMATIONTYPE.VIEWPORT)e.api.resetTransformation(c);else return(0,module$src$api$v2$ApiResponse.default)('Invalid transformation type. Types: "plugin", "viewport"');return(0,module$src$api$v2$ApiResponse.default)(null,!0)};this.setLiveTransformation=function(a,d,f){if(d&&!module$src$shared$util$GlobalUtils.default.typeCheck(d,"string")&&!Array.isArray(d))return(0,module$src$api$v2$ApiResponse.default)("The provided viewports is not of type array or string, but also not null.");
   module$src$shared$util$GlobalUtils.default.typeCheck(d,"string")&&!Array.isArray(d)&&(d=[d]);d||(d=[],e.getApis().forEach(function(a){d.push(a.getViewportRuntimeId())}));if(f&&!module$src$shared$util$GlobalUtils.default.typeCheck(f,"notnegative"))return(0,module$src$api$v2$ApiResponse.default)("The provided duration is not a valid number.");f||(f=Infinity);a=Array.isArray(a)?a:[a];if(0===a.length)return(0,module$src$api$v2$ApiResponse.default)("No live transformations were provided.");for(var h=0,
   k=a.length;h<k;h++){var l=a[h];if(!l.scenePaths)return(0,module$src$api$v2$ApiResponse.default)("No scene paths provided.");Array.isArray(l.scenePaths)||(l.scenePaths=[l.scenePaths]);for(var m=0,t=l.scenePaths.length;m<t;m++)if(!module$src$shared$util$GlobalUtils.default.typeCheck(l.scenePaths[m],"string"))return(0,module$src$api$v2$ApiResponse.default)("One of the provided scenePaths of a live transformation is not of valid type.");if(!l.transformations)return(0,module$src$api$v2$ApiResponse.default)("No live transformations provided.");
   Array.isArray(l.transformations)||(l.transformations=[a]);if(0===l.transformations.length)return(0,module$src$api$v2$ApiResponse.default)("One of the provided live transformations does not have any transformations.");m=0;for(t=l.transformations.length;m<t;m++){var r=l.transformations[m];if(!module$src$shared$util$GlobalUtils.default.typeCheck(r.type,"string")||r.type!==c.LIVETRANSFORMATIONTYPE.ROTATION&&r.type!==c.LIVETRANSFORMATIONTYPE.TRANSLATION&&r.type!==c.LIVETRANSFORMATIONTYPE.SCALING)return(0,module$src$api$v2$ApiResponse.default)("No valid transformation type provided for at least one of the live transformations.");
   if(!module$src$shared$util$GlobalUtils.default.typeCheck(r.duration,"notnegative"))return(0,module$src$api$v2$ApiResponse.default)("No valid duration provided for at least one of the live transformations.");module$src$shared$util$GlobalUtils.default.typeCheck(r.delay,"notnegative")||(r.delay&&b.warn("setLiveTransformation","The value "+r.delay+" is not a valid input for the delay. It is set to the default (0)."),r.delay=0);module$src$shared$util$GlobalUtils.default.typeCheck(r.repeat,"notnegative")||
   (r.repeat&&b.warn("setLiveTransformation","The value "+r.repeat+" is not a valid input for the repeat. It is set to the default (0)."),r.repeat=0);module$src$shared$util$GlobalUtils.default.typeCheck(r.yoyo,"boolean")||(r.yoyo&&b.warn("setLiveTransformation","The value "+r.yoyo+" is not a valid input for the yoyo. It is set to the default (false)."),r.yoyo=!1);module$src$shared$util$GlobalUtils.default.typeCheck(r.parent,"string")?g.getBoundingBox(r.parent)||(b.warn("setLiveTransformation","The value "+
   r.parent+" is not a valid path to a parent. It is set to the default (null)."),r.parent=null):(r.parent&&b.warn("setLiveTransformation","The value "+r.parent+" is not a valid input for the parent. It is set to the default (null)."),r.parent=null);r.easing?module$src$shared$util$GlobalUtils.default.typeCheck(r.easing,"string")?(r.easing=module$src$shared$util$GlobalUtils.default.getAtPath(module$node_modules$$tweenjs$tween_js$src$Tween.default.Easing,r.easing),r.easing||(b.warn("setLiveTransformation",
   "The value "+r.easing+" is not a valid input for the easing. It is set to the default (Linear.None)."),r.easing=module$node_modules$$tweenjs$tween_js$src$Tween.default.Easing.Linear.None)):module$src$shared$util$GlobalUtils.default.typeCheck(r.easing,"function")||r.easing||(b.warn("setLiveTransformation","The value "+r.easing+" is not a valid input for the easing. It is set to the default (Linear.None)."),r.easing=module$node_modules$$tweenjs$tween_js$src$Tween.default.Easing.Linear.None):r.easing=
   module$node_modules$$tweenjs$tween_js$src$Tween.default.Easing.Linear.None;module$src$shared$util$GlobalUtils.default.typeCheck(r.pivot,"vector3any")||(r.pivot&&b.warn("setLiveTransformation","The value "+r.pivot+" is not a valid input for the pivot. It is set to the default (null)."),r.pivot=null);if(!module$src$shared$util$GlobalUtils.default.typeCheck(r.rotationAxis,"vector3any")&&r.type===c.LIVETRANSFORMATIONTYPE.ROTATION)return(0,module$src$api$v2$ApiResponse.default)("No valid rotationAxis provided for at least one of the live transformations with type ROTATION.");
   if(!module$src$shared$util$GlobalUtils.default.typeCheck(r.rotationDegree,"number")&&r.type===c.LIVETRANSFORMATIONTYPE.ROTATION)return(0,module$src$api$v2$ApiResponse.default)("No valid rotationDegree provided for at least one of the live transformations with type ROTATION.");if(!module$src$shared$util$GlobalUtils.default.typeCheck(r.scalingVector,"vector3any")&&r.type===c.LIVETRANSFORMATIONTYPE.SCALING)return(0,module$src$api$v2$ApiResponse.default)("No valid scalingVector provided for at least one of the live transformations with type SCALING.");
   if(!module$src$shared$util$GlobalUtils.default.typeCheck(r.translationVector,"vector3any")&&r.type===c.LIVETRANSFORMATIONTYPE.TRANSLATION)return(0,module$src$api$v2$ApiResponse.default)("No valid translationVector provided for at least one of the live transformations with type TRANSLATION.")}module$src$shared$util$GlobalUtils.default.typeCheck(l.reset,"boolean")||(l.reset&&b.warn("setLiveTransformation","The value "+l.reset+" is not a valid input for the reset. It is set to the default (true)."),
   l.reset=!0)}h=[];l={};t=0;for(m=d.length;t<m;l={stops:l.stops},t++){r=[];l.stops=[];var v=[],w=e.api.setLiveTransformation(d[t],a,f),y=0;for(k=w.length;y<k;y++)r.push({stop:w[y].stop,promise:w[y].promise}),l.stops.push(w[y].stop),v.push(w[y].promise);h.push({responses:r,stop:function(a){return function(b){for(var c=0,d=a.stops.length;c<d;c++)a.stops[c](b)}}(l),promise:Promise.all(v)})}return(0,module$src$api$v2$ApiResponse.default)(null,1===h.length?h[0]:h)};this.getScreenshot=function(){return e.api.getScreenshot()};
   this.getScreenshotAsync=function(){return e.api.getScreenshotAsync()};this.updateSelected=function(a,b){return e.api.updateSelected(a,b)};this.getSelected=function(){return e.api.getSelected()};this.startExternalDragEvent=function(a,b){return e.api.startExternalDragEvent(a,b)};this.removeAsync=function(a,e,f){e=e||b.getRuntimeId();var g=c.get(a,e,!0);g.payload=f;if(g.err)return g;a=[];for(var h=$jscomp.makeIterator(g.data),k=h.next();!k.done;k=h.next())a.push(k.value.id);return d.removeOutputIds(e,
   a).then(function(){return(0,module$src$api$v2$ApiResponse.default)(null,g.data,f)},function(a){return Promise.resolve((0,module$src$api$v2$ApiResponse.default)(a,null,f))})};this.updatePersistentAsync=function(a,c,e){Array.isArray(a)||(a=[a]);c=c||b.getRuntimeId();var f=[];a=$jscomp.makeIterator(a);for(var g=a.next();!g.done;g=a.next()){g=g.value;if(void 0===g||"object"!==typeof g)return Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Unexpected asset format",null,e));if(!g.hasOwnProperty("id"))return Promise.resolve((0,module$src$api$v2$ApiResponse.default)('Asset does not have "id" attribute.',
   null,e));f.push(d.setPersistentAttributes(g.id,c,g))}return Promise.all(f).then(function(a){return(0,module$src$api$v2$ApiResponse.default)(null,a,e)}).catch(function(a){return Promise.resolve((0,module$src$api$v2$ApiResponse.default)(a,null,e))})};this.getPersistent=function(a,e){e=e||b.getRuntimeId();var f=c.get(a,e,!1);if(f.err)return f;a=[];f=$jscomp.makeIterator(f.data);for(var g=f.next();!g.done;g=f.next())(g=d.getPersistentAttributes(g.value.id,e))&&a.push(g);return(0,module$src$api$v2$ApiResponse.default)(null,
   a)};this.updateInteractionGroups=function(a){Array.isArray(a)||(a=[a]);var b={};a=$jscomp.makeIterator(a);for(var c=a.next();!c.done;b={g:b.g,group:b.group},c=a.next()){b.group=c.value;if(!b.group||!b.group.id)return(0,module$src$api$v2$ApiResponse.default)("Interaction group without id property");b.g={};["hoverable","selectable","draggable"].forEach(function(a){return function(b){a.g[b]=a.group[b]||!1}}(b));b.group.selectionMode&&(b.g.selectionMode=b.group.selectionMode);b.g.name=b.group.id;c=function(a){var b=
   ["active","passive"],c;for(c in b)if(b=a[c]){if("object"!==typeof b)return"Effect has invalid type. Should be object.";if(!b.name)return"Effect has no name property.";if(-1==["colorHighlight","opacityHighlight"].indexOf(b.name))return"Invalid effect type name."}};if(b.g.hoverable&&b.group.hoverEffect){var d=c(b.group.hoverEffect);if(d)return(0,module$src$api$v2$ApiResponse.default)(d);b.g.hoverableHighlight=b.group.hoverEffect}if(b.g.selectable&&b.group.selectionEffect){if(d=c(b.group.selectionEffect))return(0,module$src$api$v2$ApiResponse.default)(d);
   b.g.selectableHighlight=b.group.selectionEffect}if(b.g.draggable&&b.group.dragEffect){if(c=c(b.group.dragEffect))return(0,module$src$api$v2$ApiResponse.default)(c);b.g.draggableHighlight=b.group.dragEffect}h.isInteractionGroup(b.g.name)&&(c=h.getGroup(b.g.name),b.g.hasOwnProperty("hoverable")||(b.g.hoverable=c.isHoverable()),b.g.hasOwnProperty("selectable")||(b.g.selectable=c.isSelectable()),b.g.hasOwnProperty("selectionMode")||(b.g.selectionMode=c.getSelectionMode()),b.g.hasOwnProperty("draggable")||
   (b.g.draggable=c.isDraggable()),b.g.hasOwnProperty("hoverEffect")||(b.g.hoverEffect=c.getHoverableHighlight()),b.g.hasOwnProperty("selectionEffect")||(b.g.selectionEffect=c.getSelectableHighlight()),b.g.hasOwnProperty("dragEffect")||(b.g.dragEffect=c.getDraggableHighlight()));h.addOrReplaceInteractionGroup(b.g)}return(0,module$src$api$v2$ApiResponse.default)(null,!0)};this.getInteractionGroups=function(){var a=h.getGroups(),b=[],c={};a=$jscomp.makeIterator(a);for(var d=a.next();!d.done;c={g:c.g},
   d=a.next())d=d.value,c.g={},c.g.id=d.getName(),c.g.hoverable=d.isHoverable(),c.g.selectable=d.isSelectable(),c.g.selectionMode=d.getSelectionMode(),c.g.draggable=d.isDraggable(),c.g.hoverEffect=d.getHoverableHighlight(),c.g.selectionEffect=d.getSelectableHighlight(),c.g.dragEffect=d.getDraggableHighlight(),["dragEffect","hoverEffect","selectionEffect"].forEach(function(a){return function(b){if(a.g[b]){var c=a.g[b],d={};["active","passive"].forEach(function(a){if(c[a]&&(d[a]={name:c[a].name},c[a].options&&
   (d[a].options={},d[a].options.opacity&&(d[a].options.opacity=c[a].options.opacity),c[a].options.color))){var b=c[a].options.color;["r","g","b"].every(function(a){return b.hasOwnProperty(a)})&&(d[a].options.color=[255*b.r,255*b.g,255*b.b])}});a.g[b]=d}}}(c)),b.push(c.g);return(0,module$src$api$v2$ApiResponse.default)(null,b)};this.addEventListener=function(a,d){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")||0>=a.length)return(0,module$src$api$v2$ApiResponse.default)("Event type must be a string");
   var e;if(!Object.keys(c.EVENTTYPE).find(function(b){b=c.EVENTTYPE[b];return a.startsWith(b)?(e=b,!0):!1}))return(0,module$src$api$v2$ApiResponse.default)("Unsupported event type");var f=b.subscribeToMessageStream(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE+"."+a,function(a,b){a=new CustomEvent(e);a.api=b.api;b.token&&(a.token=b.token);var c={};c[module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION]=null;c[module$src$shared$constants$MessagingConstants.default.messageDataTypes.GENERIC]=
   null;c[module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_ANCHORDATA]=null;c[module$src$shared$constants$MessagingConstants.default.messageDataTypes.SUBSCENE_UPDATE]={assets:1};for(var f in c){var g=b.getUniquePartByType(f);if(g){g.data&&(g=g.data);var h=c[f]?c[f]:g,k;for(k in h)a[k]=g[k]}}d(a)});return(0,module$src$api$v2$ApiResponse.default)(null,f)};this.removeEventListener=function(a){return(0,module$src$api$v2$ApiResponse.default)(null,b.unsubscribeFromMessageStream(a))};
   this.render=function(){return e.api.render()};this.updateShadowMap=function(){return e.api.updateShadowMap()};this.startContinuousRendering=function(){return e.api.startContinuousRendering()};this.stopContinuousRendering=function(){return e.api.stopContinuousRendering()};this.pause=function(){return e.api.pause()};this.resume=function(){return e.api.resume()};this.toggleGeometry=function(a,b){return e.api.toggleGeometry(a,b)};this.getViewportRuntimeId=function(){return e.api.getViewportRuntimeId()};
   this.getContainer=function(a){return e.api.getContainer(a)}};var module$src$api$v2$implementation$ApiStateImplementationV2_1={},messagingConstants$$module$src$api$v2$implementation$ApiStateImplementationV2_1=module$src$shared$constants$MessagingConstants.default,ApiInterfaceV2$$module$src$api$v2$implementation$ApiStateImplementationV2_1=new module$src$api$v2$ApiInterfaceV2_1.default,APIResponse$$module$src$api$v2$implementation$ApiStateImplementationV2_1=module$src$api$v2$ApiResponse.default;
   module$src$api$v2$implementation$ApiStateImplementationV2_1.default=function(b,a){var c=this;this.EVENTTYPE=ApiInterfaceV2$$module$src$api$v2$implementation$ApiStateImplementationV2_1.state.EVENTTYPE;var d=a.messagingHandler,e=a.processStatusHandler;this.get=function(){var a=e.getSummary();a.failedStatusMessages=d.getFailedStatusMessages();return(0,module$src$api$v2$ApiResponse.default)(null,a)};this.setBusy=function(a,c){var d={};if(c){if("number"!==typeof c||0>c||1<c)return(0,module$src$api$v2$ApiResponse.default)("progess must be a number between 0 and 1",
   e.getSummary());d.progress=c}else d.progress=0;a?(d.busy=!0,e.updateProcessStatus(b.getRuntimeId(),d)):e.unregisterProcess(b.getRuntimeId());return this.get()};this.addEventListener=function(a,d){if(!Object.keys(c.EVENTTYPE).find(function(b){return c.EVENTTYPE[b]===a}))return(0,module$src$api$v2$ApiResponse.default)("Unsupported event type");var e=b.subscribeToMessageStream(module$src$shared$constants$MessagingConstants.default.messageTopics.STATUS+"."+a,function(b,c){b=new CustomEvent(a);b.api=c.api;
   c.token&&(b.token=c.token);var e={};e[module$src$shared$constants$MessagingConstants.default.messageDataTypes.APP_STATUS]={progress:1};e[module$src$shared$constants$MessagingConstants.default.messageDataTypes.STATUS_MESSAGE]=null;for(var f in e){var g=c.getUniquePartByType(f);if(g){g.data&&(g=g.data);var h=e[f]?e[f]:g,k;for(k in h)b[k]=g[k]}}d(b)});return(0,module$src$api$v2$ApiResponse.default)(null,e)};this.removeEventListener=function(a){return(0,module$src$api$v2$ApiResponse.default)(null,b.unsubscribeFromMessageStream(a))}};var module$src$api$v2$implementation$ApiViewportsImplementationV2_1={},messagingConstants$$module$src$api$v2$implementation$ApiViewportsImplementationV2_1=module$src$shared$constants$MessagingConstants.default,GlobalUtils$$module$src$api$v2$implementation$ApiViewportsImplementationV2_1=module$src$shared$util$GlobalUtils.default,ApiInterfaceV2$$module$src$api$v2$implementation$ApiViewportsImplementationV2_1=new module$src$api$v2$ApiInterfaceV2_1.default,APIResponse$$module$src$api$v2$implementation$ApiViewportsImplementationV2_1=
   module$src$api$v2$ApiResponse.default;
   module$src$api$v2$implementation$ApiViewportsImplementationV2_1.default=function(b,a){var c=this,d=a.viewportManager;this.EVENTTYPE=ApiInterfaceV2$$module$src$api$v2$implementation$ApiViewportsImplementationV2_1.viewports.EVENTTYPE;this.get=function(a){return a?module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")?(a=d.getApi(a))?a:(0,module$src$api$v2$ApiResponse.default)("The requested api was not found"):(0,module$src$api$v2$ApiResponse.default)("The provided input is not a valid runtimeId"):1===
   d.getApis().length?d.getApis()[0]:d.getApis()};this.create=function(a){return d.createThreeDManager(a)[0]};this.destroy=function(a){return d.removeThreeDManager(a)};this.addEventListener=function(a,d){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")||0>=a.length)return(0,module$src$api$v2$ApiResponse.default)("Event type must be a string");if(!Object.keys(c.EVENTTYPE).find(function(b){return c.EVENTTYPE[b]===a}))return(0,module$src$api$v2$ApiResponse.default)("Unsupported event type");
   var e=b.subscribeToMessageStream(module$src$shared$constants$MessagingConstants.default.messageTopics.VIEWPORTS+"."+a,function(b,c){b=new CustomEvent(a);b.api=c.api;c.token&&(b.token=c.token);var e={};e[module$src$shared$constants$MessagingConstants.default.messageDataTypes.GENERIC]=null;for(var f in e){var g=c.getUniquePartByType(f);if(g){g.data&&(g=g.data);var h=e[f]?e[f]:g,k;for(k in h)b[k]=g[k]}}d(b)});return(0,module$src$api$v2$ApiResponse.default)(null,e)};this.removeEventListener=function(a){return(0,module$src$api$v2$ApiResponse.default)(null,
   b.unsubscribeFromMessageStream(a))}};var module$src$api$v2$ApiImplementationV2_1={},messagingConstants$$module$src$api$v2$ApiImplementationV2_1=module$src$shared$constants$MessagingConstants.default,GlobalUtils$$module$src$api$v2$ApiImplementationV2_1=module$src$shared$util$GlobalUtils.default,ApiInterfaceV2$$module$src$api$v2$ApiImplementationV2_1=new module$src$api$v2$ApiInterfaceV2_1.default,APIResponse$$module$src$api$v2$ApiImplementationV2_1=module$src$api$v2$ApiResponse.default,Settings$$module$src$api$v2$ApiImplementationV2_1=
   module$node_modules$shapedivernodemodule_viewersettings$bundle.default.Settings_2_0,ExportApi$$module$src$api$v2$ApiImplementationV2_1=module$src$api$v2$implementation$ApiExportImplementationV2_1.default,ParameterApi$$module$src$api$v2$ApiImplementationV2_1=module$src$api$v2$implementation$ApiParameterImplementationV2_1.default,PluginApi$$module$src$api$v2$ApiImplementationV2_1=module$src$api$v2$implementation$ApiPluginImplementationV2_1.default,SceneApi$$module$src$api$v2$ApiImplementationV2_1=module$src$api$v2$implementation$ApiSceneImplementationV2_1.default,
   StateApi$$module$src$api$v2$ApiImplementationV2_1=module$src$api$v2$implementation$ApiStateImplementationV2_1.default,ViewportsApi$$module$src$api$v2$ApiImplementationV2_1=module$src$api$v2$implementation$ApiViewportsImplementationV2_1.default;
   module$src$api$v2$ApiImplementationV2_1.default=function(b,a){var c=this,d=module$src$shared$util$GlobalUtils.default.deepCopy(a);d.runtimeId&&module$src$shared$util$GlobalUtils.default.typeCheck(d.runtimeId,"string")||(d.runtimeId=module$src$shared$util$GlobalUtils.default.createRandomId());this.EVENTTYPE=ApiInterfaceV2$$module$src$api$v2$ApiImplementationV2_1.EVENTTYPE;this.getRuntimeId=function(){return d.runtimeId};var e=b.app,g=b.exportHandler,h=b.messagingHandler,f=b.parameterHandler,k=b.pluginHandler,
   l=b.processStatusHandler,m=b.sceneManager,n=b.settingsHandler,q=b.viewportManager,p=b.sceneGeometryManager,u=b.interactionGroupManager;a=b.arApi;var t=/^scene\./;module$src$shared$util$GlobalUtils.default.inject(b.loggingHandler,c);var r={};this.clearProcessCallback=function(a){if(!r.hasOwnProperty(a))return!1;h.unsubscribeFromMessageStream(r[a].subToken);delete r[a];return!0};this.setProcessCallback=function(a,b){if(!r.hasOwnProperty(a)){var d=h.subscribeToMessageStream(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS+
   "."+a,function(d,e){var f=d.substring(d.indexOf(".")+1);if(r.hasOwnProperty(a)){var g=r[a],h=e.getUniquePartByType(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_FORK);if(h&&Array.isArray(h.data)){if(h.data.every(function(b){return b.startsWith(a+".")})){var k=g.procTokens;k=k.splice(k.indexOf(f),1);k=k.concat(h.data);g.procTokens=k}else c.error("ApiImplementationV2.setProcessCallback","Forked process token must be a sub-token of "+a);try{b(d,e)}catch(I){c.error("ApiImplementationV2.setProcessCallback",
   "Exception in process callback:",I)}}else{h=e.getUniquePartByType(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR);k=e.getUniquePartByType(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT);var l=e.getUniquePartByType(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS);h?g.procTokenStat[f]=module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR:k?g.procTokenStat[f]=
   module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT:l&&(g.procTokenStat[f]=module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS);g.procTokens.every(function(a){return g.procTokenStat.hasOwnProperty(a)})&&(c.debug("ApiImplementationV2.setProcessCallback","Clearing process callback for token "+a),c.clearProcessCallback(a));try{b(d,e)}catch(I){c.error("ApiImplementationV2.setProcessCallback","Exception in process callback:",I)}}}else c.warn("ApiImplementationV2.setProcessCallback",
   "Message for unknown token:",e)});r[a]={subToken:d,procTokens:[a],procTokenStat:{}};return a}};this.subscribeToMessageStream=function(a,b){return h.subscribeToMessageStream(a,function(a,d){try{d=d||{},d.api=c,b(a,d)}catch(J){c.warn("ApiImplementationV2.subscribeToMessageStream","Exception in callback for topic "+a,J,d)}})};this.unsubscribeFromMessageStream=function(a){return h.unsubscribeFromMessageStream(a)};this.state=new module$src$api$v2$implementation$ApiStateImplementationV2_1.default(c,{processStatusHandler:l,
   messagingHandler:h});this.parameters=new module$src$api$v2$implementation$ApiParameterImplementationV2_1.default(c,{parameterHandler:f,messagingHandler:h});this.plugins=new module$src$api$v2$implementation$ApiPluginImplementationV2_1.default(c,{pluginHandler:k,messagingHandler:h,parameterHandler:f});this.exports=new module$src$api$v2$implementation$ApiExportImplementationV2_1.default(c,{exportHandler:g});this.viewports=new module$src$api$v2$implementation$ApiViewportsImplementationV2_1.default(c,
   {viewportManager:q});this.scene=new module$src$api$v2$implementation$ApiSceneImplementationV2_1.default(c,{sceneManager:m,viewportManager:q,sceneGeometryManager:p,interactionGroupManager:u,messagingHandler:h});b=(new module$node_modules$shapedivernodemodule_viewersettings$bundle.default.Settings_2_0).getSettingDefinitions();var v={},w;for(w in b)if(w.startsWith("viewer.")&&!w.startsWith("viewer.scene."))v[w.replace("viewer.","")]=b[w];else if(w.startsWith("ar.")||w.startsWith("defaultMaterial."))v[w]=
   b[w];var y=new module$node_modules$shapedivernodemodule_viewersettings$bundle.default.Settings_2_0;delete y.settings.viewer.scene;delete y.settings.parameters;this.addEventListener=function(a,b){if(!Object.keys(c.EVENTTYPE).find(function(b){return c.EVENTTYPE[b]===a}))return(0,module$src$api$v2$ApiResponse.default)("Unsupported event type");var d=c.subscribeToMessageStream(a,function(d,e){d=new CustomEvent(a);d.api=e.api;e.token&&(d.token=e.token);if(e=e.getUniquePartByType(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SETTINGS_UPDATE)){e.data&&
   (e=e.data);d.settings={};var f=d.settings;q.api.getViewportRuntimeId().includes(e.namespace)?(f.key=e.key,f.runtimeId=e.namespace,f.namespace="scene"):"app"===e.namespace&&void 0!==v[e.key]&&(f.key=e.key,f.runtimeId=c.getRuntimeId());f.key&&(f.valueNew=e.valueNew,f.valueOld=e.valueOld,b(d))}else b(d)});return(0,module$src$api$v2$ApiResponse.default)(null,d)};this.removeEventListener=function(a){return(0,module$src$api$v2$ApiResponse.default)(null,c.unsubscribeFromMessageStream(a))};this.getSettingDefinitions=
   function(){var a=(new module$node_modules$shapedivernodemodule_viewersettings$bundle.default.Settings_2_0).getSettingDefinitions(),b={},c;for(c in a)c.startsWith("viewer.")?b[c.replace("viewer.","")]=a[c]:c.startsWith("parameters.")?b[c.replace("parameters.","")]=a[c]:b[c]=a[c];return b};this.getSettings=function(a){if(!Array.isArray(a)){a=Object.keys(c.getSettingDefinitions());for(var b=Object.keys(q.api.getSettingDefinitions()),d=0,f=b.length;d<f;d++){var g="scene."+b[d];a.includes(g)||a.push(g)}}var h=
   {};a.forEach(function(a){var b=a;a.startsWith("ar")||a.startsWith("defaultMaterial")||(b="viewer."+b);void 0!==y.getSettingObject(b)?(b=e.getSetting(a),module$src$shared$util$GlobalUtils.default.forceAtPath(h,a,b)):(b=q.api.getSetting(a.replace(t,"")),void 0!==b&&module$src$shared$util$GlobalUtils.default.forceAtPath(h,a,b))});return h};this.getSetting=function(a){var b=a;a.startsWith("ar")||a.startsWith("defaultMaterial")||(b="viewer."+b);return void 0===y.getSettingObject(b)?q.api.getSetting(a.replace(t,
   "")):e.getSetting(a)};this.updateSettingAsync=function(a,b){if("scene.show"===a)return e.updateSettingAsync("show",b);var c=a;a.startsWith("ar")||a.startsWith("defaultMaterial")||(c="viewer."+c);c=y.getSettingObject(c);if(void 0===c)return q.api.updateSettingAsync(a.replace(t,""),b);if(void 0!==c.type&&null!==c.type)if(module$src$shared$util$GlobalUtils.default.typeCheck(c.type,"string")){if(!module$src$shared$util$GlobalUtils.default.typeCheck(b,c.type))return Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Setting has wrong value type",
   !1))}else if("function"===typeof c.type&&!c.type(b))return Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Setting has wrong value type",!1));return e.updateSettingAsync(a,b).then(function(a){return a?Promise.resolve((0,module$src$api$v2$ApiResponse.default)(null,!0)):Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Update of setting failed",!1))},function(){return Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Update of setting failed",!1))})};this.updateSettingsAsync=
   function(a){var b=[];module$src$shared$util$GlobalUtils.default.getPaths(a,b);for(var d={i:0};d.i<b.length;d={i:d.i},d.i++)if(b[d.i].endsWith(".x")||b[d.i].endsWith(".y")||b[d.i].endsWith(".z"))b[d.i]=b[d.i].substring(0,b[d.i].length-2),b=b.filter(function(a){return function(c){return!(c.startsWith(b[a.i])&&b[a.i].length+2===c.length)}}(d));var e={};d=Promise.resolve();for(var f={},g=$jscomp.makeIterator(b),h=g.next();!h.done;f={path:f.path},h=g.next())f.path=h.value,d=d.then(function(b){return function(){return c.updateSettingAsync(b.path,
   module$src$shared$util$GlobalUtils.default.getAtPath(a,b.path))}}(f)),d=d.then(function(a){return function(b){b.err?module$src$shared$util$GlobalUtils.default.forceAtPath(e,a.path,!1):module$src$shared$util$GlobalUtils.default.forceAtPath(e,a.path,!0)}}(f),function(a){return function(){module$src$shared$util$GlobalUtils.default.forceAtPath(e,a.path,!1)}}(f));return d.then(function(){return(0,module$src$api$v2$ApiResponse.default)(null,e)})};this.createAsynchronousFunctions=function(){var a=function(b){var c=
   {},d;for(d in b)c.key=d,b[c.key]instanceof Function?c.key.endsWith("Async")||c.key.endsWith("EventListener")||b[c.key+"Async"]||(b[c.key+"Async"]=function(a){return function(c){for(var d=[],e=0;e<arguments.length;++e)d[e-0]=arguments[e];return new Promise(function(c,e){c(b[a.key].call.apply(b[a.key],[b].concat($jscomp.arrayFromIterable(d))))})}}(c)):-1<"state parameters plugins exports viewports scene camera lights".split(" ").indexOf(c.key)&&a(b[c.key]),c={key:c.key}};a(this)};this.saveSettingsAsync=
   function(a){return n.saveSettings(a).then(function(a){return(0,module$src$api$v2$ApiResponse.default)(null,a)},function(a){return(0,module$src$api$v2$ApiResponse.default)(a,!1)})};a&&(this.ar=a);this.utils=module$src$shared$util$GlobalUtils.default};var module$src$api$v1$ApiInterfaceV1={default:function(){this.STATUSCODE={READY:0,BUSY:1,INITIALIZING:2,ERROR:3};this.TYPE={FLOAT:"Float",INT:"Int",EVEN:"Even",ODD:"Odd",STRING:"String",COLOR:"Color",STRINGLIST:"StringList",BOOL:"Bool",TIME:"Time"};this.VISUALIZATION={SLIDER:"slider",SEQUENCE:"sequence",CYCLE:"cycle",DROPDOWN:"dropdown",CHECKLIST:"checklist",CLOCK:"clock",CALENDAR:"calendar"};this.activateTopView=function(){};this.addDraggableShape=function(){};this.cameraPath=function(){};this.changeEnvMap=
   function(){};this.clearMessagingCallback=function(){};this.clearProcessCallback=function(){};this.deregisterPlugin=function(){};this.disablePan=function(){};this.disableZoom=function(){};this.fadeInViewer=function(){};this.findTexturedGeometry=function(){};this.getApiVersion=function(){};this.getBackgroundColor=function(){};this.getCamera=function(){};this.getDraggableShapePosition=function(){};this.getExportDefinitions=function(){};this.getGeometryNames=function(){};this.getGeometryPathsByName=function(){};
   this.getModelData=function(){};this.getParameterDefinitions=function(){};this.getParameterValues=function(){};this.getScreenshot=function(){};this.getStatus=function(){};this.hideControls=function(){};this.hideFullscreenToggle=function(){};this.hideZoomToggle=function(){};this.loadStaticMesh=function(){};this.refreshPlugin=function(){};this.registerPlugin=function(){};this.removeDraggableShape=function(){};this.removeExternalTexture=function(){};this.removeStaticMesh=function(){};this.requestExport=
   function(){};this.requestSceneUpdate=function(){};this.resetCamera=function(){};this.restrictCamera=function(){};this.restrictPan=function(){};this.restrictZoom=function(){};this.setAutoRotate=function(){};this.setAutoRotation=function(){};this.setAutoRotationSpeed=function(){};this.setBackgroundColor=function(){};this.setBumpAmplitude=function(){};this.setBusyGraphic=function(){};this.setBusyGraphicPosition=function(){};this.setButtonColor=function(){};this.setCamera=function(){};this.setCommandResultCallback=
   function(){};this.setDefaultMaterialColor=function(){};this.setExternalTexture=function(){};this.setFOV=function(){};this.setPointSize=function(){};this.setToggleAmbientOcclusion=function(){};this.setToggleCastShadow=function(){};this.setControlDamping=function(){};this.setDamping=function(){};this.setEdgeColor=function(){};this.setEdgeColorByObject=function(){};this.setIgnoreMouse=function(){};this.setMessagingCallback=function(){};this.setParameterValue=function(){};this.setParameterValues=function(){};
   this.setProcessCallback=function(){};this.setRotateSpeed=function(){};this.setRotationSpeed=function(){};this.setZoomExtentFactor=function(){};this.setZoomSpeed=function(){};this.showControls=function(){};this.showEdges=function(){};this.showFullscreenToggle=function(){};this.showGrid=function(){};this.showGroundPlane=function(){};this.showShadows=function(){};this.showStaticMesh=function(){};this.showZoomToggle=function(){};this.toggleDisablePan=function(){};this.toggleDisableZoom=function(){};this.toggleFullscreen=
   function(){};this.toggleSceneBackground=function(){};this.toggleShadows=function(){};this.toggleTopView=function(){};this.zoomExt=function(){};this.zoomExtents=function(){}}};var module$src$api$v1$ApiImplementationV1={},pluginConstants$$module$src$api$v1$ApiImplementationV1=module$src$shared$constants$PluginConstantsGlobal.default,messagingConstants$$module$src$api$v1$ApiImplementationV1=module$src$shared$constants$MessagingConstants.default,GlobalUtils$$module$src$api$v1$ApiImplementationV1=module$src$shared$util$GlobalUtils.default,threeDManagerConstants$$module$src$api$v1$ApiImplementationV1=module$src$3d$viewport$ThreeDManagerConstants.default,toTinyColor$$module$src$api$v1$ApiImplementationV1=
   module$src$shared$util$toTinyColor.default,ApiInterfaceV1$$module$src$api$v1$ApiImplementationV1=new module$src$api$v1$ApiInterfaceV1.default,THREE$$module$src$api$v1$ApiImplementationV1=module$src$externals$three.default;
   module$src$api$v1$ApiImplementationV1.default=function(b){var a=this,c=b.app,d=b.viewportVisibilityHandler,e=b.exportHandler,g=b.messagingHandler,h=b.parameterHandler,f=b.pluginHandler,k=b.processStatusHandler,l=b.sceneManager,m=b.threeDManager;module$src$shared$util$GlobalUtils.default.inject(b.loggingHandler,a);var n=c.api({version:2}),q=n.getRuntimeId();module$src$shared$mixins$GlobalMixin.default.call(this);this.STATUSCODE=ApiInterfaceV1$$module$src$api$v1$ApiImplementationV1.STATUSCODE;this.TYPE=
   ApiInterfaceV1$$module$src$api$v1$ApiImplementationV1.TYPE;this.VISUALIZATION=ApiInterfaceV1$$module$src$api$v1$ApiImplementationV1.VISUALIZATION;var p={},u,t=function(b,c){if("function"===typeof u)try{u(b,c)}catch(H){a.error("ApiImplementationV1._callCommandResultCallback","Exception in callback:",b,H)}return c};this._callCommandResultCallback=t;var r={},v=function(a){a.type===n.scene.EVENTTYPE.DRAG_START?z("ObjectDragStarted"):a.type===n.scene.EVENTTYPE.DRAG_END&&z("ObjectDragEnded");if(a.dragPosAbs&&
   a.scenePath){var b=a.scenePath.split(".");r[b[1]]=a.dragPosAbs}},w=[],y=function(){if(0<Object.keys(r).length){var a=n.scene.addEventListener(n.scene.EVENTTYPE.DRAG_START+"."+q,v);a.data&&w.push(a.data);a=n.scene.addEventListener(n.scene.EVENTTYPE.DRAG_MOVE+"."+q,v);a.data&&w.push(a.data);a=n.scene.addEventListener(n.scene.EVENTTYPE.DRAG_END+"."+q,v);a.data&&w.push(a.data)}else w.forEach(function(a){n.scene.removeEventListener(a)}),w=[]},x=[],A,z=function(b){if("function"===typeof A)try{A(b)}catch(G){a.error("ApiImplementationV1._sendExternalMsg",
   "Exception in messaging callback ("+b+"):",G)}},B=function(){x.forEach(function(a){g.unsubscribeFromMessageStream(a)});x=[]},J=function(){if(!(0<x.length)){var a=module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SUBSCENE_PUBLISHED;a=g.subscribeToMessageStream(a,function(){z("GeometryUpdateDone");z("GeometryUpdateVisible")});x=x.concat(a);a=module$src$shared$constants$MessagingConstants.default.messageTopics.PLUGIN_ACTIVE;a=g.subscribeToMessageStream(a,function(a,b){if(a=b.getUniquePartByType(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PLUGIN_RUNTIME_ID))a=
   f.getPluginByRuntimeId(a.data).getShortName()+"Loaded",z(a)});x=x.concat(a);a=module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_VISIBILITY_ON;var b=g.subscribeToMessageStream(a,function(){g.unsubscribeFromMessageStream(b);z("InitialSceneReady")});x=x.concat(b)}};this.activateTopView=function(a){a=m.updateSetting("camera.type",a?module$src$3d$viewport$ThreeDManagerConstants.default.cameraViewTypes.TOP:module$src$3d$viewport$ThreeDManagerConstants.default.cameraViewTypes.PERSPECTIVE);
   return t("activateTopView",a)};this.addDraggableShape=function(b,c,d,e,f){if(!(module$src$shared$util$GlobalUtils.default.typeCheck(b,"string")&&module$src$shared$util$GlobalUtils.default.typeCheck(c,"string")&&module$src$shared$util$GlobalUtils.default.typeCheck(d,"notnegative")&&module$src$shared$util$GlobalUtils.default.typeCheck(e,"color")&&module$src$shared$util$GlobalUtils.default.typeCheck(f,"vector3obj")))return t("addDraggableShape",!1);var g=n.scene.get({id:b},q);if(g.err||0<g.data.length)return t("addDraggableShape",
   !1);var h;"box"===c?h=new module$src$externals$three.default.BoxBufferGeometry(d,d,d):"sphere"===c?h=new module$src$externals$three.default.SphereBufferGeometry(.5*d,20,20):"dodecahedron"===c&&(h=new module$src$externals$three.default.DodecahedronBufferGeometry(.5*d));if(void 0===h)return t("addDraggableShape",!1);c=n.scene.updateInteractionGroups({id:q,draggable:!0,selectable:!1,hoverable:!1});!0!==c.data?(a.error("ApiImplementationV1._createInteractionGroup","Could not add interaction group",c.err),
   c=!1):c=!0;if(!c)return t("addDraggableShape",!1);e=[{id:b,name:b,material:b+"_m",interactionGroup:q,content:[{format:"three",data:{threeObject:new module$src$externals$three.default.Mesh(h)},transformations:(new module$src$externals$three.default.Matrix4).makeTranslation(f.x,f.y,f.z)}]},{id:b+"_m",content:[{format:"material",data:{version:"3.0",color:e}}]}];n.scene.updateAsync(e,q);r[b]=module$src$shared$util$GlobalUtils.default.toVector3(f);y();return t("addDraggableShape",!0)};this.cameraPath=
   function(a,b,c){if(a.length!==b.length||0>=a.length)return t("cameraPath",!1);var d={};c&&(d.duration=c);m.cameraHandler.setCameraPath(a,b,d);return t("cameraPath",!0)};this.changeEnvMap=function(a){m.updateSettingAsync("material.environmentMap",a);return!0};this.clearMessagingCallback=function(){B();A=void 0};this.clearProcessCallback=function(a){if(!p.hasOwnProperty(a))return!1;g.unsubscribeFromMessageStream(p[a].subToken);delete p[a];return!0};this.deregisterPlugin=function(a){return f.deregisterPlugin(a)};
   this.disablePan=function(a){if(m.getSetting("camera.enablePan")===!a)return t("disablePan",!1);a=m.updateSetting("camera.enablePan",!a);return t("disablePan",a)};this.disableZoom=function(a){if(m.getSetting("camera.enableZoom")===!a)return t("disableZoom",!1);a=m.updateSetting("camera.enableZoom",!a);return t("disableZoom",a)};this.fadeInViewer=function(){d.showScene(!0);return!0};this.findTexturedGeometry=function(){var b=a.getGeometryNames(),c=[],d,e;for(d in b)for(e in b[d])c.push(e);return t("findTexturedGeometry",
   c)};this.getApiVersion=function(){return"1.0.0"};this.getBackgroundColor=function(){var a=m.getSetting("render.clearColor"),b=m.getSetting("render.clearAlpha");a=(0,module$src$shared$util$toTinyColor.default)(a);a.setAlpha(b);return a.toString("hex8")};this.getCamera=function(){var a=m.cameraHandler.getPositionAndTarget();return t("getCamera",a)};this.getDraggableShapePosition=function(a){return r.hasOwnProperty(a)?t("getDraggableShapePosition",r[a]):t("getDraggableShapePosition",!1)};this.getExportDefinitions=
   function(){var a=e.getExportDefinitions();t("getExportDefinitions",a)};this.getGeometryNames=function(a){return l.getGeometryNames(a)};this.getGeometryPathsByName=function(a,b){return l.getGeometryPathsByName(a,b)};this.getModelData=function(a){var b={};l.getModelData(a).forEach(function(a){b[a.id]=a});return t("getModelData",b)};this.getParameterDefinitions=function(a){a=h.getParameterDefinitions(a);return t("getParameterDefinitions",a)};this.getParameterValues=function(){var a=h.getParameterValuesCompat();
   return t("getParameterValues",a)};this.getScreenshot=function(){var a=m.renderingHandler.getScreenshot();return t("getScreenshot",a)};this.getStatus=function(){var a=f.getStatusDescription();if(!a.every(function(a){return a.status!==module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses.FAILED}))return a={statusCode:3,statusText:"Error",statusInfo:"At least one plugin failed"},t("getStatus",a);if(!a.every(function(a){return a.status===module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses.ACTIVE}))return a=
   {statusCode:2,statusText:"Initializing",statusInfo:"The viewer is still initializing"},t("getStatus",a);if(k.getSummary().busy)return a={statusCode:1,statusText:"Busy",statusInfo:"Viewer is processing a parameter update"},t("getStatus",a);a={statusCode:0,statusText:"Ready",statusInfo:"Viewer is fully loaded, geometry is being displayed"};return t("getStatus",a)};this.hideControls=function(){a.error("ApiImplementationV1.hideControls","Requires UI");return t("hideControls",!1)};this.hideFullscreenToggle=
   function(){a.error("ApiImplementationV1.hideFullscreenToggle","Requires UI");return!1};this.hideZoomToggle=function(){a.error("ApiImplementationV1.hideZoomToggle","Requires UI");return!1};this.loadStaticMesh=function(a,b,c,d,e,f){if(4>arguments.length||!module$src$shared$util$GlobalUtils.default.typeCheck(d,"string")||0===d.length)d=module$src$shared$util$GlobalUtils.default.createRandomId();if(!module$src$shared$util$GlobalUtils.default.typeCheck(b,"string")||0===b.length)return!1;var g=n.scene.get({id:d},
   q);if(g.err||0<g.data.length)return!1;g=[{id:d,material:"material_1",version:"1",duration:0,content:[{format:"obj",data:{objUrl:b}}]}];module$src$shared$util$GlobalUtils.default.typeCheck(c,"string")&&(g[0].content.data.mtlUrl=c);module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")&&(g[0].content.data.path=a);module$src$shared$util$GlobalUtils.default.typeCheck(e,"string")&&(g[0].content.data.texturePath=e);module$src$shared$util$GlobalUtils.default.typeCheck(f,"string")&&(g[0].content.data.side=
   f);n.scene.updateAsync(g,q).then(function(){z("LoadStaticMeshDone")});return!0};this.refreshPlugin=function(a,b){b=module$src$shared$constants$MessagingConstants.default.makeMessageToken(b);return h.refreshPlugin(a,b).err?!1:!0};this.registerPlugin=function(a){return f.registerPlugin(a)};this.removeExternalTexture=function(b,c){if(!module$src$shared$util$GlobalUtils.default.typeCheck(b,"string"))return t("removeExternalTexture",!1);var d="color alpha roughness metalness normal bump".split(" ");if("string"===
   typeof c)try{c=JSON.parse(c),Array.isArray(c)||(c=[c])}catch(L){c=d}else Array.isArray(c)||(c=d);c.includes("color")&&(c.splice(c.findIndex(function(a){return"color"===a}),1),c.push("bitmap"));c.includes("alpha")&&(c.splice(c.findIndex(function(a){return"alpha"===a}),1),c.push("transparency"));d=a.getGeometryNames();var e;for(e in d)if(d[e].hasOwnProperty(b)){var f=e;break}if(!f)return t("removeExternalTexture",!1);b=n.scene.get({name:b},f);if(b.err||1>=b.data.length)return t("removeExternalTexture",
   !1);b=b.data.filter(function(a){return a.material});if(1!==b.length)return t("removeExternalTexture",!1);b=n.scene.getPersistent({id:b[0].material},f);if(b.err||1!==b.data.length)return t("removeExternalTexture",!1);b=module$src$shared$util$GlobalUtils.default.deepCopy(b.data[0]);if(!Array.isArray(b.content)||0>=b.content.length||"material"!==b.content[0].format)return t("removeExternalTexture",!1);var g=b.content[0].data;c.forEach(function(a){delete g[a+"texture"]});n.scene.updatePersistentAsync([b],
   f);return t("removeExternalTexture",!0)};this.removeDraggableShape=function(a){if(!r.hasOwnProperty(a))return t("removeDraggableShape",!1);n.scene.removeAsync({id:a},q);delete r[a];y();return t("removeDraggableShape",!0)};this.removeStaticMesh=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")||0< !a.length)return!1;var b=n.scene.get({id:a},q);if(b.err||1!==b.data.length)return!1;n.scene.removeAsync({id:a},q);return!0};this.requestExport=function(a,b,c,d){if("string"===
   typeof a)a={idOrName:a},"string"===typeof c&&(a.plugin=c);else if(!a||"object"!==typeof a||!module$src$shared$util$GlobalUtils.default.typeCheck(a.id,"string")&&!module$src$shared$util$GlobalUtils.default.typeCheck(a.idOrName,"string")&&!module$src$shared$util$GlobalUtils.default.typeCheck(a.name,"string")||a.plugin&&"string"!==typeof a.plugin)return t("requestExport",!1);d=module$src$shared$constants$MessagingConstants.default.makeMessageToken(d);c=e.requestExport(a,d);return c!==module$src$shared$constants$PluginConstantsGlobal.default.requestExportResults.CACHE&&
   c!==module$src$shared$constants$PluginConstantsGlobal.default.requestExportResults.LOAD?t("requestExport",!1):t("requestExport",!0)};this.requestSceneUpdate=function(){var a=f.getStatusDescription(),b=!0;a=$jscomp.makeIterator(a);for(var c=a.next();!c.done;c=a.next())c=c.value,c.status===module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses.ACTIVE&&h.refreshPlugin(c.id).err&&(b=!1);return b};this.resetCamera=function(a,b){var c={duration:0};void 0===a&&(a=!0);a&&(c.duration=b?b:
   800);m.cameraHandler.resetPositionAndTarget(c);return!0};this.restrictCamera=function(a,b,c){if("number"===typeof a)if(0===a)a="x";else if(1===a)a="y";else if(2===a)a="z";else return t("restrictCamera",!1);else if("string"===typeof a){if("x"!==a&&"y"!==a&&"z"!==a)return t("restrictCamera",!1)}else return t("restrictCamera",!1);var d="min";b&&(d="max");if("number"!==typeof c)return t("restrictCamera",!1);b=m.getSetting("camera.restrictions.position.cube");b[d][a]=c;c=m.updateSetting("camera.restrictions.position.cube",
   b);return t("restrictCamera",c)};this.restrictPan=function(a,b,c){if("number"===typeof a)if(0===a)a="x";else if(1===a)a="y";else if(2===a)a="z";else return t("restrictPan",!1);else if("string"===typeof a){if("x"!==a&&"y"!==a&&"z"!==a)return!1}else return t("restrictPan",!1);var d="min";b&&(d="max");if("number"!==typeof c)return t("restrictPan",!1);b=m.getSetting("camera.restrictions.target.cube");b[d][a]=c;c=m.updateSetting("camera.restrictions.target.cube",b);return t("restrictPan",c)};this.restrictZoom=
   function(a,b){a=m.updateSetting("camera.restrictions.zoom",{minDistance:a,maxDistance:b});return t("restrictZoom",a)};this.setAutoRotate=function(b){if("number"===typeof b){var c=a.setAutoRotationSpeed(b);b=m.updateSetting("camera.enableAutoRotation",0!==b);return t("setAutoRotate",c||b)}return"boolean"===typeof b?(c=m.updateSetting("camera.enableAutoRotation",b),t("setAutoRotate",c)):t("setAutoRotate",!1)};this.setAutoRotation=function(b){return a.setAutoRotate(b)};this.setAutoRotationSpeed=function(a){return"number"!==
   typeof a?!1:m.updateSetting("camera.autoRotationSpeed",a)};this.setBackgroundColor=function(a){a=(0,module$src$shared$util$toTinyColor.default)(a);return a.isValid()&&m.updateSetting("render.clearColor",a.toString("hex6"))&&m.updateSetting("render.clearAlpha",a.getAlpha())?t("setBackgroundColor",!0):t("setBackgroundColor",!1)};this.setBumpAmplitude=function(a){n.updateSettingAsync("defaultMaterial.bumpAmplitude",a);return t("setBumpAmplitude",!0)};this.setBusyGraphic=function(){a.error("ApiImplementationV1.setBusyGraphic",
   "Requires UI")};this.setBusyGraphicPosition=function(){a.error("ApiImplementationV1.setBusyGraphicPosition","Requires UI")};this.setButtonColor=function(){a.error("ApiImplementationV1.setButtonColor","Not implemented yet");return t("setButtonColor",!1)};this.setCamera=function(a,b,c,d){var e={duration:0};void 0===c&&(c=!0);c&&(e.duration=d?d:800);a=m.cameraHandler.setPositionAndTarget(a,b,e);return t("setCamera",a)};this.setCommandResultCallback=function(a){u=a};this.setDefaultMaterialColor=function(a){n.updateSettingAsync("defaultMaterial.color",
   a);return t("setDefaultMaterialColor",!0)};this.setExternalTexture=function(b,c){if(!module$src$shared$util$GlobalUtils.default.typeCheck(b,"string"))return t("setExternalTexture",!1);if("string"===typeof c)try{c=JSON.parse(c)}catch(L){c={color:c}}else if(c&&"object"===typeof c)c=module$src$shared$util$GlobalUtils.default.deepCopy(c);else return t("setExternalTexture",!1);c.color&&(c.bitmap=c.color,delete c.color);c.alpha&&(c.transparency=c.alpha,delete c.alpha);var d=a.getGeometryNames();for(f in d)if(d[f].hasOwnProperty(b)){var e=
   f;break}if(!e)return t("setExternalTexture",!1);b=n.scene.get({name:b},e);if(b.err||1>=b.data.length)return t("setExternalTexture",!1);b=b.data.filter(function(a){return a.material});if(1!==b.length)return t("setExternalTexture",!1);d=b[0];b=n.scene.get({id:d.material},e);if(b.err||1!==b.data.length||!Array.isArray(b.data[0].content)||0>=b.data[0].content.length)return t("setExternalTexture",!1);var f={};f.content=module$src$shared$util$GlobalUtils.default.deepCopy(b.data[0].content);if("material"!==
   f.content[0].format)return t("setExternalTexture",!1);var g=f.content[0].data;"bitmap metalness roughness bump normal transparency".split(" ").forEach(function(a){if(c[a]&&module$src$shared$util$GlobalUtils.default.typeCheck(c[a],"string")){var b=a+"texture";g[b]&&"object"===typeof g[b]?g[b].href=c[a]:g[b]=c[a]}});f.id=d.material;n.scene.updatePersistentAsync([f],e);return t("setExternalTexture",!0)};this.setFOV=function(a){a=m.updateSetting("camera.fov",a);return t("setFOV",a)};this.setPointSize=
   function(a){"number"!==typeof a&&(a=1);a=m.updateSetting("render.pointSize",a);return t("setPointSize",a)};this.setToggleAmbientOcclusion=function(a){return m.updateSetting("render.ambientOcclusion",a)};this.setToggleCastShadow=function(a,b){m.setToggleCastShadow(a,b)};this.setControlDamping=function(a){a=m.updateSetting("camera.damping",a);return t("setControlDamping",a)};this.setDamping=function(b){return a.setControlDamping(b)};this.setEdgeColor=function(){a.warn("ApiImplementationV1.setEdgeColor",
   "Not implemented");return t("setEdgeColor",!1)};this.setEdgeColorByObject=function(){a.warn("ApiImplementationV1.setEdgeColorByObject","Not implemented");return t("setEdgeColorByObject",!1)};this.setIgnoreMouse=function(a){return!0};this.setMessagingCallback=function(a){"function"===typeof a&&(J(),A=a)};var F=function(a){return!a||"object"!==typeof a||"string"!==typeof a.id&&"string"!==typeof a.idOrName&&"string"!==typeof a.name||a.plugin&&"string"!==typeof a.plugin||void 0===a.value?!1:!0};this.setParameterValue=
   function(b,c){if("string"===typeof b)b={idOrName:b,value:c};else if(F(b))var d=c;else return t("setParameterValue",!1);d=module$src$shared$constants$MessagingConstants.default.makeMessageToken(d);c=h.setParameterValue(b,d);if(c.err)return a.error("ApiImplementationV1.setParameterValue","_parameterHandler.setParameterValue returned error",c),t("setParameterValue",!1);if(c.warn)return a.warn("ApiImplementationV1.setParameterValue","_parameterHandler.setParameterValue returned warning",c),t("setParameterValue",
   !1);a.debug("ApiImplementationV1.setParameterValue","_parameterHandler.setParameterValue returned",c);return t("setParameterValue",!0)};this.setParameterValues=function(b,c){var d=[];if(!Array.isArray(b))return t("setParameterValues",!1);if(b.every(function(a){return"string"===typeof a})){if(!Array.isArray(c)||c.length!==b.length)return!1;for(var e=0;e<b.length;e++)d.push({idOrName:b[e],value:c[e]})}else if(b.every(function(a){return F(a)})){d=b;var f=c}f=module$src$shared$constants$MessagingConstants.default.makeMessageToken(f);
   b=h.setMultipleParameterValues(d,f);if(b.err)return a.error("ApiImplementationV1.setParameterValues","_parameterHandler.setParameterValue returned error",b),t("setParameterValues",!1);if(b.warn)return a.warn("ApiImplementationV1.setParameterValues","_parameterHandler.setParameterValue returned warning",b),t("setParameterValues",!1);a.debug("ApiImplementationV1.setParameterValues","_parameterHandler.setParameterValue returned",b);return t("setParameterValues",!0)};this.setProcessCallback=function(b,
   c){if(!p.hasOwnProperty(b)){var d=g.subscribeToMessageStream(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS+"."+b,function(d,e){var f=d.substring(d.indexOf(".")+1);if(p.hasOwnProperty(b)){var g=p[b],h=e.getUniquePartByType(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_FORK);if(h&&Array.isArray(h.data)){if(h.data.every(function(a){return a.startsWith(b+".")})){var k=g.procTokens;k=k.splice(k.indexOf(f),1);k=k.concat(h.data);g.procTokens=
   k}else a.error("ApiImplementationV1.setProcessCallback","Forked process token must be a sub-token of "+b);try{c(d,e)}catch(N){a.error("ApiImplementationV1.setProcessCallback","Exception in process callback:",N)}}else{h=e.getUniquePartByType(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR);k=e.getUniquePartByType(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT);var l=e.getUniquePartByType(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS);
   h?g.procTokenStat[f]=module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR:k?g.procTokenStat[f]=module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT:l&&(g.procTokenStat[f]=module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS);g.procTokens.every(function(a){return g.procTokenStat.hasOwnProperty(a)})&&(a.debug("ApiImplementationV1.setProcessCallback","Clearing process callback for token "+b),a.clearProcessCallback(b));
   try{c(d,e)}catch(N){a.error("ApiImplementationV1.setProcessCallback","Exception in process callback:",N)}}}else a.warn("ApiImplementationV1.setProcessCallback","Message for unknown token:",e)});p[b]={subToken:d,procTokens:[b],procTokenStat:{}};return b}};this.setRotateSpeed=function(a){a=m.updateSetting("camera.rotationSpeed",a);return t("setRotateSpeed",a)};this.setRotationSpeed=function(b){return a.setRotateSpeed(b)};this.setZoomExtentFactor=function(a){a=m.updateSetting("camera.zoomExtentsFactor",
   a);return t("setZoomExtentFactor",a)};this.setZoomSpeed=function(a){a=m.updateSetting("camera.zoomSpeed",a);return t("setZoomSpeed",a)};this.showControls=function(){a.error("ApiImplementationV1.showControls","Requires UI");return t("showControls",!1)};this.showEdges=function(){a.warn("ApiImplementationV1.showEdges","Not implemented");return t("showEdges",!1)};this.showFullscreenToggle=function(){a.error("ApiImplementationV1.showFullscreenToggle","Requires UI");return!1};this.showGrid=function(a){"boolean"!==
   typeof a&&(a=!0);if(m.getSettingShallow("gridVisibility")==a)return t("showGrid",!1);a=m.updateSetting("gridVisibility",a);return t("showGrid",a)};this.showGroundPlane=function(a){"boolean"!==typeof a&&(a=!0);if(m.getSettingShallow("groundPlaneVisibility")==a)return t("showGroundPlane",!1);a=m.updateSetting("groundPlaneVisibility",a);return t("showGroundPlane",a)};this.showShadows=function(a){"boolean"!==typeof a&&(a=!0);if(m.getSettingShallow("render.shadows")==a)return t("showShadows",!1);a=m.updateSetting("render.shadows",
   a);return t("showShadows",a)};this.showStaticMesh=function(a,b){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")||0===a.length||!module$src$shared$util$GlobalUtils.default.typeCheck(b,"boolean"))return!1;var c=n.scene.get({id:a},q);if(c.err||1!==c.data.length)return!1;n.scene.updateAsync({id:a,visible:b},q);return!0};this.showZoomToggle=function(){a.error("ApiImplementationV1.showZoomToggle","Requires UI");return!1};this.toggleDisablePan=function(){var a=m.getSettingShallow("camera.enablePan");
   return m.updateSetting("camera.enablePan",!a)};this.toggleDisableZoom=function(){var a=m.getSettingShallow("camera.enableZoom");a=m.updateSetting("camera.enableZoom",!a);return t(a)};this.toggleFullscreen=function(a){var b=m.getSettingShallow("fullscreen");if("boolean"!==typeof a)a=!b;else if(a===b)return!1;return m.updateSetting("fullscreen",a)};this.toggleSceneBackground=function(a){"boolean"!==typeof a&&(a=!0);return m.updateSetting("material.environmentMapAsBackground",a)};this.toggleShadows=
   function(){var a=m.getSettingShallow("render.shadows");return m.updateSetting("render.shadows",!a)};this.toggleTopView=function(){var a=m.getSettingShallow("camera.type")===module$src$3d$viewport$ThreeDManagerConstants.default.cameraViewTypes.PERSPECTIVE?module$src$3d$viewport$ThreeDManagerConstants.default.cameraViewTypes.TOP:module$src$3d$viewport$ThreeDManagerConstants.default.cameraViewTypes.PERSPECTIVE;return m.updateSetting("camera.type",a)};this.zoomExt=function(b){return a.zoomExtents(b)};
   this.zoomExtents=function(a,b){var c={duration:0};void 0===a&&(a=!0);a&&(c.duration=b?b:800);m.cameraHandler.zoomExtents(c);return!0};return this};var module$src$app$handlers$SettingsHandler={default:{}},__awaiter$$module$src$app$handlers$SettingsHandler=this&&module$src$app$handlers$SettingsHandler.default.__awaiter||function(b,a,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,h){function f(a){try{l(d.next(a))}catch(n){h(n)}}function g(a){try{l(d["throw"](a))}catch(n){h(n)}}function l(a){a.done?c(a.value):e(a.value).then(f,g)}l((d=d.apply(b,a||[])).next())})},__generator$$module$src$app$handlers$SettingsHandler=
   this&&module$src$app$handlers$SettingsHandler.default.__generator||function(b,a){function c(a){return function(b){return d([a,b])}}function d(c){if(g)throw new TypeError("Generator is already executing.");for(;e;)try{if(g=1,h&&(f=c[0]&2?h["return"]:c[0]?h["throw"]||((f=h["return"])&&f.call(h),0):h.next)&&!(f=f.call(h,c[1])).done)return f;if(h=0,f)c=[c[0]&2,f.value];switch(c[0]){case 0:case 1:f=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++;h=c[1];c=[0];continue;case 7:c=e.ops.pop();
   e.trys.pop();continue;default:if(!(f=e.trys,f=0<f.length&&f[f.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!f||c[1]>f[0]&&c[1]<f[3]))e.label=c[1];else if(6===c[0]&&e.label<f[1])e.label=f[1],f=c;else if(f&&e.label<f[2])e.label=f[2],e.ops.push(c);else{f[2]&&e.ops.pop();e.trys.pop();continue}}c=a.call(b,e)}catch(m){c=[6,m],h=0}finally{g=f=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},g,h,
   f,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k},__read$$module$src$app$handlers$SettingsHandler=this&&module$src$app$handlers$SettingsHandler.default.__read||function(b,a){var c="function"===typeof Symbol&&b[Symbol.iterator];if(!c)return b;b=c.call(b);var d,e=[];try{for(;(void 0===a||0<a--)&&!(d=b.next()).done;)e.push(d.value)}catch(h){var g={error:h}}finally{try{d&&!d.done&&(c=b["return"])&&c.call(b)}finally{if(g)throw g.error;
   }}return e},__spread$$module$src$app$handlers$SettingsHandler=this&&module$src$app$handlers$SettingsHandler.default.__spread||function(){for(var b=[],a=0;a<arguments.length;a++)b=b.concat(__read$$module$src$app$handlers$SettingsHandler(arguments[a]));return b},__importDefault$$module$src$app$handlers$SettingsHandler=this&&module$src$app$handlers$SettingsHandler.default.__importDefault||function(b){return b&&b.__esModule?b:{"default":b}};
   Object.defineProperty(module$src$app$handlers$SettingsHandler.default,"__esModule",{value:!0});
   var shapedivernodemodule_viewersettings_1$$module$src$app$handlers$SettingsHandler=module$node_modules$shapedivernodemodule_viewersettings$bundle.default,StateDashboard_1$$module$src$app$handlers$SettingsHandler=module$src$modules$shapediver_state_dashboard$StateDashboard.default,MessagingConstants_1$$module$src$app$handlers$SettingsHandler=__importDefault$$module$src$app$handlers$SettingsHandler(module$src$shared$constants$MessagingConstants.default),PluginConstantsGlobal_1$$module$src$app$handlers$SettingsHandler=
   __importDefault$$module$src$app$handlers$SettingsHandler(module$src$shared$constants$PluginConstantsGlobal.default),MessagePrototype_1$$module$src$app$handlers$SettingsHandler=__importDefault$$module$src$app$handlers$SettingsHandler(module$src$shared$messages$MessagePrototype.default),GlobalUtils_1$$module$src$app$handlers$SettingsHandler=__importDefault$$module$src$app$handlers$SettingsHandler(module$src$shared$util$GlobalUtils.default),ViewerAppConstants_1$$module$src$app$handlers$SettingsHandler=
   __importDefault$$module$src$app$handlers$SettingsHandler(module$src$app$ViewerAppConstants.default);
   module$src$app$handlers$SettingsHandler.default.SettingsHandler=function(){function b(a){this._app=a;this._viewportSettingsRestored=!1}b.prototype.messageReceiver=function(a,b,d,e){return __awaiter$$module$src$app$handlers$SettingsHandler(this,void 0,void 0,function(){var a,c,f,k;return __generator$$module$src$app$handlers$SettingsHandler(this,function(g){switch(g.label){case 0:if(this._storedSettings)return[2];if(d!==ViewerAppConstants_1$$module$src$app$handlers$SettingsHandler.default.messageDataTypes.APP_SETTINGS)return[3,
   4];a=b?(new module$node_modules$shapedivernodemodule_viewersettings$bundle.default.SettingsConversion).convert(b,"2.0"):null;this._storedSettings=new module$node_modules$shapedivernodemodule_viewersettings$bundle.default.Settings_2_0(a);this._storedSettingsOrigin=e;c=this._storedSettings.toJSON(!0).parameters;c.plugin=e.plugin;f=new MessagePrototype_1$$module$src$app$handlers$SettingsHandler.default(MessagingConstants_1$$module$src$app$handlers$SettingsHandler.default.messageDataTypes.PARAMETER_SETTINGS,
   c,e);this._app.message(MessagingConstants_1$$module$src$app$handlers$SettingsHandler.default.messageTopics.PARAMETER_REGISTER,f);this._app.message(MessagingConstants_1$$module$src$app$handlers$SettingsHandler.default.messageTopics.EXPORT_REGISTER,f);return this._app.getSetting("useModelSettings")?[4,this.restoreSettings()]:[3,2];case 1:return g.sent(),[3,3];case 2:this.resolveSettingsRestoredStates(),this._app.message(MessagingConstants_1$$module$src$app$handlers$SettingsHandler.default.messageTopics.SETTINGS_REGISTERED,
   new MessagePrototype_1$$module$src$app$handlers$SettingsHandler.default(MessagingConstants_1$$module$src$app$handlers$SettingsHandler.default.messageDataTypes.GENERIC,{})),g.label=3;case 3:k=module$src$modules$shapediver_state_dashboard$StateDashboard.default.StateDashboardLibrary.getInstance(this._app.api({version:2}).getSetting("viewerRuntimeId")),k.settingsLoaded.resolve(!0),this._app.updateSetting("viewer.hasRestoredSettings",!0),g.label=4;case 4:return[2]}})})};b.prototype.resolveSettingsRestoredStates=
   function(a){var b=[],d=module$src$modules$shapediver_state_dashboard$StateDashboard.default.StateDashboardLibrary.getInstance(this._app.api({version:2}).getSetting("viewerRuntimeId"));if(a)b.push(d.createCustomState(a.getViewportRuntimeId()+"_settingsRestored"));else{a=this._app.viewportManager.getApis();for(var e=0,g=a.length;e<g;e++)b.push(d.createCustomState(a[e].getViewportRuntimeId()+"_settingsRestored"))}for(e=0;e<b.length;e++)b[e].resolve(!0)};b.prototype.restoreSettings=function(a){var b;
   return __awaiter$$module$src$app$handlers$SettingsHandler(this,void 0,void 0,function(){var c,e,g,h,f,k,l,m,n,q;return __generator$$module$src$app$handlers$SettingsHandler(this,function(d){switch(d.label){case 0:c=module$src$modules$shapediver_state_dashboard$StateDashboard.default.StateDashboardLibrary.getInstance(this._app.api({version:2}).getSetting("viewerRuntimeId"));if(a&&(null===(b=c.getCustomState(a.getViewportRuntimeId()+"_settingsRestored"))||void 0===b?0:b.resolved))return[2,Promise.resolve(!0)];
   if(!this._app.getSetting("useModelSettings"))return this.resolveSettingsRestoredStates(a),[2,Promise.resolve(!0)];if(!this._storedSettings)return[2,Promise.resolve(!1)];e=this._storedSettings.getSettings(!0);g=[];for(h in e)g.push(h);f=0;d.label=1;case 1:if(!(f<g.length))return[3,13];k=g[f];if(!k.startsWith("viewer.scene."))return[3,8];l=k.replace("viewer.scene.","");return a?[4,a.updateSettingAsync(l,e[k])]:[3,3];case 2:return d.sent(),[3,7];case 3:m=this._app.viewportManager.getApis(),n=0,q=m.length,
   d.label=4;case 4:return n<q?[4,m[n].updateSettingAsync(l,e[k])]:[3,7];case 5:d.sent(),d.label=6;case 6:return n++,[3,4];case 7:return[3,12];case 8:return k.startsWith("defaultMaterial.")||k.startsWith("ar.")?[4,this._app.updateSettingAsync(k,e[k])]:[3,10];case 9:return d.sent(),[3,12];case 10:if(!k.startsWith("viewer."))return[3,12];l=k.replace("viewer.","");return[4,this._app.updateSettingAsync(l,e[k])];case 11:d.sent(),d.label=12;case 12:return f++,[3,1];case 13:return this.resolveSettingsRestoredStates(a),
   a&&!this._viewportSettingsRestored&&(this._viewportSettingsRestored=!0,this._app.message(MessagingConstants_1$$module$src$app$handlers$SettingsHandler.default.messageTopics.SETTINGS_REGISTERED,new MessagePrototype_1$$module$src$app$handlers$SettingsHandler.default(MessagingConstants_1$$module$src$app$handlers$SettingsHandler.default.messageDataTypes.GENERIC,{}))),[2,!0]}})})};b.prototype.saveSettings=function(a){return __awaiter$$module$src$app$handlers$SettingsHandler(this,void 0,void 0,function(){var b,
   d,e,g,h;return __generator$$module$src$app$handlers$SettingsHandler(this,function(c){GlobalUtils_1$$module$src$app$handlers$SettingsHandler.default.typeCheck(a,"string")?b=this._app.pluginManager.getPluginByRuntimeId(a):(this._storedSettingsOrigin&&this._storedSettingsOrigin.plugin&&(b=this._app.pluginManager.getPluginByRuntimeId(this._storedSettingsOrigin.plugin))&&!b.getCapabilities().includes(PluginConstantsGlobal_1$$module$src$app$handlers$SettingsHandler.default.pluginCapabilities.SETTINGS)&&
   (b=void 0),b||(b=this._app.pluginManager.getPluginByCapabilities(PluginConstantsGlobal_1$$module$src$app$handlers$SettingsHandler.default.pluginCapabilities.SETTINGS)));if(!b||!GlobalUtils_1$$module$src$app$handlers$SettingsHandler.default.typeCheck(b.saveSettings,"function"))return[2,!1];d=new module$node_modules$shapedivernodemodule_viewersettings$bundle.default.Settings_2_0;e=d.toJSON(!0);this._getParameterSettings(e.parameters,b.getRuntimeId());e.viewer.commitParameters=this._app.getSetting("commitParameters");
   e.defaultMaterial={bumpAmplitude:this._app.getSetting("defaultMaterial.bumpAmplitude"),color:this._app.getSetting("defaultMaterial.color"),metalness:this._app.getSetting("defaultMaterial.metalness"),roughness:this._app.getSetting("defaultMaterial.roughness")};g=this._app.viewportManager.getApis()[0];g.camera.updateAsync(g.camera.get().data,{default:!0,duration:0});e.viewer.scene=g.getSettings();e.viewer.scene.lights.helper=!1;e.viewer.scene.lights.lightScene=g.getSetting("lights.lightScene");e.viewer.scene.lights.lightScenes=
   g.getSetting("lights.lightScenes");h=(new module$node_modules$shapedivernodemodule_viewersettings$bundle.default.Settings_2_0(e)).toJSON(!0);return[2,b.saveSettings(h)]})})};b.prototype._getParameterSettings=function(a,b){var c={},e=this._app.parameterManager.getConfig(b);Object.keys(e).forEach(function(a){e[a]&&(c.hasOwnProperty(a)?c[a]=__spread$$module$src$app$handlers$SettingsHandler(c[a],e[a]):c[a]=e[a])});var g=this._app.exportManager.getConfig(b);Object.keys(g).forEach(function(a){g[a]&&(c.hasOwnProperty(a)?
   c[a]=__spread$$module$src$app$handlers$SettingsHandler(c[a],g[a]):c[a]=g[a])});a.controlNames={};c.hasOwnProperty("controlNames")&&(b=c.controlNames,b.forEach(function(b){return a.controlNames[b.id]=b.name}));a.controlOrder=[];c.hasOwnProperty("controlOrder")&&(b=c.controlOrder,b.sort(function(a,b){return a.order-b.order}),a.controlOrder=b.map(function(a){return a.id}));a.parametersHidden=[];c.hasOwnProperty("parametersHidden")&&(a.parametersHidden=c.parametersHidden)};return b}();var module$src$app$conf$DispatchingConstants={},callbackParamTypes$$module$src$app$conf$DispatchingConstants={TYPE:"type",DATA:"data",TOKEN:"token",ORIGIN:"origin",TOPIC:"topic",PLUGIN:"plugin"},callbackParamTypesDefault$$module$src$app$conf$DispatchingConstants=[callbackParamTypes$$module$src$app$conf$DispatchingConstants.TOKEN,callbackParamTypes$$module$src$app$conf$DispatchingConstants.DATA,callbackParamTypes$$module$src$app$conf$DispatchingConstants.TYPE,callbackParamTypes$$module$src$app$conf$DispatchingConstants.ORIGIN],
   dispatchingConstants$$module$src$app$conf$DispatchingConstants={callbackParamTypes:callbackParamTypes$$module$src$app$conf$DispatchingConstants,callbackParamTypesDefault:callbackParamTypesDefault$$module$src$app$conf$DispatchingConstants},GlobalUtils$$module$src$app$conf$DispatchingConstants=module$src$shared$util$GlobalUtils.default;module$src$app$conf$DispatchingConstants.default=module$src$shared$util$GlobalUtils.default.deepCopy(dispatchingConstants$$module$src$app$conf$DispatchingConstants);var module$src$app$conf$DispatchingConfig={},GlobalUtils$$module$src$app$conf$DispatchingConfig=module$src$shared$util$GlobalUtils.default;module$src$app$conf$DispatchingConfig.default=function(){var b={};this.getConfig=function(){return b};this.addPartListener=function(a,c,d,e){b.hasOwnProperty(a)&&"object"===typeof b[a]||(b[a]={});a=b[a];a.hasOwnProperty("partListeners")&&Array.isArray(a.partListeners)||(a.partListeners=[]);var g={};g.type=c;g.cb=d;g.params=e;a.partListeners.push(g);return!0}};var module$src$app$conf$DefaultDispatching={},messagingConstants$$module$src$app$conf$DefaultDispatching=module$src$shared$constants$MessagingConstants.default,dispatchingConstants$$module$src$app$conf$DefaultDispatching=module$src$app$conf$DispatchingConstants.default,DispatchingConfig$$module$src$app$conf$DefaultDispatching=module$src$app$conf$DispatchingConfig.default;
   module$src$app$conf$DefaultDispatching.default=function(b){var a=new module$src$app$conf$DispatchingConfig.default;a.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.PARAMETER_REGISTER,module$src$shared$constants$MessagingConstants.default.messageDataTypes.PARAMETER_DEFINITION,b.parameterManager.registerMultipleParameters,[module$src$app$conf$DispatchingConstants.default.callbackParamTypes.DATA,module$src$app$conf$DispatchingConstants.default.callbackParamTypes.PLUGIN,
   module$src$app$conf$DispatchingConstants.default.callbackParamTypes.TOKEN]);a.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.PARAMETER_REGISTER,module$src$shared$constants$MessagingConstants.default.messageDataTypes.PARAMETER_SETTINGS,b.parameterManager.registerConfig,[module$src$app$conf$DispatchingConstants.default.callbackParamTypes.DATA,module$src$app$conf$DispatchingConstants.default.callbackParamTypes.PLUGIN,module$src$app$conf$DispatchingConstants.default.callbackParamTypes.TOKEN]);
   a.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.EXPORT_REGISTER,module$src$shared$constants$MessagingConstants.default.messageDataTypes.PARAMETER_SETTINGS,b.exportManager.registerConfig,[module$src$app$conf$DispatchingConstants.default.callbackParamTypes.DATA,module$src$app$conf$DispatchingConstants.default.callbackParamTypes.PLUGIN,module$src$app$conf$DispatchingConstants.default.callbackParamTypes.TOKEN]);a.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.PLUGIN_ACTIVE,
   module$src$shared$constants$MessagingConstants.default.messageDataTypes.PLUGIN_RUNTIME_ID,b.parameterManager.refreshPluginInitial,[module$src$app$conf$DispatchingConstants.default.callbackParamTypes.PLUGIN,module$src$app$conf$DispatchingConstants.default.callbackParamTypes.TOKEN]);a.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.EXPORT_REGISTER,module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_DEFINITION,b.exportManager.registerMultipleExports,
   [module$src$app$conf$DispatchingConstants.default.callbackParamTypes.DATA,module$src$app$conf$DispatchingConstants.default.callbackParamTypes.PLUGIN,module$src$app$conf$DispatchingConstants.default.callbackParamTypes.TOKEN]);a.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SUBSCENE_INIT,module$src$shared$constants$MessagingConstants.default.messageDataTypes.SUBSCENE_INIT,b.sceneManager.initSubScene,[module$src$app$conf$DispatchingConstants.default.callbackParamTypes.DATA,
   module$src$app$conf$DispatchingConstants.default.callbackParamTypes.PLUGIN,module$src$app$conf$DispatchingConstants.default.callbackParamTypes.TOKEN]);a.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SUBSCENE_OUTPUTVERSION,module$src$shared$constants$MessagingConstants.default.messageDataTypes.SUBSCENE_OUTPUTVERSION_JSON,b.sceneManager.addJSONOutputVersionToSubScene,[module$src$app$conf$DispatchingConstants.default.callbackParamTypes.DATA,module$src$app$conf$DispatchingConstants.default.callbackParamTypes.PLUGIN,
   module$src$app$conf$DispatchingConstants.default.callbackParamTypes.TOKEN]);a.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SUBSCENE_OUTPUTVERSION,module$src$shared$constants$MessagingConstants.default.messageDataTypes.SUBSCENE_OUTPUTVERSION_OBJ,b.sceneManager.addOutputVersionToSubScene,[module$src$app$conf$DispatchingConstants.default.callbackParamTypes.DATA,module$src$app$conf$DispatchingConstants.default.callbackParamTypes.PLUGIN,module$src$app$conf$DispatchingConstants.default.callbackParamTypes.TOKEN]);
   a.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_STATUS,b.processStatusHandler.updateProcessStatus);a.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS,b.processStatusHandler.unregisterProcess);a.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,
   module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT,b.processStatusHandler.unregisterProcess);a.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR,b.processStatusHandler.unregisterProcess);a.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_FORK,
   b.processStatusHandler.forkProcessStatus);a.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_STATUS,b.viewportVisibilityHandler.messageReceiver);a.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS,b.viewportVisibilityHandler.messageReceiver);a.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,
   module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR,b.viewportVisibilityHandler.messageReceiver);a.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_FORK,b.processStatusHandler.forkProcessStatus);a.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.SETTINGS_REGISTER,module$src$shared$constants$MessagingConstants.default.messageDataTypes.APP_SETTINGS,
   b.settingsHandler.messageReceiver.bind(b.settingsHandler));return a.getConfig()};var module$src$app$ViewerApp={},viewerAppConstants$$module$src$app$ViewerApp=module$src$app$ViewerAppConstants.default,GlobalUtils$$module$src$app$ViewerApp=module$src$shared$util$GlobalUtils.default,StateDashboardLibrary$$module$src$app$ViewerApp=module$src$modules$shapediver_state_dashboard$StateDashboard.default.StateDashboardLibrary;
   module$src$app$ViewerApp.default=function(b){var a=this;module$src$shared$mixins$GlobalMixin.default.call(this);module$src$shared$mixins$SettingsMixin.default.call(this,b,module$src$app$ViewerAppConstants.default.defaultSettings,"app",["container","containerControls","containerSettings","resizeHandler"]);var c=module$src$shared$util$GlobalUtils.default.createRandomId();a.updateSetting("viewerRuntimeId",c);module$src$modules$shapediver_state_dashboard$StateDashboard.default.StateDashboardLibrary.getInstance(c);
   module$src$shared$mixins$LoggingMixin.default.call(this);module$src$app$partials$ViewerAppLoggingPartial.default.call(this);var d={error:a.error,warn:a.warn,info:a.info,debug:a.debug,log:a.log};THREE.Extensions.Logger.bind(d);THREE.Extensions.Settings.bind({debug:function(){return!1},allowedCachedPrograms:function(){return 50}});module$src$shared$mixins$MessagingMixin.default.call(this);module$src$app$partials$ViewerAppMessagingPartial.default.call(this);this.pluginManager=module$src$app$partials$ViewerAppPluginManager.default.call(a);
   this.parameterManager=module$src$app$partials$ViewerAppParameterManager.default.call(a,{pluginManager:a.pluginManager});this.exportManager=module$src$app$partials$ViewerAppExportManager.default.call(a,{pluginManager:a.pluginManager,parameterManager:a.parameterManager});this.interactionGroupManager=new module$src$3d$InteractionGroupManager.default;this.viewportManager=new module$src$3d$viewportManager$ViewportManager.default(a,d,a.interactionGroupManager);this.sceneGeometryManager=new module$src$3d$SceneGeometryManager.default(a.viewportManager,
   {loggingHandler:d,messagingHandler:{message:a.message,subscribeToMessageStream:a.subscribeToMessageStream,unsubscribeFromMessageStream:a.unsubscribeFromMessageStream}});this.viewportVisibilityHandler=module$src$app$handlers$ViewportVisibilityHandler.default.call(a,{viewerApp:a,viewportManager:a.viewportManager,sceneGeometryManager:a.sceneGeometryManager});this.getContainer=function(){var b=a.viewportManager.getContainers();return 1===b.length?b[0]:b};this.sceneManager=module$src$app$partials$ViewerAppSceneManager.default.call(a,
   {sceneGeometryManager:a.sceneGeometryManager});this.processStatusHandler=module$src$app$handlers$ProcessStatusHandler.default.call(a,{viewportManager:a.viewportManager});!0===this.getSetting("arkitbridge")&&(this.arApi=(0,module$src$ar$ArApiARKit.default)({viewportManager:a.viewportManager,apiResponse:module$src$api$v2$ApiResponse.default,sceneGeometryManager:a.sceneGeometryManager,settings:a.getSection("ar"),container:b.container,loggingHandler:d}));this.api=function(b){b=b||{version:1};return!b.version||
   2!==b.version&&"2"!==b.version?new module$src$api$v1$ApiImplementationV1.default({exportHandler:a.exportManager,parameterHandler:a.parameterManager,pluginHandler:a.pluginManager,processStatusHandler:a.processStatusHandler,sceneManager:a.sceneManager,settingsHandler:a.settingsHandler,threeDManager:a.viewportManager.getApis()[0].threeDManager,viewportVisibilityHandler:a.viewportVisibilityHandler,messagingHandler:{message:a.message,subscribeToMessageStream:a.subscribeToMessageStream,unsubscribeFromMessageStream:a.unsubscribeFromMessageStream,
   getFailedStatusMessages:a.getFailedStatusMessages},loggingHandler:d,app:a},b):new module$src$api$v2$ApiImplementationV2_1.default({exportHandler:a.exportManager,parameterHandler:a.parameterManager,pluginHandler:a.pluginManager,processStatusHandler:a.processStatusHandler,sceneManager:a.sceneManager,settingsHandler:a.settingsHandler,viewportManager:a.viewportManager,sceneGeometryManager:a.sceneGeometryManager,interactionGroupManager:a.interactionGroupManager,arApi:a.arApi,messagingHandler:{message:a.message,
   subscribeToMessageStream:a.subscribeToMessageStream,unsubscribeFromMessageStream:a.unsubscribeFromMessageStream,getFailedStatusMessages:a.getFailedStatusMessages},loggingHandler:d,app:a},b)};b.container&&a.viewportManager.createThreeDManager(b.container);this.settingsHandler=new module$src$app$handlers$SettingsHandler.default.SettingsHandler(a);this.setupDispatching(module$src$app$conf$DefaultDispatching.default.call(a,{parameterManager:a.parameterManager,exportManager:a.exportManager,pluginManager:a.pluginManager,
   sceneManager:a.sceneManager,processStatusHandler:a.processStatusHandler,viewportVisibilityHandler:a.viewportVisibilityHandler,settingsHandler:a.settingsHandler}));this.viewportVisibilityHandler.init();b.build_version&&b.build_date&&("number"===typeof b.brandedModeConsole?console.log((1===b.brandedModeConsole?"SD":"ShapeDiver")+" Viewer App "+b.build_version+", built "+b.build_date):console.log("%cShapeDiver Viewer App "+b.build_version+"           \n%c"+b.build_date+"\n\n%cWe're hiring: https://shapediver.com/jobs",
   "font-size:16px; font-weight:200; letter-spacing:0.02em; line-height:1.4em; font-family:helvetica,arial; color: #0a12c6; background:url(https://s3.amazonaws.com/wp-shapediver-content/static/images/logomark_gradient%40400x17.png) no-repeat; display: block; background-size: 400px 17px; background-position: right bottom;","font-size:10px; font-weight:200; letter-spacing:0.02em; line-height:1.4em; font-family:helvetica,arial; color: #be47fd;","font-size:12px; font-weight:200; letter-spacing:0.02em; line-height:1.4em; font-family:helvetica,arial; color: #0a12c6;"));
   return this};var module$build$package={},GLOBAL_UTILS$$module$build$package=module$src$shared$util$GlobalUtils.default,BUILD_DATA$$module$build$package=module$build$build_data.default.build_data,API_REFLECTOR$$module$build$package=module$src$api$v2$ApiReflectorV2_1.default,RUNNING_IN_BROWSER$$module$build$package=module$src$shared$util$GlobalUtils.default.runningInBrowser(),RUNNING_IN_IFRAME$$module$build$package=module$src$shared$util$GlobalUtils.default.runningInIframe(),SETTING_DEFINITIONS$$module$build$package=
   {anchorElements:{type:"boolean",defval:RUNNING_IN_BROWSER$$module$build$package},authorization:{type:"string",defval:""},arkitbridge:{type:"boolean",defval:!1},brandedMode:{type:"boolean",defval:!0},busyGraphic:{type:"string",defval:null},createButtons:{type:"boolean",defval:!0},editMode:{type:"boolean",defval:!1},commitParameters:{type:"boolean",defval:!1},exportModal:{type:"boolean",defval:!0},downloadExportButtonName:{type:"string",defval:"download"},showControlsButton:{type:"boolean",defval:!0},
   showControlsInitial:{type:"boolean",defval:!1},showSettingsButton:{type:"boolean",defval:!0},showSettingsInitial:{type:"boolean",defval:!1},showZoomButton:{type:"boolean",defval:!0},zoomButtonResetsCamera:{type:"boolean",defval:!1},showFullscreenButton:{type:"boolean",defval:!0},showInitialSpinner:{type:"boolean",defval:!0},showBusySpinner:{type:"boolean",defval:!0},viewportOverlays:{type:"boolean",defval:!0},apiversion:{type:"string",defval:"2"},runtimeId:{type:"string",defval:""},blurSceneWhenBusy:{type:"boolean",
   defval:!0},deferGeometryLoading:{type:"boolean",defval:!1},ignoreSuperseded:{type:"boolean",defval:!0},exposeViewer:{type:"boolean",defval:!1},loggingLevel:{type:"number",defval:-1},messageLoggingLevel:{type:"number",defval:-1},iframeDebugging:{type:"boolean",defval:!1},modelViewUrl:{type:"string",defval:""},showSceneMode:{type:"number",defval:2},ticket:{type:"string",defval:""},iframeId:{type:"string",defval:"sdv-iframe"},commPluginRuntimeId:{type:"string",defval:"CommPlugin_1"},useModelSettings:{type:"boolean",
   defval:!0}},ParametricViewer$$module$build$package=function(){var b=this;this.constants=module$src$app$ViewerAppConstants.default;this.plugins={runtimeIds:[]};this.plugins.CommPlugin=module$src$plugins$comm$CommPlugin.default;this.plugins.PluginPrototype=module$src$plugins$PluginPrototype.default;this.apps={};this.apps.controls=module$src$api$apps$SDControls.default.default;this.apps.domElements=module$src$api$apps$DomElementManager.default;this.apps.overlays=module$src$api$apps$UIkitViewportOverlays.default;
   this.apps.exportModal=module$src$api$apps$UIkitExportModal.default;this.utils=module$src$shared$util$GlobalUtils.default;this.getBuildData=function(){return module$src$shared$util$GlobalUtils.default.deepCopy(module$build$build_data.default.build_data)};this.ParametricViewer=function(a){a=a||{};if(RUNNING_IN_IFRAME$$module$build$package&&(a.useQueryStringParameters||a.forceQueryStringParameters)){var c=module$src$shared$util$GlobalUtils.default.parseQueryString(window.location.search.substring(1));
   Object.keys(c).forEach(function(b){if(SETTING_DEFINITIONS$$module$build$package.hasOwnProperty(b)&&(a.forceQueryStringParameters||!a.hasOwnProperty(b))){var d=SETTING_DEFINITIONS$$module$build$package[b];a[b]="boolean"===d.type?module$src$shared$util$GlobalUtils.default.toBoolean(c[b],d.defval):"number"===d.type?module$src$shared$util$GlobalUtils.default.toNumber(c[b],d.defval):c[b]}})}a.domElementIdPrefix=a.domElementIdPrefix||"sdv-container";if(RUNNING_IN_BROWSER$$module$build$package){a.container||
   (a.container=document.getElementById(a.domElementIdPrefix+"-viewport"));!a.container&&1<(a.logginglevel&3)&&console.log("No viewport container");a.containerControls=void 0===a.containerControls?document.getElementById(a.domElementIdPrefix+"-controls"):a.containerControls;a.containerSettings=void 0===a.containerSettings?document.getElementById(a.domElementIdPrefix+"-settings"):a.containerSettings;var d=a.container?Array.isArray(a.container)&&0<a.container.length?a.container[0].parentElement:a.container.parentElement:
   null,e=a.containerControls,g=a.containerSettings;if(d&&e&&g){var h=d.parentElement,f=g.parentElement;if(h===e.parentElement&&h===f&&null!==h){var k=[h,d,e,g];a.resizeHandler=function(){var a="landscape",b="portrait",c=250,d=h.offsetWidth,f=0,l="landscape";"none"!==e.style.display&&(d-=c,f+=1);"none"!==g.style.display&&(d-=c,f+=1);h.offsetHeight>d&&(a="portrait",b="landscape",c=40+(1<f?99:198),l="portrait");k.forEach(function(c){c&&(c.classList.remove(b),c.classList.add(a))});e.style.flexBasis=c+"px";
   g.style.flexBasis=c+"px";c=new CustomEvent("viewer-resized",{detail:{mode:l,flexBasis:c,clientWidth:window.innerWidth}});g.dispatchEvent(c);e.dispatchEvent(c)};window.addEventListener("resize",a.resizeHandler);window.addEventListener("orientationchange",a.resizeHandler);a.resizeHandler()}}}Object.keys(SETTING_DEFINITIONS$$module$build$package).forEach(function(b){if(!a.hasOwnProperty(b)){var c=SETTING_DEFINITIONS$$module$build$package[b],d=b.toLowerCase();d=module$src$shared$util$GlobalUtils.default.getNodeAttribute(a.container,
   d,c.defval);a[b]="boolean"===c.type?module$src$shared$util$GlobalUtils.default.toBoolean(d,c.defval):"number"===c.type?module$src$shared$util$GlobalUtils.default.toNumber(d,c.defval):d}});if(1>a.showSceneMode||3<a.showSceneMode)a.showSceneMode=2;a.editMode||void 0!==a.showSettingsButton||(a.showSettingsButton=!1);for(var l in module$build$build_data.default.build_data)a[l]=module$build$build_data.default.build_data[l];RUNNING_IN_IFRAME$$module$build$package&&document.referrer&&parent.postMessage({type:"sdv-DOMContentLoaded",
   iframeId:a.iframeId},document.referrer);var m=new module$src$app$ViewerApp.default(a),n=m.api({version:a.apiversion,runtimeId:a.runtimeId});n.apps={};n.getApiV2=function(a){a=a||{};a.version=2;return m.api(a)};a.exposeViewer&&(module$build$build_data.default.build_data.build_branch.startsWith("feature")||module$build$build_data.default.build_data.build_branch.startsWith("development"))&&(n.getViewer=function(){console.warn("Direct access to the ShapeDiver Viewer is disabled for release builds.");
   return m});d=n;d.scene||(d=n.getApiV2());if(a.ticket){var q={runtimeId:a.commPluginRuntimeId,ticket:a.ticket,deferGeometryLoading:a.deferGeometryLoading,loggingLevel:a.loggingLevel,messageLoggingLevel:a.messageLoggingLevel,authorization:a.authorization,ignoreSuperseded:a.ignoreSuperseded};a.modelViewUrl&&(q.modelViewUrl=a.modelViewUrl);f=new b.plugins.CommPlugin(q);d.plugins.registerPluginAsync(f).then(function(c){RUNNING_IN_IFRAME$$module$build$package&&document.referrer&&(c.err||c.data&&"failed"===
   c.data.status?parent.postMessage({type:"sdv-CommPluginFailed",runtimeId:q.runtimeId,iframeId:a.iframeId},document.referrer):(b.plugins.runtimeIds.push(q.runtimeId),parent.postMessage({type:"sdv-CommPluginLoaded",data:c.data,runtimeId:q.runtimeId,iframeId:a.iframeId},document.referrer)))},function(b){RUNNING_IN_IFRAME$$module$build$package&&document.referrer&&parent.postMessage({type:"sdv-CommPluginFailed",err:b,runtimeId:q.runtimeId,iframeId:a.iframeId},document.referrer)})}if(a.viewportOverlays){var p=
   {containerViewport:a.container,containerControls:a.containerControls,containerSettings:a.containerSettings,domElementIdPrefix:a.domElementIdPrefix};"brandedMode createButtons showControlsButton showSettingsButton showControlsInitial showSettingsInitial showZoomButton showFullscreenButton showInitialSpinner showBusySpinner viewportOverlays zoomButtonResetsCamera resizeHandler".split(" ").forEach(function(b){p[b]=a[b]});try{n.apps.overlays=new b.apps.overlays(d,p),n.apps.overlays||n.warn("SDVApp.ParametricViewer",
   "Viewport overlays could not be created, has UIkit been loaded ?")}catch(t){delete n.apps.overlays,n.warn("SDVApp.ParametricViewer","Exception when creating viewport overlays, has UIkit been loaded ?",t)}a.busyGraphic&&n.apps.overlays.setBusyGraphic(a.busyGraphic)}if(a.containerControls){f={editMode:a.editMode,commitParameters:a.commitParameters};n.apps.overlays&&(f.showMessage=n.apps.overlays.showMessage);try{n.apps.controls=new b.apps.controls(d,a.containerControls,f,{onElementCreated:a.resizeHandler}),
   n.apps.controls||n.warn("SDVApp.ParametricViewer","Parameter controls could not be created.")}catch(t){delete n.apps.controls,n.warn("SDVApp.ParametricViewer","Exception when creating parameter controls",t)}}if(a.containerSettings)try{n.apps.settings=new b.apps.controls(d,a.containerSettings,{settings:!0,editMode:a.editMode},{onElementCreated:a.resizeHandler}),n.apps.settings||n.warn("SDVApp.ParametricViewer","Setting controls could not be created.")}catch(t){delete n.apps.settings,n.warn("SDVApp.ParametricViewer",
   "Exception when creating setting controls",t)}if(a.anchorElements)try{n.apps.domElements=new b.apps.domElements(d),n.apps.domElements||n.warn("SDVApp.ParametricViewer","Anchor elements app could not be created.")}catch(t){delete n.apps.domElements,n.warn("SDVApp.ParametricViewer","Exception when creating anchor elements app",t)}if(a.exportModal)try{n.apps.exportModal=new b.apps.exportModal(d,{domElementIdPrefix:a.domElementIdPrefix+"-modal-export",downloadExportButtonName:a.downloadExportButtonName}),
   n.apps.exportModal||n.warn("SDVApp.ParametricViewer","Modal dialog could not be created, has UIkit been loaded ?")}catch(t){delete n.apps.exportModal,n.warn("SDVApp.ParametricViewer","Exception when creating modal dialog",t)}var u=function(a){n.apps.overlays&&(a.setBusyGraphic=n.apps.overlays.setBusyGraphic,a.setBusyGraphicPosition=n.apps.overlays.setBusyGraphicPosition,a.hideControls=function(){n.apps.overlays.buttonOnClick("controls",!1);n.apps.overlays.toggleVisibility("controls",!1);a._callCommandResultCallback("hideControls",
   !0)},a.hideFullscreenToggle=function(){n.apps.overlays.toggleVisibility("fullscreen",!1);return!0},a.hideZoomToggle=function(){n.apps.overlays.toggleVisibility("zoom",!1);return!0},a.showControls=function(){n.apps.overlays.buttonOnClick("controls",!0);n.apps.overlays.toggleVisibility("controls",!0);a._callCommandResultCallback("showControls",!0)},a.showFullscreenToggle=function(){n.apps.overlays.toggleVisibility("fullscreen",!0);return!0},a.showZoomToggle=function(){n.apps.overlays.toggleVisibility("zoom",
   !0);return!0});return a};1===Number(a.apiversion)&&u(n);n.getApiV1=function(a){a=a||{};a.version=1;return u(m.api(a))};RUNNING_IN_IFRAME$$module$build$package&&document.referrer&&(d.apps||(d.apps=n.apps),(new module$src$api$v2$ApiReflectorV2_1.default(parent,document.referrer,a.iframeDebugging,a.iframeId)).reflect(d,"api").then(function(){parent.postMessage({type:"sdv-ViewerLoaded",iframeId:a.iframeId},document.referrer);a.iframeDebugging&&console.log("API object could be reflected")},function(){a.iframeDebugging&&
   console.log("API object could NOT be reflected")}));return n};return this};module$build$package.default=new ParametricViewer$$module$build$package;var SDVApp=module$build$package.default;
   
   
   
   //# sourceMappingURL=sdv.concat.min.js.map